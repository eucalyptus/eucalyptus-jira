{"errors":[],"detail":[{"repositories":[{"name":"eucalyptus","url":"https://github.com/eucalyptus/eucalyptus","commits":[{"id":"431e43094de0275ecd0393d66c8911e3d4d832df","displayId":"431e430","authorTimestamp":"2013-04-19T14:54:10.000+0000","url":"https://github.com/eucalyptus/eucalyptus/commit/431e43094de0275ecd0393d66c8911e3d4d832df","author":{"name":"Zach Hill","avatar":"https://avatars0.githubusercontent.com/u/1696308?v=4","url":"https://github.com/zhill"},"fileCount":72,"merge":false,"message":"Changes EBS attachments to be initiated from NC instead of CLC. Fixes EUCA-5179.\n\nChanges EBS message flow signifcantly and adds a new required network path from each\nNC to the SCs in the cluster regardless of which backend the SC is using.\n\nPrior to this commit the CLC would call attachVolume() on the SC an pass it the\nlist of IQNs for each NC in the cluster for BfEBS instances or the single specific\nNCs IQN for EBS volume attachments. The SC returned the connection string and the\nCLC would pass it down to the NC(s) via the CC.\n\nThis commit adds the concept of an attachment token to the EBS architecture. A single\nEBS attachment (for BfEBS or regular EBS) has an associated token that is requested by\nthe CLC prior to the call to the NC to do the attachment. That token is opaque and sent\nto any/all NCs involved in the attachment. Each NC then calls the ExportVolume() operation\non the SC to resolve the token and get a host-specific connection string used to connect\nthe EBS volume to the NC host.\n\nThis commit adds:\n1. New SOAP interface for SC to NC using a new XML namespace: storagecontroller.eucalyptus.com\n2. ExportVolume/UnexportVolume operations to be invoked by the NC on the SC\n3. GetVolumeToken operation invoked by the CLC on the SC to get a new token for a volume attachment\n4. A C client to make calls to the SC from the NC. And the associated eucalyptus_sc.wsdl\n5. New VolumeToken and VolumeExportRecord entities in eucalyptus_storage db to persist tokens and exports\n6. Refactoring of ebs volume operations in the NC into the single ebs_utils.c/h module to isolate ebs ops","files":[{"path":".gitignore","url":"https://github.com/eucalyptus/eucalyptus/commit/431e43094de0275ecd0393d66c8911e3d4d832df#diff-0","changeType":"MODIFIED","linesAdded":2,"linesRemoved":0},{"path":"clc/modules/cluster-manager/src/main/java/com/eucalyptus/blockstorage/VolumeManager.java","url":"https://github.com/eucalyptus/eucalyptus/commit/431e43094de0275ecd0393d66c8911e3d4d832df#diff-1","changeType":"MODIFIED","linesAdded":62,"linesRemoved":12},{"path":"clc/modules/cluster-manager/src/main/java/com/eucalyptus/cloud/run/ClusterAllocator.java","url":"https://github.com/eucalyptus/eucalyptus/commit/431e43094de0275ecd0393d66c8911e3d4d832df#diff-2","changeType":"MODIFIED","linesAdded":93,"linesRemoved":71},{"path":"clc/modules/cluster-manager/src/main/java/com/eucalyptus/vm/VmInstances.java","url":"https://github.com/eucalyptus/eucalyptus/commit/431e43094de0275ecd0393d66c8911e3d4d832df#diff-3","changeType":"MODIFIED","linesAdded":1,"linesRemoved":0},{"path":"clc/modules/core/src/main/java/com/eucalyptus/util/BlockStorageUtil.java","url":"https://github.com/eucalyptus/eucalyptus/commit/431e43094de0275ecd0393d66c8911e3d4d832df#diff-4","changeType":"MODIFIED","linesAdded":34,"linesRemoved":0}]},{"id":"8f48792e06e6e640c76947a5fd64778607e6ad4f","displayId":"8f48792","authorTimestamp":"2013-05-01T07:00:31.000+0000","url":"https://github.com/eucalyptus/eucalyptus/commit/8f48792e06e6e640c76947a5fd64778607e6ad4f","author":{"name":"Zach Hill","avatar":"https://avatars0.githubusercontent.com/u/1696308?v=4","url":"https://github.com/zhill"},"fileCount":41,"merge":false,"message":"Lots of fixes related to EUCA-5179 and ebs functionality.\n\nFixes for DASManager reload() and changed lv naming. Also added explicity db clean on cleanup of export\nFixes for BfEBS instance start from stop. Was accidentally using root volume for request to SC instead of other attached volumes.\n\nFixed disconnect perl script for netapp/emc where rescan check was incorrect and rescan was happening when it should not\n\nChanged lv/vg names from using random chars to labelled as the volume id\n\nAdded a bunch to make the Overlay/DAS detach synchronous and to implement separation of unexport and unexportAll.\n\nRenamed attach/detach to export/unexport throughout SC since it is more accurate. Split LVM ops out into the\nLVMWrapper class to clear up Overlay an DASManagers.\n\nAdded EucalyptusUnsupportedOperationException to handle the unexport() call in DAS/Overlay so that case can be\ndifferentiated from other failures.\n\nChanged some in VolumeInfo and VolumeToken to do better lookup of invalid and inactive exports.\n\nChanged volume state update on CLC to not rever to GENERATING state if no actualDeviceNam valid is found or is invalid is found as that is now a legitimate state for an unattached volume\n\nRemoved AOE entities tweaks to volume tokens and added some tests\n\nDescribeVolumes in SC return valid token instead of connection string now.\n\nAdded token tracking and cleanup as well as export tracking in the db.\n\nAlso made changes in the storage interfaces so changed the Overlay/DASManagers\nto conform with those changes. Removed the list of iqns for attach/detach. Added\na detachFromAll() function to explicitly\n\nVolumeInfo now has a reference to the set of VolumeTokens for it. Only one should\nbe marked valid at a time for any volume. Each VolumeToken has a set of\nVolumeExportRecords to track the ip,iqn, and connection string for each export.\nThere may be multiple exports valid for a single token.","files":[{"path":"clc/modules/cluster-manager/src/main/java/com/eucalyptus/blockstorage/VolumeManager.java","url":"https://github.com/eucalyptus/eucalyptus/commit/8f48792e06e6e640c76947a5fd64778607e6ad4f#diff-0","changeType":"MODIFIED","linesAdded":0,"linesRemoved":37},{"path":"clc/modules/cluster-manager/src/main/java/com/eucalyptus/blockstorage/Volumes.java","url":"https://github.com/eucalyptus/eucalyptus/commit/8f48792e06e6e640c76947a5fd64778607e6ad4f#diff-1","changeType":"MODIFIED","linesAdded":8,"linesRemoved":4},{"path":"clc/modules/cluster-manager/src/main/java/com/eucalyptus/cloud/run/ClusterAllocator.java","url":"https://github.com/eucalyptus/eucalyptus/commit/8f48792e06e6e640c76947a5fd64778607e6ad4f#diff-2","changeType":"MODIFIED","linesAdded":34,"linesRemoved":34},{"path":"clc/modules/cluster-manager/src/main/java/com/eucalyptus/vm/VmRuntimeState.java","url":"https://github.com/eucalyptus/eucalyptus/commit/8f48792e06e6e640c76947a5fd64778607e6ad4f#diff-3","changeType":"MODIFIED","linesAdded":8,"linesRemoved":5},{"path":"clc/modules/core/src/main/java/edu/ucsb/eucalyptus/cloud/entities/AOEMetaInfo.java","url":"https://github.com/eucalyptus/eucalyptus/commit/8f48792e06e6e640c76947a5fd64778607e6ad4f#diff-4","changeType":"DELETED","linesAdded":0,"linesRemoved":121}]}]}],"_instance":{"singleInstance":true,"baseUrl":"https://github.com","name":"GitHub","typeName":"GitHub","id":"github","type":"github"}}]}
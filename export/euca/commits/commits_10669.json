{"errors":[],"detail":[{"repositories":[{"name":"eucalyptus","url":"https://github.com/eucalyptus/eucalyptus","commits":[{"id":"0af8acfd2fde1afd6c024aa224d9cd18b007d708","displayId":"0af8acf","authorTimestamp":"2013-02-02T17:59:52.000+0000","url":"https://github.com/eucalyptus/eucalyptus/commit/0af8acfd2fde1afd6c024aa224d9cd18b007d708","author":{"name":"chris grzegorczyk","avatar":"https://avatars2.githubusercontent.com/u/985057?v=4","url":"https://github.com/grze"},"fileCount":51,"merge":false,"message":"Implementation of EUCA-4529.\n\n- Add user-facing operation for reading vm types\n- Add euca-describe-instance-types\n\nAlso relates to EUCA-223, EUCA-2764, EUCA-442.","files":[{"path":"clc/.classpath","url":"https://github.com/eucalyptus/eucalyptus/commit/0af8acfd2fde1afd6c024aa224d9cd18b007d708#diff-0","changeType":"MODIFIED","linesAdded":7,"linesRemoved":1},{"path":"clc/eucadmin/bin/euca-describe-instance-types","url":"https://github.com/eucalyptus/eucalyptus/commit/0af8acfd2fde1afd6c024aa224d9cd18b007d708#diff-1","changeType":"ADDED","linesAdded":32,"linesRemoved":0},{"path":"clc/eucadmin/bin/euca-modify-instance-type-attribute","url":"https://github.com/eucalyptus/eucalyptus/commit/0af8acfd2fde1afd6c024aa224d9cd18b007d708#diff-2","changeType":"ADDED","linesAdded":32,"linesRemoved":0},{"path":"clc/eucadmin/eucadmin/describeinstancetypes.py","url":"https://github.com/eucalyptus/eucalyptus/commit/0af8acfd2fde1afd6c024aa224d9cd18b007d708#diff-3","changeType":"ADDED","linesAdded":102,"linesRemoved":0},{"path":"clc/eucadmin/eucadmin/modifyinstancetype.py","url":"https://github.com/eucalyptus/eucalyptus/commit/0af8acfd2fde1afd6c024aa224d9cd18b007d708#diff-4","changeType":"ADDED","linesAdded":136,"linesRemoved":0}]},{"id":"69b0edf1a710421b375ab28a69c2f34cb5b7ff77","displayId":"69b0edf","authorTimestamp":"2013-05-15T14:58:40.000+0000","url":"https://github.com/eucalyptus/eucalyptus/commit/69b0edf1a710421b375ab28a69c2f34cb5b7ff77","author":{"name":"chris grzegorczyk","avatar":"https://avatars2.githubusercontent.com/u/985057?v=4","url":"https://github.com/grze"},"fileCount":13,"merge":false,"message":"Fixes to instance type handling, syntax, ordering\n\nChanges are properly persisted and re-read from the database.\nSo, a modify will be saved, and after failover/upgrade/restart\nbe re-read correctly.\n\nAlong with this persisting of changes using the UI is fixed.\n\nThe name of the operations are now fixed to be InstanceType\nrather than VmType.  Corresponding adjust made in euca2ools\nand included here are for the console and autoscaling.\n\nType ordering restriction is relaxed in the following way:\n- Instance types are not /required/ to be partial ordered\n- Instances types which are /not/ partially ordered are\n  treated as a degenerate case.\n- The system determines the set of partially ordered types\n  and as long as run-instance requests during a duty cycle\n  only refer to ordered types the system behaves as it did\n  before.\n- Should an unordered type be requested, or be inflight when\n  any other run-instance request arrives, the request will\n  be preceded by and immediately followed by a CC downcall\n  to update resource state information.  Note that only the\n  preceding resource state update happens synchronously.\n- The state updates must happen whenever there is an as-yet-\n  unfulfilled request that references an unordered type.\n  Otherwise, the ordered type resource accounting is skewed.\n- Below is a script for computing the set of conflicting or\n  unordered instance types and could serve as the basis for\n  future enhancement to tighten up resource accounting and\n  perhaps allow removing the synchronous special case update.\n\nThis functionality supercedes the previous approach using\n'euca-describe-availability-zones verbose' which will be\ndeprecated in a subsequent release.\n\nThe following tickets are addressed\n- EUCA-442  instance types can be set out of order\n- EUCA-6018 persisting changes to instance types\n- EUCA-5915 IAM policy checking\n- EUCA-5968 modification of instance types in the admin ui\n- EUCA-6041 upgrading of instances types using old values\n- EUCA-6042 adjust operation and parameter naming to prefer instance to vm\n- EUCA-6095 changes in admin ui are saved properly\n- EUCA-4529 api for retrieving instance type information\n- EUCA-3635 non-ui method for modifying instance types\n- EUCA-3056 instance types can be set out of order\n\nimport org.apache.log4j.Logger\nimport com.eucalyptus.scripting.Groovyness\nimport com.eucalyptus.vmtypes.VmType\nimport com.eucalyptus.vmtypes.VmTypes\n\nLogger LOG = Logger.getLogger( \"TESTING\" );\n\ndef conflictVms=[:], res = [:]\ndef comparator = { compVm, vm ->\n  boolean gtcpu = vm.cpu > compVm.cpu, eqcpu = vm.cpu == compVm.cpu, ltcpu = vm.cpu < compVm.cpu;\n  boolean gtdisk = vm.disk > compVm.disk, eqdisk = vm.disk == compVm.disk, ltdisk = vm.disk < compVm.disk;\n  boolean gtmemory = vm.memory > compVm.memory, eqmem = vm.memory == compVm.memory, ltmem = vm.memory < compVm.memory;\n\n  boolean singleOrder = ( gtcpu && gtdisk && ltmem ) ||\n      ( gtcpu && gtmemory && ltdisk ) ||\n      ( gtdisk && gtmemory && ltcpu );\n\n  boolean doubleOrder = ( gtmemory && ltcpu && ltdisk ) ||\n      ( gtdisk && ltcpu && ltmem ) ||\n      ( gtcpu && ltdisk && ltmem );\n\n  !compVm.equals(vm) && ( singleOrder || doubleOrder )\n}\nvmTypes.each {\n  conflictVms[it.name]=[]\n}\nvmTypes.each{ compVm ->\n  def c=compVm.cpu,m=compVm.memory;\n  vmTypes.findAll{ comparator(compVm,it) }.each{ vm ->\n    c = vm.cpu >= c && vm.memory < m ? vm.cpu : c;\n    m = vm.memory >= m && vm.cpu < c ? vm.memory : m;\n    conflictVms[compVm.name].add(vm.name)\n  }\n  res[compVm.name]= VmType.create(compVm.name,c,compVm.disk,m);\n}\nreturn (\".\\n\"+\nres.collect{ dimension ->\n  dimension.collect{ \"\\n${dimension.key}\\t${VmTypes.lookup(dimension.key)}\\n${dimension.key}\\t${it.value} (${conflictVms[dimension.key].sort()})\" }\n}\n+ \"\\n.\"\n).toString().replace(\"[\",\"\").replace(\"]\",\"\").replace( \") ,\",')')","files":[{"path":"clc/modules/autoscaling/src/main/java/com/eucalyptus/autoscaling/activities/ActivityManager.java","url":"https://github.com/eucalyptus/eucalyptus/commit/69b0edf1a710421b375ab28a69c2f34cb5b7ff77#diff-0","changeType":"MODIFIED","linesAdded":7,"linesRemoved":7},{"path":"clc/modules/cloud/src/main/java/com/eucalyptus/vmtypes/VmTypeMessages.groovy","url":"https://github.com/eucalyptus/eucalyptus/commit/69b0edf1a710421b375ab28a69c2f34cb5b7ff77#diff-1","changeType":"MODIFIED","linesAdded":18,"linesRemoved":4},{"path":"clc/modules/cluster-manager/src/main/java/com/eucalyptus/cloud/ResourceToken.java","url":"https://github.com/eucalyptus/eucalyptus/commit/69b0edf1a710421b375ab28a69c2f34cb5b7ff77#diff-2","changeType":"MODIFIED","linesAdded":11,"linesRemoved":0},{"path":"clc/modules/cluster-manager/src/main/java/com/eucalyptus/cloud/run/AdmissionControl.java","url":"https://github.com/eucalyptus/eucalyptus/commit/69b0edf1a710421b375ab28a69c2f34cb5b7ff77#diff-3","changeType":"MODIFIED","linesAdded":19,"linesRemoved":0},{"path":"clc/modules/cluster-manager/src/main/java/com/eucalyptus/cluster/Cluster.java","url":"https://github.com/eucalyptus/eucalyptus/commit/69b0edf1a710421b375ab28a69c2f34cb5b7ff77#diff-4","changeType":"MODIFIED","linesAdded":9,"linesRemoved":3}]}]}],"_instance":{"singleInstance":true,"baseUrl":"https://github.com","name":"GitHub","typeName":"GitHub","id":"github","type":"github"}}]}
{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"27558","self":"https://eucalyptus.atlassian.net/rest/api/2/issue/27558","key":"EUCA-8775","fields":{"issuetype":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://eucalyptus.atlassian.net/secure/viewavatar?size=xsmall&avatarId=14803&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":14803},"timespent":null,"customfield_13100":null,"project":{"self":"https://eucalyptus.atlassian.net/rest/api/2/project/10000","id":"10000","key":"EUCA","name":"Eucalyptus","avatarUrls":{"48x48":"https://eucalyptus.atlassian.net/secure/projectavatar?pid=10000&avatarId=10011","24x24":"https://eucalyptus.atlassian.net/secure/projectavatar?size=small&pid=10000&avatarId=10011","16x16":"https://eucalyptus.atlassian.net/secure/projectavatar?size=xsmall&pid=10000&avatarId=10011","32x32":"https://eucalyptus.atlassian.net/secure/projectavatar?size=medium&pid=10000&avatarId=10011"}},"customfield_11000":null,"fixVersions":[],"customfield_11001":null,"aggregatetimespent":null,"customfield_10310":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/10209","value":"CentOS 6","id":"10209"}],"resolution":null,"customfield_10311":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/10308","value":"Managed-NOVLAN","id":"10308"}],"customfield_11401":null,"customfield_11400":null,"customfield_10500":{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/10403","value":"Not Applicable","id":"10403"},"customfield_10104":[],"customfield_10302":null,"customfield_10303":null,"customfield_10105":null,"customfield_10700":null,"customfield_10304":null,"customfield_10701":null,"customfield_10306":{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/10201","value":"Medium","id":"10201"},"customfield_10702":null,"customfield_10703":null,"customfield_10308":null,"customfield_10704":null,"resolutiondate":null,"customfield_10705":null,"customfield_10309":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/10203","value":"Xen","id":"10203"}],"workratio":-1,"watches":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/EUCA-8775/watchers","watchCount":4,"isWatching":false},"lastViewed":null,"created":"2014-02-22T21:58:01.733-0600","customfield_12000":null,"customfield_12400":null,"priority":{"self":"https://eucalyptus.atlassian.net/rest/api/2/priority/3","iconUrl":"https://eucalyptus.atlassian.net/images/icons/priorities/major.svg","name":"Major","id":"3"},"customfield_12201":null,"customfield_10102":null,"customfield_10300":null,"customfield_12600":"{}","labels":[],"customfield_10301":null,"customfield_11700":null,"aggregatetimeoriginalestimate":null,"timeestimate":null,"versions":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/version/10602","id":"10602","description":"Eucalyptus 3.3.0","name":"3.3.0","archived":false,"released":true,"releaseDate":"2013-06-18"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/version/12106","id":"12106","description":"Eucalyptus 3.3.1","name":"3.3.1","archived":false,"released":true,"releaseDate":"2013-08-27"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/version/12107","id":"12107","description":"Eucalyptus 3.3.2","name":"3.3.2","archived":false,"released":true,"releaseDate":"2013-10-02"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/version/12105","id":"12105","description":"Eucalyptus 3.4.0","name":"3.4.0","archived":false,"released":true,"releaseDate":"2013-10-24"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/version/12801","id":"12801","description":"Eucalyptus 3.4.1","name":"3.4.1","archived":false,"released":true,"releaseDate":"2013-12-16"}],"customfield_11901":null,"issuelinks":[],"assignee":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=vasya","name":"vasya","key":"vasya","accountId":"557058:1c63481a-0634-4ae7-9004-cb0f143e141f","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/fa832ffa4e20c9aa05ac272214d43196?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dvasya%26avatarId%3D10408%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/fa832ffa4e20c9aa05ac272214d43196?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dvasya%26avatarId%3D10408%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/fa832ffa4e20c9aa05ac272214d43196?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dvasya%26avatarId%3D10408%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/fa832ffa4e20c9aa05ac272214d43196?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dvasya%26avatarId%3D10408%26noRedirect%3Dtrue"},"displayName":"Vasiliy Kochergin","active":false,"timeZone":"America/Los_Angeles"},"updated":"2016-10-28T11:56:15.488-0500","status":{"self":"https://eucalyptus.atlassian.net/rest/api/2/status/10001","description":"This issue has been validated/reproduced, but has not been prioritized yet.","iconUrl":"https://eucalyptus.atlassian.net/images/icons/statuses/generic.png","name":"Confirmed","id":"10001","statusCategory":{"self":"https://eucalyptus.atlassian.net/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"components":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/component/10014","id":"10014","name":"Storage Controller"}],"timeoriginalestimate":null,"description":"In Eucalyptus 3.3, the Eucalyptus-SC supports creating volumes as sparse files.  Only if the \"Zero-fill volumes\" checkbox under the SC setup is checked are sparse files not used.  This is a very nice feature as larger volumes can be created in less time and will require less disk space initially.\r\n\r\nHOWEVER, when creating a snapshot of a \"sparse file\" volume, a \"sparse file\" copy is not made.  The snapshot always zero-fills the volume.\r\n\r\nDisk space usage of sparse files can be checked with the \"-s\" option of ls:\r\n\r\nFor example, here is the behavior when working with a 30GB volume:\r\n\r\nOriginal volume only 279M as a sparse file:\r\n279M -rw-r--r--  1 root       root        31G Feb 22 20:47 vol-0942421F\r\n\r\nSnapshot is 31G !\r\n 31G -rw-r--r--  1 root       root        30G Feb 22 15:14 snap-C3513D77\r\n\r\nVolume created from the snapshot is also 31G !\r\n 31G -rw-r--r--  1 root       root        31G Feb 22 20:36 vol-9A603FED\r\n\r\nI suspect that since the volume has ballooned, all operations will require much more time!  \r\n\r\nBoth volumes and snapshots should remain as sparse files to conserve disk space and time of minimize file operations.\r\n\r\nThe \"--sparse=always\" flag of cp should force a file copy to be sparse.\r\nRsync also offers the \"-S\" flag.\r\n\r\nNote:\r\nI have not tested this in Euca 3.4.x, but I searched JIRA and couldn't find this issue...","customfield_13000":null,"customfield_13200":null,"customfield_11300":null,"customfield_11500":null,"timetracking":{},"customfield_10005":null,"customfield_10401":null,"customfield_10600":null,"customfield_12900":null,"aggregatetimeestimate":null,"attachment":[],"summary":"Volume Snapshots are not created as sparse files","creator":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=wlloyd","name":"wlloyd","key":"wlloyd","accountId":"557058:e7bbe1b9-5ad1-43f6-9780-334c73017bd1","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/50ec8d8b1a23b63b5e58ae33c163c6f6?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FavatarId%3D10122%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/50ec8d8b1a23b63b5e58ae33c163c6f6?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26avatarId%3D10122%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/50ec8d8b1a23b63b5e58ae33c163c6f6?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26avatarId%3D10122%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/50ec8d8b1a23b63b5e58ae33c163c6f6?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26avatarId%3D10122%26noRedirect%3Dtrue"},"displayName":"Wes Lloyd","active":true,"timeZone":"US/Central"},"subtasks":[],"reporter":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=wlloyd","name":"wlloyd","key":"wlloyd","accountId":"557058:e7bbe1b9-5ad1-43f6-9780-334c73017bd1","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/50ec8d8b1a23b63b5e58ae33c163c6f6?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FavatarId%3D10122%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/50ec8d8b1a23b63b5e58ae33c163c6f6?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26avatarId%3D10122%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/50ec8d8b1a23b63b5e58ae33c163c6f6?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26avatarId%3D10122%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/50ec8d8b1a23b63b5e58ae33c163c6f6?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26avatarId%3D10122%26noRedirect%3Dtrue"},"displayName":"Wes Lloyd","active":true,"timeZone":"US/Central"},"customfield_12100":"0|i02k2v:","aggregateprogress":{"progress":0,"total":0},"customfield_10000":null,"customfield_10001":"2016-10-26T23:21:33.856-0500","customfield_10200":null,"customfield_10002":null,"customfield_10003":null,"customfield_12500":null,"customfield_10400":null,"customfield_10116":null,"customfield_11600":["vasya(vasya)","wlloyd(wlloyd)"],"customfield_10117":null,"environment":null,"customfield_11800":null,"customfield_11802":null,"customfield_11805":null,"duedate":null,"customfield_11806":null,"progress":{"progress":0,"total":0},"votes":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/EUCA-8775/votes","votes":0,"hasVoted":false},"comment":{"comments":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/27558/comment/63307","id":"63307","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=wlloyd","name":"wlloyd","key":"wlloyd","accountId":"557058:e7bbe1b9-5ad1-43f6-9780-334c73017bd1","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/50ec8d8b1a23b63b5e58ae33c163c6f6?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FavatarId%3D10122%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/50ec8d8b1a23b63b5e58ae33c163c6f6?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26avatarId%3D10122%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/50ec8d8b1a23b63b5e58ae33c163c6f6?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26avatarId%3D10122%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/50ec8d8b1a23b63b5e58ae33c163c6f6?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26avatarId%3D10122%26noRedirect%3Dtrue"},"displayName":"Wes Lloyd","active":true,"timeZone":"US/Central"},"body":"Please note this documentation, under \"Snapshotting Volumes\" suggests that dd is used to create snapshots.\r\nBut the option \"count=0\" is not used to force a sparse file to be created:\r\n\r\nhttps://support.eucalyptus.com/hc/en-us/articles/200735764-Understanding-EBS-Volume-iSCSI-Management-in-Eucalyptus\r\n\r\nhttp://prefetch.net/blog/index.php/2009/07/05/creating-sparse-files-on-linux-hosts-with-dd/","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=wlloyd","name":"wlloyd","key":"wlloyd","accountId":"557058:e7bbe1b9-5ad1-43f6-9780-334c73017bd1","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/50ec8d8b1a23b63b5e58ae33c163c6f6?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FavatarId%3D10122%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/50ec8d8b1a23b63b5e58ae33c163c6f6?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26avatarId%3D10122%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/50ec8d8b1a23b63b5e58ae33c163c6f6?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26avatarId%3D10122%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/50ec8d8b1a23b63b5e58ae33c163c6f6?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26avatarId%3D10122%26noRedirect%3Dtrue"},"displayName":"Wes Lloyd","active":true,"timeZone":"US/Central"},"created":"2014-02-24T13:00:20.423-0600","updated":"2014-02-24T13:00:20.423-0600"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/27558/comment/63310","id":"63310","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=wlloyd","name":"wlloyd","key":"wlloyd","accountId":"557058:e7bbe1b9-5ad1-43f6-9780-334c73017bd1","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/50ec8d8b1a23b63b5e58ae33c163c6f6?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FavatarId%3D10122%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/50ec8d8b1a23b63b5e58ae33c163c6f6?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26avatarId%3D10122%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/50ec8d8b1a23b63b5e58ae33c163c6f6?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26avatarId%3D10122%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/50ec8d8b1a23b63b5e58ae33c163c6f6?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26avatarId%3D10122%26noRedirect%3Dtrue"},"displayName":"Wes Lloyd","active":true,"timeZone":"US/Central"},"body":"A use case where this is a problem is as follows:\r\n\r\nWe had two sparse 30GB volumes which only consumed about 2.8 GB.\r\n\r\nls -alsh\r\n279M -rw-r--r--  1 root       root        31G Feb 24 13:48 vol-0942421F\r\n2.5G -rw-r--r--  1 root       root        31G Feb 22 23:45 vol-0D20400F\r\n\r\nWe had to snapshot and then make volumes from the snapshots to duplicate the volumes for additional instances of the same VMs.  This cost a whopping 120GB.\r\n\r\nThis is not scalable as disk space is quickly consumed and is also slow because of time spent making the zero-fill snapshots and volumes:\r\n\r\nls -alsh\r\n 31G -rw-r--r--  1 root       root        30G Feb 22 14:43 snap-AD933BCF\r\n 31G -rw-r--r--  1 root       root        30G Feb 22 15:14 snap-C3513D77\r\n 31G -rw-r--r--  1 root       root        31G Feb 24 13:48 vol-2FAB3DCC\r\n 31G -rw-r--r--  1 root       root        31G Feb 24 13:40 vol-EE4E3F0D\r\n\r\nOuch = 124 GB! for what was 2.8 GB!\r\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=wlloyd","name":"wlloyd","key":"wlloyd","accountId":"557058:e7bbe1b9-5ad1-43f6-9780-334c73017bd1","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/50ec8d8b1a23b63b5e58ae33c163c6f6?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FavatarId%3D10122%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/50ec8d8b1a23b63b5e58ae33c163c6f6?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26avatarId%3D10122%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/50ec8d8b1a23b63b5e58ae33c163c6f6?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26avatarId%3D10122%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/50ec8d8b1a23b63b5e58ae33c163c6f6?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26avatarId%3D10122%26noRedirect%3Dtrue"},"displayName":"Wes Lloyd","active":true,"timeZone":"US/Central"},"created":"2014-02-24T14:52:08.067-0600","updated":"2014-02-24T14:52:08.067-0600"}],"maxResults":2,"total":2,"startAt":0},"customfield_11808":null,"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]}}}
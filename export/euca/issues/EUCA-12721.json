{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"48105","self":"https://eucalyptus.atlassian.net/rest/api/2/issue/48105","key":"EUCA-12721","fields":{"issuetype":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://eucalyptus.atlassian.net/secure/viewavatar?size=xsmall&avatarId=14803&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":14803},"timespent":null,"customfield_13100":null,"project":{"self":"https://eucalyptus.atlassian.net/rest/api/2/project/10000","id":"10000","key":"EUCA","name":"Eucalyptus","avatarUrls":{"48x48":"https://eucalyptus.atlassian.net/secure/projectavatar?pid=10000&avatarId=10011","24x24":"https://eucalyptus.atlassian.net/secure/projectavatar?size=small&pid=10000&avatarId=10011","16x16":"https://eucalyptus.atlassian.net/secure/projectavatar?size=xsmall&pid=10000&avatarId=10011","32x32":"https://eucalyptus.atlassian.net/secure/projectavatar?size=medium&pid=10000&avatarId=10011"}},"customfield_11000":null,"customfield_11001":null,"fixVersions":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/version/18100","id":"18100","description":"Eucalyptus 4.4.0","name":"4.4.0","archived":false,"released":true,"releaseDate":"2017-03-07"}],"aggregatetimespent":null,"resolution":{"self":"https://eucalyptus.atlassian.net/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_10310":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/12601","value":"CentOS 7","id":"12601"}],"customfield_10311":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/12401","value":"VPC-MIDO","id":"12401"}],"customfield_11401":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=tony","name":"tony","key":"tony","accountId":"557058:353956db-b78c-4f3b-9096-f8f58e6709c8","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/14ec1b18e630cc0743492fc327a12df7?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dtony%26avatarId%3D16600%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/14ec1b18e630cc0743492fc327a12df7?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dtony%26avatarId%3D16600%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/14ec1b18e630cc0743492fc327a12df7?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dtony%26avatarId%3D16600%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/14ec1b18e630cc0743492fc327a12df7?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dtony%26avatarId%3D16600%26noRedirect%3Dtrue"},"displayName":"Tony Beckham","active":true,"timeZone":"America/Tijuana"},"customfield_11400":null,"customfield_10500":{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/10403","value":"Not Applicable","id":"10403"},"customfield_10302":null,"customfield_10104":["com.atlassian.greenhopper.service.sprint.Sprint@774979a3[id=140,rapidViewId=118,state=CLOSED,name=4.4.0 Sprint 1,goal=,startDate=2016-09-06T16:08:39.183Z,endDate=2016-09-26T22:08:00.000Z,completeDate=2016-09-27T14:08:28.095Z,sequence=140]","com.atlassian.greenhopper.service.sprint.Sprint@2cda41a8[id=141,rapidViewId=118,state=CLOSED,name=4.4.0 Sprint 2,goal=,startDate=2016-09-27T14:08:02.191Z,endDate=2016-10-17T20:08:00.000Z,completeDate=2016-10-18T13:35:10.406Z,sequence=141]"],"customfield_10303":null,"customfield_10105":null,"customfield_10700":null,"customfield_10304":null,"customfield_10701":null,"customfield_10702":null,"customfield_10306":{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/10200","value":"High","id":"10200"},"customfield_10703":null,"customfield_10308":null,"customfield_10704":null,"resolutiondate":"2017-01-05T10:10:24.082-0600","customfield_10309":null,"customfield_10705":null,"workratio":-1,"lastViewed":null,"watches":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/EUCA-12721/watchers","watchCount":4,"isWatching":false},"created":"2016-09-02T16:38:24.366-0500","customfield_12000":null,"customfield_12400":null,"priority":{"self":"https://eucalyptus.atlassian.net/rest/api/2/priority/2","iconUrl":"https://eucalyptus.atlassian.net/images/icons/priorities/critical.svg","name":"Critical","id":"2"},"customfield_12201":null,"customfield_10300":null,"customfield_10102":null,"customfield_12600":"{repository={count=2, dataType=repository}, json={\"cachedValue\":{\"errors\":[],\"summary\":{\"repository\":{\"overall\":{\"count\":2,\"lastUpdated\":\"2016-09-27T12:50:26.000-0500\",\"dataType\":\"repository\"},\"byInstanceType\":{\"github\":{\"count\":2,\"name\":\"GitHub\"}}}}},\"isStale\":true}}","labels":[],"customfield_10301":null,"customfield_11700":null,"aggregatetimeoriginalestimate":null,"timeestimate":null,"customfield_11901":null,"versions":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/version/16800","id":"16800","description":"Eucalyptus 4.3.0","name":"4.3.0","archived":false,"released":true,"releaseDate":"2016-08-09"}],"issuelinks":[{"id":"43405","self":"https://eucalyptus.atlassian.net/rest/api/2/issueLink/43405","type":{"id":"10600","name":"Bonfire Testing","inward":"discovered while testing","outward":"testing discovered","self":"https://eucalyptus.atlassian.net/rest/api/2/issueLinkType/10600"},"outwardIssue":{"id":"48811","key":"EUCA-12780","self":"https://eucalyptus.atlassian.net/rest/api/2/issue/48811","fields":{"summary":"Delay in network information processing when running instance","status":{"self":"https://eucalyptus.atlassian.net/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://eucalyptus.atlassian.net/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://eucalyptus.atlassian.net/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://eucalyptus.atlassian.net/rest/api/2/priority/3","iconUrl":"https://eucalyptus.atlassian.net/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://eucalyptus.atlassian.net/secure/viewavatar?size=xsmall&avatarId=14803&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":14803}}}}],"assignee":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=tony","name":"tony","key":"tony","accountId":"557058:353956db-b78c-4f3b-9096-f8f58e6709c8","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/14ec1b18e630cc0743492fc327a12df7?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dtony%26avatarId%3D16600%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/14ec1b18e630cc0743492fc327a12df7?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dtony%26avatarId%3D16600%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/14ec1b18e630cc0743492fc327a12df7?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dtony%26avatarId%3D16600%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/14ec1b18e630cc0743492fc327a12df7?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dtony%26avatarId%3D16600%26noRedirect%3Dtrue"},"displayName":"Tony Beckham","active":true,"timeZone":"America/Tijuana"},"updated":"2017-01-05T10:10:24.093-0600","status":{"self":"https://eucalyptus.atlassian.net/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://eucalyptus.atlassian.net/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://eucalyptus.atlassian.net/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/component/11504","id":"11504","name":"EC2"}],"timeoriginalestimate":null,"customfield_13000":null,"description":"Mido router 'eucart' is missing the route for EIPs which have been moved (re-associated) more than once. The EIP can be moved 1 time without a noticeable issue. The EIP can not be associated with the original or 3rd+ instance after it's first re-association. \r\nThe route will return if the EIP is re-associated with the 2nd instance/association. \r\n\r\nThanks, \r\n-M\r\n\r\n{code}\r\nIn [214]: eip.associate(network_interface_id=vm2.interfaces[0].id)\r\nOut[214]: True\r\nIn [218]: for route in eucart.get_routes():\r\n    if route.get_dst_network_addr() == eip.public_ip:\r\n        md.show_routes(route)\r\n        print 'got it!'\r\n        break\r\n[2016-09-02 14:29:29,717][INFO][MidoDebug:10.111.5.10]:\r\n+------------------+-----------+-------------+--------------------------------------+--------+--------------------------------------+\r\n|   Destination    |   Source  |  nexthopGW  |               nexthop                | weight |                  ID                  |\r\n+------------------+-----------+-------------+--------------------------------------+--------+--------------------------------------+\r\n| 10.116.216.58/32 | 0.0.0.0/0 | 169.254.0.8 | 0ebc84fd-4239-4bbf-8ce4-53126182b5c2 |  100   | 98aa395f-57c9-4ac4-9984-18bf0eacd4f0 |\r\n+------------------+-----------+-------------+--------------------------------------+--------+--------------------------------------+\r\n\r\ngot it!\r\n\r\nIn [219]: eip.associate(network_interface_id=vm1.interfaces[0].id)\r\nOut[219]: True\r\n\r\nIn [220]: eucart = md.get_router_by_name('eucart')\r\nIn [221]: for route in eucart.get_routes():\r\n    if route.get_dst_network_addr() == eip.public_ip:\r\n        md.show_routes(route)\r\n        print 'got it!'\r\n        break\r\n\r\n<not there>\r\n\r\nassociate it with the previous vm and the route returns...\r\nIn [222]: eip.associate(network_interface_id=vm2.interfaces[0].id)\r\nOut[222]: True\r\n\r\nIn [223]: eucart = md.get_router_by_name('eucart')\r\n\r\nIn [224]: for route in eucart.get_routes():\r\n    if route.get_dst_network_addr() == eip.public_ip:\r\n        md.show_routes(route)\r\n        print 'got it!'\r\n        break\r\n+------------------+-----------+-------------+--------------------------------------+--------+--------------------------------------+\r\n|   Destination    |   Source  |  nexthopGW  |               nexthop                | weight |                  ID                  |\r\n+------------------+-----------+-------------+--------------------------------------+--------+--------------------------------------+\r\n| 10.116.216.58/32 | 0.0.0.0/0 | 169.254.0.8 | 0ebc84fd-4239-4bbf-8ce4-53126182b5c2 |  100   | 165e3aa9-fcb9-4e8b-9506-a95fd0120a9b |\r\n+------------------+-----------+-------------+--------------------------------------+--------+--------------------------------------+\r\n\r\ngot it!\r\n\r\n{code}\r\n\r\nTest setup details....\r\n\r\nCreate 2 instances, same subnet, group, etc.. Verify ssh connectivity to the VMs...\r\n\r\n{code}\r\nIn [95]: vm1, vm2 = vt.get_test_instances(zone='one', group_id=group.id, vpc_id=vpc.id, subnet_id=subnet.id, count=2)\r\n\r\n+---------------------+--------------------+-------------------+----------------------------------------------------------------------------+\r\n|INSTANCE ID          |INSTANCE IMAGE      |INSTANCE STATE     |INSTANCE NETWORK INFO:                                                      |\r\n+---------------------+--------------------+-------------------+----------------------------------------------------------------------------+\r\n|ID: i-38ac04e1       |EMI: emi-9a08c6d8   |STATE: running     |NODE:???              KEYPAIR:VpcBasics_000569605883_147284757617           |\r\n|TYPE: m1.small       |OS: linux           |AGE: 49            |+------------+---------------+-----------+-+---------------+---------------+|\r\n|RES: r-bba5821c      |VIRT: HVM           |ZONE: one          ||    VPC     |     SUBNET    |  SEC GRPS |P|    PRIV IP    |     PUB IP    ||\r\n|ACCOUNT ID:          |IMAGE NAME:         |ROOTDEV:           |+------------+---------------+-----------+-+---------------+---------------+|\r\n|000569605883         |preciseservercloud..|instance-store     ||vpc-d2371df1|subnet-5703719c|sg-371a2093|N|  172.1.24.231 | 10.116.220.127||\r\n+---------------------+--------------------+-------------------+----------------------------------------------------------------------------+\r\n|ID: i-beacd299       |EMI: emi-9a08c6d8   |STATE: running     |NODE:???              KEYPAIR:VpcBasics_000569605883_147284757617           |\r\n|TYPE: m1.small       |OS: linux           |AGE: 49            |+------------+---------------+-----------+-+---------------+---------------+|\r\n|RES: r-bba5821c      |VIRT: HVM           |ZONE: one          ||    VPC     |     SUBNET    |  SEC GRPS |P|    PRIV IP    |     PUB IP    ||\r\n|ACCOUNT ID:          |IMAGE NAME:         |ROOTDEV:           |+------------+---------------+-----------+-+---------------+---------------+|\r\n|000569605883         |preciseservercloud..|instance-store     ||vpc-d2371df1|subnet-5703719c|sg-371a2093|N|  172.1.24.183 | 10.116.216.83 ||\r\n+---------------------+--------------------+-------------------+----------------------------------------------------------------------------+\r\n{code}\r\n\r\nThe above method connects via ssh, but double check tcp port 22 on each vm...\r\n\r\n{code}\r\nIn [105]: test_port_status(vm1.ip_address, 22)\r\ntest_port_status, ip:10.116.220.127, port:22, TCP:True\r\ntest_port_status, success\r\n\r\nIn [106]: test_port_status(vm2.ip_address, 22)\r\ntest_port_status, ip:10.116.216.83, port:22, TCP:True\r\ntest_port_status, success\r\n\r\n{code}\r\n\r\n\r\n\r\n\r\nAllocate an EIP...\r\n\r\n{code}\r\n\r\nIn [96]: eip = user.ec2.allocate_address()\r\n[09-02 13:48:32][DEBUG][EC2ops(admin:testrunner)]: Attempting to allocate an address...\r\n[09-02 13:48:33][DEBUG][EC2ops(admin:testrunner)]: Allocated Address:10.116.216.58\r\n\r\nIn [97]: user.ec2.show_addresses(eip)\r\n[09-02 13:48:40][INFO][EC2ops(admin:testrunner)]:\r\n+---------------+--------------+--------------------------------------------+--------------+\r\n| PUBLIC IP     | ACCOUNT NAME | REGION                                     | ADDRESS INFO |\r\n+---------------+--------------+--------------------------------------------+--------------+\r\n| 10.116.216.58 |              | ec2.h-12.autoqa.qa1.eucalyptus-systems.com | None         |\r\n+---------------+--------------+--------------------------------------------+--------------+\r\n\r\n{code}\r\n\r\n\r\nVM1  ENI info before associating the new test EIP...\r\n\r\n{code}\r\nIn [98]: vm1.show_enis()\r\n[09-02 13:49:34][INFO][i-38ac04e1]:\r\n+=================================================================================================================+\r\n| Index:0, eni-b69bdae8, DESC:nephoria_auto_assigned, STATUS:in-use (attached)                                    |\r\n+=================================================================================================================+\r\n|+-----------------------------------------+----------------------+------------------+-------------------+-------+|\r\n|. ENI INFO                                . PRIV_IPS (Primary)   . PUB IP           . MAC ADDR          . DOT   .|\r\n|+-----------------------------------------+----------------------+------------------+-------------------+-------+|\r\n|.  ID:            eni-b69bdae8            .   172.1.24.231 (P)   . 10.116.220.127   . d0:0d:b6:9b:da:e8 . True  .|\r\n|.  VPC:           vpc-d2371df1            .                      .                  .                   .       .|\r\n|.  SUBNET:        subnet-5703719c         .                      .                  .                   .       .|\r\n|.  CHECK SRC/DST  True                    .                      .                  .                   .       .|\r\n|.  REGION:        ec2.h-12.autoqa.qa1     .                      .                  .                   .       .|\r\n|.                 .eucalyptus-            .                      .                  .                   .       .|\r\n|.                 systems.com             .                      .                  .                   .       .|\r\n|.  OWNER:         000569605883            .                      .                  .                   .       .|\r\n|+-----------------------------------------+----------------------+------------------+-------------------+-------+|\r\n|Security Groups For ENI eni-b69bdae8:                                                                            |\r\n| Security Group: VpcBasics_1_147284757617/sg-371a2093, VPC: vpc-d2371df1                                         |\r\n| INGRESS RULES:                                                                                                  |\r\n|     +---------------------+--------------------------+-------------+--------------+-------+----------+-------+  |\r\n|       CIDR_IP               SRC_GRP_NAME               SRC_GRP_ID    OWNER_ID       PORT    END_PORT   PROTO    |\r\n|     +---------------------+--------------------------+-------------+--------------+-------+----------+-------+  |\r\n|       0.0.0.0/0             None                       None          None           -1      -1         icmp     |\r\n|       0.0.0.0/0             None                       None          None           22      22         tcp      |\r\n|     +---------------------+--------------------------+-------------+--------------+-------+----------+-------+  |\r\n|                                                                                                                 |\r\n| EGRESS RULES:                                                                                                   |\r\n|     +---------------------+--------------------------+-------------+--------------+-------+----------+-------+  |\r\n|       CIDR_IP               SRC_GRP_NAME               SRC_GRP_ID    OWNER_ID       PORT    END_PORT   PROTO    |\r\n|     +---------------------+--------------------------+-------------+--------------+-------+----------+-------+  |\r\n|       0.0.0.0/0             None                       None          None           None    None       -1       |\r\n|     +---------------------+--------------------------+-------------+--------------+-------+----------+-------+  |\r\n|                                                                                                                 |\r\n+=================================================================================================================+\r\n{code}\r\n\r\n\r\nAssociate the EIP with VM1...\r\n\r\n{code}\r\n\r\nIn [107]: eip.associate(network_interface_id=vm1.interfaces[0].id)\r\nOut[107]: True\r\n\r\nIn [108]: vm1.show_enis()\r\n[09-02 13:57:06][DEBUG][EC2ops(admin:testrunner)]: Found matching security group for name:None and id:sg-371a2093\r\n[09-02 13:57:06][DEBUG][EC2ops(admin:testrunner)]: Found matching security group for name:None and id:sg-371a2093\r\n[09-02 13:57:06][INFO][i-38ac04e1]:\r\n+=================================================================================================================+\r\n| Index:0, eni-b69bdae8, DESC:nephoria_auto_assigned, STATUS:in-use (attached)                                    |\r\n+=================================================================================================================+\r\n|+-----------------------------------------+----------------------+------------------+-------------------+-------+|\r\n|. ENI INFO                                . PRIV_IPS (Primary)   . PUB IP           . MAC ADDR          . DOT   .|\r\n|+-----------------------------------------+----------------------+------------------+-------------------+-------+|\r\n|.  ID:            eni-b69bdae8            .   172.1.24.231 (P)   . 10.116.216.58    . d0:0d:b6:9b:da:e8 . True  .|\r\n|.  VPC:           vpc-d2371df1            .                      .                  .                   .       .|\r\n|.  SUBNET:        subnet-5703719c         .                      .                  .                   .       .|\r\n|.  CHECK SRC/DST  True                    .                      .                  .                   .       .|\r\n|.  REGION:        ec2.h-12.autoqa.qa1     .                      .                  .                   .       .|\r\n|.                 .eucalyptus-            .                      .                  .                   .       .|\r\n|.                 systems.com             .                      .                  .                   .       .|\r\n|.  OWNER:         000569605883            .                      .                  .                   .       .|\r\n|+-----------------------------------------+----------------------+------------------+-------------------+-------+|\r\n|Security Groups For ENI eni-b69bdae8:                                                                            |\r\n| Security Group: VpcBasics_1_147284757617/sg-371a2093, VPC: vpc-d2371df1                                         |\r\n| INGRESS RULES:                                                                                                  |\r\n|     +---------------------+--------------------------+-------------+--------------+-------+----------+-------+  |\r\n|       CIDR_IP               SRC_GRP_NAME               SRC_GRP_ID    OWNER_ID       PORT    END_PORT   PROTO    |\r\n|     +---------------------+--------------------------+-------------+--------------+-------+----------+-------+  |\r\n|       0.0.0.0/0             None                       None          None           -1      -1         icmp     |\r\n|       0.0.0.0/0             None                       None          None           22      22         tcp      |\r\n|     +---------------------+--------------------------+-------------+--------------+-------+----------+-------+  |\r\n|                                                                                                                 |\r\n| EGRESS RULES:                                                                                                   |\r\n|     +---------------------+--------------------------+-------------+--------------+-------+----------+-------+  |\r\n|       CIDR_IP               SRC_GRP_NAME               SRC_GRP_ID    OWNER_ID       PORT    END_PORT   PROTO    |\r\n|     +---------------------+--------------------------+-------------+--------------+-------+----------+-------+  |\r\n|       0.0.0.0/0             None                       None          None           None    None       -1       |\r\n|     +---------------------+--------------------------+-------------+--------------+-------+----------+-------+  |\r\n|                                                                                                                 |\r\n+=================================================================================================================+\r\n\r\n\r\n{code}\r\n\r\n\r\nVerify tcp port 22 again for vm1...\r\n\r\n{code}\r\n\r\nIn [109]: vm1.ip_address\r\nOut[109]: u'10.116.216.58'\r\n\r\nIn [110]: test_port_status(vm1.ip_address, 22)\r\ntest_port_status, ip:10.116.216.58, port:22, TCP:True\r\ntest_port_status, success\r\nOut[110]: ''\r\n\r\nIn [111]: eip.public_ip\r\nOut[111]: u'10.116.216.58'\r\n\r\nIn [112]: vm1.connect_to_instance()\r\n[09-02 13:58:41][INFO][i-38ac04e1]: Attempting to reconnect_to_instance:i-38ac04e1\r\n[09-02 13:58:43][INFO][i-38ac04e1]: SSH Connection Succeeded\r\n\r\nIn [113]: vm1.sys('cat testfile')\r\n[09-02 13:58:55][DEBUG][i-38ac04e1]: [root@10.116.216.58]# cat testfile\r\n[09-02 13:58:55][DEBUG][i-38ac04e1]:\r\ni-38ac04e1\r\n\r\n{code}\r\n\r\nToggle the EIP. Move to VM2...\r\nVM2's ENI info before associating the test EIP\r\n\r\n{code}\r\nIn [99]: vm2.show_enis()\r\n[09-02 13:49:40][INFO][i-beacd299]:\r\n+=================================================================================================================+\r\n| Index:0, eni-2b3449d7, DESC:nephoria_auto_assigned, STATUS:in-use (attached)                                    |\r\n+=================================================================================================================+\r\n|+-----------------------------------------+----------------------+------------------+-------------------+-------+|\r\n|. ENI INFO                                . PRIV_IPS (Primary)   . PUB IP           . MAC ADDR          . DOT   .|\r\n|+-----------------------------------------+----------------------+------------------+-------------------+-------+|\r\n|.  ID:            eni-2b3449d7            .   172.1.24.183 (P)   . 10.116.216.83    . d0:0d:2b:34:49:d7 . True  .|\r\n|.  VPC:           vpc-d2371df1            .                      .                  .                   .       .|\r\n|.  SUBNET:        subnet-5703719c         .                      .                  .                   .       .|\r\n|.  CHECK SRC/DST  True                    .                      .                  .                   .       .|\r\n|.  REGION:        ec2.h-12.autoqa.qa1     .                      .                  .                   .       .|\r\n|.                 .eucalyptus-            .                      .                  .                   .       .|\r\n|.                 systems.com             .                      .                  .                   .       .|\r\n|.  OWNER:         000569605883            .                      .                  .                   .       .|\r\n|+-----------------------------------------+----------------------+------------------+-------------------+-------+|\r\n|Security Groups For ENI eni-2b3449d7:                                                                            |\r\n| Security Group: VpcBasics_1_147284757617/sg-371a2093, VPC: vpc-d2371df1                                         |\r\n| INGRESS RULES:                                                                                                  |\r\n|     +---------------------+--------------------------+-------------+--------------+-------+----------+-------+  |\r\n|       CIDR_IP               SRC_GRP_NAME               SRC_GRP_ID    OWNER_ID       PORT    END_PORT   PROTO    |\r\n|     +---------------------+--------------------------+-------------+--------------+-------+----------+-------+  |\r\n|       0.0.0.0/0             None                       None          None           -1      -1         icmp     |\r\n|       0.0.0.0/0             None                       None          None           22      22         tcp      |\r\n|     +---------------------+--------------------------+-------------+--------------+-------+----------+-------+  |\r\n|                                                                                                                 |\r\n| EGRESS RULES:                                                                                                   |\r\n|     +---------------------+--------------------------+-------------+--------------+-------+----------+-------+  |\r\n|       CIDR_IP               SRC_GRP_NAME               SRC_GRP_ID    OWNER_ID       PORT    END_PORT   PROTO    |\r\n|     +---------------------+--------------------------+-------------+--------------+-------+----------+-------+  |\r\n|       0.0.0.0/0             None                       None          None           None    None       -1       |\r\n|     +---------------------+--------------------------+-------------+--------------+-------+----------+-------+  |\r\n|                                                                                                                 |\r\n+=================================================================================================================+\r\n\r\n\r\n{code}\r\n\r\n...and After...\r\n\r\n{code}\r\nIn [114]: eip.associate(network_interface_id=vm2.interfaces[0].id)\r\nOut[114]: True\r\n\r\nIn [115]: vm2.show_enis()\r\n[09-02 14:00:09][DEBUG][EC2ops(admin:testrunner)]: Found matching security group for name:None and id:sg-371a2093\r\n[09-02 14:00:09][DEBUG][EC2ops(admin:testrunner)]: Found matching security group for name:None and id:sg-371a2093\r\n[09-02 14:00:09][INFO][i-beacd299]:\r\n+=================================================================================================================+\r\n| Index:0, eni-2b3449d7, DESC:nephoria_auto_assigned, STATUS:in-use (attached)                                    |\r\n+=================================================================================================================+\r\n|+-----------------------------------------+----------------------+------------------+-------------------+-------+|\r\n|. ENI INFO                                . PRIV_IPS (Primary)   . PUB IP           . MAC ADDR          . DOT   .|\r\n|+-----------------------------------------+----------------------+------------------+-------------------+-------+|\r\n|.  ID:            eni-2b3449d7            .   172.1.24.183 (P)   . 10.116.216.58    . d0:0d:2b:34:49:d7 . True  .|\r\n|.  VPC:           vpc-d2371df1            .                      .                  .                   .       .|\r\n|.  SUBNET:        subnet-5703719c         .                      .                  .                   .       .|\r\n|.  CHECK SRC/DST  True                    .                      .                  .                   .       .|\r\n|.  REGION:        ec2.h-12.autoqa.qa1     .                      .                  .                   .       .|\r\n|.                 .eucalyptus-            .                      .                  .                   .       .|\r\n|.                 systems.com             .                      .                  .                   .       .|\r\n|.  OWNER:         000569605883            .                      .                  .                   .       .|\r\n|+-----------------------------------------+----------------------+------------------+-------------------+-------+|\r\n|Security Groups For ENI eni-2b3449d7:                                                                            |\r\n| Security Group: VpcBasics_1_147284757617/sg-371a2093, VPC: vpc-d2371df1                                         |\r\n| INGRESS RULES:                                                                                                  |\r\n|     +---------------------+--------------------------+-------------+--------------+-------+----------+-------+  |\r\n|       CIDR_IP               SRC_GRP_NAME               SRC_GRP_ID    OWNER_ID       PORT    END_PORT   PROTO    |\r\n|     +---------------------+--------------------------+-------------+--------------+-------+----------+-------+  |\r\n|       0.0.0.0/0             None                       None          None           -1      -1         icmp     |\r\n|       0.0.0.0/0             None                       None          None           22      22         tcp      |\r\n|     +---------------------+--------------------------+-------------+--------------+-------+----------+-------+  |\r\n|                                                                                                                 |\r\n| EGRESS RULES:                                                                                                   |\r\n|     +---------------------+--------------------------+-------------+--------------+-------+----------+-------+  |\r\n|       CIDR_IP               SRC_GRP_NAME               SRC_GRP_ID    OWNER_ID       PORT    END_PORT   PROTO    |\r\n|     +---------------------+--------------------------+-------------+--------------+-------+----------+-------+  |\r\n|       0.0.0.0/0             None                       None          None           None    None       -1       |\r\n|     +---------------------+--------------------------+-------------+--------------+-------+----------+-------+  |\r\n|                                                                                                                 |\r\n+=================================================================================================================+\r\n{code}\r\n\r\n\r\nCheck tcp 22 connectivity on VM2, verify VM2 is actually on the rx'ing end...\r\n\r\n{code}\r\nIn [116]: test_port_status(vm2.ip_address, 22)\r\ntest_port_status, ip:10.116.216.58, port:22, TCP:True\r\ntest_port_status, success\r\nOut[116]: ''\r\n\r\nIn [117]: eip.public_ip\r\nOut[117]: u'10.116.216.58'\r\n\r\nIn [118]: vm2.connect_to_instance()\r\n[09-02 14:01:02][INFO][i-beacd299]: Attempting to reconnect_to_instance:i-beacd299\r\n[09-02 14:01:02][DEBUG][i-beacd299]: SSH - Connected to 10.116.216.58\r\n\r\n\r\nIn [119]: vm2.sys('cat testfile')\r\n[09-02 14:01:09][DEBUG][i-beacd299]: [root@10.116.216.58]# cat testfile\r\n[09-02 14:01:09][DEBUG][i-beacd299]:\r\ni-beacd299\r\n{code}\r\n\r\n\r\nToggle EIP back to VM1...\r\n\r\n{code}\r\nIn [132]: vm1.show_enis()\r\n+=================================================================================================================+\r\n| Index:0, eni-b69bdae8, DESC:nephoria_auto_assigned, STATUS:in-use (attached)                                    |\r\n+=================================================================================================================+\r\n|+-----------------------------------------+----------------------+------------------+-------------------+-------+|\r\n|. ENI INFO                                . PRIV_IPS (Primary)   . PUB IP           . MAC ADDR          . DOT   .|\r\n|+-----------------------------------------+----------------------+------------------+-------------------+-------+|\r\n|.  ID:            eni-b69bdae8            .   172.1.24.231 (P)   . 10.116.216.58    . d0:0d:b6:9b:da:e8 . True  .|\r\n|.  VPC:           vpc-d2371df1            .                      .                  .                   .       .|\r\n|.  SUBNET:        subnet-5703719c         .                      .                  .                   .       .|\r\n|.  CHECK SRC/DST  True                    .                      .                  .                   .       .|\r\n|.  REGION:        ec2.h-12.autoqa.qa1     .                      .                  .                   .       .|\r\n|.                 .eucalyptus-            .                      .                  .                   .       .|\r\n|.                 systems.com             .                      .                  .                   .       .|\r\n|.  OWNER:         000569605883            .                      .                  .                   .       .|\r\n|+-----------------------------------------+----------------------+------------------+-------------------+-------+|\r\n|Security Groups For ENI eni-b69bdae8:                                                                            |\r\n| Security Group: VpcBasics_1_147284757617/sg-371a2093, VPC: vpc-d2371df1                                         |\r\n| INGRESS RULES:                                                                                                  |\r\n|     +---------------------+--------------------------+-------------+--------------+-------+----------+-------+  |\r\n|       CIDR_IP               SRC_GRP_NAME               SRC_GRP_ID    OWNER_ID       PORT    END_PORT   PROTO    |\r\n|     +---------------------+--------------------------+-------------+--------------+-------+----------+-------+  |\r\n|       0.0.0.0/0             None                       None          None           -1      -1         icmp     |\r\n|       0.0.0.0/0             None                       None          None           22      22         tcp      |\r\n|     +---------------------+--------------------------+-------------+--------------+-------+----------+-------+  |\r\n|                                                                                                                 |\r\n| EGRESS RULES:                                                                                                   |\r\n|     +---------------------+--------------------------+-------------+--------------+-------+----------+-------+  |\r\n|       CIDR_IP               SRC_GRP_NAME               SRC_GRP_ID    OWNER_ID       PORT    END_PORT   PROTO    |\r\n|     +---------------------+--------------------------+-------------+--------------+-------+----------+-------+  |\r\n|       0.0.0.0/0             None                       None          None           None    None       -1       |\r\n|     +---------------------+--------------------------+-------------+--------------+-------+----------+-------+  |\r\n|                                                                                                                 |\r\n+=================================================================================================================+\r\n\r\n\r\nIn [124]: eip.associate(network_interface_id=vm1.interfaces[0].id)\r\nOut[124]: True\r\n\r\n{code}\r\n\r\nAttempt to reconnect to VM1 using the EIP. Try tcp from this test machine as well as ICMP ping from\r\na new host (in this test I used a UFS).\r\n\r\n(see log time stamps for the time elapsed between\r\nthe allocation and tests).\r\n\r\n\r\n{code}\r\nIn [127]: test_port_status(vm1.ip_address, 22)\r\ntest_port_status, ip:10.116.216.58, port:22, TCP:True\r\ntest_port_status failed socket error:timed out\r\ntest_port_status: Connect to 10.116.216.58:22 timed out\r\n---------------------------------------------------------------------------\r\ntimeout                                   Traceback (most recent call last)\r\n<ipython-input-127-92fb3bfb6eda> in <module>()\r\n----> 1 test_port_status(vm1.ip_address, 22)\r\n\r\n/Library/Python/2.7/site-packages/adminapi-0.22-py2.7.egg/cloud_utils/net_utils/__init__.pyc in test_port_status(ip, port, timeout, tcp, recv_size, send_buf, debug, logger, verbose)\r\n     72             if ecode == socket.errno.ETIMEDOUT or ecode == \"timed out\":\r\n     73                 debug(\"test_port_status: Connect to \" + str(ip) + \":\" + str(port) + \" timed out\")\r\n---> 74             raise se\r\n     75         except socket.timeout, st:\r\n     76             debug('test_port_status failed socket timeout')\r\n\r\ntimeout: timed out\r\n\r\nIn [128]: ufs = tc.sysadmin.get_hosts_for_ufs()[0]\r\n\r\nIn [129]: ufs.sys('ping -c1 -t5 ' + vm1.ip_address)\r\n[09-02 14:05:57][DEBUG][10.111.5.12:(['UFS'])]: [root@10.111.5.12]# ping -c1 -t5 10.116.216.58\r\n[09-02 14:05:57][DEBUG][10.111.5.12:(['UFS'])]:\r\nPING 10.116.216.58 (10.116.216.58) 56(84) bytes of data.\r\n\r\n[09-02 14:06:07][DEBUG][10.111.5.12:(['UFS'])]:\r\n--- 10.116.216.58 ping statistics ---\r\n1 packets transmitted, 0 received, 100% packet loss, time 0ms\r\n\r\nIn [140]: ufs.sys('ping -c1 -t2 ' + vm1.ip_address)\r\n[09-02 14:09:33][DEBUG][10.111.5.12:(['UFS'])]: [root@10.111.5.12]# ping -c1 -t2 10.116.216.58\r\n[09-02 14:09:33][DEBUG][10.111.5.12:(['UFS'])]:\r\nPING 10.116.216.58 (10.116.216.58) 56(84) bytes of data.\r\n\r\n[09-02 14:09:33][DEBUG][10.111.5.12:(['UFS'])]: From 10.111.5.173 icmp_seq=1 Time to live exceeded\r\n\r\n--- 10.116.216.58 ping statistics ---\r\n1 packets transmitted, 0 received, +1 errors, 100% packet loss, time 0ms\r\n\r\n{code}\r\nFrom what I can tell the SNAT rule looks good...\r\nRule from VM2's router...\r\nIn [168]: rule = md.mapi.get_rule('70095079-d936-4ea7-8808-3b43991d9c49')\r\n\r\nIn [169]: md.show_rules(rule)\r\n[2016-09-02 14:16:10,131][INFO][MidoDebug:10.111.5.10]:\r\n+-----------------------+------+-------------+-----+------+---+----------------------+--------+---+----+--------+-------------+\r\n|RULES FOR CHAIN:..2b7e0| SRC  |     DST     |PROTO|DPORTS|TOS|GRP ADDRS             |FRAG POL|POS|TYPE| ACTION |TARGET       |\r\n+-----------------------+------+-------------+-----+------+---+----------------------+--------+---+----+--------+-------------+\r\n|RULE#:1                |None/0|!172.1.0.0/16|  IP | None | 0 |(elip_post_i-38ac04e1)|  any   | 1 |snat|continue|10.116.216.58|\r\n|70095079-d936-4ea7-8808|      |             |     |      |   |- 172.1.24.231        |        |   |    |        |             |\r\n|-3b43991d9c49          |      |             |     |      |   |                      |        |   |    |        |             |\r\n+-----------------------+------+-------------+-----+------+---+----------------------+--------+---+----+--------+-------------+\r\n\r\n\r\n{code}\r\n\r\n\r\n\r\n\r\n\r\n\r\n{code}\r\n\r\nMove the EIP back to vm2 and things work again...\r\n\r\n{code}\r\n\r\nIn [146]: eip.associate(network_interface_id=vm2.interfaces[0].id)\r\nOut[146]: True\r\n\r\nIn [155]: vm2.connect_to_instance()\r\n\r\nIn [155]: vm2.sys('cat testfile')\r\n[09-02 14:13:48][DEBUG][i-beacd299]: [root@10.116.216.58]# cat testfile\r\n[09-02 14:13:48][DEBUG][i-beacd299]:\r\ni-beacd299\r\n\r\n\r\n{code}","customfield_13200":null,"customfield_11300":null,"customfield_11500":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=tsugawa","name":"tsugawa","key":"tsugawa","accountId":"557058:619bab88-9b87-4778-995a-1e8a85d8b899","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/c16b1da4b6426cad544b6eddd78d76b1?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FavatarId%3D10122%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/c16b1da4b6426cad544b6eddd78d76b1?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26avatarId%3D10122%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/c16b1da4b6426cad544b6eddd78d76b1?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26avatarId%3D10122%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/c16b1da4b6426cad544b6eddd78d76b1?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26avatarId%3D10122%26noRedirect%3Dtrue"},"displayName":"M Tsugawa","active":true,"timeZone":"America/New_York"},"timetracking":{},"customfield_10401":null,"customfield_10005":null,"customfield_10600":null,"customfield_12900":null,"aggregatetimeestimate":null,"attachment":[],"summary":"EIP routes are lost if toggled between VMs","creator":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=mclark","name":"mclark","key":"mclark","accountId":"557058:9b68e4d6-90d8-47d3-9c86-519770009164","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/4227b07e7ea0ea725670fc4e987ed04d?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FavatarId%3D10122%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/4227b07e7ea0ea725670fc4e987ed04d?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26avatarId%3D10122%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/4227b07e7ea0ea725670fc4e987ed04d?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26avatarId%3D10122%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/4227b07e7ea0ea725670fc4e987ed04d?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26avatarId%3D10122%26noRedirect%3Dtrue"},"displayName":"Matt Clark","active":true,"timeZone":"America/Los_Angeles"},"subtasks":[],"reporter":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=mclark","name":"mclark","key":"mclark","accountId":"557058:9b68e4d6-90d8-47d3-9c86-519770009164","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/4227b07e7ea0ea725670fc4e987ed04d?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FavatarId%3D10122%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/4227b07e7ea0ea725670fc4e987ed04d?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26avatarId%3D10122%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/4227b07e7ea0ea725670fc4e987ed04d?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26avatarId%3D10122%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/4227b07e7ea0ea725670fc4e987ed04d?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26avatarId%3D10122%26noRedirect%3Dtrue"},"displayName":"Matt Clark","active":true,"timeZone":"America/Los_Angeles"},"aggregateprogress":{"progress":0,"total":0},"customfield_12100":"0|i03wyv:","customfield_10000":"10007_*:*_1_*:*_43164_*|*_3_*:*_1_*:*_352284509_*|*_5_*:*_1_*:*_0_*|*_10000_*:*_2_*:*_1285138518_*|*_10001_*:*_3_*:*_605211077_*|*_10003_*:*_1_*:*_8537642461","customfield_10001":"2016-09-15T16:06:36.605-0500","customfield_10002":null,"customfield_10200":null,"customfield_10003":null,"customfield_10400":null,"customfield_12500":null,"customfield_10116":null,"customfield_11600":["dmitrii(dmitrii)","mclark(mclark)","tsugawa(tsugawa)","sjones(sjones)","tony(tony)"],"customfield_10117":null,"environment":null,"customfield_11800":null,"customfield_11802":null,"customfield_11805":null,"duedate":null,"customfield_11806":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/48105/comment/110312","id":"110312","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=dmitrii","name":"dmitrii","key":"dmitrii","accountId":"557058:1e0ea807-434b-4b54-967f-1dec4a9ede55","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue"},"displayName":"Dmitrii Calzago","active":false,"timeZone":"America/Los_Angeles"},"body":"[~tsugawa] to investigate the root cause. EIP change is supposed to come in separate GNIs.","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=dmitrii","name":"dmitrii","key":"dmitrii","accountId":"557058:1e0ea807-434b-4b54-967f-1dec4a9ede55","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue"},"displayName":"Dmitrii Calzago","active":false,"timeZone":"America/Los_Angeles"},"created":"2016-09-15T16:06:36.605-0500","updated":"2016-09-15T16:06:36.605-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/48105/comment/110388","id":"110388","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=tsugawa","name":"tsugawa","key":"tsugawa","accountId":"557058:619bab88-9b87-4778-995a-1e8a85d8b899","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/c16b1da4b6426cad544b6eddd78d76b1?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FavatarId%3D10122%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/c16b1da4b6426cad544b6eddd78d76b1?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26avatarId%3D10122%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/c16b1da4b6426cad544b6eddd78d76b1?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26avatarId%3D10122%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/c16b1da4b6426cad544b6eddd78d76b1?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26avatarId%3D10122%26noRedirect%3Dtrue"},"displayName":"M Tsugawa","active":true,"timeZone":"America/New_York"},"body":"When an EIP that is associated with VM1 is re-associated with VM2, without explicitly disassociating it from VM1, CLC broadcasts the updated global network state with the new association. Desirably, a broadcast that \"represents\" a disassociation (i.e., a global network state in which the EIP does not appear) would resolve a system-wide ambiguity of \"who\" owns the EIP (the implemented association of the EIP is with VM1, but the global network state says otherwise). ","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=tsugawa","name":"tsugawa","key":"tsugawa","accountId":"557058:619bab88-9b87-4778-995a-1e8a85d8b899","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/c16b1da4b6426cad544b6eddd78d76b1?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FavatarId%3D10122%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/c16b1da4b6426cad544b6eddd78d76b1?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26avatarId%3D10122%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/c16b1da4b6426cad544b6eddd78d76b1?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26avatarId%3D10122%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/c16b1da4b6426cad544b6eddd78d76b1?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26avatarId%3D10122%26noRedirect%3Dtrue"},"displayName":"M Tsugawa","active":true,"timeZone":"America/New_York"},"created":"2016-09-20T18:54:15.177-0500","updated":"2016-09-20T18:54:15.177-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/48105/comment/110704","id":"110704","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=sjones","name":"sjones","key":"sjones","accountId":"557058:f5dce1b0-db45-4dd6-a0e8-3cea5effb5ce","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue"},"displayName":"Steve Jones","active":true,"timeZone":"America/Los_Angeles"},"body":"We now send a broadcast with a public ip omitted when that ip is being reassociated. Once processed a second broadcast will be generated with the new association for the public ip.\r\n\r\n[~tsugawa], assigning to you for any additional changes.","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=sjones","name":"sjones","key":"sjones","accountId":"557058:f5dce1b0-db45-4dd6-a0e8-3cea5effb5ce","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue"},"displayName":"Steve Jones","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-09-27T15:44:57.323-0500","updated":"2016-09-27T15:44:57.323-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/48105/comment/110720","id":"110720","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=tsugawa","name":"tsugawa","key":"tsugawa","accountId":"557058:619bab88-9b87-4778-995a-1e8a85d8b899","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/c16b1da4b6426cad544b6eddd78d76b1?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FavatarId%3D10122%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/c16b1da4b6426cad544b6eddd78d76b1?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26avatarId%3D10122%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/c16b1da4b6426cad544b6eddd78d76b1?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26avatarId%3D10122%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/c16b1da4b6426cad544b6eddd78d76b1?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26avatarId%3D10122%26noRedirect%3Dtrue"},"displayName":"M Tsugawa","active":true,"timeZone":"America/New_York"},"body":"EIP disconnects are handled now at early stages of eucanetd VPCMIDO iteration. This early disconnection avoids conflicts when re-connecting EIPs (at later stages).\r\nThis back-end change complements the updated GNI broadcast (which now have EIP disconnection broadcasts) mechanism. It handles/tolerates CLC/eucanetd restarts (and possibly missed GNI broadcasts).","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=tsugawa","name":"tsugawa","key":"tsugawa","accountId":"557058:619bab88-9b87-4778-995a-1e8a85d8b899","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/c16b1da4b6426cad544b6eddd78d76b1?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FavatarId%3D10122%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/c16b1da4b6426cad544b6eddd78d76b1?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26avatarId%3D10122%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/c16b1da4b6426cad544b6eddd78d76b1?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26avatarId%3D10122%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/c16b1da4b6426cad544b6eddd78d76b1?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26avatarId%3D10122%26noRedirect%3Dtrue"},"displayName":"M Tsugawa","active":true,"timeZone":"America/New_York"},"created":"2016-09-27T20:32:25.279-0500","updated":"2016-09-27T20:32:25.279-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/48105/comment/115118","id":"115118","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=mclark","name":"mclark","key":"mclark","accountId":"557058:9b68e4d6-90d8-47d3-9c86-519770009164","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/4227b07e7ea0ea725670fc4e987ed04d?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FavatarId%3D10122%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/4227b07e7ea0ea725670fc4e987ed04d?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26avatarId%3D10122%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/4227b07e7ea0ea725670fc4e987ed04d?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26avatarId%3D10122%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/4227b07e7ea0ea725670fc4e987ed04d?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26avatarId%3D10122%26noRedirect%3Dtrue"},"displayName":"Matt Clark","active":true,"timeZone":"America/Los_Angeles"},"body":"Reverting this ticket's state as I'm seeing the automated test written for this failing in 4.4 on several setups. Attempting to gather more info now. \r\n\r\nhttp://jenkins.qa1.eucalyptus-systems.com:8080/view/All/job/nephoria-vpc-network-suite/58/console\r\n..and..\r\nhttp://jenkins.qa1.eucalyptus-systems.com:8080/view/All/job/nephoria-vpc-network-suite/59/parsed_console/job/nephoria-vpc-network-suite/59/parsed_console/log_content.html#ERROR1\r\n\r\nThanks,\r\n-M","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=mclark","name":"mclark","key":"mclark","accountId":"557058:9b68e4d6-90d8-47d3-9c86-519770009164","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/4227b07e7ea0ea725670fc4e987ed04d?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FavatarId%3D10122%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/4227b07e7ea0ea725670fc4e987ed04d?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26avatarId%3D10122%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/4227b07e7ea0ea725670fc4e987ed04d?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26avatarId%3D10122%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/4227b07e7ea0ea725670fc4e987ed04d?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26avatarId%3D10122%26noRedirect%3Dtrue"},"displayName":"Matt Clark","active":true,"timeZone":"America/Los_Angeles"},"created":"2017-01-04T15:06:27.747-0600","updated":"2017-01-04T15:06:27.747-0600"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/48105/comment/115124","id":"115124","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=tsugawa","name":"tsugawa","key":"tsugawa","accountId":"557058:619bab88-9b87-4778-995a-1e8a85d8b899","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/c16b1da4b6426cad544b6eddd78d76b1?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FavatarId%3D10122%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/c16b1da4b6426cad544b6eddd78d76b1?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26avatarId%3D10122%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/c16b1da4b6426cad544b6eddd78d76b1?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26avatarId%3D10122%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/c16b1da4b6426cad544b6eddd78d76b1?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26avatarId%3D10122%26noRedirect%3Dtrue"},"displayName":"M Tsugawa","active":true,"timeZone":"America/New_York"},"body":"[~mclark], [~sjones], test may be failing due to a different problem - after an eip is disassociated, instances are not getting public IP back. Refer to the sequence below:\r\n\r\n# 2 instances are created (note that public IP is automatically assigned)\r\n# an eip is allocated\r\n# eip is associated with instance 1\r\n# eip is associated with instance 2\r\n# public IP does not come back to instance 1\r\n\r\n{noformat}\r\n[root@g-08-07 ~]# euca-run-instances -n 2 -k key -g foo emi-c9ab8fcc\r\nRESERVATION\tr-344fa3f9\t000791509743\tfoo\r\nINSTANCE\ti-4d3fd5e2\temi-c9ab8fcc\teuca-10-116-164-18.eucalyptus.g-19-01.autoqa.qa1.eucalyptus-systems.com\teuca-172-31-14-10.eucalyptus.internal\tpending\tkey\t0\t\tm1.small\t2017-01-05T01:43:21.719Z\tone\t\t\t\tmonitoring-disabled\t10.116.164.18\t172.31.14.10\tvpc-38779fd4\tsubnet-5b069125\tinstance-store\t\t\t\t\thvm\t\t\tsg-922a7c0a\t\t\t\tx86_64\r\nNETWORKINTERFACE\teni-6ffd0e02\tsubnet-5b069125\tvpc-38779fd4\t000791509743\tin-use\t172.31.14.10\teuca-172-31-14-10.eucalyptus.internal\ttrue\r\nATTACHMENT\t\teni-attach-6d11c302\t0\tattached\t2017-01-05T01:43:21.732Z\ttrue\r\nASSOCIATION\t10.116.164.18\t\t172.31.14.10\r\nGROUP\tsg-922a7c0a\tfoo\r\nPRIVATEIPADDRESS\t172.31.14.10\teuca-172-31-14-10.eucalyptus.internal\tprimary\r\nINSTANCE\ti-6c4beda3\temi-c9ab8fcc\teuca-10-116-164-62.eucalyptus.g-19-01.autoqa.qa1.eucalyptus-systems.com\teuca-172-31-12-13.eucalyptus.internal\tpending\tkey\t1\t\tm1.small\t2017-01-05T01:43:21.900Z\tone\t\t\t\tmonitoring-disabled\t10.116.164.62\t172.31.12.13\tvpc-38779fd4\tsubnet-5b069125\tinstance-store\t\t\t\t\thvm\t\t\tsg-922a7c0a\t\t\t\tx86_64\r\nNETWORKINTERFACE\teni-47ed97e9\tsubnet-5b069125\tvpc-38779fd4\t000791509743\tin-use\t172.31.12.13\teuca-172-31-12-13.eucalyptus.internal\ttrue\r\nATTACHMENT\t\teni-attach-8aab94b8\t0\tattached\t2017-01-05T01:43:21.904Z\ttrue\r\nASSOCIATION\t10.116.164.62\t\t172.31.12.13\r\nGROUP\tsg-922a7c0a\tfoo\r\nPRIVATEIPADDRESS\t172.31.12.13\teuca-172-31-12-13.eucalyptus.internal\tprimary\r\n[root@g-08-07 ~]# \r\n[root@g-08-07 ~]# euca-allocate-address \r\nADDRESS\t10.116.164.25\tvpc\teipalloc-eb1f4247\r\n[root@g-08-07 ~]# \r\n[root@g-08-07 ~]# euca-associate-address -i i-4d3fd5e2 10.116.164.25\r\nADDRESS\t10.116.164.25\ti-4d3fd5e2\r\n[root@g-08-07 ~]# \r\n[root@g-08-07 ~]# euca-describe-instances i-4d3fd5e2\r\nRESERVATION\tr-344fa3f9\t000791509743\tfoo\r\nINSTANCE\ti-4d3fd5e2\temi-c9ab8fcc\teuca-10-116-164-25.eucalyptus.g-19-01.autoqa.qa1.eucalyptus-systems.com\teuca-172-31-14-10.eucalyptus.internal\trunning\tkey\t0\t\tm1.small\t2017-01-05T01:43:21.719Z\tone\t\t\t\tmonitoring-disabled\t10.116.164.25\t172.31.14.10\tvpc-38779fd4\tsubnet-5b069125\tinstance-store\t\t\t\t\thvm\t\t\tsg-922a7c0a\t\t\t\tx86_64\r\nNETWORKINTERFACE\teni-6ffd0e02\tsubnet-5b069125\tvpc-38779fd4\t000791509743\tin-use\t172.31.14.10\teuca-172-31-14-10.eucalyptus.internal\ttrue\r\nATTACHMENT\t\teni-attach-6d11c302\t0\tattached\t2017-01-05T01:43:21.732Z\ttrue\r\nASSOCIATION\t10.116.164.25\t000791509743\t172.31.14.10\r\nGROUP\tsg-922a7c0a\tfoo\r\nPRIVATEIPADDRESS\t172.31.14.10\teuca-172-31-14-10.eucalyptus.internal\tprimary\r\nTAG\tinstance\ti-4d3fd5e2\teuca:node\t10.111.5.176\r\n[root@g-08-07 ~]# \r\n[root@g-08-07 ~]# euca-associate-address -i i-6c4beda3 10.116.164.25\r\nADDRESS\t10.116.164.25\ti-6c4beda3\r\n[root@g-08-07 ~]# \r\n[root@g-08-07 ~]# euca-describe-instances i-4d3fd5e2\r\nRESERVATION\tr-344fa3f9\t000791509743\tfoo\r\nINSTANCE\ti-4d3fd5e2\temi-c9ab8fcc\t\teuca-172-31-14-10.eucalyptus.internal\trunning\tkey\t0\t\tm1.small\t2017-01-05T01:43:21.719Z\tone\t\t\t\tmonitoring-disabled\t\t172.31.14.10\tvpc-38779fd4\tsubnet-5b069125\tinstance-store\t\t\thvm\t\t\tsg-922a7c0a\t\t\t\tx86_64\r\nNETWORKINTERFACE\teni-6ffd0e02\tsubnet-5b069125\tvpc-38779fd4\t000791509743\tin-use\t172.31.14.10\teuca-172-31-14-10.eucalyptus.internal\ttrue\r\nATTACHMENT\t\teni-attach-6d11c302\t0\tattached\t2017-01-05T01:43:21.732Z\ttrue\r\nGROUP\tsg-922a7c0a\tfoo\r\nPRIVATEIPADDRESS\t172.31.14.10\teuca-172-31-14-10.eucalyptus.internal\tprimary\r\nTAG\tinstance\ti-4d3fd5e2\teuca:node\t10.111.5.176\r\n[root@g-08-07 ~]# \r\n{noformat}","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=tsugawa","name":"tsugawa","key":"tsugawa","accountId":"557058:619bab88-9b87-4778-995a-1e8a85d8b899","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/c16b1da4b6426cad544b6eddd78d76b1?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FavatarId%3D10122%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/c16b1da4b6426cad544b6eddd78d76b1?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26avatarId%3D10122%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/c16b1da4b6426cad544b6eddd78d76b1?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26avatarId%3D10122%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/c16b1da4b6426cad544b6eddd78d76b1?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26avatarId%3D10122%26noRedirect%3Dtrue"},"displayName":"M Tsugawa","active":true,"timeZone":"America/New_York"},"created":"2017-01-04T19:51:32.958-0600","updated":"2017-01-04T19:51:32.958-0600"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/48105/comment/115126","id":"115126","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=mclark","name":"mclark","key":"mclark","accountId":"557058:9b68e4d6-90d8-47d3-9c86-519770009164","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/4227b07e7ea0ea725670fc4e987ed04d?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FavatarId%3D10122%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/4227b07e7ea0ea725670fc4e987ed04d?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26avatarId%3D10122%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/4227b07e7ea0ea725670fc4e987ed04d?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26avatarId%3D10122%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/4227b07e7ea0ea725670fc4e987ed04d?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26avatarId%3D10122%26noRedirect%3Dtrue"},"displayName":"Matt Clark","active":true,"timeZone":"America/Los_Angeles"},"body":"I'm looking at this specific automated test now as well. Not sure this test has ran all the way through prior to this fix, likely there's still issues to be flushed out with the test. Will update shortly. \r\nThanks,\r\n-M","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=mclark","name":"mclark","key":"mclark","accountId":"557058:9b68e4d6-90d8-47d3-9c86-519770009164","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/4227b07e7ea0ea725670fc4e987ed04d?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FavatarId%3D10122%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/4227b07e7ea0ea725670fc4e987ed04d?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26avatarId%3D10122%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/4227b07e7ea0ea725670fc4e987ed04d?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26avatarId%3D10122%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/4227b07e7ea0ea725670fc4e987ed04d?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26avatarId%3D10122%26noRedirect%3Dtrue"},"displayName":"Matt Clark","active":true,"timeZone":"America/Los_Angeles"},"created":"2017-01-04T21:45:17.094-0600","updated":"2017-01-04T21:45:17.094-0600"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/48105/comment/115127","id":"115127","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=mclark","name":"mclark","key":"mclark","accountId":"557058:9b68e4d6-90d8-47d3-9c86-519770009164","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/4227b07e7ea0ea725670fc4e987ed04d?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FavatarId%3D10122%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/4227b07e7ea0ea725670fc4e987ed04d?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26avatarId%3D10122%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/4227b07e7ea0ea725670fc4e987ed04d?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26avatarId%3D10122%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/4227b07e7ea0ea725670fc4e987ed04d?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26avatarId%3D10122%26noRedirect%3Dtrue"},"displayName":"Matt Clark","active":true,"timeZone":"America/Los_Angeles"},"body":"[~tsugawa]  There was 2 issues in the test. The underlying ssh session was not being updated correctly/reliably.  I (hopefully) corrected that. \r\n\r\nThe 2nd issue is that there is a delay in the EIP association/nat taking effect which caused the test to reconnect to the VM previously associated with the EIP. Not sure if this is expected?...\r\n \r\nAfter the EIP is re-assigned, the new connection is still connecting to the VM which was previously associated with it.  The test would immediately try the new connection and fail. I've added some retries and debug to show how long the EIP get's Nat'd to the old VM. The test is showing it connects to the VM previously associated with the EIP for between 0-20 seconds before connecting to the new VM+association . The test now continues to retry the connection until it succeed with the new VM/association or times out. So far is passing. \r\n\r\nFailed w/o retries:\r\nhttp://jenkins.qa1.eucalyptus-systems.com:8080/view/All/job/nephoria-vpc-network-suite/61/console\r\n\r\nWith retries:\r\nhttp://jenkins.qa1.eucalyptus-systems.com:8080/view/All/job/nephoria-vpc-network-suite/62/console\r\n \r\nIf the  ~0-20 second delay in the new association is acceptable I can move this ticket resolved, and/or open a separate ticket to discuss the delay?\r\n\r\n\r\nThanks!, \r\n-M","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=mclark","name":"mclark","key":"mclark","accountId":"557058:9b68e4d6-90d8-47d3-9c86-519770009164","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/4227b07e7ea0ea725670fc4e987ed04d?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FavatarId%3D10122%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/4227b07e7ea0ea725670fc4e987ed04d?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26avatarId%3D10122%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/4227b07e7ea0ea725670fc4e987ed04d?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26avatarId%3D10122%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/4227b07e7ea0ea725670fc4e987ed04d?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26avatarId%3D10122%26noRedirect%3Dtrue"},"displayName":"Matt Clark","active":true,"timeZone":"America/Los_Angeles"},"created":"2017-01-04T23:58:21.976-0600","updated":"2017-01-05T00:01:44.785-0600"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/48105/comment/115128","id":"115128","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=tsugawa","name":"tsugawa","key":"tsugawa","accountId":"557058:619bab88-9b87-4778-995a-1e8a85d8b899","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/c16b1da4b6426cad544b6eddd78d76b1?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FavatarId%3D10122%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/c16b1da4b6426cad544b6eddd78d76b1?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26avatarId%3D10122%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/c16b1da4b6426cad544b6eddd78d76b1?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26avatarId%3D10122%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/c16b1da4b6426cad544b6eddd78d76b1?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26avatarId%3D10122%26noRedirect%3Dtrue"},"displayName":"M Tsugawa","active":true,"timeZone":"America/New_York"},"body":"I think the delay is expected. For a given action, CLC can take up to 30 sec to generate GNI (for some commands CLC broadcasts GNI immediately, but I am not sure if it is the case for EIP). Moreover, moving an EIP involves 2 GNI broadcasts: one to disconnect and another to connect (I would not expect a delay between these 2 GNI broadcasts, though). Once ENI association/re-association/move command is issued, a 0-30 sec delay for the GNI broadcast, 0-5 sec (assuming EIP actions are the only ones reflected in GNI) for eucanetd to actuate MidoNet, and 0-5 sec for MidoNet to actuate involved OVS would be expected.\r\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=tsugawa","name":"tsugawa","key":"tsugawa","accountId":"557058:619bab88-9b87-4778-995a-1e8a85d8b899","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/c16b1da4b6426cad544b6eddd78d76b1?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FavatarId%3D10122%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/c16b1da4b6426cad544b6eddd78d76b1?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26avatarId%3D10122%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/c16b1da4b6426cad544b6eddd78d76b1?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26avatarId%3D10122%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/c16b1da4b6426cad544b6eddd78d76b1?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26avatarId%3D10122%26noRedirect%3Dtrue"},"displayName":"M Tsugawa","active":true,"timeZone":"America/New_York"},"created":"2017-01-05T09:43:03.226-0600","updated":"2017-01-05T09:43:03.226-0600"}],"maxResults":9,"total":9,"startAt":0},"votes":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/EUCA-12721/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_11808":null}}
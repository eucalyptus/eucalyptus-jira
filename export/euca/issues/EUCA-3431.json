{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"15568","self":"https://eucalyptus.atlassian.net/rest/api/2/issue/15568","key":"EUCA-3431","fields":{"issuetype":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://eucalyptus.atlassian.net/secure/viewavatar?size=xsmall&avatarId=14803&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":14803},"timespent":null,"customfield_13100":null,"project":{"self":"https://eucalyptus.atlassian.net/rest/api/2/project/10000","id":"10000","key":"EUCA","name":"Eucalyptus","avatarUrls":{"48x48":"https://eucalyptus.atlassian.net/secure/projectavatar?pid=10000&avatarId=10011","24x24":"https://eucalyptus.atlassian.net/secure/projectavatar?size=small&pid=10000&avatarId=10011","16x16":"https://eucalyptus.atlassian.net/secure/projectavatar?size=xsmall&pid=10000&avatarId=10011","32x32":"https://eucalyptus.atlassian.net/secure/projectavatar?size=medium&pid=10000&avatarId=10011"}},"customfield_11000":null,"fixVersions":[],"customfield_11001":null,"aggregatetimespent":null,"customfield_10310":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/10209","value":"CentOS 6","id":"10209"}],"resolution":{"self":"https://eucalyptus.atlassian.net/rest/api/2/resolution/5","id":"5","description":"All attempts at reproducing this issue failed, or not enough information was available to reproduce the issue. Reading the code produces no clues as to why this behavior would occur. If more information appears later, please reopen the issue.","name":"Cannot Reproduce"},"customfield_10311":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/10308","value":"Managed-NOVLAN","id":"10308"}],"customfield_11401":null,"customfield_11400":null,"customfield_10302":null,"customfield_10500":{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/10403","value":"Not Applicable","id":"10403"},"customfield_10104":[],"customfield_10105":{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/10101","value":"No","id":"10101"},"customfield_10303":null,"customfield_10304":null,"customfield_10700":null,"customfield_10701":null,"customfield_10306":null,"customfield_10702":null,"customfield_10703":null,"customfield_10704":null,"resolutiondate":"2012-08-31T10:36:29.311-0500","customfield_10308":null,"customfield_10705":null,"customfield_10309":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/10204","value":"KVM","id":"10204"}],"workratio":-1,"watches":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/EUCA-3431/watchers","watchCount":1,"isWatching":false},"lastViewed":null,"created":"2012-08-31T10:35:06.922-0500","customfield_12000":null,"priority":{"self":"https://eucalyptus.atlassian.net/rest/api/2/priority/3","iconUrl":"https://eucalyptus.atlassian.net/images/icons/priorities/major.svg","name":"Major","id":"3"},"customfield_12400":null,"customfield_12201":null,"customfield_10300":null,"customfield_10102":null,"customfield_12600":"{}","customfield_10301":null,"labels":[],"customfield_11700":null,"aggregatetimeoriginalestimate":null,"timeestimate":null,"versions":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/version/10005","id":"10005","description":"Eucalyptus 3.1.0","name":"3.1.0","archived":false,"released":true,"releaseDate":"2012-06-25"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/version/10201","id":"10201","description":"Eucalyptus 3.1.1","name":"3.1.1","archived":false,"released":true,"releaseDate":"2012-08-24"}],"customfield_11901":null,"issuelinks":[],"assignee":null,"updated":"2012-08-31T10:43:09.159-0500","status":{"self":"https://eucalyptus.atlassian.net/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://eucalyptus.atlassian.net/images/icons/statuses/generic.png","name":"Closed","id":"6","statusCategory":{"self":"https://eucalyptus.atlassian.net/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/component/10003","id":"10003","name":"Cluster Controller"}],"timeoriginalestimate":null,"description":"Under certain conditions the iptables show two DNAT rules for a particular endpoint. One point to the enabled CC and the other the disabled cc. This can lead to a conflict as there should only be one rule. This symptom has been reproduced in the PRC","customfield_13000":null,"customfield_13200":null,"customfield_11300":null,"customfield_11500":null,"timetracking":{},"customfield_10401":null,"customfield_10005":null,"customfield_10600":null,"customfield_12900":null,"attachment":[],"aggregatetimeestimate":null,"summary":"Active CC have two NAT chart about 169.254.169.254 [RT9524]","creator":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=nbeard","name":"nbeard","key":"nbeard","accountId":"557058:0d3a01f5-ec79-48de-8d8f-79bd6a2c5cb3","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/f26add140f84a617d35f2b4cbed36f47?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dnbeard%26avatarId%3D10207%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/f26add140f84a617d35f2b4cbed36f47?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dnbeard%26avatarId%3D10207%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/f26add140f84a617d35f2b4cbed36f47?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dnbeard%26avatarId%3D10207%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/f26add140f84a617d35f2b4cbed36f47?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dnbeard%26avatarId%3D10207%26noRedirect%3Dtrue"},"displayName":"Neil Beard","active":false,"timeZone":"America/Los_Angeles"},"subtasks":[],"reporter":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=nbeard","name":"nbeard","key":"nbeard","accountId":"557058:0d3a01f5-ec79-48de-8d8f-79bd6a2c5cb3","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/f26add140f84a617d35f2b4cbed36f47?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dnbeard%26avatarId%3D10207%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/f26add140f84a617d35f2b4cbed36f47?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dnbeard%26avatarId%3D10207%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/f26add140f84a617d35f2b4cbed36f47?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dnbeard%26avatarId%3D10207%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/f26add140f84a617d35f2b4cbed36f47?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dnbeard%26avatarId%3D10207%26noRedirect%3Dtrue"},"displayName":"Neil Beard","active":false,"timeZone":"America/Los_Angeles"},"aggregateprogress":{"progress":0,"total":0},"customfield_10000":"10000_*:*_1_*:*_82409_*|*_6_*:*_1_*:*_0","customfield_12100":"0|i01jnj:","customfield_10001":null,"customfield_10200":null,"customfield_10002":null,"customfield_10003":null,"customfield_12500":null,"customfield_10400":null,"customfield_11600":["nbeard(nbeard)"],"customfield_10116":null,"customfield_10117":null,"environment":"two computers running in HA, a third as a NC. In the PRC, running Centos 6.3, KVM.","customfield_11800":null,"customfield_11802":null,"duedate":null,"customfield_11805":null,"progress":{"progress":0,"total":0},"customfield_11806":null,"votes":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/EUCA-3431/votes","votes":0,"hasVoted":false},"comment":{"comments":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/15568/comment/31704","id":"31704","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=nbeard","name":"nbeard","key":"nbeard","accountId":"557058:0d3a01f5-ec79-48de-8d8f-79bd6a2c5cb3","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/f26add140f84a617d35f2b4cbed36f47?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dnbeard%26avatarId%3D10207%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/f26add140f84a617d35f2b4cbed36f47?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dnbeard%26avatarId%3D10207%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/f26add140f84a617d35f2b4cbed36f47?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dnbeard%26avatarId%3D10207%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/f26add140f84a617d35f2b4cbed36f47?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dnbeard%26avatarId%3D10207%26noRedirect%3Dtrue"},"displayName":"Neil Beard","active":false,"timeZone":"America/Los_Angeles"},"body":"error opening bug","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=nbeard","name":"nbeard","key":"nbeard","accountId":"557058:0d3a01f5-ec79-48de-8d8f-79bd6a2c5cb3","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/f26add140f84a617d35f2b4cbed36f47?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dnbeard%26avatarId%3D10207%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/f26add140f84a617d35f2b4cbed36f47?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dnbeard%26avatarId%3D10207%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/f26add140f84a617d35f2b4cbed36f47?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dnbeard%26avatarId%3D10207%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/f26add140f84a617d35f2b4cbed36f47?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dnbeard%26avatarId%3D10207%26noRedirect%3Dtrue"},"displayName":"Neil Beard","active":false,"timeZone":"America/Los_Angeles"},"created":"2012-08-31T10:36:29.326-0500","updated":"2012-08-31T10:36:29.326-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/15568/comment/31706","id":"31706","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=nbeard","name":"nbeard","key":"nbeard","accountId":"557058:0d3a01f5-ec79-48de-8d8f-79bd6a2c5cb3","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/f26add140f84a617d35f2b4cbed36f47?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dnbeard%26avatarId%3D10207%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/f26add140f84a617d35f2b4cbed36f47?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dnbeard%26avatarId%3D10207%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/f26add140f84a617d35f2b4cbed36f47?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dnbeard%26avatarId%3D10207%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/f26add140f84a617d35f2b4cbed36f47?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dnbeard%26avatarId%3D10207%26noRedirect%3Dtrue"},"displayName":"Neil Beard","active":false,"timeZone":"America/Los_Angeles"},"body":"I reproduced this symptom by getting a 3.1.1 system running and stable with all services \"enabled\" on the primary computer. Started an instance running. Then stopped the enabled CC so that the secondary CC became the enabled CC. Here is what I saw.\n\nHello Kimi,\n\nI have retested. I believe that you intended to say restart the eucalyptus-cc which I have. Here are my results.\n\n[root@g-22-02 ~]# iptables-save \n# Generated by iptables-save v1.4.7 on Thu Aug 30 15:37:17 2012                                                                                 \n*nat                                                                                                                                            \n:PREROUTING ACCEPT [191:11542]                                                                                                                  \n:POSTROUTING ACCEPT [202:12120]                                                                                                                 \n:OUTPUT ACCEPT [202:12120]                                                                                                                      \n-A PREROUTING -d 10.104.3.101/32 -j DNAT --to-destination 10.129.0.87                                                                           \n-A PREROUTING -d 169.254.169.254/32 -p tcp -m tcp --dport 80 -j DNAT --to-destination 10.104.1.114:8773                                         \n-A PREROUTING -d 10.104.3.100/32 -j DNAT --to-destination 10.129.0.91                                                                           \n-A PREROUTING -d 10.104.3.102/32 -j DNAT --to-destination 10.129.0.92                                                                           \n-A PREROUTING -d 10.104.3.103/32 -j DNAT --to-destination 10.129.0.73                                                                           \n-A PREROUTING -d 10.104.3.104/32 -j DNAT --to-destination 10.129.0.84                                                                           \n-A PREROUTING -d 169.254.169.254/32 -p tcp -m tcp --dport 80 -j DNAT --to-destination 10.104.1.113:8773   <---<<<                                     \n-A POSTROUTING -s 10.129.0.84/32 -j SNAT --to-source 10.104.3.104                                                                               \n-A POSTROUTING -s 10.129.0.73/32 -j SNAT --to-source 10.104.3.103                                                                               \n-A POSTROUTING -s 10.129.0.92/32 -j SNAT --to-source 10.104.3.102                                                                               \n-A POSTROUTING -s 10.129.0.91/32 -j SNAT --to-source 10.104.3.100                                                                               \n-A POSTROUTING -s 10.129.0.87/32 -j SNAT --to-source 10.104.3.101                                                                               \n-A POSTROUTING -s 10.129.0.0/24 ! -d 10.129.0.0/24 -j MASQUERADE                                                                                \n-A OUTPUT -d 10.104.3.101/32 -j DNAT --to-destination 10.129.0.87 \n-A OUTPUT -d 10.104.3.100/32 -j DNAT --to-destination 10.129.0.91 \n-A OUTPUT -d 10.104.3.102/32 -j DNAT --to-destination 10.129.0.92 \n-A OUTPUT -d 10.104.3.103/32 -j DNAT --to-destination 10.129.0.73 \n-A OUTPUT -d 10.104.3.104/32 -j DNAT --to-destination 10.129.0.84 \nCOMMIT\n# Completed on Thu Aug 30 15:37:17 2012\n# Generated by iptables-save v1.4.7 on Thu Aug 30 15:37:17 2012\n*filter\n:INPUT ACCEPT [15:5133]\n:FORWARD DROP [0:0]\n:OUTPUT ACCEPT [7:1461]\n:Q5CBVzLRMiXg79hHyu7QsA== - [0:0]\n-A FORWARD -m conntrack --ctstate ESTABLISHED -j ACCEPT \n-A FORWARD ! -d 10.129.0.0/24 -j ACCEPT \n-A FORWARD -j Q5CBVzLRMiXg79hHyu7QsA== \n-A FORWARD -s 10.129.0.64/27 -d 10.129.0.64/27 -j ACCEPT \n-A Q5CBVzLRMiXg79hHyu7QsA== -d 10.129.0.64/27 -p tcp -m tcp --dport 22 -j ACCEPT \nCOMMIT\n# Completed on Thu Aug 30 15:37:17 2012\n\nWe are investigating. Have you observed any other abnormal behavior associated with this symptom?\n\nThank you,\n\nNeil Beard\n\n\n\nIt is my premise that there should be exactly one DNAT rule per instance..\n\n...                                                                          \n-A PREROUTING -d 169.254.169.254/32 -p tcp -m tcp --dport 80 -j DNAT --to-destination 10.104.1.114:8773                                         \n...                                                                          \n-A PREROUTING -d 169.254.169.254/32 -p tcp -m tcp --dport 80 -j DNAT --to-destination 10.104.1.113:8773   <---<<<  This should not be here.","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=nbeard","name":"nbeard","key":"nbeard","accountId":"557058:0d3a01f5-ec79-48de-8d8f-79bd6a2c5cb3","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/f26add140f84a617d35f2b4cbed36f47?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dnbeard%26avatarId%3D10207%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/f26add140f84a617d35f2b4cbed36f47?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dnbeard%26avatarId%3D10207%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/f26add140f84a617d35f2b4cbed36f47?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dnbeard%26avatarId%3D10207%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/f26add140f84a617d35f2b4cbed36f47?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dnbeard%26avatarId%3D10207%26noRedirect%3Dtrue"},"displayName":"Neil Beard","active":false,"timeZone":"America/Los_Angeles"},"created":"2012-08-31T10:42:32.356-0500","updated":"2012-08-31T10:42:32.356-0500"}],"maxResults":2,"total":2,"startAt":0},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_11808":null}}
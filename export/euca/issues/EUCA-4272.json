{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"17565","self":"https://eucalyptus.atlassian.net/rest/api/2/issue/17565","key":"EUCA-4272","fields":{"issuetype":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://eucalyptus.atlassian.net/secure/viewavatar?size=xsmall&avatarId=14803&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":14803},"timespent":null,"customfield_13100":null,"project":{"self":"https://eucalyptus.atlassian.net/rest/api/2/project/10000","id":"10000","key":"EUCA","name":"Eucalyptus","avatarUrls":{"48x48":"https://eucalyptus.atlassian.net/secure/projectavatar?pid=10000&avatarId=10011","24x24":"https://eucalyptus.atlassian.net/secure/projectavatar?size=small&pid=10000&avatarId=10011","16x16":"https://eucalyptus.atlassian.net/secure/projectavatar?size=xsmall&pid=10000&avatarId=10011","32x32":"https://eucalyptus.atlassian.net/secure/projectavatar?size=medium&pid=10000&avatarId=10011"}},"customfield_11000":null,"fixVersions":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/version/10602","id":"10602","description":"Eucalyptus 3.3.0","name":"3.3.0","archived":false,"released":true,"releaseDate":"2013-06-18"}],"customfield_11001":null,"aggregatetimespent":null,"resolution":{"self":"https://eucalyptus.atlassian.net/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_10310":null,"customfield_11401":null,"customfield_10311":null,"customfield_11400":null,"customfield_10104":["com.atlassian.greenhopper.service.sprint.Sprint@6c815365[id=18,rapidViewId=<null>,state=CLOSED,name=3.3 Sprint 8,goal=<null>,startDate=2013-05-15T22:11:05.921Z,endDate=2013-05-31T22:11:05.921Z,completeDate=2013-06-07T17:47:14.384Z,sequence=18]","com.atlassian.greenhopper.service.sprint.Sprint@3ce44e9c[id=10,rapidViewId=<null>,state=CLOSED,name=3.2 Sprint 7,goal=<null>,startDate=2012-11-10T22:18:20.990Z,endDate=2012-12-04T19:02:20.990Z,completeDate=2012-12-26T19:14:23.804Z,sequence=10]"],"customfield_10500":{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/10400","value":"Premium","id":"10400"},"customfield_10302":null,"customfield_10303":null,"customfield_10105":{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/10101","value":"No","id":"10101"},"customfield_10700":null,"customfield_10304":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/version/10112","id":"10112","description":"Eucalyptus 3.2.0","name":"3.2.0","archived":false,"released":true,"releaseDate":"2012-12-19"}],"customfield_10701":null,"customfield_10702":null,"customfield_10306":{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/10200","value":"High","id":"10200"},"customfield_10703":null,"customfield_10308":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=hspencer","name":"hspencer","key":"hspencer","accountId":"557058:4a3a93bc-21f8-4658-9f5b-9cb484c910a7","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue"},"displayName":"Harold Spencer Jr.","active":true,"timeZone":"America/Los_Angeles"},"customfield_10704":null,"resolutiondate":"2013-05-22T18:38:51.219-0500","customfield_10705":null,"customfield_10309":null,"workratio":0,"lastViewed":null,"watches":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/EUCA-4272/watchers","watchCount":8,"isWatching":false},"created":"2012-11-29T19:28:14.577-0600","customfield_12000":null,"priority":{"self":"https://eucalyptus.atlassian.net/rest/api/2/priority/2","iconUrl":"https://eucalyptus.atlassian.net/images/icons/priorities/critical.svg","name":"Critical","id":"2"},"customfield_12400":null,"customfield_12201":null,"customfield_10102":null,"customfield_12600":"{repository={count=2, dataType=repository}, json={\"cachedValue\":{\"errors\":[],\"summary\":{\"repository\":{\"overall\":{\"count\":2,\"lastUpdated\":\"2013-04-30T17:27:58.000-0500\",\"dataType\":\"repository\"},\"byInstanceType\":{\"github\":{\"count\":2,\"name\":\"GitHub\"}}}}},\"isStale\":true}}","customfield_10300":null,"customfield_10301":null,"labels":["QA-assigned"],"customfield_11700":null,"aggregatetimeoriginalestimate":0,"timeestimate":0,"versions":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/version/10706","id":"10706","name":"3.2.0-devel","archived":false,"released":true},{"self":"https://eucalyptus.atlassian.net/rest/api/2/version/11300","id":"11300","name":"3.2.1","archived":false,"released":true,"releaseDate":"2013-02-14"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/version/11305","id":"11305","name":"3.2.2","archived":false,"released":true,"releaseDate":"2013-04-01"}],"customfield_11901":null,"issuelinks":[{"id":"17351","self":"https://eucalyptus.atlassian.net/rest/api/2/issueLink/17351","type":{"id":"10103","name":"Relates","inward":"relates to","outward":"relates to","self":"https://eucalyptus.atlassian.net/rest/api/2/issueLinkType/10103"},"outwardIssue":{"id":"20470","key":"EUCA-5715","self":"https://eucalyptus.atlassian.net/rest/api/2/issue/20470","fields":{"summary":"Cloud unable to launch instances; Walrus left \"view\" of CLC which caused NCs not be be able to download manifest file","status":{"self":"https://eucalyptus.atlassian.net/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://eucalyptus.atlassian.net/images/icons/statuses/generic.png","name":"Closed","id":"6","statusCategory":{"self":"https://eucalyptus.atlassian.net/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://eucalyptus.atlassian.net/rest/api/2/priority/1","iconUrl":"https://eucalyptus.atlassian.net/images/icons/priorities/blocker.svg","name":"Blocker","id":"1"},"issuetype":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://eucalyptus.atlassian.net/secure/viewavatar?size=xsmall&avatarId=14803&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":14803}}}},{"id":"17700","self":"https://eucalyptus.atlassian.net/rest/api/2/issueLink/17700","type":{"id":"10103","name":"Relates","inward":"relates to","outward":"relates to","self":"https://eucalyptus.atlassian.net/rest/api/2/issueLinkType/10103"},"outwardIssue":{"id":"19145","key":"EUCA-4987","self":"https://eucalyptus.atlassian.net/rest/api/2/issue/19145","fields":{"summary":"NC does not time out instances stuck in \"pending\" or \"shutting down\" state ","status":{"self":"https://eucalyptus.atlassian.net/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://eucalyptus.atlassian.net/images/icons/statuses/generic.png","name":"Closed","id":"6","statusCategory":{"self":"https://eucalyptus.atlassian.net/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://eucalyptus.atlassian.net/rest/api/2/priority/3","iconUrl":"https://eucalyptus.atlassian.net/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://eucalyptus.atlassian.net/secure/viewavatar?size=xsmall&avatarId=14803&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":14803}}}}],"assignee":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=dmitrii","name":"dmitrii","key":"dmitrii","accountId":"557058:1e0ea807-434b-4b54-967f-1dec4a9ede55","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue"},"displayName":"Dmitrii Calzago","active":false,"timeZone":"America/Los_Angeles"},"updated":"2014-06-16T16:51:24.678-0500","status":{"self":"https://eucalyptus.atlassian.net/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://eucalyptus.atlassian.net/images/icons/statuses/generic.png","name":"Closed","id":"6","statusCategory":{"self":"https://eucalyptus.atlassian.net/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/component/10010","id":"10010","name":"Node Controller"}],"timeoriginalestimate":0,"description":"The way that locks are held in walrus_request_timeout leads to a problem when the referenced walrus request does not timeout in a timely fashion.  Reproducing the problem is non-deterministic, but can be achieved by interleaving instance runs and terminates on an over committed NC.  The user perceived symptom is, fundamentally, that any instances submitted to run after the problem is triggered will remain 'pending' until timing out.  \r\n\r\nAn NC can be identified as suffering from this malady using:\r\n\r\n{code}\r\n[root@eucahost-51-107 ~]# pstack $(pgrep httpd | tail -n1) | grep -B3 Curl_perform\r\nThread 11 (Thread 0x7fc2e5110700 (LWP 26483)):\r\n#0  0x00007fc30a2b2a63 in poll () from /lib64/libc.so.6\r\n#1  0x00007fc3051269e6 in Curl_socket_ready () from /usr/lib64/libcurl.so.4\r\n#2  0x00007fc30511ac62 in Curl_perform () from /usr/lib64/libcurl.so.4\r\n{code}","customfield_13000":null,"customfield_13200":null,"customfield_11300":null,"customfield_11500":null,"timetracking":{"originalEstimate":"0m","remainingEstimate":"0m","originalEstimateSeconds":0,"remainingEstimateSeconds":0},"customfield_10005":null,"customfield_10401":null,"customfield_10600":null,"customfield_12900":null,"attachment":[],"aggregatetimeestimate":0,"summary":"walrus_request_timeout may hang and impact unrelated instances","creator":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=decker","name":"decker","key":"decker","accountId":"557058:518b1ab0-12c2-4e72-b694-6c07036941a8","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/a84cbf1ecec07d9320b42ae4fc90ccce?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Ddecker%26avatarId%3D16203%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/a84cbf1ecec07d9320b42ae4fc90ccce?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Ddecker%26avatarId%3D16203%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/a84cbf1ecec07d9320b42ae4fc90ccce?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Ddecker%26avatarId%3D16203%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/a84cbf1ecec07d9320b42ae4fc90ccce?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Ddecker%26avatarId%3D16203%26noRedirect%3Dtrue"},"displayName":"do not want! (use @grze, please)","active":false,"timeZone":"America/Los_Angeles"},"subtasks":[],"reporter":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=decker","name":"decker","key":"decker","accountId":"557058:518b1ab0-12c2-4e72-b694-6c07036941a8","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/a84cbf1ecec07d9320b42ae4fc90ccce?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Ddecker%26avatarId%3D16203%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/a84cbf1ecec07d9320b42ae4fc90ccce?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Ddecker%26avatarId%3D16203%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/a84cbf1ecec07d9320b42ae4fc90ccce?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Ddecker%26avatarId%3D16203%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/a84cbf1ecec07d9320b42ae4fc90ccce?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Ddecker%26avatarId%3D16203%26noRedirect%3Dtrue"},"displayName":"do not want! (use @grze, please)","active":false,"timeZone":"America/Los_Angeles"},"customfield_12100":"0|i00oa7:","aggregateprogress":{"progress":0,"total":0},"customfield_10000":"3_*:*_1_*:*_37813914_*|*_10001_*:*_2_*:*_1342724295_*|*_10002_*:*_1_*:*_4306_*|*_10000_*:*_1_*:*_255624887_*|*_6_*:*_1_*:*_8038099364_*|*_10006_*:*_2_*:*_1112210196_*|*_5_*:*_1_*:*_1846256936_*|*_10003_*:*_2_*:*_2149459760_*|*_4_*:*_1_*:*_6362_*|*_10007_*:*_1_*:*_244836710","customfield_10001":"2012-12-01T18:55:42.705-0600","customfield_10002":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/10000","value":"Customer Affecting","id":"10000"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/11001","value":"Blocked","id":"11001"}],"customfield_10200":null,"customfield_10003":null,"customfield_12500":null,"customfield_10400":null,"customfield_11600":["dmitrii(dmitrii)","decker(decker)","hspencer(hspencer)","neil(neil)","rich(rich)","tjcramer(tjcramer)"],"customfield_10116":null,"customfield_10117":null,"environment":null,"customfield_11800":null,"customfield_11802":null,"duedate":null,"customfield_11805":null,"progress":{"progress":0,"total":0},"customfield_11806":null,"votes":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/EUCA-4272/votes","votes":1,"hasVoted":false},"comment":{"comments":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/17565/comment/36674","id":"36674","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=neil","name":"neil","key":"neil","accountId":"557058:bdcb5450-c2ec-4e86-a815-f842a934f480","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/7497770f3e2aaa247f356838f1fd8ba2?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dneil%26avatarId%3D10703%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/7497770f3e2aaa247f356838f1fd8ba2?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dneil%26avatarId%3D10703%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/7497770f3e2aaa247f356838f1fd8ba2?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dneil%26avatarId%3D10703%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/7497770f3e2aaa247f356838f1fd8ba2?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dneil%26avatarId%3D10703%26noRedirect%3Dtrue"},"displayName":"Neil Soman","active":true,"timeZone":"America/Los_Angeles"},"body":"Apparently there is a failure on the server side? Who has more info? How do I reproduce?","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=neil","name":"neil","key":"neil","accountId":"557058:bdcb5450-c2ec-4e86-a815-f842a934f480","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/7497770f3e2aaa247f356838f1fd8ba2?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dneil%26avatarId%3D10703%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/7497770f3e2aaa247f356838f1fd8ba2?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dneil%26avatarId%3D10703%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/7497770f3e2aaa247f356838f1fd8ba2?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dneil%26avatarId%3D10703%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/7497770f3e2aaa247f356838f1fd8ba2?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dneil%26avatarId%3D10703%26noRedirect%3Dtrue"},"displayName":"Neil Soman","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-12-01T18:55:42.705-0600","updated":"2012-12-01T18:55:42.705-0600"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/17565/comment/36729","id":"36729","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=dmitrii","name":"dmitrii","key":"dmitrii","accountId":"557058:1e0ea807-434b-4b54-967f-1dec4a9ede55","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue"},"displayName":"Dmitrii Calzago","active":false,"timeZone":"America/Los_Angeles"},"body":"*QA:* tricky to reproduce, of course: you want Walrus to accept the TCP connection and client's data, but then send no reply. (Simply stopping Walrus in the middle of a download or blocking traffic with iptables is likely to result in TCP connection being timed out, which is a different condition.)","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=dmitrii","name":"dmitrii","key":"dmitrii","accountId":"557058:1e0ea807-434b-4b54-967f-1dec4a9ede55","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue"},"displayName":"Dmitrii Calzago","active":false,"timeZone":"America/Los_Angeles"},"created":"2012-12-03T12:08:49.296-0600","updated":"2012-12-03T12:08:49.296-0600"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/17565/comment/37039","id":"37039","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=decker","name":"decker","key":"decker","accountId":"557058:518b1ab0-12c2-4e72-b694-6c07036941a8","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/a84cbf1ecec07d9320b42ae4fc90ccce?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Ddecker%26avatarId%3D16203%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/a84cbf1ecec07d9320b42ae4fc90ccce?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Ddecker%26avatarId%3D16203%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/a84cbf1ecec07d9320b42ae4fc90ccce?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Ddecker%26avatarId%3D16203%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/a84cbf1ecec07d9320b42ae4fc90ccce?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Ddecker%26avatarId%3D16203%26noRedirect%3Dtrue"},"displayName":"do not want! (use @grze, please)","active":false,"timeZone":"America/Los_Angeles"},"body":"I used a tweaked version of an old churn test to initially trigger the problem.  This earned the test the name castle-bravo.  It is here: https://github.com/grze/castle-bravo The test was performed using 3 NCs which had MAX_CORES=16\n\nThe latest code no longer exhibits this problem over a 5000 instance run.","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=decker","name":"decker","key":"decker","accountId":"557058:518b1ab0-12c2-4e72-b694-6c07036941a8","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/a84cbf1ecec07d9320b42ae4fc90ccce?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Ddecker%26avatarId%3D16203%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/a84cbf1ecec07d9320b42ae4fc90ccce?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Ddecker%26avatarId%3D16203%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/a84cbf1ecec07d9320b42ae4fc90ccce?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Ddecker%26avatarId%3D16203%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/a84cbf1ecec07d9320b42ae4fc90ccce?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Ddecker%26avatarId%3D16203%26noRedirect%3Dtrue"},"displayName":"do not want! (use @grze, please)","active":false,"timeZone":"America/Los_Angeles"},"created":"2012-12-06T14:09:39.164-0600","updated":"2012-12-06T14:09:39.164-0600"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/17565/comment/43256","id":"43256","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=hspencer","name":"hspencer","key":"hspencer","accountId":"557058:4a3a93bc-21f8-4658-9f5b-9cb484c910a7","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue"},"displayName":"Harold Spencer Jr.","active":true,"timeZone":"America/Los_Angeles"},"body":"Issue was seen in 3.2.1.  The following timeout was experienced on the NC where the image was cached and ran before:\r\n\r\n{code}\r\n2013-04-13 01:22:47 DEBUG 000035138 walrus_request_timeout   | {721032960} walrus_request: wrote 188 byte(s) in 1 write(s)\r\n2013-04-13 01:22:47 ERROR 000035138 walrus_request_timeout   | {721032960} walrus_request: server responded with HTTP code 403\r\n2013-04-13 01:22:47  INFO 000035138 walrus_request_timeout   | {721032960} walrus_request: due to error, removing /tmp/walrus-digest-Q2c6Yd\r\n2013-04-13 01:22:47 ERROR 000035138 walrus_get_digest        | failed to download digest to /tmp/walrus-digest-Q2c6Yd\r\n2013-04-13 01:22:47 ERROR 000035138 art_alloc_vbr            | [i-20C24491] failed to obtain image digest from  Walrus\r\n2013-04-13 01:22:47 ERROR 000035138 create_instance_backing  | [i-2D7641F6] failed to prepare backing for instance\r\n{code}\r\n\r\nWhat caused the timeout to happen can be found in EUCA-5715.","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=hspencer","name":"hspencer","key":"hspencer","accountId":"557058:4a3a93bc-21f8-4658-9f5b-9cb484c910a7","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue"},"displayName":"Harold Spencer Jr.","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-04-12T21:45:46.147-0500","updated":"2013-04-12T21:45:46.147-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/17565/comment/44258","id":"44258","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=dmitrii","name":"dmitrii","key":"dmitrii","accountId":"557058:1e0ea807-434b-4b54-967f-1dec4a9ede55","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue"},"displayName":"Dmitrii Calzago","active":false,"timeZone":"America/Los_Angeles"},"body":"This is related and possibly a duplicate of EUCA-4987 (Different stages of Walrus communication both bogged down by a {{curl}} call blocking for a long time.) To be specific, in some cases, we see blocking in {{art_implement_tree}} and in other cases we see it in {{vbr_alloc_tree}}, both of which contact Walrus and may block for a long time, while holding a lock.","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=dmitrii","name":"dmitrii","key":"dmitrii","accountId":"557058:1e0ea807-434b-4b54-967f-1dec4a9ede55","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue"},"displayName":"Dmitrii Calzago","active":false,"timeZone":"America/Los_Angeles"},"created":"2013-04-26T18:36:18.713-0500","updated":"2013-04-26T18:44:39.576-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/17565/comment/44261","id":"44261","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=dmitrii","name":"dmitrii","key":"dmitrii","accountId":"557058:1e0ea807-434b-4b54-967f-1dec4a9ede55","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue"},"displayName":"Dmitrii Calzago","active":false,"timeZone":"America/Los_Angeles"},"body":"Here is a different, but I suspect, related stack trace from system that [~rich] runs:\n\n{code}\n[root@nc01 eucalyptus]# pstack 16064\nThread 5 (Thread 0x7fa2b023b700 (LWP 16071)):\n#0  0x00007fa2c523db8d in nanosleep () from /lib64/libc.so.6\n#1  0x00007fa2c5272d64 in usleep () from /lib64/libc.so.6\n#2  0x00007fa2beffa715 in ?? () from /usr/lib64/axis2c/services/EucalyptusNC/libEucalyptusNC.so\n#3  0x00007fa2beffae26 in ?? () from /usr/lib64/axis2c/services/EucalyptusNC/libEucalyptusNC.so\n#4  0x00007fa2c552b851 in start_thread () from /lib64/libpthread.so.0\n#5  0x00007fa2c527990d in clone () from /lib64/libc.so.6\nThread 4 (Thread 0x7fa2af83a700 (LWP 16082)):\n#0  0x00007fa2c523db8d in nanosleep () from /lib64/libc.so.6\n#1  0x00007fa2c523da00 in sleep () from /lib64/libc.so.6\n#2  0x00007fa2befb30c1 in monitoring_thread () from /usr/lib64/axis2c/services/EucalyptusNC/libEucalyptusNC.so\n#3  0x00007fa2c552b851 in start_thread () from /lib64/libpthread.so.0\n#4  0x00007fa2c527990d in clone () from /lib64/libc.so.6\nThread 3 (Thread 0x7fa2aec23700 (LWP 25454)):\n#0  0x00007fa2c5270253 in poll () from /lib64/libc.so.6\n#1  0x00007fa2c31a0b96 in Curl_socket_ready () from /usr/lib64/libcurl.so.4\n#2  0x00007fa2c3194e12 in Curl_perform () from /usr/lib64/libcurl.so.4\n#3  0x00007fa2befd0e5d in ?? () from /usr/lib64/axis2c/services/EucalyptusNC/libEucalyptusNC.so\n#4  0x00007fa2befd4668 in ?? () from /usr/lib64/axis2c/services/EucalyptusNC/libEucalyptusNC.so\n#5  0x00007fa2befd2ece in art_implement_tree () from /usr/lib64/axis2c/services/EucalyptusNC/libEucalyptusNC.so\n#6  0x00007fa2befd2dc4 in art_implement_tree () from /usr/lib64/axis2c/services/EucalyptusNC/libEucalyptusNC.so\n#7  0x00007fa2befd2dc4 in art_implement_tree () from /usr/lib64/axis2c/services/EucalyptusNC/libEucalyptusNC.so\n#8  0x00007fa2befd2dc4 in art_implement_tree () from /usr/lib64/axis2c/services/EucalyptusNC/libEucalyptusNC.so\n#9  0x00007fa2befc4beb in create_instance_backing () from /usr/lib64/axis2c/services/EucalyptusNC/libEucalyptusNC.so\n#10 0x00007fa2befb4095 in startup_thread () from /usr/lib64/axis2c/services/EucalyptusNC/libEucalyptusNC.so\n#11 0x00007fa2c552b851 in start_thread () from /lib64/libpthread.so.0\n#12 0x00007fa2c527990d in clone () from /lib64/libc.so.6\nThread 2 (Thread 0x7fa2ae222700 (LWP 27374)):\n#0  0x00007fa2c552f43c in pthread_cond_wait@@GLIBC_2.3.2 () from /lib64/libpthread.so.0\n#1  0x00007fa2befee7cb in sem_prolaag () from /usr/lib64/axis2c/services/EucalyptusNC/libEucalyptusNC.so\n#2  0x00007fa2befc4bc8 in create_instance_backing () from /usr/lib64/axis2c/services/EucalyptusNC/libEucalyptusNC.so\n#3  0x00007fa2befb4095 in startup_thread () from /usr/lib64/axis2c/services/EucalyptusNC/libEucalyptusNC.so\n#4  0x00007fa2c552b851 in start_thread () from /lib64/libpthread.so.0\n#5  0x00007fa2c527990d in clone () from /lib64/libc.so.6\nThread 1 (Thread 0x7fa2c6c437e0 (LWP 16064)):\n#0  0x00007fa2c527bc3f in accept4 () from /lib64/libc.so.6\n#1  0x00007fa2c575ce8a in apr_socket_accept () from /usr/lib64/axis2c/lib/libapr-1.so.0\n#2  0x00007fa2c6c95be1 in unixd_accept ()\n#3  0x00007fa2c6c94913 in ?? ()\n#4  0x00007fa2c6c94c8a in ?? ()\n#5  0x00007fa2c6c9590c in ap_mpm_run ()\n#6  0x00007fa2c6c6c900 in main ()\n[root@nc01 eucalyptus]#\n{code}","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=dmitrii","name":"dmitrii","key":"dmitrii","accountId":"557058:1e0ea807-434b-4b54-967f-1dec4a9ede55","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue"},"displayName":"Dmitrii Calzago","active":false,"timeZone":"America/Los_Angeles"},"created":"2013-04-26T18:49:05.581-0500","updated":"2013-04-26T18:49:05.581-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/17565/comment/44281","id":"44281","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=rich","name":"rich","key":"rich","accountId":"557058:8c482bdc-e25e-4adf-8ce3-d545bda65679","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/836ed5700fb9db2dd603525a729cf69f?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FavatarId%3D10122%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/836ed5700fb9db2dd603525a729cf69f?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26avatarId%3D10122%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/836ed5700fb9db2dd603525a729cf69f?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26avatarId%3D10122%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/836ed5700fb9db2dd603525a729cf69f?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26avatarId%3D10122%26noRedirect%3Dtrue"},"displayName":"Rich Wolski","active":true,"timeZone":"US/Central"},"body":"This stack trace occurred on two separate nodes (exactly the same call stack) that were deadlocked.","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=rich","name":"rich","key":"rich","accountId":"557058:8c482bdc-e25e-4adf-8ce3-d545bda65679","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/836ed5700fb9db2dd603525a729cf69f?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FavatarId%3D10122%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/836ed5700fb9db2dd603525a729cf69f?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26avatarId%3D10122%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/836ed5700fb9db2dd603525a729cf69f?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26avatarId%3D10122%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/836ed5700fb9db2dd603525a729cf69f?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26avatarId%3D10122%26noRedirect%3Dtrue"},"displayName":"Rich Wolski","active":true,"timeZone":"US/Central"},"created":"2013-04-27T11:14:32.708-0500","updated":"2013-04-27T11:14:32.708-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/17565/comment/44546","id":"44546","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=dmitrii","name":"dmitrii","key":"dmitrii","accountId":"557058:1e0ea807-434b-4b54-967f-1dec4a9ede55","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue"},"displayName":"Dmitrii Calzago","active":false,"timeZone":"America/Los_Angeles"},"body":"I have a fix for the NC part of this problem. Looks like one of our timeouts got lost in refactoring. So this is a regression that is getting fixed for 3.3. NC will now time out quicker on connection attempts and will eventually time out on a non-responsive Walrus. Needless to say, whatever problem on Walrus lead this this condition may or may not be fixed at this point (see the tickets linked to this one).\n\nh2. Connection timeout\n\nTo test the connection timeout, I would clear the cache on NC, place a \"bitbucket\" rule on the NC for any traffic bound for Walrus, and then try running an instance:\n\n{code}\nlosetup -a\ndmsetup table\nrm -rf /disk1/storage/eucalyptus/instances/cache/*\niptables -A OUTPUT -d $WALRUS_IP -p tcp --dport 8773 -j DROP\neuca-run-instance ...\n{code}\n\nin nc.log connection failure looks like this:\n\n{code}\n2013-04-30 13:56:54 DEBUG 000005278 startup_thread           | [i-4D8E4820] spawning startup thread\n2013-04-30 13:56:54 DEBUG 000005278 vnetStartNetworkManaged  | params: vnetconfig=0x7fea25b06010, vlan=43, uuid=UNSET, userName=UNSET, netName=UNSET\n2013-04-30 13:56:54  INFO 000005278 ensure_directories_exist | creating path /disk1/storage/eucalyptus/instances/work/YFGR18PWUQYMI17J4AISG/i-4D8E4820\n2013-04-30 13:56:54 DEBUG 000005278 diskutil_ch              | ch(own|mod) '/disk1/storage/eucalyptus/instances/work/YFGR18PWUQYMI17J4AISG/i-4D8E4820' *.root 771\n2013-04-30 13:56:54 DEBUG 000005278 vbr_alloc_tree           | [i-4D8E4820] found 2 prereqs and 3 partitions in the VBR\n2013-04-30 13:56:54 DEBUG 000005278 art_alloc                | [i-4D8E4820] allocated artifact 001|i-4D8E4820 size=-1 vbr=(nil) cache=0 file=0\n2013-04-30 13:56:54 DEBUG 000005278 walrus_request_timeout   | writing GET output to /tmp/walrus-digest-K5pGb5\n...\n2013-04-30 13:57:04 DEBUG 000005278 walrus_request_timeout   | wrote 0 byte(s) in 0 write(s)\n2013-04-30 13:57:04 ERROR 000005278 walrus_request_timeout   | connection to Walrus failed: connect() timed out! (28)\n2013-04-30 13:57:04  WARN 000005278 walrus_request_timeout   | download attempt 2 of 3 will commence in 4 sec for http://192.168.51.167:8773/services/Walrus/tmpvuykw7gdig/vmlinuz-3.2.0-23-virtual.manifest.xml\n...\n2013-04-30 13:57:18 DEBUG 000005278 walrus_request_timeout   | wrote 0 byte(s) in 0 write(s)\n2013-04-30 13:57:18 ERROR 000005278 walrus_request_timeout   | connection to Walrus failed: connect() timed out! (28)\n2013-04-30 13:57:18  WARN 000005278 walrus_request_timeout   | download attempt 3 of 3 will commence in 8 sec for http://192.168.51.167:8773/services/Walrus/tmpvuykw7gdig/vmlinuz-3.2.0-23-virtual.manifest.xml\n...\n2013-04-30 13:57:36 DEBUG 000005278 walrus_request_timeout   | wrote 0 byte(s) in 0 write(s)\n2013-04-30 13:57:36 ERROR 000005278 walrus_request_timeout   | connection to Walrus failed: connect() timed out! (28)\n2013-04-30 13:57:36  INFO 000005278 walrus_request_timeout   | due to error, removing /tmp/walrus-digest-K5pGb5\n2013-04-30 13:57:36 ERROR 000005278 walrus_get_digest        | failed to download digest to /tmp/walrus-digest-K5pGb5\n2013-04-30 13:57:36 ERROR 000005278 art_alloc_vbr            | [i-4D8E4820] failed to obtain image digest from  Walrus\n2013-04-30 13:57:36 ERROR 000005278 create_instance_backing  | [i-4D8E4820] failed to prepare backing for instance\n2013-04-30 13:57:36 ERROR 000005278 startup_thread           | [i-4D8E4820] failed to prepare images for instance (error=1)\n2013-04-30 13:57:36 DEBUG 000005278 change_state             | [i-4D8E4820] state change for instance: Staging -> Shutoff (Pending)\n2013-04-30 13:57:40  WARN 000005227 libvirt_err_handler      | libvirt: Domain not found: no domain with matching name 'i-4D8E4820' (code=42)\n2013-04-30 13:57:40  INFO 000005227 monitoring_thread        | [i-4D8E4820] cleaning up state for instance\n2013-04-30 13:57:40 DEBUG 000005227 diskutil_ch              | ch(own|mod) '/disk1/storage/eucalyptus/instan\n{code}\n\nThe stack trace for such a process looks like this (and, notably, different from a stuck-in-transfer NC):\n\n{code}\nThread 2 (Thread 0x7f1aaee65700 (LWP 13967)):\n#0  0x00007f1ac6c0ea63 in poll () from /lib64/libc.so.6\n#1  0x00007f1ac1aa89e6 in Curl_socket_ready () from /usr/lib64/libcurl.so.4\n#2  0x00007f1ac1a9fd01 in ?? () from /usr/lib64/libcurl.so.4\n#3  0x00007f1ac1a9ffd1 in Curl_connecthost () from /usr/lib64/libcurl.so.4\n#4  0x00007f1ac1a949e6 in Curl_connect () from /usr/lib64/libcurl.so.4\n#5  0x00007f1ac1a9c9b0 in Curl_perform () from /usr/lib64/libcurl.so.4\n#6  0x00007f1ac2817634 in walrus_request_timeout.clone.0 () from /opt/eucalyptus/packages/axis2c-1.6.0/services/EucalyptusNC/libEucalyptusNC.so\n#7  0x00007f1ac2817c82 in walrus_get_digest () from /opt/eucalyptus/packages/axis2c-1.6.0/services/EucalyptusNC/libEucalyptusNC.so\n#8  0x00007f1ac281df7c in art_alloc_vbr () from /opt/eucalyptus/packages/axis2c-1.6.0/services/EucalyptusNC/libEucalyptusNC.so\n#9  0x00007f1ac281e723 in vbr_alloc_tree () from /opt/eucalyptus/packages/axis2c-1.6.0/services/EucalyptusNC/libEucalyptusNC.so\n#10 0x00007f1ac280bc05 in create_instance_backing () from /opt/eucalyptus/packages/axis2c-1.6.0/services/EucalyptusNC/libEucalyptusNC.so\n#11 0x00007f1ac27fef33 in startup_thread () from /opt/eucalyptus/packages/axis2c-1.6.0/services/EucalyptusNC/libEucalyptusNC.so\n#12 0x00007f1ac6eca851 in start_thread () from /lib64/libpthread.so.0\n#13 0x00007f1ac6c1811d in clone () from /lib64/libc.so.6\n{code}\n\nh2. Transfer timeout\n\nTo test timeout after the connection is established, I would take the same steps as above, but would introduce the \"bitbucket\" rule *after* the long transfer from Walrus has started. The log then looks like this:\n\n{code}\n2013-04-30 14:36:19 DEBUG 000006460 walrus_request_timeout   | writing GET/GetDecryptedImage output\n2013-04-30 14:36:19 DEBUG 000006460 walrus_request_timeout   |         from http://192.168.51.167:8773/services/Walrus/tmpf2mkanj07n/precise-server-cloudimg-amd64-ext3.img.mani\nfest.xml\n2013-04-30 14:36:19 DEBUG 000006460 walrus_request_timeout   |         to /disk1/storage/eucalyptus/instances/cache/emi-FD0C37DF-1cdad98c/blocks\n...\n2013-04-30 14:36:22  INFO 000006460 progress_function        | downloaded 15.9% of http://192.168.51.167:8773/services/Walrus/tmpf2mkanj07n/precise-server-cloudimg-amd64-ext3.i\nmg.manifest.xml\n2013-04-30 14:36:25  INFO 000006460 progress_function        | downloaded 39.2% of http://192.168.51.167:8773/services/Walrus/tmpf2mkanj07n/precise-server-cloudimg-amd64-ext3.i\nmg.manifest.xml\n2013-04-30 14:36:28  INFO 000006460 progress_function        | downloaded 60.6% of http://192.168.51.167:8773/services/Walrus/tmpf2mkanj07n/precise-server-cloudimg-amd64-ext3.i\nmg.manifest.xml\n...\n2013-04-30 14:36:31  INFO 000006460 progress_function        | downloaded 71.1% of http://192.168.51.167:8773/services/Walrus/tmpf2mkanj07n/precise-server-cloudimg-amd64-ext3.i\nmg.manifest.xml\n2013-04-30 14:36:34  INFO 000006460 progress_function        | downloaded 71.1% of http://192.168.51.167:8773/services/Walrus/tmpf2mkanj07n/precise-server-cloudimg-amd64-ext3.i\nmg.manifest.xml\n2013-04-30 14:36:37 DEBUG 000005210 doDescribeResource       | returning status=enabled cores=3/4 mem=7536/7792 disk=32/37 iqn=iqn.1994-05.com.redhat:fb38f529275e\n2013-04-30 14:36:37 DEBUG 000005210 doDescribeInstances      | invoked userId=eucalyptus correlationId=UNSET epoch=32 services[0]{.name=CC_167 .type=cluster .uris[0]=http://192\n.168.51.167:8774/axis2/services/EucalyptusCC}\n2013-04-30 14:36:37 DEBUG 000005210 doDescribeInstances      | [i-C88C4138] Pending (not migrating) pub=192.168.40.110 vols=\n2013-04-30 14:36:37  INFO 000006460 progress_function        | downloaded 71.1% of http://192.168.51.167:8773/services/Walrus/tmpf2mkanj07n/precise-server-cloudimg-amd64-ext3.i\nmg.manifest.xml\n2013-04-30 14:36:40  INFO 000006460 progress_function        | downloaded 71.1% of http://192.168.51.167:8773/services/Walrus/tmpf2mkanj07n/precise-server-cloudimg-amd64-ext3.i\nmg.manifest.xml\n...\n2013-04-30 14:36:45 DEBUG 000006460 walrus_request_timeout   | wrote 1043417352 byte(s) in 115567 write(s)\n2013-04-30 14:36:45 ERROR 000006460 walrus_request_timeout   | connection to Walrus failed: Operation too slow. Less than 360 bytes/sec transfered the last 10 seconds (28)\n2013-04-30 14:36:45  WARN 000006460 walrus_request_timeout   | download attempt 2 of 3 will commence in 4 sec for http://192.168.51.167:8773/services/Walrus/tmpf2mkanj07n/precise-server-cloudimg-amd64-ext3.img.manifest.xml\n...\n{code}\n\nThe \"bitbucket\" rule can be removed with\n\n{code}\niptables -D OUTPUT -d $WALRUS_IP -p tcp --dport 8773 -j DROP\n{code}","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=dmitrii","name":"dmitrii","key":"dmitrii","accountId":"557058:1e0ea807-434b-4b54-967f-1dec4a9ede55","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue"},"displayName":"Dmitrii Calzago","active":false,"timeZone":"America/Los_Angeles"},"created":"2013-04-30T17:25:08.780-0500","updated":"2013-04-30T17:25:08.780-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/17565/comment/46375","id":"46375","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=dmitrii","name":"dmitrii","key":"dmitrii","accountId":"557058:1e0ea807-434b-4b54-967f-1dec4a9ede55","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue"},"displayName":"Dmitrii Calzago","active":false,"timeZone":"America/Los_Angeles"},"body":"I did my own testing (as described in the comments), so I'm taking this off QA-team's plate.","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=dmitrii","name":"dmitrii","key":"dmitrii","accountId":"557058:1e0ea807-434b-4b54-967f-1dec4a9ede55","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue"},"displayName":"Dmitrii Calzago","active":false,"timeZone":"America/Los_Angeles"},"created":"2013-05-22T18:38:51.238-0500","updated":"2013-05-22T18:38:51.238-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/17565/comment/48703","id":"48703","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=tjcramer","name":"tjcramer","key":"tjcramer","accountId":"557058:e076cf45-80ca-4b67-befb-7b0c21f32739","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/65e7a5c18fc469f1978f6367993c3bf0?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dtjcramer%26avatarId%3D10401%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/65e7a5c18fc469f1978f6367993c3bf0?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dtjcramer%26avatarId%3D10401%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/65e7a5c18fc469f1978f6367993c3bf0?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dtjcramer%26avatarId%3D10401%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/65e7a5c18fc469f1978f6367993c3bf0?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dtjcramer%26avatarId%3D10401%26noRedirect%3Dtrue"},"displayName":"Tim Cramer","active":true,"timeZone":"America/Los_Angeles"},"body":"Resolved in the 3.3.0 release","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=tjcramer","name":"tjcramer","key":"tjcramer","accountId":"557058:e076cf45-80ca-4b67-befb-7b0c21f32739","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/65e7a5c18fc469f1978f6367993c3bf0?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dtjcramer%26avatarId%3D10401%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/65e7a5c18fc469f1978f6367993c3bf0?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dtjcramer%26avatarId%3D10401%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/65e7a5c18fc469f1978f6367993c3bf0?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dtjcramer%26avatarId%3D10401%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/65e7a5c18fc469f1978f6367993c3bf0?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dtjcramer%26avatarId%3D10401%26noRedirect%3Dtrue"},"displayName":"Tim Cramer","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-06-26T21:45:33.026-0500","updated":"2013-06-26T21:45:33.026-0500"}],"maxResults":10,"total":10,"startAt":0},"customfield_11808":null,"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]}}}
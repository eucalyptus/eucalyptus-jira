{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"61001","self":"https://eucalyptus.atlassian.net/rest/api/2/issue/61001","key":"EUCA-13442","fields":{"issuetype":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://eucalyptus.atlassian.net/secure/viewavatar?size=xsmall&avatarId=14803&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":14803},"timespent":null,"customfield_13100":null,"project":{"self":"https://eucalyptus.atlassian.net/rest/api/2/project/10000","id":"10000","key":"EUCA","name":"Eucalyptus","avatarUrls":{"48x48":"https://eucalyptus.atlassian.net/secure/projectavatar?pid=10000&avatarId=10011","24x24":"https://eucalyptus.atlassian.net/secure/projectavatar?size=small&pid=10000&avatarId=10011","16x16":"https://eucalyptus.atlassian.net/secure/projectavatar?size=xsmall&pid=10000&avatarId=10011","32x32":"https://eucalyptus.atlassian.net/secure/projectavatar?size=medium&pid=10000&avatarId=10011"}},"customfield_11000":null,"fixVersions":[],"customfield_11001":null,"aggregatetimespent":null,"resolution":null,"customfield_10310":null,"customfield_11401":null,"customfield_10311":null,"customfield_11400":null,"customfield_10104":[],"customfield_10500":{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/10403","value":"Not Applicable","id":"10403"},"customfield_10302":null,"customfield_10303":null,"customfield_10105":null,"customfield_10304":null,"customfield_10700":null,"customfield_10701":null,"customfield_10702":null,"customfield_10306":null,"customfield_10703":null,"customfield_10704":null,"customfield_10308":null,"resolutiondate":null,"customfield_10705":null,"customfield_10309":null,"workratio":-1,"watches":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/EUCA-13442/watchers","watchCount":1,"isWatching":false},"lastViewed":null,"created":"2017-08-02T19:13:53.951-0500","customfield_12000":null,"customfield_12400":null,"priority":{"self":"https://eucalyptus.atlassian.net/rest/api/2/priority/3","iconUrl":"https://eucalyptus.atlassian.net/images/icons/priorities/major.svg","name":"Major","id":"3"},"customfield_12201":null,"customfield_12600":"{}","customfield_10300":null,"customfield_10102":null,"customfield_10301":null,"labels":[],"customfield_11700":null,"aggregatetimeoriginalestimate":null,"timeestimate":null,"customfield_11901":null,"versions":[],"issuelinks":[],"assignee":null,"updated":"2017-08-03T10:54:02.951-0500","status":{"self":"https://eucalyptus.atlassian.net/rest/api/2/status/10001","description":"This issue has been validated/reproduced, but has not been prioritized yet.","iconUrl":"https://eucalyptus.atlassian.net/images/icons/statuses/generic.png","name":"Confirmed","id":"10001","statusCategory":{"self":"https://eucalyptus.atlassian.net/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"components":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/component/10010","id":"10010","name":"Node Controller"}],"timeoriginalestimate":null,"customfield_13000":null,"description":"The node controller uses both posix threads and fork, causing locking failures on fork:\r\n\r\n{code}\r\nThread 28 (Thread 0x7f07b9568700 (LWP 59035)):\r\n#0  0x00007f07c534d66d in nanosleep () from /usr/lib64/axis2c/lib/libc.so.6\r\n#1  0x00007f07c537e2f4 in usleep () from /usr/lib64/axis2c/lib/libc.so.6\r\n#2  0x00007f07be5e584d in sensor_bottom_half () at sensor.c:455\r\n#3  0x00007f07be5e5e73 in sensor_thread (arg=<optimized out>) at sensor.c:529\r\n#4  0x00007f07c585bdc5 in start_thread () from /usr/lib64/axis2c/lib/libpthread.so.0\r\n#5  0x00007f07c538676d in clone () from /usr/lib64/axis2c/lib/libc.so.6\r\nThread 27 (Thread 0x7f07b3fff700 (LWP 59137)):\r\n#0  0x00007f07c534d66d in nanosleep () from /usr/lib64/axis2c/lib/libc.so.6\r\n#1  0x00007f07c534d504 in sleep () from /usr/lib64/axis2c/lib/libc.so.6\r\n#2  0x00007f07be59dcc1 in monitoring_thread (arg=<optimized out>) at handlers.c:1711\r\n#3  0x00007f07c585bdc5 in start_thread () from /usr/lib64/axis2c/lib/libpthread.so.0\r\n#4  0x00007f07c538676d in clone () from /usr/lib64/axis2c/lib/libc.so.6\r\nThread 26 (Thread 0x7f07b37fe700 (LWP 59138)):\r\n#0  0x00007f07c534d66d in nanosleep () from /usr/lib64/axis2c/lib/libc.so.6\r\n#1  0x00007f07c537e2f4 in usleep () from /usr/lib64/axis2c/lib/libc.so.6\r\n#2  0x00007f07be5cbd86 in run_stats (run_once=run_once@entry=0, execution_interval_sec=<optimized out>, update_config_fn=update_config_fn@entry=0x0) at stats.c:190\r\n#3  0x00007f07be5933ed in nc_run_stats (ignored_arg=<optimized out>) at handlers.c:317\r\n#4  0x00007f07c585bdc5 in start_thread () from /usr/lib64/axis2c/lib/libpthread.so.0\r\n#5  0x00007f07c538676d in clone () from /usr/lib64/axis2c/lib/libc.so.6\r\nThread 25 (Thread 0x7f079affd700 (LWP 1469)):\r\n#0  0x00007f07c585f6d5 in pthread_cond_wait@@GLIBC_2.3.2 () from /usr/lib64/axis2c/lib/libpthread.so.0\r\n#1  0x00007f07be5db88b in sem_prolaag (pSem=0x7f07c810ac50, doLog=doLog@entry=1 '\\001') at ipc.c:378\r\n#2  0x00007f07be5db90a in sem_p (pSem=<optimized out>) at ipc.c:410\r\n#3  0x00007f07be594e16 in lock_hypervisor_conn () at handlers.c:942\r\n#4  0x00007f07be59ef39 in startup_thread (arg=0x7f07cd129620) at handlers.c:1887\r\n#5  0x00007f07c585bdc5 in start_thread () from /usr/lib64/axis2c/lib/libpthread.so.0\r\n#6  0x00007f07c538676d in clone () from /usr/lib64/axis2c/lib/libc.so.6\r\nThread 24 (Thread 0x7f079a7fc700 (LWP 1496)):\r\n#0  0x00007f07c585f6d5 in pthread_cond_wait@@GLIBC_2.3.2 () from /usr/lib64/axis2c/lib/libpthread.so.0\r\n#1  0x00007f07be5db88b in sem_prolaag (pSem=0x7f07c810ac50, doLog=doLog@entry=1 '\\001') at ipc.c:378\r\n#2  0x00007f07be5db90a in sem_p (pSem=<optimized out>) at ipc.c:410\r\n#3  0x00007f07be594e16 in lock_hypervisor_conn () at handlers.c:942\r\n#4  0x00007f07be59ef39 in startup_thread (arg=0x7f07c98a4650) at handlers.c:1887\r\n#5  0x00007f07c585bdc5 in start_thread () from /usr/lib64/axis2c/lib/libpthread.so.0\r\n#6  0x00007f07c538676d in clone () from /usr/lib64/axis2c/lib/libc.so.6\r\nThread 23 (Thread 0x7f0799ffb700 (LWP 1540)):\r\n#0  0x00007f07c585f6d5 in pthread_cond_wait@@GLIBC_2.3.2 () from /usr/lib64/axis2c/lib/libpthread.so.0\r\n#1  0x00007f07be5db88b in sem_prolaag (pSem=0x7f07c810ac50, doLog=doLog@entry=1 '\\001') at ipc.c:378\r\n#2  0x00007f07be5db90a in sem_p (pSem=<optimized out>) at ipc.c:410\r\n#3  0x00007f07be594e16 in lock_hypervisor_conn () at handlers.c:942\r\n#4  0x00007f07be59ef39 in startup_thread (arg=0x7f07c9a8ecd0) at handlers.c:1887\r\n#5  0x00007f07c585bdc5 in start_thread () from /usr/lib64/axis2c/lib/libpthread.so.0\r\n#6  0x00007f07c538676d in clone () from /usr/lib64/axis2c/lib/libc.so.6\r\nThread 22 (Thread 0x7f07997fa700 (LWP 1556)):\r\n#0  0x00007f07c585f6d5 in pthread_cond_wait@@GLIBC_2.3.2 () from /usr/lib64/axis2c/lib/libpthread.so.0\r\n#1  0x00007f07be5db88b in sem_prolaag (pSem=0x7f07c810ac50, doLog=doLog@entry=1 '\\001') at ipc.c:378\r\n#2  0x00007f07be5db90a in sem_p (pSem=<optimized out>) at ipc.c:410\r\n#3  0x00007f07be594e16 in lock_hypervisor_conn () at handlers.c:942\r\n#4  0x00007f07be59ef39 in startup_thread (arg=0x7f07c9c79350) at handlers.c:1887\r\n#5  0x00007f07c585bdc5 in start_thread () from /usr/lib64/axis2c/lib/libpthread.so.0\r\n#6  0x00007f07c538676d in clone () from /usr/lib64/axis2c/lib/libc.so.6\r\nThread 21 (Thread 0x7f0798ff9700 (LWP 1581)):\r\n#0  0x00007f07c585f6d5 in pthread_cond_wait@@GLIBC_2.3.2 () from /usr/lib64/axis2c/lib/libpthread.so.0\r\n#1  0x00007f07be5db88b in sem_prolaag (pSem=0x7f07c810ac50, doLog=doLog@entry=1 '\\001') at ipc.c:378\r\n#2  0x00007f07be5db90a in sem_p (pSem=<optimized out>) at ipc.c:410\r\n#3  0x00007f07be594e16 in lock_hypervisor_conn () at handlers.c:942\r\n#4  0x00007f07be59ef39 in startup_thread (arg=0x7f07c9e639d0) at handlers.c:1887\r\n#5  0x00007f07c585bdc5 in start_thread () from /usr/lib64/axis2c/lib/libpthread.so.0\r\n#6  0x00007f07c538676d in clone () from /usr/lib64/axis2c/lib/libc.so.6\r\nThread 20 (Thread 0x7f0777fff700 (LWP 1615)):\r\n#0  0x00007f07c585f6d5 in pthread_cond_wait@@GLIBC_2.3.2 () from /usr/lib64/axis2c/lib/libpthread.so.0\r\n#1  0x00007f07be5db88b in sem_prolaag (pSem=0x7f07c810ac50, doLog=doLog@entry=1 '\\001') at ipc.c:378\r\n#2  0x00007f07be5db90a in sem_p (pSem=<optimized out>) at ipc.c:410\r\n#3  0x00007f07be594e16 in lock_hypervisor_conn () at handlers.c:942\r\n#4  0x00007f07be59ef39 in startup_thread (arg=0x7f07ce2670a0) at handlers.c:1887\r\n#5  0x00007f07c585bdc5 in start_thread () from /usr/lib64/axis2c/lib/libpthread.so.0\r\n#6  0x00007f07c538676d in clone () from /usr/lib64/axis2c/lib/libc.so.6\r\nThread 19 (Thread 0x7f07777fe700 (LWP 1646)):\r\n#0  0x00007f07c585f6d5 in pthread_cond_wait@@GLIBC_2.3.2 () from /usr/lib64/axis2c/lib/libpthread.so.0\r\n#1  0x00007f07be5db88b in sem_prolaag (pSem=0x7f07c810ac50, doLog=doLog@entry=1 '\\001') at ipc.c:378\r\n#2  0x00007f07be5db90a in sem_p (pSem=<optimized out>) at ipc.c:410\r\n#3  0x00007f07be594e16 in lock_hypervisor_conn () at handlers.c:942\r\n#4  0x00007f07be59ef39 in startup_thread (arg=0x7f07cd408fe0) at handlers.c:1887\r\n#5  0x00007f07c585bdc5 in start_thread () from /usr/lib64/axis2c/lib/libpthread.so.0\r\n#6  0x00007f07c538676d in clone () from /usr/lib64/axis2c/lib/libc.so.6\r\nThread 18 (Thread 0x7f0776ffd700 (LWP 1663)):\r\n#0  0x00007f07c585f6d5 in pthread_cond_wait@@GLIBC_2.3.2 () from /usr/lib64/axis2c/lib/libpthread.so.0\r\n#1  0x00007f07be5db88b in sem_prolaag (pSem=0x7f07c810ac50, doLog=doLog@entry=1 '\\001') at ipc.c:378\r\n#2  0x00007f07be5db90a in sem_p (pSem=<optimized out>) at ipc.c:410\r\n#3  0x00007f07be594e16 in lock_hypervisor_conn () at handlers.c:942\r\n#4  0x00007f07be59ef39 in startup_thread (arg=0x7f07cde923a0) at handlers.c:1887\r\n#5  0x00007f07c585bdc5 in start_thread () from /usr/lib64/axis2c/lib/libpthread.so.0\r\n#6  0x00007f07c538676d in clone () from /usr/lib64/axis2c/lib/libc.so.6\r\nThread 17 (Thread 0x7f07767fc700 (LWP 1719)):\r\n#0  0x00007f07c585f6d5 in pthread_cond_wait@@GLIBC_2.3.2 () from /usr/lib64/axis2c/lib/libpthread.so.0\r\n#1  0x00007f07be5db88b in sem_prolaag (pSem=0x7f07c810ac50, doLog=doLog@entry=1 '\\001') at ipc.c:378\r\n#2  0x00007f07be5db90a in sem_p (pSem=<optimized out>) at ipc.c:410\r\n#3  0x00007f07be594e16 in lock_hypervisor_conn () at handlers.c:942\r\n#4  0x00007f07be59ef39 in startup_thread (arg=0x7f07ce35c3e0) at handlers.c:1887\r\n#5  0x00007f07c585bdc5 in start_thread () from /usr/lib64/axis2c/lib/libpthread.so.0\r\n#6  0x00007f07c538676d in clone () from /usr/lib64/axis2c/lib/libc.so.6\r\nThread 16 (Thread 0x7f0775ffb700 (LWP 1741)):\r\n#0  0x00007f07c585f6d5 in pthread_cond_wait@@GLIBC_2.3.2 () from /usr/lib64/axis2c/lib/libpthread.so.0\r\n#1  0x00007f07be5db88b in sem_prolaag (pSem=0x7f07c810ac50, doLog=doLog@entry=1 '\\001') at ipc.c:378\r\n#2  0x00007f07be5db90a in sem_p (pSem=<optimized out>) at ipc.c:410\r\n#3  0x00007f07be594e16 in lock_hypervisor_conn () at handlers.c:942\r\n#4  0x00007f07be59ef39 in startup_thread (arg=0x7f07c9d6e690) at handlers.c:1887\r\n#5  0x00007f07c585bdc5 in start_thread () from /usr/lib64/axis2c/lib/libpthread.so.0\r\n#6  0x00007f07c538676d in clone () from /usr/lib64/axis2c/lib/libc.so.6\r\nThread 15 (Thread 0x7f07757fa700 (LWP 1753)):\r\n#0  0x00007f07c534d66d in nanosleep () from /usr/lib64/axis2c/lib/libc.so.6\r\n#1  0x00007f07c537e2f4 in usleep () from /usr/lib64/axis2c/lib/libc.so.6\r\n#2  0x00007f07be5ddeee in timewait (pid=pid@entry=7198, status=status@entry=0x7f07757f9cec, timeout_sec=timeout_sec@entry=1200) at misc.c:410\r\n#3  0x00007f07be594e6f in lock_hypervisor_conn () at handlers.c:965\r\n#4  0x00007f07be59ef39 in startup_thread (arg=0x7f07cfc43860) at handlers.c:1887\r\n#5  0x00007f07c585bdc5 in start_thread () from /usr/lib64/axis2c/lib/libpthread.so.0\r\n#6  0x00007f07c538676d in clone () from /usr/lib64/axis2c/lib/libc.so.6\r\nThread 14 (Thread 0x7f0757fff700 (LWP 1775)):\r\n#0  0x00007f07c585f6d5 in pthread_cond_wait@@GLIBC_2.3.2 () from /usr/lib64/axis2c/lib/libpthread.so.0\r\n#1  0x00007f07be5db88b in sem_prolaag (pSem=0x7f07c810ac50, doLog=doLog@entry=1 '\\001') at ipc.c:378\r\n#2  0x00007f07be5db90a in sem_p (pSem=<optimized out>) at ipc.c:410\r\n#3  0x00007f07be594e16 in lock_hypervisor_conn () at handlers.c:942\r\n#4  0x00007f07be59ef39 in startup_thread (arg=0x7f07caeac110) at handlers.c:1887\r\n#5  0x00007f07c585bdc5 in start_thread () from /usr/lib64/axis2c/lib/libpthread.so.0\r\n#6  0x00007f07c538676d in clone () from /usr/lib64/axis2c/lib/libc.so.6\r\nThread 13 (Thread 0x7f0755ffb700 (LWP 1807)):\r\n#0  0x00007f07c585f6d5 in pthread_cond_wait@@GLIBC_2.3.2 () from /usr/lib64/axis2c/lib/libpthread.so.0\r\n#1  0x00007f07be5db88b in sem_prolaag (pSem=0x7f07c810ac50, doLog=doLog@entry=1 '\\001') at ipc.c:378\r\n#2  0x00007f07be5db90a in sem_p (pSem=<optimized out>) at ipc.c:410\r\n#3  0x00007f07be594e16 in lock_hypervisor_conn () at handlers.c:942\r\n#4  0x00007f07be59ef39 in startup_thread (arg=0x7f07cb096790) at handlers.c:1887\r\n#5  0x00007f07c585bdc5 in start_thread () from /usr/lib64/axis2c/lib/libpthread.so.0\r\n#6  0x00007f07c538676d in clone () from /usr/lib64/axis2c/lib/libc.so.6\r\nThread 12 (Thread 0x7f07b0db6700 (LWP 6263)):\r\n#0  0x00007f07c585f6d5 in pthread_cond_wait@@GLIBC_2.3.2 () from /usr/lib64/axis2c/lib/libpthread.so.0\r\n#1  0x00007f07be5db88b in sem_prolaag (pSem=0x7f07c810ac50, doLog=doLog@entry=1 '\\001') at ipc.c:378\r\n#2  0x00007f07be5db90a in sem_p (pSem=<optimized out>) at ipc.c:410\r\n#3  0x00007f07be594e16 in lock_hypervisor_conn () at handlers.c:942\r\n#4  0x00007f07be59ef39 in startup_thread (arg=0x7f07cd502340) at handlers.c:1887\r\n#5  0x00007f07c585bdc5 in start_thread () from /usr/lib64/axis2c/lib/libpthread.so.0\r\n#6  0x00007f07c538676d in clone () from /usr/lib64/axis2c/lib/libc.so.6\r\nThread 11 (Thread 0x7f079b7fe700 (LWP 6268)):\r\n#0  0x00007f07c585f6d5 in pthread_cond_wait@@GLIBC_2.3.2 () from /usr/lib64/axis2c/lib/libpthread.so.0\r\n#1  0x00007f07be5db88b in sem_prolaag (pSem=0x7f07c810ac50, doLog=doLog@entry=1 '\\001') at ipc.c:378\r\n#2  0x00007f07be5db90a in sem_p (pSem=<optimized out>) at ipc.c:410\r\n#3  0x00007f07be594e16 in lock_hypervisor_conn () at handlers.c:942\r\n#4  0x00007f07be59ef39 in startup_thread (arg=0x7f07cd6ec9c0) at handlers.c:1887\r\n#5  0x00007f07c585bdc5 in start_thread () from /usr/lib64/axis2c/lib/libpthread.so.0\r\n#6  0x00007f07c538676d in clone () from /usr/lib64/axis2c/lib/libc.so.6\r\nThread 10 (Thread 0x7f079bfff700 (LWP 6272)):\r\n#0  0x00007f07c585f6d5 in pthread_cond_wait@@GLIBC_2.3.2 () from /usr/lib64/axis2c/lib/libpthread.so.0\r\n#1  0x00007f07be5db88b in sem_prolaag (pSem=0x7f07c810ac50, doLog=doLog@entry=1 '\\001') at ipc.c:378\r\n#2  0x00007f07be5db90a in sem_p (pSem=<optimized out>) at ipc.c:410\r\n#3  0x00007f07be594e16 in lock_hypervisor_conn () at handlers.c:942\r\n#4  0x00007f07be59ef39 in startup_thread (arg=0x7f07cb46b490) at handlers.c:1887\r\n#5  0x00007f07c585bdc5 in start_thread () from /usr/lib64/axis2c/lib/libpthread.so.0\r\n#6  0x00007f07c538676d in clone () from /usr/lib64/axis2c/lib/libc.so.6\r\nThread 9 (Thread 0x7f07b15b7700 (LWP 6279)):\r\n#0  0x00007f07c585f6d5 in pthread_cond_wait@@GLIBC_2.3.2 () from /usr/lib64/axis2c/lib/libpthread.so.0\r\n#1  0x00007f07be5db88b in sem_prolaag (pSem=0x7f07c810ac50, doLog=doLog@entry=1 '\\001') at ipc.c:378\r\n#2  0x00007f07be5db90a in sem_p (pSem=<optimized out>) at ipc.c:410\r\n#3  0x00007f07be594e16 in lock_hypervisor_conn () at handlers.c:942\r\n#4  0x00007f07be59ef39 in startup_thread (arg=0x7f07cdac16c0) at handlers.c:1887\r\n#5  0x00007f07c585bdc5 in start_thread () from /usr/lib64/axis2c/lib/libpthread.so.0\r\n#6  0x00007f07c538676d in clone () from /usr/lib64/axis2c/lib/libc.so.6\r\nThread 8 (Thread 0x7f07b2dba700 (LWP 6281)):\r\n#0  0x00007f07c585f6d5 in pthread_cond_wait@@GLIBC_2.3.2 () from /usr/lib64/axis2c/lib/libpthread.so.0\r\n#1  0x00007f07be5db88b in sem_prolaag (pSem=0x7f07c810ac50, doLog=doLog@entry=1 '\\001') at ipc.c:378\r\n#2  0x00007f07be5db90a in sem_p (pSem=<optimized out>) at ipc.c:410\r\n#3  0x00007f07be594e16 in lock_hypervisor_conn () at handlers.c:942\r\n#4  0x00007f07be59ef39 in startup_thread (arg=0x7f07c8b3b860) at handlers.c:1887\r\n#5  0x00007f07c585bdc5 in start_thread () from /usr/lib64/axis2c/lib/libpthread.so.0\r\n#6  0x00007f07c538676d in clone () from /usr/lib64/axis2c/lib/libc.so.6\r\nThread 7 (Thread 0x7f07b25b9700 (LWP 6283)):\r\n#0  0x00007f07c585f6d5 in pthread_cond_wait@@GLIBC_2.3.2 () from /usr/lib64/axis2c/lib/libpthread.so.0\r\n#1  0x00007f07be5db88b in sem_prolaag (pSem=0x7f07c810ac50, doLog=doLog@entry=1 '\\001') at ipc.c:378\r\n#2  0x00007f07be5db90a in sem_p (pSem=<optimized out>) at ipc.c:410\r\n#3  0x00007f07be594e16 in lock_hypervisor_conn () at handlers.c:942\r\n#4  0x00007f07be59ef39 in startup_thread (arg=0x7f07c8d25ee0) at handlers.c:1887\r\n#5  0x00007f07c585bdc5 in start_thread () from /usr/lib64/axis2c/lib/libpthread.so.0\r\n#6  0x00007f07c538676d in clone () from /usr/lib64/axis2c/lib/libc.so.6\r\nThread 6 (Thread 0x7f07b1db8700 (LWP 6287)):\r\n#0  0x00007f07c585f6d5 in pthread_cond_wait@@GLIBC_2.3.2 () from /usr/lib64/axis2c/lib/libpthread.so.0\r\n#1  0x00007f07be5db88b in sem_prolaag (pSem=0x7f07c810ac50, doLog=doLog@entry=1 '\\001') at ipc.c:378\r\n#2  0x00007f07be5db90a in sem_p (pSem=<optimized out>) at ipc.c:410\r\n#3  0x00007f07be594e16 in lock_hypervisor_conn () at handlers.c:942\r\n#4  0x00007f07be59ef39 in startup_thread (arg=0x7f07c8f10560) at handlers.c:1887\r\n#5  0x00007f07c585bdc5 in start_thread () from /usr/lib64/axis2c/lib/libpthread.so.0\r\n#6  0x00007f07c538676d in clone () from /usr/lib64/axis2c/lib/libc.so.6\r\nThread 5 (Thread 0x7f0774ff9700 (LWP 6295)):\r\n#0  0x00007f07c585f6d5 in pthread_cond_wait@@GLIBC_2.3.2 () from /usr/lib64/axis2c/lib/libpthread.so.0\r\n#1  0x00007f07be5db88b in sem_prolaag (pSem=0x7f07c810ac50, doLog=doLog@entry=1 '\\001') at ipc.c:378\r\n#2  0x00007f07be5db90a in sem_p (pSem=<optimized out>) at ipc.c:410\r\n#3  0x00007f07be594e16 in lock_hypervisor_conn () at handlers.c:942\r\n#4  0x00007f07be59ef39 in startup_thread (arg=0x7f07c90fabe0) at handlers.c:1887\r\n#5  0x00007f07c585bdc5 in start_thread () from /usr/lib64/axis2c/lib/libpthread.so.0\r\n#6  0x00007f07c538676d in clone () from /usr/lib64/axis2c/lib/libc.so.6\r\nThread 4 (Thread 0x7f07577fe700 (LWP 6299)):\r\n#0  0x00007f07c585f6d5 in pthread_cond_wait@@GLIBC_2.3.2 () from /usr/lib64/axis2c/lib/libpthread.so.0\r\n#1  0x00007f07be5db88b in sem_prolaag (pSem=0x7f07c810ac50, doLog=doLog@entry=1 '\\001') at ipc.c:378\r\n#2  0x00007f07be5db90a in sem_p (pSem=<optimized out>) at ipc.c:410\r\n#3  0x00007f07be594e16 in lock_hypervisor_conn () at handlers.c:942\r\n#4  0x00007f07be59ef39 in startup_thread (arg=0x7f07c92e5260) at handlers.c:1887\r\n#5  0x00007f07c585bdc5 in start_thread () from /usr/lib64/axis2c/lib/libpthread.so.0\r\n#6  0x00007f07c538676d in clone () from /usr/lib64/axis2c/lib/libc.so.6\r\nThread 3 (Thread 0x7f0756ffd700 (LWP 6300)):\r\n#0  0x00007f07c585f6d5 in pthread_cond_wait@@GLIBC_2.3.2 () from /usr/lib64/axis2c/lib/libpthread.so.0\r\n#1  0x00007f07be5db88b in sem_prolaag (pSem=0x7f07c810ac50, doLog=doLog@entry=1 '\\001') at ipc.c:378\r\n#2  0x00007f07be5db90a in sem_p (pSem=<optimized out>) at ipc.c:410\r\n#3  0x00007f07be594e16 in lock_hypervisor_conn () at handlers.c:942\r\n#4  0x00007f07be59ef39 in startup_thread (arg=0x7f07cd9cc380) at handlers.c:1887\r\n#5  0x00007f07c585bdc5 in start_thread () from /usr/lib64/axis2c/lib/libpthread.so.0\r\n#6  0x00007f07c538676d in clone () from /usr/lib64/axis2c/lib/libc.so.6\r\nThread 2 (Thread 0x7f07567fc700 (LWP 6308)):\r\n#0  0x00007f07c585f6d5 in pthread_cond_wait@@GLIBC_2.3.2 () from /usr/lib64/axis2c/lib/libpthread.so.0\r\n#1  0x00007f07be5db88b in sem_prolaag (pSem=0x7f07c810ac50, doLog=doLog@entry=1 '\\001') at ipc.c:378\r\n#2  0x00007f07be5db90a in sem_p (pSem=<optimized out>) at ipc.c:410\r\n#3  0x00007f07be594e16 in lock_hypervisor_conn () at handlers.c:942\r\n#4  0x00007f07be59ef39 in startup_thread (arg=0x7f07cba2a810) at handlers.c:1887\r\n#5  0x00007f07c585bdc5 in start_thread () from /usr/lib64/axis2c/lib/libpthread.so.0\r\n#6  0x00007f07c538676d in clone () from /usr/lib64/axis2c/lib/libc.so.6\r\nThread 1 (Thread 0x7f07c6d86880 (LWP 59026)):\r\n#0  0x00007f07c5387bff in accept4 () from /usr/lib64/axis2c/lib/libc.so.6\r\n#1  0x00007f07c5a8e43a in apr_socket_accept () from /usr/lib64/axis2c/lib/libapr-1.so.0\r\n#2  0x00007f07c6deec63 in ap_unixd_accept ()\r\n#3  0x00007f07c4a7e79f in child_main () from /usr/lib64/httpd/modules/mod_mpm_prefork.so\r\n#4  0x00007f07c4a7ea55 in make_child () from /usr/lib64/httpd/modules/mod_mpm_prefork.so\r\n#5  0x00007f07c4a7f6ee in prefork_run () from /usr/lib64/httpd/modules/mod_mpm_prefork.so\r\n#6  0x00007f07c6db7f6e in ap_run_mpm ()\r\n#7  0x00007f07c6db0d76 in main ()\r\n{code}\r\n\r\nThe fork checking the hypervisor:\r\n\r\n{code}\r\n#0  0x00007f07c58621bd in __lll_lock_wait () from /usr/lib64/axis2c/lib/libpthread.so.0\r\n#1  0x00007f07c585dd02 in _L_lock_791 () from /usr/lib64/axis2c/lib/libpthread.so.0\r\n#2  0x00007f07c585dc08 in pthread_mutex_lock () from /usr/lib64/axis2c/lib/libpthread.so.0\r\n#3  0x00007f07c2f14fc3 in _nss_files_getpwuid_r () from /usr/lib64/axis2c/lib/libnss_files.so.2\r\n#4  0x00007f07c534ca5c in getpwuid_r@@GLIBC_2.2.5 () from /usr/lib64/axis2c/lib/libc.so.6\r\n#5  0x00007f07bd8599b5 in virGetUserEnt () from /usr/lib64/axis2c/lib/libvirt.so.0\r\n#6  0x00007f07bd85b116 in virGetUserDirectoryByUID () from /usr/lib64/axis2c/lib/libvirt.so.0\r\n#7  0x00007f07bd85d8ce in virGetXDGDirectory () from /usr/lib64/axis2c/lib/libvirt.so.0\r\n#8  0x00007f07bd7faecd in virConfLoadConfig () from /usr/lib64/axis2c/lib/libvirt.so.0\r\n#9  0x00007f07bd8e53c3 in virConnectOpenInternal () from /usr/lib64/axis2c/lib/libvirt.so.0\r\n#10 0x00007f07bd8e6cd9 in virConnectOpen () from /usr/lib64/axis2c/lib/libvirt.so.0\r\n#11 0x00007f07be594f85 in lock_hypervisor_conn () at handlers.c:958\r\n#12 0x00007f07be59ef39 in startup_thread (arg=0x7f07cfc43860) at handlers.c:1887\r\n#13 0x00007f07c585bdc5 in start_thread () from /usr/lib64/axis2c/lib/libpthread.so.0\r\n#14 0x00007f07c538676d in clone () from /usr/lib64/axis2c/lib/libc.so.6\r\n{code}\r\n\r\nNote that many node controller threads are blocked in lock_hypervisor_conn while the process performing the hypervisor check is blocked waiting for a mutex that happened to be locked by another thread when the process was forked.\r\n\r\nWhen you see the error logging:\r\n\r\n{code}\r\n2017-08-01 22:04:13 ERROR | timed out waiting for hypervisor checker pid=64383\r\n{code}\r\n\r\nthen this could be the cause.\r\n\r\nWe kill the forked process after a timeout so this causes a single hypervisor connection error each time it occurs, for example:\r\n\r\n{code}\r\n2017-08-01 22:04:14 ERROR | [i-1aa51ad0] cannot connect to hypervisor to shut down instance\r\n{code}\r\n\r\n{code}\r\n2017-08-01 22:23:12 ERROR | [i-5f688d13] could not contact the hypervisor, abandoning the instance\r\n{code}\r\n\r\nThis issue was seen when churning 32 instances on a node controller.","customfield_13200":null,"customfield_11300":null,"customfield_11500":null,"timetracking":{},"customfield_10401":null,"customfield_10005":null,"customfield_10600":null,"customfield_12900":null,"aggregatetimeestimate":null,"attachment":[],"summary":"Node controller unsafely uses fork with posix threads","creator":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=sjones","name":"sjones","key":"sjones","accountId":"557058:f5dce1b0-db45-4dd6-a0e8-3cea5effb5ce","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue"},"displayName":"Steve Jones","active":true,"timeZone":"America/Los_Angeles"},"subtasks":[],"reporter":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=sjones","name":"sjones","key":"sjones","accountId":"557058:f5dce1b0-db45-4dd6-a0e8-3cea5effb5ce","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue"},"displayName":"Steve Jones","active":true,"timeZone":"America/Los_Angeles"},"aggregateprogress":{"progress":0,"total":0},"customfield_12100":"0|i0450f:","customfield_10000":null,"customfield_10001":null,"customfield_10200":null,"customfield_10002":null,"customfield_10003":null,"customfield_10400":null,"customfield_12500":null,"customfield_10116":null,"customfield_11600":["sjones(sjones)"],"customfield_10117":null,"environment":null,"customfield_11800":null,"customfield_11802":null,"duedate":null,"customfield_11805":null,"progress":{"progress":0,"total":0},"customfield_11806":null,"comment":{"comments":[],"maxResults":0,"total":0,"startAt":0},"votes":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/EUCA-13442/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_11808":null}}
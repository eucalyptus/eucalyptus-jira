{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"53902","self":"https://eucalyptus.atlassian.net/rest/api/2/issue/53902","key":"EUCA-13172","fields":{"issuetype":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://eucalyptus.atlassian.net/secure/viewavatar?size=xsmall&avatarId=14803&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":14803},"timespent":null,"customfield_13100":null,"project":{"self":"https://eucalyptus.atlassian.net/rest/api/2/project/10000","id":"10000","key":"EUCA","name":"Eucalyptus","avatarUrls":{"48x48":"https://eucalyptus.atlassian.net/secure/projectavatar?pid=10000&avatarId=10011","24x24":"https://eucalyptus.atlassian.net/secure/projectavatar?size=small&pid=10000&avatarId=10011","16x16":"https://eucalyptus.atlassian.net/secure/projectavatar?size=xsmall&pid=10000&avatarId=10011","32x32":"https://eucalyptus.atlassian.net/secure/projectavatar?size=medium&pid=10000&avatarId=10011"}},"customfield_11000":null,"fixVersions":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/version/17801","id":"17801","description":"Eucalyptus 5.0.0","name":"5.0.0","archived":false,"released":false}],"customfield_11001":null,"aggregatetimespent":null,"resolution":null,"customfield_10310":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/12601","value":"CentOS 7","id":"12601"}],"customfield_11401":null,"customfield_10311":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/11500","value":"Edge","id":"11500"}],"customfield_11400":null,"customfield_10104":[],"customfield_10500":{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/10403","value":"Not Applicable","id":"10403"},"customfield_10302":null,"customfield_10105":null,"customfield_10303":null,"customfield_10304":null,"customfield_10700":null,"customfield_10701":null,"customfield_10306":null,"customfield_10702":null,"customfield_10703":null,"resolutiondate":null,"customfield_10704":null,"customfield_10308":null,"customfield_10705":null,"customfield_10309":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/10203","value":"Xen","id":"10203"}],"workratio":-1,"watches":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/EUCA-13172/watchers","watchCount":5,"isWatching":false},"lastViewed":null,"created":"2017-01-30T15:49:37.358-0600","customfield_12000":null,"priority":{"self":"https://eucalyptus.atlassian.net/rest/api/2/priority/3","iconUrl":"https://eucalyptus.atlassian.net/images/icons/priorities/major.svg","name":"Major","id":"3"},"customfield_12400":null,"customfield_12201":null,"customfield_10300":null,"customfield_10102":null,"customfield_12600":"{}","labels":[],"customfield_10301":null,"customfield_11700":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"versions":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/version/18100","id":"18100","description":"Eucalyptus 4.4.0","name":"4.4.0","archived":false,"released":true,"releaseDate":"2017-03-07"}],"customfield_11901":null,"issuelinks":[{"id":"48600","self":"https://eucalyptus.atlassian.net/rest/api/2/issueLink/48600","type":{"id":"10103","name":"Relates","inward":"relates to","outward":"relates to","self":"https://eucalyptus.atlassian.net/rest/api/2/issueLinkType/10103"},"inwardIssue":{"id":"54108","key":"EUCA-13186","self":"https://eucalyptus.atlassian.net/rest/api/2/issue/54108","fields":{"summary":"volume from snapshot fails because snapshot delta failed","status":{"self":"https://eucalyptus.atlassian.net/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://eucalyptus.atlassian.net/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://eucalyptus.atlassian.net/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://eucalyptus.atlassian.net/rest/api/2/priority/1","iconUrl":"https://eucalyptus.atlassian.net/images/icons/priorities/blocker.svg","name":"Blocker","id":"1"},"issuetype":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://eucalyptus.atlassian.net/secure/viewavatar?size=xsmall&avatarId=14803&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":14803}}}}],"assignee":null,"updated":"2017-02-03T08:57:56.262-0600","status":{"self":"https://eucalyptus.atlassian.net/rest/api/2/status/10001","description":"This issue has been validated/reproduced, but has not been prioritized yet.","iconUrl":"https://eucalyptus.atlassian.net/images/icons/statuses/generic.png","name":"Confirmed","id":"10001","statusCategory":{"self":"https://eucalyptus.atlassian.net/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"components":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/component/10014","id":"10014","name":"Storage Controller"}],"timeoriginalestimate":null,"customfield_13000":null,"description":"I received a volume from snapshot creation failure during my snapshot delta testing.  After creating 3 snapshots, I tried to create a volume from the last snapshot and was not able to.  I saw the following errors in the cloud-debug.log file:\r\n{code}\r\nMon Jan 30 02:12:50 2017 DEBUG [CephRbdProvider:eucalyptus-storage-volumecreator-worker-750] Dump from rbd command:\r\nReturn value=0\r\nOutput=\r\nDebug=^MImporting image diff: 40% complete...^MImporting image diff: 80% complete...^MImporting image diff: 99% complete...^MImporting image diff: 100% complete...done.\r\n\r\nMon Jan 30 02:12:50 2017  INFO [VolumeCreator:eucalyptus-storage-volumecreator-worker-750] Download snap-2d8b0754 (delta from snap-f42bd3e8) and restore it on snap-a6a097a9\r\nMon Jan 30 02:12:50 2017 DEBUG [S3SnapshotTransfer:eucalyptus-storage-volumecreator-worker-750] Dowloading snapshot from objectstorage: snapshotId=snap-2d8b0754, bucket=snapshots-f397bf11bbc741279361eee21e29bd0f, key=snap-2d8b0754\r\nMon Jan 30 02:12:51 2017  WARN [S3SnapshotTransfer:eucalyptus-storage-volumecreator-worker-750] Failed to download snapshot from objectstorage: snapshotId=snap-2d8b0754, bucket=snapshots-f397bf11bbc741279361eee21e29bd0f, key=snap-2d8b0754\r\nMon Jan 30 02:12:51 2017 ERROR [VolumeCreator:eucalyptus-storage-volumecreator-worker-750] Failed to create volume vol-093193df\r\ncom.eucalyptus.blockstorage.exceptions.SnapshotTransferException: Failed to download snapshot from objectstorage: snapshotId=snap-2d8b0754, bucket=snapshots-f397bf11bbc741279361eee21e29bd0f, key=snap-2d8b0754\r\n        at com.eucalyptus.blockstorage.S3SnapshotTransfer.download(S3SnapshotTransfer.java:774)\r\n        at com.eucalyptus.blockstorage.S3SnapshotTransfer.download(S3SnapshotTransfer.java:458)\r\n        at com.eucalyptus.blockstorage.async.VolumeCreator.downloadAndRestoreDelta(VolumeCreator.java:628)\r\n        at com.eucalyptus.blockstorage.async.VolumeCreator.run(VolumeCreator.java:256)\r\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\r\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\r\n        at java.lang.Thread.run(Thread.java:745)\r\nCaused by: com.eucalyptus.blockstorage.exceptions.SnapshotTransferException: Snapshot transfer operation failed because of\r\n        at com.eucalyptus.blockstorage.S3SnapshotTransfer.retryAfterRefresh(S3SnapshotTransfer.java:967)\r\n        at com.eucalyptus.blockstorage.S3SnapshotTransfer.download(S3SnapshotTransfer.java:762)\r\n        ... 6 more\r\nCaused by: com.amazonaws.services.s3.model.AmazonS3Exception: Status Code: 404, AWS Service: Amazon S3, AWS Request ID: dcf0e461-e73c-46ad-8a2e-daa265431040, AWS Error Code: NoSuchKey, AWS Error Message: The specified key does not exist., S3 Extended Request ID: null\r\n        at com.amazonaws.http.AmazonHttpClient.handleErrorResponse(AmazonHttpClient.java:773)\r\n        at com.amazonaws.http.AmazonHttpClient.executeHelper(AmazonHttpClient.java:417)\r\n        at com.amazonaws.http.AmazonHttpClient.execute(AmazonHttpClient.java:229)\r\n        at com.amazonaws.services.s3.AmazonS3Client.invoke(AmazonS3Client.java:3384)\r\n        at com.amazonaws.services.s3.AmazonS3Client.getObject(AmazonS3Client.java:1093)\r\n        at com.eucalyptus.objectstorage.client.EucaS3Client.getObject(EucaS3Client.groovy:109)\r\n        at com.eucalyptus.blockstorage.S3SnapshotTransfer$4.apply(S3SnapshotTransfer.java:768)\r\n        at com.eucalyptus.blockstorage.S3SnapshotTransfer$4.apply(S3SnapshotTransfer.java:762)\r\n        at com.eucalyptus.blockstorage.S3SnapshotTransfer.retryAfterRefresh(S3SnapshotTransfer.java:958)\r\n        ... 7 more\r\n\r\n\r\n\r\nMon Jan 30 10:13:32 2017 DEBUG [Hosts:eucalyptus-bootstrap-hosts-worker-102] Hosts.entrySet(): 10.111.5.80 finished.\r\nMon Jan 30 10:13:33 2017  INFO [BlockStorageController:eucalyptus-bootstrap-servicecontext-common-worker-587] Processing CreateStorageVolume request for volume vol-e3fb2fe6\r\nMon Jan 30 10:13:33 2017  INFO [SANManager:eucalyptus-storage-volumecreator-worker-607] Checking for snap-a6a097a9 on backend\r\nMon Jan 30 10:13:33 2017 DEBUG [CephRbdProvider:eucalyptus-storage-volumecreator-worker-607] Checking if snapshot exists snapshotId=snap-a6a097a9, snapshotIqn=tempsnap/snap-a6a097a9\r\nMon Jan 30 10:13:33 2017 DEBUG [CephRbdProvider:eucalyptus-storage-volumecreator-worker-607] Checking if volume exists volumeId=snap-a6a097a9, volumeIqn=tempsnap/snap-a6a097a9\r\nMon Jan 30 10:13:33 2017  INFO [CephRbdFormatTwoAdapter:eucalyptus-storage-volumecreator-worker-607] List ceph-rbd pool poolName=tempsnap\r\nMon Jan 30 10:13:33 2017 DEBUG [SANManager:eucalyptus-storage-volumecreator-worker-607] Found database record and backend resource for snap-a6a097a9. Nothing to do here\r\nMon Jan 30 10:13:33 2017 DEBUG [VolumeCreator:eucalyptus-storage-volumecreator-worker-607] snap-a6a097a9 found on storage backend\r\nMon Jan 30 10:13:33 2017  INFO [SANManager:eucalyptus-storage-volumecreator-worker-607] Creating vol-e3fb2fe6 from snap-a6a097a9 on backend\r\nMon Jan 30 10:13:33 2017  INFO [CephRbdProvider:eucalyptus-storage-volumecreator-worker-607] Creating volume volumeId=vol-e3fb2fe6, snapshotId=snap-a6a097a9, size=1GB, snapshotIqn=tempsnap/snap-a6a097a9\r\nMon Jan 30 10:13:33 2017  INFO [CephRbdFormatTwoAdapter:eucalyptus-storage-volumecreator-worker-607] Clone (and resize) ceph-rbd image parentName=snap-a6a097a9, snapName=sp-on-snap-a6a097a9, cloneName=vol-e3fb2fe6, size=null, parentPoolName=tempsnap\r\nMon Jan 30 10:13:33 2017 DEBUG [CephRbdFormatTwoAdapter:eucalyptus-storage-volumecreator-worker-607] Cloning snapshot=sp-on-snap-a6a097a9, image=snap-a6a097a9, pool=tempsnap to image=vol-e3fb2fe6, pool=tempvol\r\nMon Jan 30 10:13:33 2017  WARN [CephRbdFormatTwoAdapter:eucalyptus-storage-volumecreator-worker-607] Caught error while cloning/resizing image vol-e3fb2fe6 from source image snap-a6a097a9: Failed to clone image snap-a6a097a9@sp-on-snap-a6a097a9 to vol-e3fb2fe6\r\nMon Jan 30 10:13:33 2017 ERROR [VolumeCreator:eucalyptus-storage-volumecreator-worker-607] Failed to create volume vol-e3fb2fe6\r\ncom.eucalyptus.blockstorage.ceph.exceptions.EucalyptusCephException: Failed to clone/resize image vol-e3fb2fe6 from source image snap-a6a097a9\r\n        at com.eucalyptus.blockstorage.ceph.CephRbdFormatTwoAdapter$10$1.apply(CephRbdFormatTwoAdapter.java:579)\r\n        at com.eucalyptus.blockstorage.ceph.CephRbdFormatTwoAdapter$10$1.apply(CephRbdFormatTwoAdapter.java:551)\r\n        at com.eucalyptus.blockstorage.ceph.CephRbdFormatTwoAdapter.executeRbdOpInPool(CephRbdFormatTwoAdapter.java:623)\r\n        at com.eucalyptus.blockstorage.ceph.CephRbdFormatTwoAdapter.executeRbdOpInRandomPool(CephRbdFormatTwoAdapter.java:642)\r\n        at com.eucalyptus.blockstorage.ceph.CephRbdFormatTwoAdapter.access$100(CephRbdFormatTwoAdapter.java:91)\r\n        at com.eucalyptus.blockstorage.ceph.CephRbdFormatTwoAdapter$10.apply(CephRbdFormatTwoAdapter.java:551)\r\n        at com.eucalyptus.blockstorage.ceph.CephRbdFormatTwoAdapter$10.apply(CephRbdFormatTwoAdapter.java:545)\r\n        at com.eucalyptus.blockstorage.ceph.CephRbdFormatTwoAdapter.executeRbdOpInPool(CephRbdFormatTwoAdapter.java:623)\r\n        at com.eucalyptus.blockstorage.ceph.CephRbdFormatTwoAdapter.cloneAndResizeImage(CephRbdFormatTwoAdapter.java:545)\r\n        at com.eucalyptus.blockstorage.ceph.CephRbdProvider.createVolume(CephRbdProvider.java:180)\r\n        at com.eucalyptus.blockstorage.san.common.SANManager.createVolume(SANManager.java:534)\r\n        at com.eucalyptus.blockstorage.async.VolumeCreator.run(VolumeCreator.java:311)\r\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\r\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\r\n        at java.lang.Thread.run(Thread.java:745)\r\nCaused by: com.ceph.rbd.RbdException: Failed to clone image snap-a6a097a9@sp-on-snap-a6a097a9 to vol-e3fb2fe6\r\n        at com.ceph.rbd.Rbd.clone(Rbd.java:346)\r\n        at com.eucalyptus.blockstorage.ceph.CephRbdFormatTwoAdapter$10$1.apply(CephRbdFormatTwoAdapter.java:563)\r\n        ... 14 more\r\n{code}\r\nThe failure happened with the maxsnapshotdeltas set to 50.  I'm not sure that is related though as I am running the test again with the same settings now and so far I cannot reproduce.  I had previous test runs immediately before this one with maxsnapshotdeltas set to 0, 10, and 20 with no failures.  I'm currently running another test with the maxsnapshotdeltas set to 50.  I will update the bug with the results.","customfield_13200":null,"customfield_11300":null,"customfield_11500":null,"timetracking":{},"customfield_10005":null,"customfield_10401":null,"customfield_10600":null,"customfield_12900":null,"attachment":[],"aggregatetimeestimate":null,"summary":"race condition when creating a volume from snapshot","creator":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=ccassler","name":"ccassler","key":"ccassler","accountId":"557058:8fb32702-a3cf-42d3-9846-95c74f801354","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/ace94e80ebc0a3b718cc5422760b57de?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dccassler%26avatarId%3D14700%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/ace94e80ebc0a3b718cc5422760b57de?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dccassler%26avatarId%3D14700%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/ace94e80ebc0a3b718cc5422760b57de?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dccassler%26avatarId%3D14700%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/ace94e80ebc0a3b718cc5422760b57de?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dccassler%26avatarId%3D14700%26noRedirect%3Dtrue"},"displayName":"Casey Cassler","active":true,"timeZone":"America/Los_Angeles"},"subtasks":[],"reporter":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=ccassler","name":"ccassler","key":"ccassler","accountId":"557058:8fb32702-a3cf-42d3-9846-95c74f801354","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/ace94e80ebc0a3b718cc5422760b57de?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dccassler%26avatarId%3D14700%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/ace94e80ebc0a3b718cc5422760b57de?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dccassler%26avatarId%3D14700%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/ace94e80ebc0a3b718cc5422760b57de?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dccassler%26avatarId%3D14700%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/ace94e80ebc0a3b718cc5422760b57de?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dccassler%26avatarId%3D14700%26noRedirect%3Dtrue"},"displayName":"Casey Cassler","active":true,"timeZone":"America/Los_Angeles"},"customfield_10000":null,"customfield_12100":"0|i0425j:","aggregateprogress":{"progress":0,"total":0},"customfield_10001":"2017-01-30T16:20:05.189-0600","customfield_10002":null,"customfield_10200":null,"customfield_10003":null,"customfield_10400":null,"customfield_12500":null,"customfield_11600":["ccassler(ccassler)","dmitrii(dmitrii)"],"customfield_10116":null,"customfield_10117":null,"environment":null,"customfield_11800":null,"customfield_11802":null,"duedate":null,"customfield_11805":null,"progress":{"progress":0,"total":0},"customfield_11806":null,"comment":{"comments":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/53902/comment/116632","id":"116632","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=dmitrii","name":"dmitrii","key":"dmitrii","accountId":"557058:1e0ea807-434b-4b54-967f-1dec4a9ede55","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue"},"displayName":"Dmitrii Calzago","active":false,"timeZone":"America/Los_Angeles"},"body":"Casey to recreate, explore snapshots that precede and follow the \"bad\" one.","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=dmitrii","name":"dmitrii","key":"dmitrii","accountId":"557058:1e0ea807-434b-4b54-967f-1dec4a9ede55","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue"},"displayName":"Dmitrii Calzago","active":false,"timeZone":"America/Los_Angeles"},"created":"2017-01-30T16:20:05.189-0600","updated":"2017-01-30T16:20:05.189-0600"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/53902/comment/116708","id":"116708","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=ccassler","name":"ccassler","key":"ccassler","accountId":"557058:8fb32702-a3cf-42d3-9846-95c74f801354","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/ace94e80ebc0a3b718cc5422760b57de?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dccassler%26avatarId%3D14700%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/ace94e80ebc0a3b718cc5422760b57de?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dccassler%26avatarId%3D14700%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/ace94e80ebc0a3b718cc5422760b57de?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dccassler%26avatarId%3D14700%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/ace94e80ebc0a3b718cc5422760b57de?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dccassler%26avatarId%3D14700%26noRedirect%3Dtrue"},"displayName":"Casey Cassler","active":true,"timeZone":"America/Los_Angeles"},"body":"[~swathi] took a look at this bug and determined it was a race condition based on these logs:\r\n{code}\r\nOrigin SC for snap-2d8b0754\r\nMon Jan 30 02:12:50 2017 DEBUG [SnapshotDeleter:eucalyptus-storage-checkerthreadpool-worker-364] Snapshot snap-2d8b0754 is not required for restoring other snapshots in the system\r\nMon Jan 30 02:12:50 2017 DEBUG [SnapshotDeleter:eucalyptus-storage-checkerthreadpool-worker-364] Deleting snapshot snap-2d8b0754 from ObjectStorageGateway\r\nMon Jan 30 02:12:50 2017 DEBUG [S3SnapshotTransfer:eucalyptus-storage-checkerthreadpool-worker-364] Deleting snapshot from objectstorage: snapshotId=snap-2d8b0754, bucket=snapshots-f397bf11bbc741279361eee21e29bd0f, key=snap-2d8b0754\r\n\r\nAnother SC that's trying to use snap-2d8b0754\r\nMon Jan 30 02:12:50 2017  INFO [VolumeCreator:eucalyptus-storage-volumecreator-worker-750] Download snap-2d8b0754 (delta from snap-f42bd3e8) and restore it on snap-a6a097a9\r\nMon Jan 30 02:12:50 2017 DEBUG [S3SnapshotTransfer:eucalyptus-storage-volumecreator-worker-750] Dowloading snapshot from objectstorage: snapshotId=snap-2d8b0754, bucket=snapshots-f397bf11bbc741279361eee21e29bd0f, key=snap-2d8b0754\r\nMon Jan 30 02:12:51 2017  WARN [S3SnapshotTransfer:eucalyptus-storage-volumecreator-worker-750] Failed to download snapshot from objectstorage: snapshotId=snap-2d8b0754, bucket=snapshots-f397bf11bbc741279361eee21e29bd0f, key=snap-2d8b0754\r\n{code}\r\nIt appears as though the SCs tried to use the snapshot and delete it at the same time.  I have so far not been able to reproduce this issue.","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=ccassler","name":"ccassler","key":"ccassler","accountId":"557058:8fb32702-a3cf-42d3-9846-95c74f801354","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/ace94e80ebc0a3b718cc5422760b57de?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dccassler%26avatarId%3D14700%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/ace94e80ebc0a3b718cc5422760b57de?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dccassler%26avatarId%3D14700%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/ace94e80ebc0a3b718cc5422760b57de?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dccassler%26avatarId%3D14700%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/ace94e80ebc0a3b718cc5422760b57de?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dccassler%26avatarId%3D14700%26noRedirect%3Dtrue"},"displayName":"Casey Cassler","active":true,"timeZone":"America/Los_Angeles"},"created":"2017-01-31T12:31:21.287-0600","updated":"2017-01-31T12:32:19.518-0600"}],"maxResults":2,"total":2,"startAt":0},"votes":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/EUCA-13172/votes","votes":0,"hasVoted":false},"customfield_11808":null,"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]}}}
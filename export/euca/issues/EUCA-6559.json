{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"21913","self":"https://eucalyptus.atlassian.net/rest/api/2/issue/21913","key":"EUCA-6559","fields":{"issuetype":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://eucalyptus.atlassian.net/secure/viewavatar?size=xsmall&avatarId=14803&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":14803},"timespent":null,"customfield_13100":null,"project":{"self":"https://eucalyptus.atlassian.net/rest/api/2/project/10000","id":"10000","key":"EUCA","name":"Eucalyptus","avatarUrls":{"48x48":"https://eucalyptus.atlassian.net/secure/projectavatar?pid=10000&avatarId=10011","24x24":"https://eucalyptus.atlassian.net/secure/projectavatar?size=small&pid=10000&avatarId=10011","16x16":"https://eucalyptus.atlassian.net/secure/projectavatar?size=xsmall&pid=10000&avatarId=10011","32x32":"https://eucalyptus.atlassian.net/secure/projectavatar?size=medium&pid=10000&avatarId=10011"}},"customfield_11000":null,"fixVersions":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/version/12105","id":"12105","description":"Eucalyptus 3.4.0","name":"3.4.0","archived":false,"released":true,"releaseDate":"2013-10-24"}],"customfield_11001":null,"aggregatetimespent":null,"resolution":{"self":"https://eucalyptus.atlassian.net/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_10310":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/10209","value":"CentOS 6","id":"10209"}],"customfield_10311":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/10307","value":"Managed","id":"10307"}],"customfield_11401":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=viglesias","name":"viglesias","key":"viglesias","accountId":"557058:49b276ff-ebf9-4dd6-ada3-b568a2898707","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/5608e0aa05bd6e5d73b855a08079cceb?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dviglesias%26avatarId%3D10405%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/5608e0aa05bd6e5d73b855a08079cceb?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dviglesias%26avatarId%3D10405%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/5608e0aa05bd6e5d73b855a08079cceb?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dviglesias%26avatarId%3D10405%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/5608e0aa05bd6e5d73b855a08079cceb?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dviglesias%26avatarId%3D10405%26noRedirect%3Dtrue"},"displayName":"Victor Iglesias","active":true,"timeZone":"America/Los_Angeles"},"customfield_11400":null,"customfield_10104":[],"customfield_10500":{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/10402","value":"Internal","id":"10402"},"customfield_10302":null,"customfield_10303":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=mmunn1","name":"mmunn1","key":"mmunn1","accountId":"557058:6e62b7e8-e48f-469d-ac54-e9449dec5cd9","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue"},"displayName":"Michael Munn","active":true,"timeZone":"America/Los_Angeles"},"customfield_10105":{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/10101","value":"No","id":"10101"},"customfield_10304":null,"customfield_10700":null,"customfield_10701":null,"customfield_10306":{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/10201","value":"Medium","id":"10201"},"customfield_10702":null,"customfield_10703":null,"customfield_10704":null,"customfield_10308":null,"resolutiondate":"2014-02-04T08:51:33.870-0600","customfield_10705":null,"customfield_10309":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/10204","value":"KVM","id":"10204"}],"workratio":-1,"watches":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/EUCA-6559/watchers","watchCount":8,"isWatching":false},"lastViewed":null,"created":"2013-06-18T08:12:04.972-0500","customfield_12000":null,"priority":{"self":"https://eucalyptus.atlassian.net/rest/api/2/priority/2","iconUrl":"https://eucalyptus.atlassian.net/images/icons/priorities/critical.svg","name":"Critical","id":"2"},"customfield_12400":null,"customfield_12201":null,"customfield_12600":"{repository={count=3, dataType=repository}, json={\"cachedValue\":{\"errors\":[],\"summary\":{\"repository\":{\"overall\":{\"count\":3,\"lastUpdated\":\"2013-09-04T14:03:39.000-0500\",\"dataType\":\"repository\"},\"byInstanceType\":{\"github\":{\"count\":3,\"name\":\"GitHub\"}}}}},\"isStale\":true}}","customfield_10102":null,"customfield_10300":null,"labels":["AWSCompat-PM","ImageManagement"],"customfield_10301":null,"customfield_11700":null,"aggregatetimeoriginalestimate":null,"timeestimate":null,"versions":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/version/10602","id":"10602","description":"Eucalyptus 3.3.0","name":"3.3.0","archived":false,"released":true,"releaseDate":"2013-06-18"}],"customfield_11901":null,"issuelinks":[{"id":"18507","self":"https://eucalyptus.atlassian.net/rest/api/2/issueLink/18507","type":{"id":"10102","name":"Duplicate","inward":"is duplicated by","outward":"duplicates","self":"https://eucalyptus.atlassian.net/rest/api/2/issueLinkType/10102"},"outwardIssue":{"id":"11576","key":"EUCA-1227","self":"https://eucalyptus.atlassian.net/rest/api/2/issue/11576","fields":{"summary":"Deregistered images linger","status":{"self":"https://eucalyptus.atlassian.net/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://eucalyptus.atlassian.net/images/icons/statuses/generic.png","name":"Closed","id":"6","statusCategory":{"self":"https://eucalyptus.atlassian.net/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://eucalyptus.atlassian.net/rest/api/2/priority/3","iconUrl":"https://eucalyptus.atlassian.net/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://eucalyptus.atlassian.net/secure/viewavatar?size=xsmall&avatarId=14803&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":14803}}}},{"id":"18506","self":"https://eucalyptus.atlassian.net/rest/api/2/issueLink/18506","type":{"id":"10103","name":"Relates","inward":"relates to","outward":"relates to","self":"https://eucalyptus.atlassian.net/rest/api/2/issueLinkType/10103"},"outwardIssue":{"id":"21910","key":"EUCA-6556","self":"https://eucalyptus.atlassian.net/rest/api/2/issue/21910","fields":{"summary":"euca-delete-bundle doesn't match behavior of ec2-delete-bundle regarding registered images","status":{"self":"https://eucalyptus.atlassian.net/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://eucalyptus.atlassian.net/images/icons/statuses/generic.png","name":"Closed","id":"6","statusCategory":{"self":"https://eucalyptus.atlassian.net/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://eucalyptus.atlassian.net/rest/api/2/priority/3","iconUrl":"https://eucalyptus.atlassian.net/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://eucalyptus.atlassian.net/secure/viewavatar?size=xsmall&avatarId=14803&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":14803}}}},{"id":"18509","self":"https://eucalyptus.atlassian.net/rest/api/2/issueLink/18509","type":{"id":"10103","name":"Relates","inward":"relates to","outward":"relates to","self":"https://eucalyptus.atlassian.net/rest/api/2/issueLinkType/10103"},"inwardIssue":{"id":"15635","key":"EUCA-3464","self":"https://eucalyptus.atlassian.net/rest/api/2/issue/15635","fields":{"summary":"DeregisterImage doesn't work when an instance of the image still exists","status":{"self":"https://eucalyptus.atlassian.net/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://eucalyptus.atlassian.net/images/icons/statuses/generic.png","name":"Closed","id":"6","statusCategory":{"self":"https://eucalyptus.atlassian.net/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://eucalyptus.atlassian.net/rest/api/2/priority/3","iconUrl":"https://eucalyptus.atlassian.net/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://eucalyptus.atlassian.net/secure/viewavatar?size=xsmall&avatarId=14803&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":14803}}}},{"id":"19055","self":"https://eucalyptus.atlassian.net/rest/api/2/issueLink/19055","type":{"id":"10103","name":"Relates","inward":"relates to","outward":"relates to","self":"https://eucalyptus.atlassian.net/rest/api/2/issueLinkType/10103"},"inwardIssue":{"id":"22493","key":"EUCA-6962","self":"https://eucalyptus.atlassian.net/rest/api/2/issue/22493","fields":{"summary":"Garbage collect de-registered images","status":{"self":"https://eucalyptus.atlassian.net/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://eucalyptus.atlassian.net/images/icons/statuses/generic.png","name":"Closed","id":"6","statusCategory":{"self":"https://eucalyptus.atlassian.net/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://eucalyptus.atlassian.net/rest/api/2/priority/3","iconUrl":"https://eucalyptus.atlassian.net/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://eucalyptus.atlassian.net/secure/viewavatar?size=xsmall&avatarId=14803&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":14803}}}},{"id":"20014","self":"https://eucalyptus.atlassian.net/rest/api/2/issueLink/20014","type":{"id":"10103","name":"Relates","inward":"relates to","outward":"relates to","self":"https://eucalyptus.atlassian.net/rest/api/2/issueLinkType/10103"},"inwardIssue":{"id":"12701","key":"EUCA-1800","self":"https://eucalyptus.atlassian.net/rest/api/2/issue/12701","fields":{"summary":"Remove images error message should be improved","status":{"self":"https://eucalyptus.atlassian.net/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://eucalyptus.atlassian.net/images/icons/statuses/generic.png","name":"Closed","id":"6","statusCategory":{"self":"https://eucalyptus.atlassian.net/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://eucalyptus.atlassian.net/rest/api/2/priority/5","iconUrl":"https://eucalyptus.atlassian.net/images/icons/priorities/trivial.svg","name":"Trivial","id":"5"},"issuetype":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://eucalyptus.atlassian.net/secure/viewavatar?size=xsmall&avatarId=14803&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":14803}}}}],"assignee":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=shaon","name":"shaon","key":"shaon","accountId":"557058:1e5e1aa5-5986-4a9e-b9ed-814f7000cd4f","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/70d1c1681d03ea38518d3b4f59db4385?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dshaon%26avatarId%3D11900%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/70d1c1681d03ea38518d3b4f59db4385?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dshaon%26avatarId%3D11900%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/70d1c1681d03ea38518d3b4f59db4385?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dshaon%26avatarId%3D11900%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/70d1c1681d03ea38518d3b4f59db4385?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dshaon%26avatarId%3D11900%26noRedirect%3Dtrue"},"displayName":"Imran Hossain Shaon","active":true,"timeZone":"America/Los_Angeles"},"updated":"2014-06-16T16:16:31.387-0500","status":{"self":"https://eucalyptus.atlassian.net/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://eucalyptus.atlassian.net/images/icons/statuses/generic.png","name":"Closed","id":"6","statusCategory":{"self":"https://eucalyptus.atlassian.net/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/component/10201","id":"10201","name":"AWS Compatibility"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/component/10002","id":"10002","name":"Cloud Controller"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/component/10015","id":"10015","name":"Walrus"}],"timeoriginalestimate":null,"customfield_13000":null,"description":"When deregistering an image, euca-deregister needs to be ran twice. This doesn't match the behavior seen on AWS with ec2-deregister.  After running euca-deregister on an image the first time, the second time its ran, we should respond with the error [InvalidAMIID.Unavailable|http://docs.aws.amazon.com/AWSEC2/latest/APIReference/api-error-codes.html] per AWS behavior.  Additionally, there isn't a _deregistered_ image state in the [DescribeImages API call|http://docs.aws.amazon.com/AWSEC2/latest/APIReference/ApiReference-query-DescribeImages.html]; only _available_, _pending_, or _failed_.\r\n\r\n*Eucalyptus*\r\n\r\n{code}\r\n[root@g-08-03 ~]# euca-describe-images eki-1E3E36D3\r\nIMAGE\teki-1E3E36D3\tprecise-06172013-part2-kernel/precise-server-cloudimg-amd64-vmlinuz-virtual.manifest.xml\t185153644748\tavailable\tprivate\tx86_64\tkernel\t\t\t\tinstance-store\r\n[root@g-08-03 ~]# euca-deregister eki-1E3E36D3\r\nIMAGE\teki-1E3E36D3\r\n[root@g-08-03 ~]# euca-describe-images eki-1E3E36D3\r\nIMAGE\teki-1E3E36D3\tprecise-06172013-part2-kernel/precise-server-cloudimg-amd64-vmlinuz-virtual.manifest.xml\t185153644748\tderegistered\tprivate\tx86_64\tkernel\t\t\t\tinstance-store\r\n[root@g-08-03 ~]# euca-deregister eki-1E3E36D3\r\nIMAGE\teki-1E3E36D3\r\n[root@g-08-03 ~]# euca-describe-images eki-1E3E36D3\r\n[root@g-08-03 ~]#\r\n{code}\r\n\r\n*AWS*\r\n\r\n{code}\r\neuca-prod-1-82:~ haroldspencerjr$ ec2-describe-images ami-69047500\r\nIMAGE\tami-69047500\t986451091583/precise-test2\t986451091583\tavailable\tprivate\t\tx86_64\tmachine\taki-88aa75e1\t\t\tinstance-store\tparavirtual\txen\r\nBLOCKDEVICEMAPPING\tEPHEMERAL\tsda2\tephemeral0\r\neuca-prod-1-82:~ haroldspencerjr$ ec2-deregister ami-69047500\r\nIMAGE\tami-69047500\r\neuca-prod-1-82:~ haroldspencerjr$ ec2-deregister ami-69047500\r\nClient.InvalidAMIID.Unavailable: The image ID 'ami-69047500' is no longer available\r\neuca-prod-1-82:~ haroldspencerjr$ ec2-describe-images ami-69047500\r\neuca-prod-1-82:~ haroldspencerjr$\r\n{code}","customfield_13200":null,"customfield_11300":null,"customfield_11500":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=mmunn1","name":"mmunn1","key":"mmunn1","accountId":"557058:6e62b7e8-e48f-469d-ac54-e9449dec5cd9","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue"},"displayName":"Michael Munn","active":true,"timeZone":"America/Los_Angeles"},"timetracking":{},"customfield_10401":null,"customfield_10005":null,"customfield_10600":null,"customfield_12900":null,"attachment":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/attachment/18805","id":"18805","filename":"sosreport-CLC-Walrus-UserConsole.6559-20140203215841-a0bb.tar.xz","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=hspencer","name":"hspencer","key":"hspencer","accountId":"557058:4a3a93bc-21f8-4658-9f5b-9cb484c910a7","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue"},"displayName":"Harold Spencer Jr.","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-02-03T20:17:29.780-0600","size":19313476,"mimeType":"application/x-xz","content":"https://eucalyptus.atlassian.net/secure/attachment/18805/sosreport-CLC-Walrus-UserConsole.6559-20140203215841-a0bb.tar.xz"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/attachment/18806","id":"18806","filename":"sosreport-CLC-Walrus-UserConsole.65592-20140203224517-4fad.tar.xz","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=hspencer","name":"hspencer","key":"hspencer","accountId":"557058:4a3a93bc-21f8-4658-9f5b-9cb484c910a7","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue"},"displayName":"Harold Spencer Jr.","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-02-03T20:18:22.717-0600","size":18964516,"mimeType":"application/x-xz","content":"https://eucalyptus.atlassian.net/secure/attachment/18806/sosreport-CLC-Walrus-UserConsole.65592-20140203224517-4fad.tar.xz"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/attachment/15703","id":"15703","filename":"sosreport-FrontEnd.6559-20130618072053-7d42.tar.xz","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=hspencer","name":"hspencer","key":"hspencer","accountId":"557058:4a3a93bc-21f8-4658-9f5b-9cb484c910a7","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue"},"displayName":"Harold Spencer Jr.","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-06-18T09:32:19.593-0500","size":931356,"mimeType":"application/octet-stream","content":"https://eucalyptus.atlassian.net/secure/attachment/15703/sosreport-FrontEnd.6559-20130618072053-7d42.tar.xz"}],"aggregatetimeestimate":null,"summary":"euca-deregister needs to be ran twice to de-register an image (doesn't match AWS behavior)","creator":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=hspencer","name":"hspencer","key":"hspencer","accountId":"557058:4a3a93bc-21f8-4658-9f5b-9cb484c910a7","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue"},"displayName":"Harold Spencer Jr.","active":true,"timeZone":"America/Los_Angeles"},"subtasks":[],"reporter":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=hspencer","name":"hspencer","key":"hspencer","accountId":"557058:4a3a93bc-21f8-4658-9f5b-9cb484c910a7","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue"},"displayName":"Harold Spencer Jr.","active":true,"timeZone":"America/Los_Angeles"},"customfield_10000":"3_*:*_1_*:*_1109328519_*|*_10001_*:*_1_*:*_2103591165_*|*_10002_*:*_1_*:*_1213628751_*|*_10000_*:*_1_*:*_1697763_*|*_10006_*:*_1_*:*_3130403445_*|*_5_*:*_2_*:*_8905833238_*|*_10003_*:*_1_*:*_3443110209_*|*_4_*:*_1_*:*_46021540_*|*_10007_*:*_1_*:*_10754296","aggregateprogress":{"progress":0,"total":0},"customfield_12100":"0|i023xz:","customfield_10001":"2013-06-18T11:39:37.016-0500","customfield_10002":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/10000","value":"Customer Affecting","id":"10000"}],"customfield_10200":null,"customfield_10003":null,"customfield_10400":null,"customfield_12500":null,"customfield_11600":["hspencer(hspencer)","shaon(shaon)","kedwards(kedwards)","mmunn1(mmunn1)","sjones(sjones)","viglesias(viglesias)"],"customfield_10116":null,"environment":"*HA and non-HA*","customfield_10117":null,"customfield_11800":null,"customfield_11802":null,"duedate":null,"customfield_11805":null,"customfield_11806":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/21913/comment/47774","id":"47774","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=hspencer","name":"hspencer","key":"hspencer","accountId":"557058:4a3a93bc-21f8-4658-9f5b-9cb484c910a7","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue"},"displayName":"Harold Spencer Jr.","active":true,"timeZone":"America/Los_Angeles"},"body":"Starting investigation on following Eucalyptus version:\r\n\r\n{code}\r\n[root@g-08-03 ~]# rpm -qa | grep euca\r\neuca2ools-release-3.0-1.el6.noarch\r\neucalyptus-gl-3.3.0-0.1055.el6.x86_64\r\neucalyptus-cc-3.3.0-0.1055.el6.x86_64\r\neucalyptus-release-3.3-1.el6.noarch\r\npython-eucadmin-3.3.0-0.1055.el6.noarch\r\neucalyptus-common-java-libs-3.3.0-0.1055.el6.x86_64\r\neucalyptus-3.3.0-0.1055.el6.x86_64\r\neucalyptus-common-java-3.3.0-0.1055.el6.x86_64\r\neuca2ools-3.0.0-0.20.el6.noarch\r\neucalyptus-load-balancer-image-1.0.0-0.92.el6.x86_64\r\neucalyptus-sc-3.3.0-0.1055.el6.x86_64\r\neucalyptus-admin-tools-3.3.0-0.1055.el6.noarch\r\neucalyptus-cloud-3.3.0-0.1055.el6.x86_64\r\neucalyptus-walrus-3.3.0-0.1055.el6.x86_64\r\n{code}","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=hspencer","name":"hspencer","key":"hspencer","accountId":"557058:4a3a93bc-21f8-4658-9f5b-9cb484c910a7","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue"},"displayName":"Harold Spencer Jr.","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-06-18T08:40:22.731-0500","updated":"2013-06-18T08:40:22.731-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/21913/comment/47776","id":"47776","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=hspencer","name":"hspencer","key":"hspencer","accountId":"557058:4a3a93bc-21f8-4658-9f5b-9cb484c910a7","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue"},"displayName":"Harold Spencer Jr.","active":true,"timeZone":"America/Los_Angeles"},"body":"Behavior was confirmed.  Re-ran tests with verbose output for both AWS and Eucalyptus.  On each environment, the following steps were done:\r\n\r\n* DescribeImages API call\r\n* DeregisterImage API call\r\n* DescribeImages API call\r\n* DeregisterImage API call\r\n* DescribeImages API call\r\n\r\nAdditionally, attached sosreport where Eucalyptus logging was set to EXTREME. \r\n\r\n*Eucalyptus* \r\n\r\n{code}\r\n[root@g-08-03 ~]# euca-describe-images eki-7E8E35CD --debug\r\n2013-06-18 07:19:35,017 DEBUG   DescribeImages parsed arguments: {'all': False, 'userregion': None, 'filters': None, 'url': None, 'ImageId': ['eki-7E8E35CD'], 'shell_configfile': '', 'deprecated_key_id': None, 'show_empty_fields': False, 'Owner': None, 'key_id': None, 'secret_key': None, 'ExecutableBy': None}\r\n2013-06-18 07:19:35,017 DEBUG   Config searching regions for option 'ec2-url'\r\n2013-06-18 07:19:35,017 DEBUG   Config   section 'aws:us-east-1'\r\n2013-06-18 07:19:35,017 INFO    Config option 'ec2-url' = 'https://ec2.us-east-1.amazonaws.com/'\r\n2013-06-18 07:19:35,018 DEBUG   Config searching regions for option 'verify-ssl'\r\n2013-06-18 07:19:35,018 DEBUG   Config   section 'aws:us-east-1'\r\n2013-06-18 07:19:35,018 DEBUG   Config   section 'aws:*'\r\n2013-06-18 07:19:35,018 INFO    Config option 'verify-ssl' = 'true'\r\n2013-06-18 07:19:35,021 INFO    DescribeImages parameters: {'Action': 'DescribeImages', 'ImageId.1': 'eki-7E8E35CD', 'Version': '2013-02-01'}\r\n2013-06-18 07:19:35,021 INFO    Eucalyptus sending request (attempt 1 of 3)\r\n2013-06-18 07:19:35,022 DEBUG   EC2CompatibleQuerySigV2Auth string to sign: 'POST\\n10.104.1.163:8773\\n/services/Eucalyptus\\nAWSAccessKeyId=HCQNP7EMFE1JEDH6K1I1T&Action=DescribeImages&ImageId.1=eki-7E8E35CD&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2013-06-18T14%3A19%3A35Z&Version=2013-02-01'\r\n2013-06-18 07:19:35,022 DEBUG   EC2CompatibleQuerySigV2Auth b64-encoded signature: OvVMkRuR7WPjSoXUSWoUEA/zlCLC9Xgn1BJoVM4xnEE=\r\n2013-06-18 07:19:35,022 DEBUG   EC2CompatibleQuerySigV2Auth converting params to POST data\r\n2013-06-18 07:19:35,028 DEBUG   Eucalyptus request method: POST\r\n2013-06-18 07:19:35,029 DEBUG   Eucalyptus request url:    http://10.104.1.163:8773/services/Eucalyptus\r\n2013-06-18 07:19:35,029 DEBUG   Eucalyptus request header: Content-Length: 240\r\n2013-06-18 07:19:35,029 DEBUG   Eucalyptus request header: Content-Type: application/x-www-form-urlencoded\r\n2013-06-18 07:19:35,029 DEBUG   Eucalyptus request header: Host: 10.104.1.163:8773\r\n2013-06-18 07:19:35,029 DEBUG   Eucalyptus request header: User-Agent: euca2ools/3.0.0 (CPython 2.6.6; Linux 2.6.32-358.6.2.el6.x86_64; x86_64) requestbuilder/0.1.0-beta2 requests/1.1.0\r\n2013-06-18 07:19:35,029 DEBUG   Eucalyptus request data:   AWSAccessKeyId: HCQNP7EMFE1JEDH6K1I1T\r\n2013-06-18 07:19:35,029 DEBUG   Eucalyptus request data:   Action: DescribeImages\r\n2013-06-18 07:19:35,029 DEBUG   Eucalyptus request data:   ImageId.1: eki-7E8E35CD\r\n2013-06-18 07:19:35,029 DEBUG   Eucalyptus request data:   Signature: OvVMkRuR7WPjSoXUSWoUEA/zlCLC9Xgn1BJoVM4xnEE=\r\n2013-06-18 07:19:35,029 DEBUG   Eucalyptus request data:   SignatureMethod: HmacSHA256\r\n2013-06-18 07:19:35,029 DEBUG   Eucalyptus request data:   SignatureVersion: 2\r\n2013-06-18 07:19:35,029 DEBUG   Eucalyptus request data:   Timestamp: 2013-06-18T14:19:35Z\r\n2013-06-18 07:19:35,029 DEBUG   Eucalyptus request data:   Version: 2013-02-01\r\n2013-06-18 07:19:36,122 DEBUG   Eucalyptus response time: 1.092 seconds\r\n2013-06-18 07:19:36,123 INFO    Eucalyptus response status: 200\r\n2013-06-18 07:19:36,123 DEBUG   Eucalyptus response header: content-length: 615\r\n2013-06-18 07:19:36,123 DEBUG   Eucalyptus response header: content-type: application/xml; charset=UTF-8\r\n2013-06-18 07:19:36,123 DEBUG   DescribeImages -- response content --\r\n<DescribeImagesResponse xmlns=\"http://ec2.amazonaws.com/doc/2013-02-01/\"><imagesSet><item><imageId>eki-7E8E35CD</imageId><imageLocation>precise-06182013-kernel/precise-server-cloudimg-amd64-vmlinuz-virtual.manifest.xml</imageLocation><imageState>available</imageState><imageOwnerId>185153644748</imageOwnerId><isPublic>false</isPublic><productCodes/><architecture>x86_64</architecture><imageType>kernel</imageType><platform/><name>precise-kernel</name><rootDeviceType>instance-store</rootDeviceType><rootDeviceName>/dev/sda1</rootDeviceName><blockDeviceMapping/><tagSet/></item></imagesSet></DescribeImagesResponse>\r\n2013-06-18 07:19:36,124 DEBUG   DescribeImages -- end of response content --\r\nIMAGE\teki-7E8E35CD\tprecise-06182013-kernel/precise-server-cloudimg-amd64-vmlinuz-virtual.manifest.xml\t185153644748\tavailable\tprivate\tx86_64\tkernel\t\t\t\tinstance-store\r\n[root@g-08-03 ~]# euca-deregister eki-7E8E35CD --debug\r\n2013-06-18 07:19:47,764 DEBUG   DeregisterImage parsed arguments: {'userregion': None, 'url': None, 'ImageId': 'eki-7E8E35CD', 'shell_configfile': '', 'deprecated_sec_key': None, 'deprecated_key_id': None, 'show_empty_fields': False, 'key_id': None, 'secret_key': None}\r\n2013-06-18 07:19:47,764 DEBUG   Config searching regions for option 'ec2-url'\r\n2013-06-18 07:19:47,764 DEBUG   Config   section 'aws:us-east-1'\r\n2013-06-18 07:19:47,764 INFO    Config option 'ec2-url' = 'https://ec2.us-east-1.amazonaws.com/'\r\n2013-06-18 07:19:47,764 DEBUG   Config searching regions for option 'verify-ssl'\r\n2013-06-18 07:19:47,764 DEBUG   Config   section 'aws:us-east-1'\r\n2013-06-18 07:19:47,764 DEBUG   Config   section 'aws:*'\r\n2013-06-18 07:19:47,764 INFO    Config option 'verify-ssl' = 'true'\r\n2013-06-18 07:19:47,767 INFO    DeregisterImage parameters: {'Action': 'DeregisterImage', 'Version': '2013-02-01', 'ImageId': 'eki-7E8E35CD'}\r\n2013-06-18 07:19:47,767 INFO    Eucalyptus sending request (attempt 1 of 3)\r\n2013-06-18 07:19:47,769 DEBUG   EC2CompatibleQuerySigV2Auth string to sign: 'POST\\n10.104.1.163:8773\\n/services/Eucalyptus\\nAWSAccessKeyId=HCQNP7EMFE1JEDH6K1I1T&Action=DeregisterImage&ImageId=eki-7E8E35CD&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2013-06-18T14%3A19%3A47Z&Version=2013-02-01'\r\n2013-06-18 07:19:47,769 DEBUG   EC2CompatibleQuerySigV2Auth b64-encoded signature: rRi/ql912iyCWQ3jhE5sTtzj6xxIIHRFzRfIkgjL7K8=\r\n2013-06-18 07:19:47,769 DEBUG   EC2CompatibleQuerySigV2Auth converting params to POST data\r\n2013-06-18 07:19:47,775 DEBUG   Eucalyptus request method: POST\r\n2013-06-18 07:19:47,775 DEBUG   Eucalyptus request url:    http://10.104.1.163:8773/services/Eucalyptus\r\n2013-06-18 07:19:47,775 DEBUG   Eucalyptus request header: Content-Length: 239\r\n2013-06-18 07:19:47,775 DEBUG   Eucalyptus request header: Content-Type: application/x-www-form-urlencoded\r\n2013-06-18 07:19:47,775 DEBUG   Eucalyptus request header: Host: 10.104.1.163:8773\r\n2013-06-18 07:19:47,775 DEBUG   Eucalyptus request header: User-Agent: euca2ools/3.0.0 (CPython 2.6.6; Linux 2.6.32-358.6.2.el6.x86_64; x86_64) requestbuilder/0.1.0-beta2 requests/1.1.0\r\n2013-06-18 07:19:47,775 DEBUG   Eucalyptus request data:   AWSAccessKeyId: HCQNP7EMFE1JEDH6K1I1T\r\n2013-06-18 07:19:47,776 DEBUG   Eucalyptus request data:   Action: DeregisterImage\r\n2013-06-18 07:19:47,776 DEBUG   Eucalyptus request data:   ImageId: eki-7E8E35CD\r\n2013-06-18 07:19:47,776 DEBUG   Eucalyptus request data:   Signature: rRi/ql912iyCWQ3jhE5sTtzj6xxIIHRFzRfIkgjL7K8=\r\n2013-06-18 07:19:47,776 DEBUG   Eucalyptus request data:   SignatureMethod: HmacSHA256\r\n2013-06-18 07:19:47,776 DEBUG   Eucalyptus request data:   SignatureVersion: 2\r\n2013-06-18 07:19:47,776 DEBUG   Eucalyptus request data:   Timestamp: 2013-06-18T14:19:47Z\r\n2013-06-18 07:19:47,776 DEBUG   Eucalyptus request data:   Version: 2013-02-01\r\n2013-06-18 07:19:48,632 DEBUG   Eucalyptus response time: 0.856 seconds\r\n2013-06-18 07:19:48,632 INFO    Eucalyptus response status: 200\r\n2013-06-18 07:19:48,633 DEBUG   Eucalyptus response header: content-length: 121\r\n2013-06-18 07:19:48,633 DEBUG   Eucalyptus response header: content-type: application/xml; charset=UTF-8\r\n2013-06-18 07:19:48,633 DEBUG   DeregisterImage -- response content --\r\n<DeregisterImageResponse xmlns=\"http://ec2.amazonaws.com/doc/2013-02-01/\"><return>true</return></DeregisterImageResponse>\r\n2013-06-18 07:19:48,633 DEBUG   DeregisterImage -- end of response content --\r\nIMAGE\teki-7E8E35CD\r\n[root@g-08-03 ~]# euca-describe-images eki-7E8E35CD --debug\r\n2013-06-18 07:19:59,757 DEBUG   DescribeImages parsed arguments: {'all': False, 'userregion': None, 'filters': None, 'url': None, 'ImageId': ['eki-7E8E35CD'], 'shell_configfile': '', 'deprecated_key_id': None, 'show_empty_fields': False, 'Owner': None, 'key_id': None, 'secret_key': None, 'ExecutableBy': None}\r\n2013-06-18 07:19:59,758 DEBUG   Config searching regions for option 'ec2-url'\r\n2013-06-18 07:19:59,758 DEBUG   Config   section 'aws:us-east-1'\r\n2013-06-18 07:19:59,758 INFO    Config option 'ec2-url' = 'https://ec2.us-east-1.amazonaws.com/'\r\n2013-06-18 07:19:59,758 DEBUG   Config searching regions for option 'verify-ssl'\r\n2013-06-18 07:19:59,758 DEBUG   Config   section 'aws:us-east-1'\r\n2013-06-18 07:19:59,758 DEBUG   Config   section 'aws:*'\r\n2013-06-18 07:19:59,758 INFO    Config option 'verify-ssl' = 'true'\r\n2013-06-18 07:19:59,762 INFO    DescribeImages parameters: {'Action': 'DescribeImages', 'ImageId.1': 'eki-7E8E35CD', 'Version': '2013-02-01'}\r\n2013-06-18 07:19:59,762 INFO    Eucalyptus sending request (attempt 1 of 3)\r\n2013-06-18 07:19:59,764 DEBUG   EC2CompatibleQuerySigV2Auth string to sign: 'POST\\n10.104.1.163:8773\\n/services/Eucalyptus\\nAWSAccessKeyId=HCQNP7EMFE1JEDH6K1I1T&Action=DescribeImages&ImageId.1=eki-7E8E35CD&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2013-06-18T14%3A19%3A59Z&Version=2013-02-01'\r\n2013-06-18 07:19:59,764 DEBUG   EC2CompatibleQuerySigV2Auth b64-encoded signature: qmv4hAspCuEzz4sFTz8USXKAiTzsenWhRvlaax9eb6w=\r\n2013-06-18 07:19:59,764 DEBUG   EC2CompatibleQuerySigV2Auth converting params to POST data\r\n2013-06-18 07:19:59,771 DEBUG   Eucalyptus request method: POST\r\n2013-06-18 07:19:59,771 DEBUG   Eucalyptus request url:    http://10.104.1.163:8773/services/Eucalyptus\r\n2013-06-18 07:19:59,771 DEBUG   Eucalyptus request header: Content-Length: 238\r\n2013-06-18 07:19:59,771 DEBUG   Eucalyptus request header: Content-Type: application/x-www-form-urlencoded\r\n2013-06-18 07:19:59,771 DEBUG   Eucalyptus request header: Host: 10.104.1.163:8773\r\n2013-06-18 07:19:59,771 DEBUG   Eucalyptus request header: User-Agent: euca2ools/3.0.0 (CPython 2.6.6; Linux 2.6.32-358.6.2.el6.x86_64; x86_64) requestbuilder/0.1.0-beta2 requests/1.1.0\r\n2013-06-18 07:19:59,772 DEBUG   Eucalyptus request data:   AWSAccessKeyId: HCQNP7EMFE1JEDH6K1I1T\r\n2013-06-18 07:19:59,772 DEBUG   Eucalyptus request data:   Action: DescribeImages\r\n2013-06-18 07:19:59,772 DEBUG   Eucalyptus request data:   ImageId.1: eki-7E8E35CD\r\n2013-06-18 07:19:59,772 DEBUG   Eucalyptus request data:   Signature: qmv4hAspCuEzz4sFTz8USXKAiTzsenWhRvlaax9eb6w=\r\n2013-06-18 07:19:59,772 DEBUG   Eucalyptus request data:   SignatureMethod: HmacSHA256\r\n2013-06-18 07:19:59,772 DEBUG   Eucalyptus request data:   SignatureVersion: 2\r\n2013-06-18 07:19:59,772 DEBUG   Eucalyptus request data:   Timestamp: 2013-06-18T14:19:59Z\r\n2013-06-18 07:19:59,772 DEBUG   Eucalyptus request data:   Version: 2013-02-01\r\n2013-06-18 07:20:00,031 DEBUG   Eucalyptus response time: 0.259 seconds\r\n2013-06-18 07:20:00,032 INFO    Eucalyptus response status: 200\r\n2013-06-18 07:20:00,032 DEBUG   Eucalyptus response header: content-length: 618\r\n2013-06-18 07:20:00,032 DEBUG   Eucalyptus response header: content-type: application/xml; charset=UTF-8\r\n2013-06-18 07:20:00,032 DEBUG   DescribeImages -- response content --\r\n<DescribeImagesResponse xmlns=\"http://ec2.amazonaws.com/doc/2013-02-01/\"><imagesSet><item><imageId>eki-7E8E35CD</imageId><imageLocation>precise-06182013-kernel/precise-server-cloudimg-amd64-vmlinuz-virtual.manifest.xml</imageLocation><imageState>deregistered</imageState><imageOwnerId>185153644748</imageOwnerId><isPublic>false</isPublic><productCodes/><architecture>x86_64</architecture><imageType>kernel</imageType><platform/><name>precise-kernel</name><rootDeviceType>instance-store</rootDeviceType><rootDeviceName>/dev/sda1</rootDeviceName><blockDeviceMapping/><tagSet/></item></imagesSet></DescribeImagesResponse>\r\n2013-06-18 07:20:00,033 DEBUG   DescribeImages -- end of response content --\r\nIMAGE\teki-7E8E35CD\tprecise-06182013-kernel/precise-server-cloudimg-amd64-vmlinuz-virtual.manifest.xml\t185153644748\tderegistered\tprivate\tx86_64\tkernel\t\t\t\tinstance-store\r\n[root@g-08-03 ~]# euca-deregister eki-7E8E35CD --debug\r\n2013-06-18 07:20:10,407 DEBUG   DeregisterImage parsed arguments: {'userregion': None, 'url': None, 'ImageId': 'eki-7E8E35CD', 'shell_configfile': '', 'deprecated_sec_key': None, 'deprecated_key_id': None, 'show_empty_fields': False, 'key_id': None, 'secret_key': None}\r\n2013-06-18 07:20:10,407 DEBUG   Config searching regions for option 'ec2-url'\r\n2013-06-18 07:20:10,408 DEBUG   Config   section 'aws:us-east-1'\r\n2013-06-18 07:20:10,408 INFO    Config option 'ec2-url' = 'https://ec2.us-east-1.amazonaws.com/'\r\n2013-06-18 07:20:10,408 DEBUG   Config searching regions for option 'verify-ssl'\r\n2013-06-18 07:20:10,408 DEBUG   Config   section 'aws:us-east-1'\r\n2013-06-18 07:20:10,408 DEBUG   Config   section 'aws:*'\r\n2013-06-18 07:20:10,408 INFO    Config option 'verify-ssl' = 'true'\r\n2013-06-18 07:20:10,410 INFO    DeregisterImage parameters: {'Action': 'DeregisterImage', 'Version': '2013-02-01', 'ImageId': 'eki-7E8E35CD'}\r\n2013-06-18 07:20:10,411 INFO    Eucalyptus sending request (attempt 1 of 3)\r\n2013-06-18 07:20:10,412 DEBUG   EC2CompatibleQuerySigV2Auth string to sign: 'POST\\n10.104.1.163:8773\\n/services/Eucalyptus\\nAWSAccessKeyId=HCQNP7EMFE1JEDH6K1I1T&Action=DeregisterImage&ImageId=eki-7E8E35CD&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2013-06-18T14%3A20%3A10Z&Version=2013-02-01'\r\n2013-06-18 07:20:10,412 DEBUG   EC2CompatibleQuerySigV2Auth b64-encoded signature: J1TOM6ImSiCkZziA87CcwvLdLXq+xCRzSjIktWrfbZg=\r\n2013-06-18 07:20:10,412 DEBUG   EC2CompatibleQuerySigV2Auth converting params to POST data\r\n2013-06-18 07:20:10,419 DEBUG   Eucalyptus request method: POST\r\n2013-06-18 07:20:10,419 DEBUG   Eucalyptus request url:    http://10.104.1.163:8773/services/Eucalyptus\r\n2013-06-18 07:20:10,419 DEBUG   Eucalyptus request header: Content-Length: 239\r\n2013-06-18 07:20:10,419 DEBUG   Eucalyptus request header: Content-Type: application/x-www-form-urlencoded\r\n2013-06-18 07:20:10,419 DEBUG   Eucalyptus request header: Host: 10.104.1.163:8773\r\n2013-06-18 07:20:10,419 DEBUG   Eucalyptus request header: User-Agent: euca2ools/3.0.0 (CPython 2.6.6; Linux 2.6.32-358.6.2.el6.x86_64; x86_64) requestbuilder/0.1.0-beta2 requests/1.1.0\r\n2013-06-18 07:20:10,419 DEBUG   Eucalyptus request data:   AWSAccessKeyId: HCQNP7EMFE1JEDH6K1I1T\r\n2013-06-18 07:20:10,419 DEBUG   Eucalyptus request data:   Action: DeregisterImage\r\n2013-06-18 07:20:10,419 DEBUG   Eucalyptus request data:   ImageId: eki-7E8E35CD\r\n2013-06-18 07:20:10,419 DEBUG   Eucalyptus request data:   Signature: J1TOM6ImSiCkZziA87CcwvLdLXq+xCRzSjIktWrfbZg=\r\n2013-06-18 07:20:10,419 DEBUG   Eucalyptus request data:   SignatureMethod: HmacSHA256\r\n2013-06-18 07:20:10,419 DEBUG   Eucalyptus request data:   SignatureVersion: 2\r\n2013-06-18 07:20:10,419 DEBUG   Eucalyptus request data:   Timestamp: 2013-06-18T14:20:10Z\r\n2013-06-18 07:20:10,420 DEBUG   Eucalyptus request data:   Version: 2013-02-01\r\n2013-06-18 07:20:11,163 DEBUG   Eucalyptus response time: 0.743 seconds\r\n2013-06-18 07:20:11,163 INFO    Eucalyptus response status: 200\r\n2013-06-18 07:20:11,163 DEBUG   Eucalyptus response header: content-length: 121\r\n2013-06-18 07:20:11,164 DEBUG   Eucalyptus response header: content-type: application/xml; charset=UTF-8\r\n2013-06-18 07:20:11,164 DEBUG   DeregisterImage -- response content --\r\n<DeregisterImageResponse xmlns=\"http://ec2.amazonaws.com/doc/2013-02-01/\"><return>true</return></DeregisterImageResponse>\r\n2013-06-18 07:20:11,165 DEBUG   DeregisterImage -- end of response content --\r\nIMAGE\teki-7E8E35CD\r\n[root@g-08-03 ~]# euca-describe-images eki-7E8E35CD --debug\r\n2013-06-18 07:20:16,110 DEBUG   DescribeImages parsed arguments: {'all': False, 'userregion': None, 'filters': None, 'url': None, 'ImageId': ['eki-7E8E35CD'], 'shell_configfile': '', 'deprecated_key_id': None, 'show_empty_fields': False, 'Owner': None, 'key_id': None, 'secret_key': None, 'ExecutableBy': None}\r\n2013-06-18 07:20:16,111 DEBUG   Config searching regions for option 'ec2-url'\r\n2013-06-18 07:20:16,111 DEBUG   Config   section 'aws:us-east-1'\r\n2013-06-18 07:20:16,111 INFO    Config option 'ec2-url' = 'https://ec2.us-east-1.amazonaws.com/'\r\n2013-06-18 07:20:16,111 DEBUG   Config searching regions for option 'verify-ssl'\r\n2013-06-18 07:20:16,111 DEBUG   Config   section 'aws:us-east-1'\r\n2013-06-18 07:20:16,111 DEBUG   Config   section 'aws:*'\r\n2013-06-18 07:20:16,111 INFO    Config option 'verify-ssl' = 'true'\r\n2013-06-18 07:20:16,114 INFO    DescribeImages parameters: {'Action': 'DescribeImages', 'ImageId.1': 'eki-7E8E35CD', 'Version': '2013-02-01'}\r\n2013-06-18 07:20:16,114 INFO    Eucalyptus sending request (attempt 1 of 3)\r\n2013-06-18 07:20:16,115 DEBUG   EC2CompatibleQuerySigV2Auth string to sign: 'POST\\n10.104.1.163:8773\\n/services/Eucalyptus\\nAWSAccessKeyId=HCQNP7EMFE1JEDH6K1I1T&Action=DescribeImages&ImageId.1=eki-7E8E35CD&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2013-06-18T14%3A20%3A16Z&Version=2013-02-01'\r\n2013-06-18 07:20:16,116 DEBUG   EC2CompatibleQuerySigV2Auth b64-encoded signature: jmu16EW/cB9mnW+rhTYmh0ZCEBoek0tBJW/P4gjBa/E=\r\n2013-06-18 07:20:16,116 DEBUG   EC2CompatibleQuerySigV2Auth converting params to POST data\r\n2013-06-18 07:20:16,122 DEBUG   Eucalyptus request method: POST\r\n2013-06-18 07:20:16,122 DEBUG   Eucalyptus request url:    http://10.104.1.163:8773/services/Eucalyptus\r\n2013-06-18 07:20:16,122 DEBUG   Eucalyptus request header: Content-Length: 246\r\n2013-06-18 07:20:16,122 DEBUG   Eucalyptus request header: Content-Type: application/x-www-form-urlencoded\r\n2013-06-18 07:20:16,122 DEBUG   Eucalyptus request header: Host: 10.104.1.163:8773\r\n2013-06-18 07:20:16,122 DEBUG   Eucalyptus request header: User-Agent: euca2ools/3.0.0 (CPython 2.6.6; Linux 2.6.32-358.6.2.el6.x86_64; x86_64) requestbuilder/0.1.0-beta2 requests/1.1.0\r\n2013-06-18 07:20:16,122 DEBUG   Eucalyptus request data:   AWSAccessKeyId: HCQNP7EMFE1JEDH6K1I1T\r\n2013-06-18 07:20:16,122 DEBUG   Eucalyptus request data:   Action: DescribeImages\r\n2013-06-18 07:20:16,122 DEBUG   Eucalyptus request data:   ImageId.1: eki-7E8E35CD\r\n2013-06-18 07:20:16,123 DEBUG   Eucalyptus request data:   Signature: jmu16EW/cB9mnW+rhTYmh0ZCEBoek0tBJW/P4gjBa/E=\r\n2013-06-18 07:20:16,123 DEBUG   Eucalyptus request data:   SignatureMethod: HmacSHA256\r\n2013-06-18 07:20:16,123 DEBUG   Eucalyptus request data:   SignatureVersion: 2\r\n2013-06-18 07:20:16,123 DEBUG   Eucalyptus request data:   Timestamp: 2013-06-18T14:20:16Z\r\n2013-06-18 07:20:16,123 DEBUG   Eucalyptus request data:   Version: 2013-02-01\r\n2013-06-18 07:20:16,847 DEBUG   Eucalyptus response time: 0.724 seconds\r\n2013-06-18 07:20:16,848 INFO    Eucalyptus response status: 200\r\n2013-06-18 07:20:16,848 DEBUG   Eucalyptus response header: content-length: 110\r\n2013-06-18 07:20:16,848 DEBUG   Eucalyptus response header: content-type: application/xml; charset=UTF-8\r\n2013-06-18 07:20:16,848 DEBUG   DescribeImages -- response content --\r\n<DescribeImagesResponse xmlns=\"http://ec2.amazonaws.com/doc/2013-02-01/\"><imagesSet/></DescribeImagesResponse>\r\n2013-06-18 07:20:16,849 DEBUG   DescribeImages -- end of response content --\r\n{code}\r\n\r\n*AWS *\r\n\r\n{code}\r\neuca-prod-1-82:~ haroldspencerjr$ ec2-describe-images ami-7750211e --verbose\r\nSetting User-Agent to [ec2-api-tools 1.6.6.0]\r\nSetting User-Agent to [ec2-api-tools 1.6.6.0]\r\n------------------------------[ REQUEST ]-------------------------------\r\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<soap:Envelope xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\"\r\n  xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\">\r\n  <soap:Header>\r\n    <wsse:Security xmlns:wsse=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd\">\r\n      <wsu:Timestamp wsu:Id=\"Timestamp-1844781148\" xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\">\r\n        <wsu:Created xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\">2013-06-18T14:22:07.058Z</wsu:Created>\r\n        <wsu:Expires xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\">2013-06-18T14:27:07.058Z</wsu:Expires>\r\n      </wsu:Timestamp>\r\n      <wsse:BinarySecurityToken\r\n        EncodingType=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary\"\r\n        ValueType=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3\"\r\n        wsu:Id=\"CertId-1523501\"\r\n        xmlns:wsse=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd\" xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\">MIICeDCCAeGgAwIBAgIGANNolQ59MA0GCSqGSIb3DQEBBQUAMFMxCzAJBgNVBAYTAlVTMRMwEQYDVQQKEwpBbWF6b24uY29tMQwwCgYDVQQLEwNBV1MxITAfBgNVBAMTGEFXUyBMaW1pdGVkLUFzc3VyYW5jZSBDQTAeFw0xMTEyMjQxNzI4MjVaFw0xMjEyMjMxNzI4MjVaMFMxCzAJBgNVBAYTAlVTMRMwEQYDVQQKEwpBbWF6b24uY29tMRcwFQYDVQQLEw5BV1MtRGV2ZWxvcGVyczEWMBQGA1UEAxMNMXdqNjI2b21mNXI3ajCBnzANBgkqhkiG9w0BAQEFAAOBjQAwgYkCgYEA0ZeYyErvPOm93oKgrb0FAggAJRY3fypO639jLcj7vw2BfWzgFp7JZflV2w1gCZx09erSO8HTp6rrNovDZ1/XnDqsUZ3IOjRvxD/XI/nIz4rDB1QfChrpDWISj00DcNJ7sC1X5Ak4ZbpXlEcI6PrjB3qAP6rbBiKu23WOnGmyeLkCAwEAAaNXMFUwDgYDVR0PAQH/BAQDAgWgMBYGA1UdJQEB/wQMMAoGCCsGAQUFBwMCMAwGA1UdEwEB/wQCMAAwHQYDVR0OBBYEFFmrDoKt08EkSfGgnL7H4hGdm1+DMA0GCSqGSIb3DQEBBQUAA4GBAGKnrmvlQ24TstFb2BDtRgcYv3Pq3D7yrrO/9ARpfPQAdSFa63XDtx3eKpG62YquaUSen0Cbjkyl/Hrrskfy66fJLMuUIjtJbT+8TIGtNuBSWwJ5PsTGeNgDB/XRoA5X/V/+B3TXBebUphBk0JUdkB8WYXQVEHOP+NE7VLc966Bx</wsse:BinarySecurityToken>\r\n      <ds:Signature Id=\"Signature-424493843\" xmlns:ds=\"http://www.w3.org/2000/09/xmldsig#\">\r\n        <ds:SignedInfo>\r\n          <ds:CanonicalizationMethod Algorithm=\"http://www.w3.org/2001/10/xml-exc-c14n#\"/>\r\n          <ds:SignatureMethod Algorithm=\"http://www.w3.org/2000/09/xmldsig#rsa-sha1\"/>\r\n          <ds:Reference URI=\"#Timestamp-1844781148\">\r\n            <ds:Transforms>\r\n              <ds:Transform Algorithm=\"http://www.w3.org/2001/10/xml-exc-c14n#\"/>\r\n            </ds:Transforms>\r\n            <ds:DigestMethod Algorithm=\"http://www.w3.org/2000/09/xmldsig#sha1\"/>\r\n            <ds:DigestValue>l/DwPjRxm/Jpofhl2cLi/Jk9nYQ=</ds:DigestValue>\r\n          </ds:Reference>\r\n          <ds:Reference URI=\"#id-1548405287\">\r\n            <ds:Transforms>\r\n              <ds:Transform Algorithm=\"http://www.w3.org/2001/10/xml-exc-c14n#\"/>\r\n            </ds:Transforms>\r\n            <ds:DigestMethod Algorithm=\"http://www.w3.org/2000/09/xmldsig#sha1\"/>\r\n            <ds:DigestValue>3OB7R33Od41sTaPfwqvbIFzHOGY=</ds:DigestValue>\r\n          </ds:Reference>\r\n        </ds:SignedInfo>\r\n        <ds:SignatureValue>\r\nt5WqsbjxSWa1DMym5Cxec+Id1529ZIiu4BjcrTLREJ62RZQ7/C63A1KYs1Tzcf6Hn8F/WFMjDCvW\r\nc/Yf51rox1HMQYHhFxOvN7nTosq+ieQ154Hr/dZTHgOZHFcFk97/BKMSmyp6ILbs8VwcTNEjjHIK\r\nGzGXih7gM69iivsyuvI=\r\n</ds:SignatureValue>\r\n        <ds:KeyInfo Id=\"KeyId-405042200\">\r\n          <wsse:SecurityTokenReference wsu:Id=\"STRId-198947115\"\r\n            xmlns:wsse=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd\" xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\">\r\n            <wsse:Reference URI=\"#CertId-1523501\"\r\n              ValueType=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3\" xmlns:wsse=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd\"/>\r\n          </wsse:SecurityTokenReference>\r\n        </ds:KeyInfo>\r\n      </ds:Signature>\r\n    </wsse:Security>\r\n  </soap:Header>\r\n  <soap:Body wsu:Id=\"id-1548405287\"\r\n    xmlns:ns1=\"http://ec2.amazonaws.com/doc/2012-12-01/\" xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\">\r\n    <ns1:DescribeImages>\r\n      <ns1:executableBySet/>\r\n      <ns1:imagesSet>\r\n        <ns1:item>\r\n          <ns1:imageId>ami-7750211e</ns1:imageId>\r\n        </ns1:item>\r\n      </ns1:imagesSet>\r\n      <ns1:ownersSet/>\r\n      <ns1:filterSet/>\r\n    </ns1:DescribeImages>\r\n  </soap:Body>\r\n</soap:Envelope>\r\n\r\n------------------------------------------------------------------------\r\n------------------------------[ RESPONSE ]------------------------------\r\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<soap:Envelope xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\">\r\n  <soap:Body>\r\n    <DescribeImagesResponse xmlns=\"http://ec2.amazonaws.com/doc/2012-12-01/\">\r\n      <requestId>601d2ada-65dc-4f70-9c19-60662efd5a8b</requestId>\r\n      <imagesSet>\r\n        <item>\r\n          <imageId>ami-7750211e</imageId>\r\n          <imageLocation>precise-test-bucket/image.manifest.xml</imageLocation>\r\n          <imageState>available</imageState>\r\n          <imageOwnerId>986451091583</imageOwnerId>\r\n          <isPublic>false</isPublic>\r\n          <architecture>x86_64</architecture>\r\n          <imageType>machine</imageType>\r\n          <kernelId>aki-88aa75e1</kernelId>\r\n          <name>precise-test</name>\r\n          <rootDeviceType>instance-store</rootDeviceType>\r\n          <rootDeviceName>/dev/sda1</rootDeviceName>\r\n          <blockDeviceMapping>\r\n            <item>\r\n              <deviceName>sda2</deviceName>\r\n              <virtualName>ephemeral0</virtualName>\r\n            </item>\r\n          </blockDeviceMapping>\r\n          <virtualizationType>paravirtual</virtualizationType>\r\n          <hypervisor>xen</hypervisor>\r\n        </item>\r\n      </imagesSet>\r\n    </DescribeImagesResponse>\r\n  </soap:Body>\r\n</soap:Envelope>\r\n\r\n------------------------------------------------------------------------\r\nIMAGE\tami-7750211e\t986451091583/precise-test\t986451091583\tavailable\tprivate\t\tx86_64\tmachine\taki-88aa75e1\t\t\tinstance-store\tparavirtual\txen\r\nBLOCKDEVICEMAPPING\tEPHEMERAL\tsda2\tephemeral0\r\neuca-prod-1-82:~ haroldspencerjr$ ec2-deregister ami-7750211e --verbose\r\nSetting User-Agent to [ec2-api-tools 1.6.6.0]\r\nSetting User-Agent to [ec2-api-tools 1.6.6.0]\r\n------------------------------[ REQUEST ]-------------------------------\r\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<soap:Envelope xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\"\r\n  xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\">\r\n  <soap:Header>\r\n    <wsse:Security xmlns:wsse=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd\">\r\n      <wsu:Timestamp wsu:Id=\"Timestamp-714752751\" xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\">\r\n        <wsu:Created xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\">2013-06-18T14:22:23.150Z</wsu:Created>\r\n        <wsu:Expires xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\">2013-06-18T14:27:23.150Z</wsu:Expires>\r\n      </wsu:Timestamp>\r\n      <wsse:BinarySecurityToken\r\n        EncodingType=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary\"\r\n        ValueType=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3\"\r\n        wsu:Id=\"CertId-1523501\"\r\n        xmlns:wsse=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd\" xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\">MIICeDCCAeGgAwIBAgIGANNolQ59MA0GCSqGSIb3DQEBBQUAMFMxCzAJBgNVBAYTAlVTMRMwEQYDVQQKEwpBbWF6b24uY29tMQwwCgYDVQQLEwNBV1MxITAfBgNVBAMTGEFXUyBMaW1pdGVkLUFzc3VyYW5jZSBDQTAeFw0xMTEyMjQxNzI4MjVaFw0xMjEyMjMxNzI4MjVaMFMxCzAJBgNVBAYTAlVTMRMwEQYDVQQKEwpBbWF6b24uY29tMRcwFQYDVQQLEw5BV1MtRGV2ZWxvcGVyczEWMBQGA1UEAxMNMXdqNjI2b21mNXI3ajCBnzANBgkqhkiG9w0BAQEFAAOBjQAwgYkCgYEA0ZeYyErvPOm93oKgrb0FAggAJRY3fypO639jLcj7vw2BfWzgFp7JZflV2w1gCZx09erSO8HTp6rrNovDZ1/XnDqsUZ3IOjRvxD/XI/nIz4rDB1QfChrpDWISj00DcNJ7sC1X5Ak4ZbpXlEcI6PrjB3qAP6rbBiKu23WOnGmyeLkCAwEAAaNXMFUwDgYDVR0PAQH/BAQDAgWgMBYGA1UdJQEB/wQMMAoGCCsGAQUFBwMCMAwGA1UdEwEB/wQCMAAwHQYDVR0OBBYEFFmrDoKt08EkSfGgnL7H4hGdm1+DMA0GCSqGSIb3DQEBBQUAA4GBAGKnrmvlQ24TstFb2BDtRgcYv3Pq3D7yrrO/9ARpfPQAdSFa63XDtx3eKpG62YquaUSen0Cbjkyl/Hrrskfy66fJLMuUIjtJbT+8TIGtNuBSWwJ5PsTGeNgDB/XRoA5X/V/+B3TXBebUphBk0JUdkB8WYXQVEHOP+NE7VLc966Bx</wsse:BinarySecurityToken>\r\n      <ds:Signature Id=\"Signature-1956433926\" xmlns:ds=\"http://www.w3.org/2000/09/xmldsig#\">\r\n        <ds:SignedInfo>\r\n          <ds:CanonicalizationMethod Algorithm=\"http://www.w3.org/2001/10/xml-exc-c14n#\"/>\r\n          <ds:SignatureMethod Algorithm=\"http://www.w3.org/2000/09/xmldsig#rsa-sha1\"/>\r\n          <ds:Reference URI=\"#Timestamp-714752751\">\r\n            <ds:Transforms>\r\n              <ds:Transform Algorithm=\"http://www.w3.org/2001/10/xml-exc-c14n#\"/>\r\n            </ds:Transforms>\r\n            <ds:DigestMethod Algorithm=\"http://www.w3.org/2000/09/xmldsig#sha1\"/>\r\n            <ds:DigestValue>yGI9OWz/nBcUtljdfzzypOO/sJ8=</ds:DigestValue>\r\n          </ds:Reference>\r\n          <ds:Reference URI=\"#id-2015342697\">\r\n            <ds:Transforms>\r\n              <ds:Transform Algorithm=\"http://www.w3.org/2001/10/xml-exc-c14n#\"/>\r\n            </ds:Transforms>\r\n            <ds:DigestMethod Algorithm=\"http://www.w3.org/2000/09/xmldsig#sha1\"/>\r\n            <ds:DigestValue>pip6T9+rJnMSDHj2JcGe/W/32Kg=</ds:DigestValue>\r\n          </ds:Reference>\r\n        </ds:SignedInfo>\r\n        <ds:SignatureValue>\r\nyRWfrpqcS8Ki6v2tobRH8r3OjxcKQiApPmHL+GBXDl0NLCqG4GkfisJaOzDelfkPpabLjRdtQb7d\r\n9BXTJkPdf0+JD6zXjyQ4j9kfWuviQH+jtCTMxV+gpIQIIuAVjYGzcJr7Uxyc5A+wX8MqEDbsHkHZ\r\nkrzkdTjdqohycz52ULA=\r\n</ds:SignatureValue>\r\n        <ds:KeyInfo Id=\"KeyId-589035397\">\r\n          <wsse:SecurityTokenReference wsu:Id=\"STRId-557082642\"\r\n            xmlns:wsse=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd\" xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\">\r\n            <wsse:Reference URI=\"#CertId-1523501\"\r\n              ValueType=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3\" xmlns:wsse=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd\"/>\r\n          </wsse:SecurityTokenReference>\r\n        </ds:KeyInfo>\r\n      </ds:Signature>\r\n    </wsse:Security>\r\n  </soap:Header>\r\n  <soap:Body wsu:Id=\"id-2015342697\"\r\n    xmlns:ns1=\"http://ec2.amazonaws.com/doc/2012-12-01/\" xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\">\r\n    <ns1:DeregisterImage>\r\n      <ns1:imageId>ami-7750211e</ns1:imageId>\r\n    </ns1:DeregisterImage>\r\n  </soap:Body>\r\n</soap:Envelope>\r\n\r\n------------------------------------------------------------------------\r\n------------------------------[ RESPONSE ]------------------------------\r\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<soap:Envelope xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\">\r\n  <soap:Body>\r\n    <DeregisterImageResponse xmlns=\"http://ec2.amazonaws.com/doc/2012-12-01/\">\r\n      <requestId>3e6a1765-a0f6-478c-a6a5-ff7de5ba8ba4</requestId>\r\n      <return>true</return>\r\n    </DeregisterImageResponse>\r\n  </soap:Body>\r\n</soap:Envelope>\r\n\r\n------------------------------------------------------------------------\r\nIMAGE\tami-7750211e\r\neuca-prod-1-82:~ haroldspencerjr$ ec2-describe-images ami-7750211e --verbose\r\nSetting User-Agent to [ec2-api-tools 1.6.6.0]\r\nSetting User-Agent to [ec2-api-tools 1.6.6.0]\r\n------------------------------[ REQUEST ]-------------------------------\r\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<soap:Envelope xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\"\r\n  xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\">\r\n  <soap:Header>\r\n    <wsse:Security xmlns:wsse=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd\">\r\n      <wsu:Timestamp wsu:Id=\"Timestamp-2127007234\" xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\">\r\n        <wsu:Created xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\">2013-06-18T14:22:38.003Z</wsu:Created>\r\n        <wsu:Expires xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\">2013-06-18T14:27:38.003Z</wsu:Expires>\r\n      </wsu:Timestamp>\r\n      <wsse:BinarySecurityToken\r\n        EncodingType=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary\"\r\n        ValueType=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3\"\r\n        wsu:Id=\"CertId-1523501\"\r\n        xmlns:wsse=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd\" xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\">MIICeDCCAeGgAwIBAgIGANNolQ59MA0GCSqGSIb3DQEBBQUAMFMxCzAJBgNVBAYTAlVTMRMwEQYDVQQKEwpBbWF6b24uY29tMQwwCgYDVQQLEwNBV1MxITAfBgNVBAMTGEFXUyBMaW1pdGVkLUFzc3VyYW5jZSBDQTAeFw0xMTEyMjQxNzI4MjVaFw0xMjEyMjMxNzI4MjVaMFMxCzAJBgNVBAYTAlVTMRMwEQYDVQQKEwpBbWF6b24uY29tMRcwFQYDVQQLEw5BV1MtRGV2ZWxvcGVyczEWMBQGA1UEAxMNMXdqNjI2b21mNXI3ajCBnzANBgkqhkiG9w0BAQEFAAOBjQAwgYkCgYEA0ZeYyErvPOm93oKgrb0FAggAJRY3fypO639jLcj7vw2BfWzgFp7JZflV2w1gCZx09erSO8HTp6rrNovDZ1/XnDqsUZ3IOjRvxD/XI/nIz4rDB1QfChrpDWISj00DcNJ7sC1X5Ak4ZbpXlEcI6PrjB3qAP6rbBiKu23WOnGmyeLkCAwEAAaNXMFUwDgYDVR0PAQH/BAQDAgWgMBYGA1UdJQEB/wQMMAoGCCsGAQUFBwMCMAwGA1UdEwEB/wQCMAAwHQYDVR0OBBYEFFmrDoKt08EkSfGgnL7H4hGdm1+DMA0GCSqGSIb3DQEBBQUAA4GBAGKnrmvlQ24TstFb2BDtRgcYv3Pq3D7yrrO/9ARpfPQAdSFa63XDtx3eKpG62YquaUSen0Cbjkyl/Hrrskfy66fJLMuUIjtJbT+8TIGtNuBSWwJ5PsTGeNgDB/XRoA5X/V/+B3TXBebUphBk0JUdkB8WYXQVEHOP+NE7VLc966Bx</wsse:BinarySecurityToken>\r\n      <ds:Signature Id=\"Signature-1021302339\" xmlns:ds=\"http://www.w3.org/2000/09/xmldsig#\">\r\n        <ds:SignedInfo>\r\n          <ds:CanonicalizationMethod Algorithm=\"http://www.w3.org/2001/10/xml-exc-c14n#\"/>\r\n          <ds:SignatureMethod Algorithm=\"http://www.w3.org/2000/09/xmldsig#rsa-sha1\"/>\r\n          <ds:Reference URI=\"#Timestamp-2127007234\">\r\n            <ds:Transforms>\r\n              <ds:Transform Algorithm=\"http://www.w3.org/2001/10/xml-exc-c14n#\"/>\r\n            </ds:Transforms>\r\n            <ds:DigestMethod Algorithm=\"http://www.w3.org/2000/09/xmldsig#sha1\"/>\r\n            <ds:DigestValue>k0yy+AiJZp0ih5EqWvt2fKMut/w=</ds:DigestValue>\r\n          </ds:Reference>\r\n          <ds:Reference URI=\"#id-1473766991\">\r\n            <ds:Transforms>\r\n              <ds:Transform Algorithm=\"http://www.w3.org/2001/10/xml-exc-c14n#\"/>\r\n            </ds:Transforms>\r\n            <ds:DigestMethod Algorithm=\"http://www.w3.org/2000/09/xmldsig#sha1\"/>\r\n            <ds:DigestValue>CnmquOw1mRYnqZkXE2L95tV/fCw=</ds:DigestValue>\r\n          </ds:Reference>\r\n        </ds:SignedInfo>\r\n        <ds:SignatureValue>\r\nux2ieZx9MHi37J1NHPlUSG9zw7X4464VSx0IfiNm3G95Dv4oamFYCRaZ+lSB0qm0VykHseyaHeYA\r\nyT6h77Xq7D4wJqgND9K5tblQN5Q9c+w/Hk9DmAAZdqBn6z8iM+isJjQeJC+lljVYoFQKq2MgQYZm\r\nZMnw5azDCgheeFMRkS8=\r\n</ds:SignatureValue>\r\n        <ds:KeyInfo Id=\"KeyId-1497874461\">\r\n          <wsse:SecurityTokenReference wsu:Id=\"STRId-1108267618\"\r\n            xmlns:wsse=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd\" xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\">\r\n            <wsse:Reference URI=\"#CertId-1523501\"\r\n              ValueType=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3\" xmlns:wsse=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd\"/>\r\n          </wsse:SecurityTokenReference>\r\n        </ds:KeyInfo>\r\n      </ds:Signature>\r\n    </wsse:Security>\r\n  </soap:Header>\r\n  <soap:Body wsu:Id=\"id-1473766991\"\r\n    xmlns:ns1=\"http://ec2.amazonaws.com/doc/2012-12-01/\" xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\">\r\n    <ns1:DescribeImages>\r\n      <ns1:executableBySet/>\r\n      <ns1:imagesSet>\r\n        <ns1:item>\r\n          <ns1:imageId>ami-7750211e</ns1:imageId>\r\n        </ns1:item>\r\n      </ns1:imagesSet>\r\n      <ns1:ownersSet/>\r\n      <ns1:filterSet/>\r\n    </ns1:DescribeImages>\r\n  </soap:Body>\r\n</soap:Envelope>\r\n\r\n------------------------------------------------------------------------\r\n------------------------------[ RESPONSE ]------------------------------\r\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<soap:Envelope xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\">\r\n  <soap:Body>\r\n    <DescribeImagesResponse xmlns=\"http://ec2.amazonaws.com/doc/2012-12-01/\">\r\n      <requestId>9f4bd710-2ec4-4f23-a921-12514ba368e7</requestId>\r\n      <imagesSet/>\r\n    </DescribeImagesResponse>\r\n  </soap:Body>\r\n</soap:Envelope>\r\n\r\n------------------------------------------------------------------------\r\neuca-prod-1-82:~ haroldspencerjr$ ec2-deregister ami-7750211e --verbose\r\nSetting User-Agent to [ec2-api-tools 1.6.6.0]\r\nSetting User-Agent to [ec2-api-tools 1.6.6.0]\r\n------------------------------[ REQUEST ]-------------------------------\r\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<soap:Envelope xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\"\r\n  xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\">\r\n  <soap:Header>\r\n    <wsse:Security xmlns:wsse=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd\">\r\n      <wsu:Timestamp wsu:Id=\"Timestamp-806542204\" xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\">\r\n        <wsu:Created xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\">2013-06-18T14:23:10.672Z</wsu:Created>\r\n        <wsu:Expires xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\">2013-06-18T14:28:10.672Z</wsu:Expires>\r\n      </wsu:Timestamp>\r\n      <wsse:BinarySecurityToken\r\n        EncodingType=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary\"\r\n        ValueType=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3\"\r\n        wsu:Id=\"CertId-1523501\"\r\n        xmlns:wsse=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd\" xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\">MIICeDCCAeGgAwIBAgIGANNolQ59MA0GCSqGSIb3DQEBBQUAMFMxCzAJBgNVBAYTAlVTMRMwEQYDVQQKEwpBbWF6b24uY29tMQwwCgYDVQQLEwNBV1MxITAfBgNVBAMTGEFXUyBMaW1pdGVkLUFzc3VyYW5jZSBDQTAeFw0xMTEyMjQxNzI4MjVaFw0xMjEyMjMxNzI4MjVaMFMxCzAJBgNVBAYTAlVTMRMwEQYDVQQKEwpBbWF6b24uY29tMRcwFQYDVQQLEw5BV1MtRGV2ZWxvcGVyczEWMBQGA1UEAxMNMXdqNjI2b21mNXI3ajCBnzANBgkqhkiG9w0BAQEFAAOBjQAwgYkCgYEA0ZeYyErvPOm93oKgrb0FAggAJRY3fypO639jLcj7vw2BfWzgFp7JZflV2w1gCZx09erSO8HTp6rrNovDZ1/XnDqsUZ3IOjRvxD/XI/nIz4rDB1QfChrpDWISj00DcNJ7sC1X5Ak4ZbpXlEcI6PrjB3qAP6rbBiKu23WOnGmyeLkCAwEAAaNXMFUwDgYDVR0PAQH/BAQDAgWgMBYGA1UdJQEB/wQMMAoGCCsGAQUFBwMCMAwGA1UdEwEB/wQCMAAwHQYDVR0OBBYEFFmrDoKt08EkSfGgnL7H4hGdm1+DMA0GCSqGSIb3DQEBBQUAA4GBAGKnrmvlQ24TstFb2BDtRgcYv3Pq3D7yrrO/9ARpfPQAdSFa63XDtx3eKpG62YquaUSen0Cbjkyl/Hrrskfy66fJLMuUIjtJbT+8TIGtNuBSWwJ5PsTGeNgDB/XRoA5X/V/+B3TXBebUphBk0JUdkB8WYXQVEHOP+NE7VLc966Bx</wsse:BinarySecurityToken>\r\n      <ds:Signature Id=\"Signature-1844781148\" xmlns:ds=\"http://www.w3.org/2000/09/xmldsig#\">\r\n        <ds:SignedInfo>\r\n          <ds:CanonicalizationMethod Algorithm=\"http://www.w3.org/2001/10/xml-exc-c14n#\"/>\r\n          <ds:SignatureMethod Algorithm=\"http://www.w3.org/2000/09/xmldsig#rsa-sha1\"/>\r\n          <ds:Reference URI=\"#Timestamp-806542204\">\r\n            <ds:Transforms>\r\n              <ds:Transform Algorithm=\"http://www.w3.org/2001/10/xml-exc-c14n#\"/>\r\n            </ds:Transforms>\r\n            <ds:DigestMethod Algorithm=\"http://www.w3.org/2000/09/xmldsig#sha1\"/>\r\n            <ds:DigestValue>1vlKRF9D89EJTDT7CQbAqUmuFLE=</ds:DigestValue>\r\n          </ds:Reference>\r\n          <ds:Reference URI=\"#id-2063323644\">\r\n            <ds:Transforms>\r\n              <ds:Transform Algorithm=\"http://www.w3.org/2001/10/xml-exc-c14n#\"/>\r\n            </ds:Transforms>\r\n            <ds:DigestMethod Algorithm=\"http://www.w3.org/2000/09/xmldsig#sha1\"/>\r\n            <ds:DigestValue>72pFZTjxql53F9llMM4ab77TL/0=</ds:DigestValue>\r\n          </ds:Reference>\r\n        </ds:SignedInfo>\r\n        <ds:SignatureValue>\r\nU5qBrra0Sn0zjKjEfZ/yigPnR6SwvZTJvrEf0HausHNEWSOXzRCIL2yZJ7hqAzEgfEMI04ELq4Ed\r\nYc4JE/mVqsPqicnrD3GL3RU1B0kumC6WTsCli0YsSJdXgn+jkHIfrUtznFxbjWZt4jiYxlpre0fG\r\njr/7Nj0IVjKMHn3Gy+s=\r\n</ds:SignatureValue>\r\n        <ds:KeyInfo Id=\"KeyId-1752627995\">\r\n          <wsse:SecurityTokenReference wsu:Id=\"STRId-1932933332\"\r\n            xmlns:wsse=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd\" xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\">\r\n            <wsse:Reference URI=\"#CertId-1523501\"\r\n              ValueType=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3\" xmlns:wsse=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd\"/>\r\n          </wsse:SecurityTokenReference>\r\n        </ds:KeyInfo>\r\n      </ds:Signature>\r\n    </wsse:Security>\r\n  </soap:Header>\r\n  <soap:Body wsu:Id=\"id-2063323644\"\r\n    xmlns:ns1=\"http://ec2.amazonaws.com/doc/2012-12-01/\" xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\">\r\n    <ns1:DeregisterImage>\r\n      <ns1:imageId>ami-7750211e</ns1:imageId>\r\n    </ns1:DeregisterImage>\r\n  </soap:Body>\r\n</soap:Envelope>\r\n\r\n------------------------------------------------------------------------\r\nClient.InvalidAMIID.Unavailable: The image ID 'ami-7750211e' is no longer available\r\neuca-prod-1-82:~ haroldspencerjr$ ec2-describe-images ami-7750211e --verbose\r\nSetting User-Agent to [ec2-api-tools 1.6.6.0]\r\nSetting User-Agent to [ec2-api-tools 1.6.6.0]\r\n------------------------------[ REQUEST ]-------------------------------\r\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<soap:Envelope xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\"\r\n  xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\">\r\n  <soap:Header>\r\n    <wsse:Security xmlns:wsse=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd\">\r\n      <wsu:Timestamp wsu:Id=\"Timestamp-1530577229\" xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\">\r\n        <wsu:Created xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\">2013-06-18T14:28:58.141Z</wsu:Created>\r\n        <wsu:Expires xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\">2013-06-18T14:33:58.141Z</wsu:Expires>\r\n      </wsu:Timestamp>\r\n      <wsse:BinarySecurityToken\r\n        EncodingType=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary\"\r\n        ValueType=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3\"\r\n        wsu:Id=\"CertId-1523501\"\r\n        xmlns:wsse=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd\" xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\">MIICeDCCAeGgAwIBAgIGANNolQ59MA0GCSqGSIb3DQEBBQUAMFMxCzAJBgNVBAYTAlVTMRMwEQYDVQQKEwpBbWF6b24uY29tMQwwCgYDVQQLEwNBV1MxITAfBgNVBAMTGEFXUyBMaW1pdGVkLUFzc3VyYW5jZSBDQTAeFw0xMTEyMjQxNzI4MjVaFw0xMjEyMjMxNzI4MjVaMFMxCzAJBgNVBAYTAlVTMRMwEQYDVQQKEwpBbWF6b24uY29tMRcwFQYDVQQLEw5BV1MtRGV2ZWxvcGVyczEWMBQGA1UEAxMNMXdqNjI2b21mNXI3ajCBnzANBgkqhkiG9w0BAQEFAAOBjQAwgYkCgYEA0ZeYyErvPOm93oKgrb0FAggAJRY3fypO639jLcj7vw2BfWzgFp7JZflV2w1gCZx09erSO8HTp6rrNovDZ1/XnDqsUZ3IOjRvxD/XI/nIz4rDB1QfChrpDWISj00DcNJ7sC1X5Ak4ZbpXlEcI6PrjB3qAP6rbBiKu23WOnGmyeLkCAwEAAaNXMFUwDgYDVR0PAQH/BAQDAgWgMBYGA1UdJQEB/wQMMAoGCCsGAQUFBwMCMAwGA1UdEwEB/wQCMAAwHQYDVR0OBBYEFFmrDoKt08EkSfGgnL7H4hGdm1+DMA0GCSqGSIb3DQEBBQUAA4GBAGKnrmvlQ24TstFb2BDtRgcYv3Pq3D7yrrO/9ARpfPQAdSFa63XDtx3eKpG62YquaUSen0Cbjkyl/Hrrskfy66fJLMuUIjtJbT+8TIGtNuBSWwJ5PsTGeNgDB/XRoA5X/V/+B3TXBebUphBk0JUdkB8WYXQVEHOP+NE7VLc966Bx</wsse:BinarySecurityToken>\r\n      <ds:Signature Id=\"Signature-1948387089\" xmlns:ds=\"http://www.w3.org/2000/09/xmldsig#\">\r\n        <ds:SignedInfo>\r\n          <ds:CanonicalizationMethod Algorithm=\"http://www.w3.org/2001/10/xml-exc-c14n#\"/>\r\n          <ds:SignatureMethod Algorithm=\"http://www.w3.org/2000/09/xmldsig#rsa-sha1\"/>\r\n          <ds:Reference URI=\"#Timestamp-1530577229\">\r\n            <ds:Transforms>\r\n              <ds:Transform Algorithm=\"http://www.w3.org/2001/10/xml-exc-c14n#\"/>\r\n            </ds:Transforms>\r\n            <ds:DigestMethod Algorithm=\"http://www.w3.org/2000/09/xmldsig#sha1\"/>\r\n            <ds:DigestValue>XkxUC8Rp6cnCUCchtf+eJ6b0m+I=</ds:DigestValue>\r\n          </ds:Reference>\r\n          <ds:Reference URI=\"#id-451360643\">\r\n            <ds:Transforms>\r\n              <ds:Transform Algorithm=\"http://www.w3.org/2001/10/xml-exc-c14n#\"/>\r\n            </ds:Transforms>\r\n            <ds:DigestMethod Algorithm=\"http://www.w3.org/2000/09/xmldsig#sha1\"/>\r\n            <ds:DigestValue>ULSaGFwMe7NplUolh9yfnKM7vwM=</ds:DigestValue>\r\n          </ds:Reference>\r\n        </ds:SignedInfo>\r\n        <ds:SignatureValue>\r\ncvnIdGLCMqDxY/KQsfWyBfcmGhM1J3B+qfanXIE6rMotXvREvyp0wu3ABguyM1mRms6ZVKGi9SAT\r\n0RGuBRj0fAgohmh64f+w84TMT+clrugKjWCrY7fmKUOi8Qr+t9hWAOLbSUfDcWJ0HbiO+mniTr7i\r\n4IZF9zaEbkWiX2LTbTo=\r\n</ds:SignatureValue>\r\n        <ds:KeyInfo Id=\"KeyId-287252545\">\r\n          <wsse:SecurityTokenReference wsu:Id=\"STRId-875733797\"\r\n            xmlns:wsse=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd\" xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\">\r\n            <wsse:Reference URI=\"#CertId-1523501\"\r\n              ValueType=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3\" xmlns:wsse=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd\"/>\r\n          </wsse:SecurityTokenReference>\r\n        </ds:KeyInfo>\r\n      </ds:Signature>\r\n    </wsse:Security>\r\n  </soap:Header>\r\n  <soap:Body wsu:Id=\"id-451360643\"\r\n    xmlns:ns1=\"http://ec2.amazonaws.com/doc/2012-12-01/\" xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\">\r\n    <ns1:DescribeImages>\r\n      <ns1:executableBySet/>\r\n      <ns1:imagesSet>\r\n        <ns1:item>\r\n          <ns1:imageId>ami-7750211e</ns1:imageId>\r\n        </ns1:item>\r\n      </ns1:imagesSet>\r\n      <ns1:ownersSet/>\r\n      <ns1:filterSet/>\r\n    </ns1:DescribeImages>\r\n  </soap:Body>\r\n</soap:Envelope>\r\n\r\n------------------------------------------------------------------------\r\n------------------------------[ RESPONSE ]------------------------------\r\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<soap:Envelope xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\">\r\n  <soap:Body>\r\n    <DescribeImagesResponse xmlns=\"http://ec2.amazonaws.com/doc/2012-12-01/\">\r\n      <requestId>c181b6bb-04a5-4c11-887a-6bf72fa2d49e</requestId>\r\n      <imagesSet/>\r\n    </DescribeImagesResponse>\r\n  </soap:Body>\r\n</soap:Envelope>\r\n\r\n------------------------------------------------------------------------\r\n{code}","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=hspencer","name":"hspencer","key":"hspencer","accountId":"557058:4a3a93bc-21f8-4658-9f5b-9cb484c910a7","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue"},"displayName":"Harold Spencer Jr.","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-06-18T09:32:19.596-0500","updated":"2013-06-18T09:32:19.596-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/21913/comment/47785","id":"47785","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=kedwards","name":"kedwards","key":"kedwards","accountId":"557058:f9c2f8da-1fc6-4aa7-8fb0-750e7e422b6b","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/d1746a6d05a30ca027012a7da4545962?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dkedwards%26avatarId%3D10200%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/d1746a6d05a30ca027012a7da4545962?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dkedwards%26avatarId%3D10200%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/d1746a6d05a30ca027012a7da4545962?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dkedwards%26avatarId%3D10200%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/d1746a6d05a30ca027012a7da4545962?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dkedwards%26avatarId%3D10200%26noRedirect%3Dtrue"},"displayName":"Ken Edwards","active":true,"timeZone":"America/Los_Angeles"},"body":"slated for the next engineering bug scrub","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=kedwards","name":"kedwards","key":"kedwards","accountId":"557058:f9c2f8da-1fc6-4aa7-8fb0-750e7e422b6b","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/d1746a6d05a30ca027012a7da4545962?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dkedwards%26avatarId%3D10200%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/d1746a6d05a30ca027012a7da4545962?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dkedwards%26avatarId%3D10200%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/d1746a6d05a30ca027012a7da4545962?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dkedwards%26avatarId%3D10200%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/d1746a6d05a30ca027012a7da4545962?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dkedwards%26avatarId%3D10200%26noRedirect%3Dtrue"},"displayName":"Ken Edwards","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-06-18T11:39:37.016-0500","updated":"2013-06-18T11:39:37.016-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/21913/comment/49007","id":"49007","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=hspencer","name":"hspencer","key":"hspencer","accountId":"557058:4a3a93bc-21f8-4658-9f5b-9cb484c910a7","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue"},"displayName":"Harold Spencer Jr.","active":true,"timeZone":"America/Los_Angeles"},"body":"This may be a regression and a dup of EUCA-590 and/or EUCA-1227. It looks like it, but would like a second set of eyes to confirm.","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=hspencer","name":"hspencer","key":"hspencer","accountId":"557058:4a3a93bc-21f8-4658-9f5b-9cb484c910a7","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue"},"displayName":"Harold Spencer Jr.","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-06-27T07:30:40.231-0500","updated":"2013-06-27T07:30:40.231-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/21913/comment/50395","id":"50395","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=mmunn1","name":"mmunn1","key":"mmunn1","accountId":"557058:6e62b7e8-e48f-469d-ac54-e9449dec5cd9","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue"},"displayName":"Michael Munn","active":true,"timeZone":"America/Los_Angeles"},"body":"Code Review Request : \r\n\r\nbranch : dev/mmunn1/EUCA-6559\r\n\r\ndiff :  git show --color d949b8c94c7d2aeaa890b634a26749cb35f961aa\r\n\r\nSummary: The first time euca-deregister is called on an image it is just set to the 'deregistered' state\r\n         it is not deleted from the database, it is only deleted the second time euca-deregister is called.\r\n         This doesn't match the behavior seen on AWS where it is deleted on the firs call.\r\n\r\n\r\nSolution:  delete the image ImageInfo on the first call to  euca-deregister\r\n \r\n\r\nUnit test :\r\neuca-deregister should remove ImageInfo the first time and never set images to the 'deregistered'\r\n\r\n\r\nI have created eutester/testcases/cloud_admin/3-3/Euca6559\r\n\r\nThx Mike","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=mmunn1","name":"mmunn1","key":"mmunn1","accountId":"557058:6e62b7e8-e48f-469d-ac54-e9449dec5cd9","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue"},"displayName":"Michael Munn","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-07-25T16:08:16.712-0500","updated":"2013-07-25T16:08:16.712-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/21913/comment/50396","id":"50396","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=sjones","name":"sjones","key":"sjones","accountId":"557058:f5dce1b0-db45-4dd6-a0e8-3cea5effb5ce","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue"},"displayName":"Steve Jones","active":true,"timeZone":"America/Los_Angeles"},"body":"[~mmunn1], what happens when an instance is running that references the image? i.e. you run an instance using the image and then try to delete the image.","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=sjones","name":"sjones","key":"sjones","accountId":"557058:f5dce1b0-db45-4dd6-a0e8-3cea5effb5ce","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue"},"displayName":"Steve Jones","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-07-25T16:16:27.898-0500","updated":"2013-07-25T16:16:27.898-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/21913/comment/50399","id":"50399","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=mmunn1","name":"mmunn1","key":"mmunn1","accountId":"557058:6e62b7e8-e48f-469d-ac54-e9449dec5cd9","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue"},"displayName":"Michael Munn","active":true,"timeZone":"America/Los_Angeles"},"body":"I will test it and get back to you , I am bringing up a new setup.\r\n\r\n\r\nOn Thu, Jul 25, 2013 at 2:18 PM, Steve Jones (JIRA) <\r\n\r\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=mmunn1","name":"mmunn1","key":"mmunn1","accountId":"557058:6e62b7e8-e48f-469d-ac54-e9449dec5cd9","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue"},"displayName":"Michael Munn","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-07-25T16:28:11.889-0500","updated":"2013-07-25T16:28:11.889-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/21913/comment/50410","id":"50410","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=mmunn1","name":"mmunn1","key":"mmunn1","accountId":"557058:6e62b7e8-e48f-469d-ac54-e9449dec5cd9","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue"},"displayName":"Michael Munn","active":true,"timeZone":"America/Los_Angeles"},"body":"{code}\r\nCalling euca-deregister against an image with a running instance.\r\n   Without the fix:\r\n         The first time you run euca-deregister it sets the state to \"deregistered' and it returns the ImageID\r\n         The second time you run it with against the same ImageID you get the error: \r\n         euca-deregister: error (DeregisterImageType): To deregister emi-223C3703 all associated instances must be in the terminated state.\r\n   With the fix:\r\n         The first time you run euca-deregister you get the error:\r\n         euca-deregister: error (DeregisterImageType): To deregister emi-223C3703 all associated instances must be in the terminated state. \r\n{code}\r\nThe fix works as expected.","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=mmunn1","name":"mmunn1","key":"mmunn1","accountId":"557058:6e62b7e8-e48f-469d-ac54-e9449dec5cd9","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue"},"displayName":"Michael Munn","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-07-25T18:14:48.804-0500","updated":"2013-07-25T18:18:12.363-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/21913/comment/50411","id":"50411","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=sjones","name":"sjones","key":"sjones","accountId":"557058:f5dce1b0-db45-4dd6-a0e8-3cea5effb5ce","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue"},"displayName":"Steve Jones","active":true,"timeZone":"America/Los_Angeles"},"body":"I don't think that is consistent with AWS behaviour. In AWS I believe you can deregister an image that is being used.\n\nIt sounds like with this fix in place you can no longer prevent further use of an image for which instances are running. It seems important to be able to deregister even if there are running instances so you can stop further use of an image.","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=sjones","name":"sjones","key":"sjones","accountId":"557058:f5dce1b0-db45-4dd6-a0e8-3cea5effb5ce","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue"},"displayName":"Steve Jones","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-07-25T18:24:05.631-0500","updated":"2013-07-25T18:24:05.631-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/21913/comment/50412","id":"50412","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=mmunn1","name":"mmunn1","key":"mmunn1","accountId":"557058:6e62b7e8-e48f-469d-ac54-e9449dec5cd9","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue"},"displayName":"Michael Munn","active":true,"timeZone":"America/Los_Angeles"},"body":"I will look into it.","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=mmunn1","name":"mmunn1","key":"mmunn1","accountId":"557058:6e62b7e8-e48f-469d-ac54-e9449dec5cd9","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue"},"displayName":"Michael Munn","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-07-25T18:29:15.510-0500","updated":"2013-07-25T18:29:15.510-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/21913/comment/50531","id":"50531","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=mmunn1","name":"mmunn1","key":"mmunn1","accountId":"557058:6e62b7e8-e48f-469d-ac54-e9449dec5cd9","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue"},"displayName":"Michael Munn","active":true,"timeZone":"America/Los_Angeles"},"body":"[~sjones] : AWS does in fact let you deregister images that have running associated instances:  see http://aws.amazon.com/articles/Amazon-EC2/637\n\nTo deregister images associated with running instances in eucalyptus I believe we would need to alter the metadata_instances foreign key constraint fkf1c9856e63e1b9fd to use 'ON DELETE CASCADE' as opposed  to the current use of 'ON DELETE NO ACTION' (see below)\n\nDB = eucalyptus_cloud\n\nALTER TABLE metadata_instances\n  ADD CONSTRAINT fkf1c9856e63e1b9fd FOREIGN KEY (machineimage_id)\n      REFERENCES metadata_images (id) MATCH SIMPLE\n      ON UPDATE NO ACTION ON DELETE NO ACTION;\n      \nALTER TABLE metadata_instances\n  ADD CONSTRAINT fkf1c9856e63e1b9fd FOREIGN KEY (machineimage_id)\n      REFERENCES metadata_images (id) MATCH SIMPLE\n      ON UPDATE NO ACTION ON DELETE CASCADE;\n      \nWhere exactly would I make theses changes in the code taking into account\nupgrades?","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=mmunn1","name":"mmunn1","key":"mmunn1","accountId":"557058:6e62b7e8-e48f-469d-ac54-e9449dec5cd9","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue"},"displayName":"Michael Munn","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-07-29T14:33:13.302-0500","updated":"2013-07-29T14:33:13.302-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/21913/comment/50534","id":"50534","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=sjones","name":"sjones","key":"sjones","accountId":"557058:f5dce1b0-db45-4dd6-a0e8-3cea5effb5ce","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue"},"displayName":"Steve Jones","active":true,"timeZone":"America/Los_Angeles"},"body":"[~mmunn1], I suggest the following approach for this issue:\n\n1) Do not include images in the deregistered state in the response for DescribeImages unless the verbose option is used (cloud admin only)\n2) Add a clean up task that periodically deletes any deregistered images for which there are no running instances.\n\nThe cloud administrator should still be able to delete images in the deregistered state. Regular accounts / users would not be able to interact with deregistered images, and perhaps deregistered images should not count towards a users image quota.","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=sjones","name":"sjones","key":"sjones","accountId":"557058:f5dce1b0-db45-4dd6-a0e8-3cea5effb5ce","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue"},"displayName":"Steve Jones","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-07-29T15:00:02.280-0500","updated":"2013-07-29T15:00:02.280-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/21913/comment/50539","id":"50539","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=mmunn1","name":"mmunn1","key":"mmunn1","accountId":"557058:6e62b7e8-e48f-469d-ac54-e9449dec5cd9","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue"},"displayName":"Michael Munn","active":true,"timeZone":"America/Los_Angeles"},"body":"That makes sense Steve. I agree, I think that deregistered images should not count towards a users image quota. I will use your approach.\nThanks!","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=mmunn1","name":"mmunn1","key":"mmunn1","accountId":"557058:6e62b7e8-e48f-469d-ac54-e9449dec5cd9","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue"},"displayName":"Michael Munn","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-07-29T15:44:06.166-0500","updated":"2013-07-29T15:44:06.166-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/21913/comment/50595","id":"50595","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=mmunn1","name":"mmunn1","key":"mmunn1","accountId":"557058:6e62b7e8-e48f-469d-ac54-e9449dec5cd9","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue"},"displayName":"Michael Munn","active":true,"timeZone":"America/Los_Angeles"},"body":"[~sjones] The method ImageUtil.cleanDeregistered( ) does not do anything because the db.query( Images.exampleWithImageState( ImageMetadata.State.deregistered ) always returns an empty list, even when there are in fact deregistered images? What am I missing here?","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=mmunn1","name":"mmunn1","key":"mmunn1","accountId":"557058:6e62b7e8-e48f-469d-ac54-e9449dec5cd9","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue"},"displayName":"Michael Munn","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-07-30T13:10:50.688-0500","updated":"2013-07-30T13:10:50.688-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/21913/comment/50597","id":"50597","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=sjones","name":"sjones","key":"sjones","accountId":"557058:f5dce1b0-db45-4dd6-a0e8-3cea5effb5ce","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue"},"displayName":"Steve Jones","active":true,"timeZone":"America/Los_Angeles"},"body":"[~mmunn1], the method AbstractStatefulPersistent.setState records the stack if debug mode is enabled. For QBE to work you will need to ensure the value for the stack is cleared as it will not match (i.e. \"setStateChangeStack(null)\")","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=sjones","name":"sjones","key":"sjones","accountId":"557058:f5dce1b0-db45-4dd6-a0e8-3cea5effb5ce","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue"},"displayName":"Steve Jones","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-07-30T13:23:29.480-0500","updated":"2013-07-30T13:23:29.480-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/21913/comment/50603","id":"50603","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=mmunn1","name":"mmunn1","key":"mmunn1","accountId":"557058:6e62b7e8-e48f-469d-ac54-e9449dec5cd9","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue"},"displayName":"Michael Munn","active":true,"timeZone":"America/Los_Angeles"},"body":"[~sjones] setStateChangeStack(null) seems to have no effect?  I still always get an empty list?  I even set 'this.stateChangeStack' to null and  \"n/a\" directly in the AbstractStatefulPersistent.setState method?","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=mmunn1","name":"mmunn1","key":"mmunn1","accountId":"557058:6e62b7e8-e48f-469d-ac54-e9449dec5cd9","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue"},"displayName":"Michael Munn","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-07-30T14:23:05.273-0500","updated":"2013-07-30T14:23:05.273-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/21913/comment/50622","id":"50622","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=sjones","name":"sjones","key":"sjones","accountId":"557058:f5dce1b0-db45-4dd6-a0e8-3cea5effb5ce","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue"},"displayName":"Steve Jones","active":true,"timeZone":"America/Los_Angeles"},"body":"[~mmunn1], you probably need to also set the last state (\"\"setLastState(null)\"). If you are not sure what fields are set on an object you can create a unit test and look at it in the debugger. Alternatively you can log Hibernate queries to see what is generated for your example object.","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=sjones","name":"sjones","key":"sjones","accountId":"557058:f5dce1b0-db45-4dd6-a0e8-3cea5effb5ce","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue"},"displayName":"Steve Jones","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-07-30T16:01:58.455-0500","updated":"2013-07-30T16:01:58.455-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/21913/comment/50640","id":"50640","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=mmunn1","name":"mmunn1","key":"mmunn1","accountId":"557058:6e62b7e8-e48f-469d-ac54-e9449dec5cd9","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue"},"displayName":"Michael Munn","active":true,"timeZone":"America/Los_Angeles"},"body":"[~sjones] Looking at this in the debugger everything in the ImageInfo object returned by Images.exampleWithImageState( ImageMetadata.State.deregistered ) is set to null except 'state' which is set to 'deregistered'  and metaClass which is set to 'MyMetaClass'. The above is still returning and empty list?   I cannot see how to set the MetaClass to null? Any suggestions?  \nhere are my changes:\n+++ b/clc/modules/cluster-manager/src/main/java/com/eucalyptus/images/Images.java\n@@ -585,6 +585,8 @@ public class Images {\n     ImageInfo img = new ImageInfo( ) {\n       {\n         setState( state );\n+        setStateChangeStack(null);\n+        setLastState(null);\n       }\n     };\n\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=mmunn1","name":"mmunn1","key":"mmunn1","accountId":"557058:6e62b7e8-e48f-469d-ac54-e9449dec5cd9","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue"},"displayName":"Michael Munn","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-07-30T18:34:27.804-0500","updated":"2013-07-30T18:34:27.804-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/21913/comment/50776","id":"50776","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=sjones","name":"sjones","key":"sjones","accountId":"557058:f5dce1b0-db45-4dd6-a0e8-3cea5effb5ce","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue"},"displayName":"Steve Jones","active":true,"timeZone":"America/Los_Angeles"},"body":"[~mmunn1], the following works for me:\n\n{code}\n    final ImageInfo img = new ImageInfo( );\n    img.setState( state );\n    img.setStateChangeStack( null );\n    img.setLastState( null );\n{code}","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=sjones","name":"sjones","key":"sjones","accountId":"557058:f5dce1b0-db45-4dd6-a0e8-3cea5effb5ce","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue"},"displayName":"Steve Jones","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-08-01T14:27:32.564-0500","updated":"2013-08-01T14:27:32.564-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/21913/comment/50810","id":"50810","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=mmunn1","name":"mmunn1","key":"mmunn1","accountId":"557058:6e62b7e8-e48f-469d-ac54-e9449dec5cd9","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue"},"displayName":"Michael Munn","active":true,"timeZone":"America/Los_Angeles"},"body":"[~sjones] The above just does not work for me db.query( Images.exampleWithImageState( ImageMetadata.State.deregistered )  still returns an empty list and the deregistered images remain in the euca-describe-images output.  What am I missing? I am testing this against 3.1.1. on qa machine 10.111.1.12.","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=mmunn1","name":"mmunn1","key":"mmunn1","accountId":"557058:6e62b7e8-e48f-469d-ac54-e9449dec5cd9","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue"},"displayName":"Michael Munn","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-08-02T00:18:22.953-0500","updated":"2013-08-02T00:18:22.953-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/21913/comment/50811","id":"50811","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=sjones","name":"sjones","key":"sjones","accountId":"557058:f5dce1b0-db45-4dd6-a0e8-3cea5effb5ce","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue"},"displayName":"Steve Jones","active":true,"timeZone":"America/Los_Angeles"},"body":"[~mmunn1], here's the full updated function I used (tested with the 3.3.0 tag):\n\n{code}\n  public static ImageInfo exampleWithImageState( final ImageMetadata.State state ) {\n    final ImageInfo img = new ImageInfo( );\n    img.setState( state );\n    img.setStateChangeStack( null );\n    img.setLastState( null );\n    return img;\n  }\n{code}\n\nIt is important not to use an anonymous subclass for the example object as was done previously.","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=sjones","name":"sjones","key":"sjones","accountId":"557058:f5dce1b0-db45-4dd6-a0e8-3cea5effb5ce","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue"},"displayName":"Steve Jones","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-08-02T00:56:24.219-0500","updated":"2013-08-02T00:56:24.219-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/21913/comment/50820","id":"50820","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=mmunn1","name":"mmunn1","key":"mmunn1","accountId":"557058:6e62b7e8-e48f-469d-ac54-e9449dec5cd9","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue"},"displayName":"Michael Munn","active":true,"timeZone":"America/Los_Angeles"},"body":"[~sjones] Thanks removing the anonymous subclass works,  although I am unclear why?","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=mmunn1","name":"mmunn1","key":"mmunn1","accountId":"557058:6e62b7e8-e48f-469d-ac54-e9449dec5cd9","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue"},"displayName":"Michael Munn","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-08-02T08:33:12.251-0500","updated":"2013-08-02T08:33:12.251-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/21913/comment/51001","id":"51001","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=mmunn1","name":"mmunn1","key":"mmunn1","accountId":"557058:6e62b7e8-e48f-469d-ac54-e9449dec5cd9","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue"},"displayName":"Michael Munn","active":true,"timeZone":"America/Los_Angeles"},"body":"Code Review Request #2 :\nbranch : dev/mmunn1/EUCA-6559\ndiff : git show --color  0dd88fcc9c964633ee61507897564154b21bc336\nSummary: The first time euca-deregister is called on an image it is just set to the 'deregistered' state\nit is not deleted from the database, it is only deleted the second time euca-deregister is called.\nThis doesn't match the behavior seen on AWS where it is deleted on the first call.\n\nSolution: I changed the fix so that the non-admin user does not see images in the deregistered state when \nusing euca-describe-images, only the admin will see deregistered images listed. The ImageUtil.cleanDeregistered \nis now working and I moved it to the beginning of the ImageManager.describe method so that all dergeistered \nimages not associated with a running instance will be removed from the DB and not listed by the describe method. \nNow when the describe method is run only dergeistered images still associated with a 'running\" instance will be \nleft in the DB and they will only be visible to the admin.\n\nUnit test :\neuca-deregister followed by euca-describe-images will not list deregistered images for non-admin users.\nFor admin users euca-describe-images will list only deregistered images that have not been fully removed \nbecause they are still associated with a running image. \nI have created eutester/testcases/cloud_admin/3-3/Euca6559\nThx Mike","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=mmunn1","name":"mmunn1","key":"mmunn1","accountId":"557058:6e62b7e8-e48f-469d-ac54-e9449dec5cd9","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue"},"displayName":"Michael Munn","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-08-06T17:10:17.906-0500","updated":"2013-08-06T17:10:17.906-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/21913/comment/51005","id":"51005","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=sjones","name":"sjones","key":"sjones","accountId":"557058:f5dce1b0-db45-4dd6-a0e8-3cea5effb5ce","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue"},"displayName":"Steve Jones","active":true,"timeZone":"America/Los_Angeles"},"body":"[~mmunn1], this looks OK to me though it does not address the following from the bug description:\n\n{quote}\nAfter running euca-deregister on an image the first time, the second time its ran, we should respond with the error InvalidAMIID.Unavailable per AWS behavior.\n{quote}","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=sjones","name":"sjones","key":"sjones","accountId":"557058:f5dce1b0-db45-4dd6-a0e8-3cea5effb5ce","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue"},"displayName":"Steve Jones","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-08-06T17:32:41.940-0500","updated":"2013-08-06T17:32:41.940-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/21913/comment/51012","id":"51012","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=mmunn1","name":"mmunn1","key":"mmunn1","accountId":"557058:6e62b7e8-e48f-469d-ac54-e9449dec5cd9","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue"},"displayName":"Michael Munn","active":true,"timeZone":"America/Los_Angeles"},"body":"I have added a call to ImageUtil.cleanDeregistered();  in Images.deregisterImage to address the above, the error is different but the result is effectively the same.\ndiff : git show --color 733805946d828d60501ff7a2aa7a13af817e9b23\n\nThe new output is:\n[b-12:~]euca-register fedora-testbucket/euca-fedora17-ec2user-2013.07.04-x86_64.img.manifest.xml --name mike\nIMAGE\temi-380A3371\n[b-12:~]euca-deregister emi-380A3371\nIMAGE\temi-380A3371\n[b-12:~]euca-deregister emi-380A3371\neuca-deregister: error (DeregisterImageType): The image id '[emi-380A3371]' does not exist\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=mmunn1","name":"mmunn1","key":"mmunn1","accountId":"557058:6e62b7e8-e48f-469d-ac54-e9449dec5cd9","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue"},"displayName":"Michael Munn","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-08-06T18:10:19.144-0500","updated":"2013-08-06T18:10:19.144-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/21913/comment/51014","id":"51014","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=sjones","name":"sjones","key":"sjones","accountId":"557058:f5dce1b0-db45-4dd6-a0e8-3cea5effb5ce","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue"},"displayName":"Steve Jones","active":true,"timeZone":"America/Los_Angeles"},"body":"[~mmunn1], I think the proposed fix does not work if the image is still in use (so is present but in the deregistered state). The EC2 service can now (as of 3.4) respond with correct error codes, so ideally we could throw an appropriate ClientComputeException for this error case.","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=sjones","name":"sjones","key":"sjones","accountId":"557058:f5dce1b0-db45-4dd6-a0e8-3cea5effb5ce","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue"},"displayName":"Steve Jones","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-08-06T18:25:50.937-0500","updated":"2013-08-06T18:25:50.937-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/21913/comment/51017","id":"51017","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=mmunn1","name":"mmunn1","key":"mmunn1","accountId":"557058:6e62b7e8-e48f-469d-ac54-e9449dec5cd9","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue"},"displayName":"Michael Munn","active":true,"timeZone":"America/Los_Angeles"},"body":"[~sjones] The fix does work if the image is sill in use i.e. an associated running image. The call to ImageUtil.cleanDeregistered() removes only the images with no associated running instances and swallows the InstanceNotTerminatedException. I will take a look at the ClientComputeException.","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=mmunn1","name":"mmunn1","key":"mmunn1","accountId":"557058:6e62b7e8-e48f-469d-ac54-e9449dec5cd9","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue"},"displayName":"Michael Munn","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-08-06T18:34:01.905-0500","updated":"2013-08-06T18:34:19.998-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/21913/comment/51019","id":"51019","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=mmunn1","name":"mmunn1","key":"mmunn1","accountId":"557058:6e62b7e8-e48f-469d-ac54-e9449dec5cd9","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue"},"displayName":"Michael Munn","active":true,"timeZone":"America/Los_Angeles"},"body":"[~sjones] I see what you are saying now,  the second time a user deregisters the same image with an associated running instance he will get an InstanceNotTerminatedException. I will change this so only the admin will see this error and I will look into using the ClientComputeException.","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=mmunn1","name":"mmunn1","key":"mmunn1","accountId":"557058:6e62b7e8-e48f-469d-ac54-e9449dec5cd9","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue"},"displayName":"Michael Munn","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-08-06T18:45:41.195-0500","updated":"2013-08-06T18:45:41.195-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/21913/comment/51085","id":"51085","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=mmunn1","name":"mmunn1","key":"mmunn1","accountId":"557058:6e62b7e8-e48f-469d-ac54-e9449dec5cd9","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue"},"displayName":"Michael Munn","active":true,"timeZone":"America/Los_Angeles"},"body":"[~sjones] I think our approach to this should be much simpler, this more closely matches AWS behavior\n\n1) Do not list dergistered images for anyone with euca-describe-images\n2) instead of throwing the InstanceNotTerminatedException we throw an exception similar to the aws exception i.e. \n   \"Client.InvalidAMIID.Unavailable: The image ID 'ami-da682fb3' is no longer available\"\n3) All images left in the deregistered state will be cleaned up in the background after all associated instances are terminated via euca-describe-images and euca-deregister calls\n4) When the image is finally cleaned up in the background after all associated images are terminated and euca-deregister is called on the now removed emi\n    we throw a similar exceptiopn to aws i.e.  \"Client.InvalidAMIID.NotFound: The image id 'ami-da682fb3' does not exist\"\n\nYour thoughts Steve?","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=mmunn1","name":"mmunn1","key":"mmunn1","accountId":"557058:6e62b7e8-e48f-469d-ac54-e9449dec5cd9","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue"},"displayName":"Michael Munn","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-08-07T16:41:01.314-0500","updated":"2013-08-07T16:41:01.314-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/21913/comment/51120","id":"51120","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=mmunn1","name":"mmunn1","key":"mmunn1","accountId":"557058:6e62b7e8-e48f-469d-ac54-e9449dec5cd9","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue"},"displayName":"Michael Munn","active":true,"timeZone":"America/Los_Angeles"},"body":"Code Review Request #3:\nbranch : dev/mmunn1/EUCA-6559\ndiff : git show --color 877b87b2eaefeb40a90f5985bfc49457906ab761\n\nSummary: The first time euca-deregister is called on an image it is just set to the 'deregistered' state\nit is not deleted from the database, it is only deleted the second time euca-deregister is called.\nThis doesn't match the behavior seen on AWS where it is deleted on the first call.\n\nSolution: \n1) Do not list dergistered images for anyone with euca-describe-images\n2) instead of throwing the InstanceNotTerminatedException we throw an exception similar to the aws exception i.e. \n    \"Client.InvalidAMIID.Unavailable: The image ID 'ami-da682fb3' is no longer available\"\n3) All images left in the deregistered state will be cleaned up in the background after all associated instances are terminated via euca-describe-images and euca-deregister calls\n4) When the image is finally cleaned up in the background after all associated images are terminated and euca-deregister is called on the now removed emi\n    we throw a similar exception to aws i.e. \"Client.InvalidAMIID.NotFound: The image id 'ami-da682fb3' does not exist\"\n\nUnit test :\neuca-deregister followed by euca-describe-images will not list deregistered images for non-admin users.\nFor admin users euca-describe-images will list only deregistered images that have not been fully removed \nbecause they are still associated with a running image. \nI have created eutester/testcases/cloud_admin/3-3/Euca6559","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=mmunn1","name":"mmunn1","key":"mmunn1","accountId":"557058:6e62b7e8-e48f-469d-ac54-e9449dec5cd9","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue"},"displayName":"Michael Munn","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-08-08T11:55:40.413-0500","updated":"2013-08-08T11:55:40.413-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/21913/comment/51133","id":"51133","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=sjones","name":"sjones","key":"sjones","accountId":"557058:f5dce1b0-db45-4dd6-a0e8-3cea5effb5ce","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue"},"displayName":"Steve Jones","active":true,"timeZone":"America/Los_Angeles"},"body":"[~mmunn1], the AWS error codes to use are \"InvalidAMIID.Unavailable\" and \"InvalidAMIID.NotFound\".\n\nYou can find this information in the AWS EC2 API documentation : http://docs.aws.amazon.com/AWSEC2/latest/APIReference/api-error-codes.html\n\nError codes will be used by clients to understand the cause of an error, we should use the error codes as defined by AWS to ensure compatibility. To be more specific, this means we should not add a prefix such as \"Client.\" and should not change from \"AMI\" to \"EMI\".\n\nWhen the error codes are corrected the changes look good, no need for further review.","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=sjones","name":"sjones","key":"sjones","accountId":"557058:f5dce1b0-db45-4dd6-a0e8-3cea5effb5ce","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue"},"displayName":"Steve Jones","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-08-08T14:46:45.091-0500","updated":"2013-08-08T14:46:45.091-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/21913/comment/51134","id":"51134","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=mmunn1","name":"mmunn1","key":"mmunn1","accountId":"557058:6e62b7e8-e48f-469d-ac54-e9449dec5cd9","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue"},"displayName":"Michael Munn","active":true,"timeZone":"America/Los_Angeles"},"body":"[~sjones] done, thanks steve","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=mmunn1","name":"mmunn1","key":"mmunn1","accountId":"557058:6e62b7e8-e48f-469d-ac54-e9449dec5cd9","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue"},"displayName":"Michael Munn","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-08-08T14:53:50.837-0500","updated":"2013-08-08T14:53:50.837-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/21913/comment/52611","id":"52611","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=shaon","name":"shaon","key":"shaon","accountId":"557058:1e5e1aa5-5986-4a9e-b9ed-814f7000cd4f","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/70d1c1681d03ea38518d3b4f59db4385?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dshaon%26avatarId%3D11900%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/70d1c1681d03ea38518d3b4f59db4385?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dshaon%26avatarId%3D11900%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/70d1c1681d03ea38518d3b4f59db4385?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dshaon%26avatarId%3D11900%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/70d1c1681d03ea38518d3b4f59db4385?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dshaon%26avatarId%3D11900%26noRedirect%3Dtrue"},"displayName":"Imran Hossain Shaon","active":true,"timeZone":"America/Los_Angeles"},"body":"When the instance is not terminated it does not show the image without {{verbose}} flag (as expected).\n\nBut when try to deregister again (from both image owner account and eucalyptus admin account) it throws the following exception,\n{noformat}\n[root@c-21 eucalyptus_iam]# euca-deregister emi-28DA3BCF --debug\n2013-09-02 23:08:20,993 DEBUG   DeregisterImage parsed arguments: {'userregion': None, 'url': None, 'ImageId': 'emi-28DA3BCF', 'shell_configfile': '', 'deprecated_sec_key': None, 'deprecated_key_id': None, 'show_empty_fields': False, 'key_id': None, 'secret_key': None}\n2013-09-02 23:08:20,993 DEBUG   Config searching regions for option 'ec2-url'\n2013-09-02 23:08:20,993 DEBUG   Config   section 'aws:us-east-1'\n2013-09-02 23:08:20,993 INFO    Config option 'ec2-url' = 'https://ec2.us-east-1.amazonaws.com/'\n2013-09-02 23:08:20,993 DEBUG   Config searching regions for option 'verify-ssl'\n2013-09-02 23:08:20,993 DEBUG   Config   section 'aws:us-east-1'\n2013-09-02 23:08:20,993 DEBUG   Config   section 'aws:*'\n2013-09-02 23:08:20,993 INFO    Config option 'verify-ssl' = 'true'\n2013-09-02 23:08:20,996 INFO    DeregisterImage parameters: {'Action': 'DeregisterImage', 'Version': '2013-02-01', 'ImageId': 'emi-28DA3BCF'}\n2013-09-02 23:08:20,996 INFO    Eucalyptus sending request (attempt 1 of 3)\n2013-09-02 23:08:20,997 DEBUG   EC2CompatibleQuerySigV2Auth string to sign: 'POST\\n10.111.1.56:8773\\n/services/Eucalyptus\\nAWSAccessKeyId=AKI0WPDEXAPAHMXY1L3T&Action=DeregisterImage&ImageId=emi-28DA3BCF&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2013-09-03T06%3A08%3A20Z&Version=2013-02-01'\n2013-09-02 23:08:20,997 DEBUG   EC2CompatibleQuerySigV2Auth b64-encoded signature: 8Baw6gWp8npx5EplM53X3Mi8yZCZptQFZEKhHRaY0d0=\n2013-09-02 23:08:20,997 DEBUG   EC2CompatibleQuerySigV2Auth converting params to POST data\n2013-09-02 23:08:21,002 DEBUG   Eucalyptus request method: POST\n2013-09-02 23:08:21,002 DEBUG   Eucalyptus request url:    http://10.111.1.56:8773/services/Eucalyptus\n2013-09-02 23:08:21,002 DEBUG   Eucalyptus request header: Content-Length: 236\n2013-09-02 23:08:21,003 DEBUG   Eucalyptus request header: Content-Type: application/x-www-form-urlencoded\n2013-09-02 23:08:21,003 DEBUG   Eucalyptus request header: Host: 10.111.1.56:8773\n2013-09-02 23:08:21,003 DEBUG   Eucalyptus request header: User-Agent: euca2ools/3.0.1 (CPython 2.6.6; Linux 2.6.32-358.14.1.el6.x86_64; x86_64) requestbuilder/0.1.0 requests/1.1.0\n2013-09-02 23:08:21,003 DEBUG   Eucalyptus request data:   AWSAccessKeyId: AKI0WPDEXAPAHMXY1L3T\n2013-09-02 23:08:21,003 DEBUG   Eucalyptus request data:   Action: DeregisterImage\n2013-09-02 23:08:21,003 DEBUG   Eucalyptus request data:   ImageId: emi-28DA3BCF\n2013-09-02 23:08:21,003 DEBUG   Eucalyptus request data:   Signature: 8Baw6gWp8npx5EplM53X3Mi8yZCZptQFZEKhHRaY0d0=\n2013-09-02 23:08:21,003 DEBUG   Eucalyptus request data:   SignatureMethod: HmacSHA256\n2013-09-02 23:08:21,003 DEBUG   Eucalyptus request data:   SignatureVersion: 2\n2013-09-02 23:08:21,003 DEBUG   Eucalyptus request data:   Timestamp: 2013-09-03T06:08:20Z\n2013-09-02 23:08:21,003 DEBUG   Eucalyptus request data:   Version: 2013-02-01\n2013-09-02 23:08:21,298 DEBUG   Eucalyptus response time: 0.295 seconds\n2013-09-02 23:08:21,299 ERROR   Eucalyptus response status: 406\n2013-09-02 23:08:21,299 DEBUG   Eucalyptus response header: content-length: 25867\n2013-09-02 23:08:21,299 DEBUG   Eucalyptus response header: content-type: application/xml; charset=UTF-8\n2013-09-02 23:08:21,301 DEBUG   DeregisterImage -- response content --\n<?xml version=\"1.0\"?><Response><Errors><Error><Code>DeregisterImageType</Code><Message>could not execute statement</Message></Error></Errors><RequestID>org.hibernate.exception.ConstraintViolationException: could not execute statement\nCaused by: org.postgresql.util.PSQLException: ERROR: update or delete on table \"metadata_images\" violates foreign key constraint \"fk_ta414b0s2ahp2n969ri01f2pw\" on table \"metadata_instances\"\n  Detail: Key (id)=(8aef81b840de01b80140e24bffa31093) is still referenced from table \"metadata_instances\".\norg.hibernate.exception.ConstraintViolationException: could not execute statement\n\tat org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:129)\n\tat org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:49)\n\tat org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:125)\n\tat org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:110)\n\tat org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:136)\n\tat org.hibernate.persister.entity.AbstractEntityPersister.delete(AbstractEntityPersister.java:3346)\n\tat org.hibernate.persister.entity.AbstractEntityPersister.delete(AbstractEntityPersister.java:3546)\n\tat org.hibernate.action.internal.EntityDeleteAction.execute(EntityDeleteAction.java:100)\n\tat org.hibernate.engine.spi.ActionQueue.execute(ActionQueue.java:377)\n\tat org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:369)\n\tat org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:293)\n\tat org.hibernate.event.internal.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:339)\n\tat org.hibernate.event.internal.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:52)\n\tat org.hibernate.internal.SessionImpl.flush(SessionImpl.java:1234)\n\tat org.hibernate.internal.SessionImpl.managedFlush(SessionImpl.java:404)\n\tat org.hibernate.engine.transaction.internal.jdbc.JdbcTransaction.beforeTransactionCommit(JdbcTransaction.java:101)\n\tat org.hibernate.engine.transaction.spi.AbstractTransactionImpl.commit(AbstractTransactionImpl.java:175)\n\tat org.hibernate.ejb.TransactionImpl.commit(TransactionImpl.java:75)\n\tat com.eucalyptus.entities.Entities$CascadingTx$TxState.commit(Entities.java:917)\n\tat com.eucalyptus.entities.Entities$CascadingTx.commit(Entities.java:803)\n\tat com.eucalyptus.images.ImageManager.deregister(ImageManager.java:328)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:606)\n\tat org.mule.model.resolvers.AbstractEntryPointResolver.invokeMethod(AbstractEntryPointResolver.java:151)\n\tat org.mule.model.resolvers.ReflectionEntryPointResolver.invoke(ReflectionEntryPointResolver.java:121)\n\tat org.mule.model.resolvers.DefaultEntryPointResolverSet.invoke(DefaultEntryPointResolverSet.java:39)\n\tat org.mule.component.DefaultComponentLifecycleAdapter.invoke(DefaultComponentLifecycleAdapter.java:343)\n\tat org.mule.component.AbstractJavaComponent.invokeComponentInstance(AbstractJavaComponent.java:86)\n\tat org.mule.component.AbstractJavaComponent.doInvoke(AbstractJavaComponent.java:77)\n\tat org.mule.component.AbstractComponent.invokeInternal(AbstractComponent.java:126)\n\tat org.mule.component.AbstractComponent.access$000(AbstractComponent.java:61)\n\tat org.mule.component.AbstractComponent$1$1.process(AbstractComponent.java:242)\n\tat org.mule.execution.ExceptionToMessagingExceptionExecutionInterceptor.execute(ExceptionToMessagingExceptionExecutionInterceptor.java:27)\n\tat org.mule.execution.MessageProcessorNotificationExecutionInterceptor.execute(MessageProcessorNotificationExecutionInterceptor.java:61)\n\tat org.mule.execution.MessageProcessorExecutionTemplate.execute(MessageProcessorExecutionTemplate.java:47)\n\tat org.mule.execution.ExceptionToMessagingExceptionExecutionInterceptor.execute(ExceptionToMessagingExceptionExecutionInterceptor.java:27)\n\tat org.mule.execution.MessageProcessorNotificationExecutionInterceptor.execute(MessageProcessorNotificationExecutionInterceptor.java:61)\n\tat org.mule.execution.MessageProcessorExecutionTemplate.execute(MessageProcessorExecutionTemplate.java:47)\n\tat org.mule.component.AbstractComponent.process(AbstractComponent.java:160)\n\tat org.mule.service.processor.ServiceInternalMessageProcessor.process(ServiceInternalMessageProcessor.java:44)\n\tat org.mule.execution.ExceptionToMessagingExceptionExecutionInterceptor.execute(ExceptionToMessagingExceptionExecutionInterceptor.java:27)\n\tat org.mule.execution.MessageProcessorNotificationExecutionInterceptor.execute(MessageProcessorNotificationExecutionInterceptor.java:61)\n\tat org.mule.execution.MessageProcessorExecutionTemplate.execute(MessageProcessorExecutionTemplate.java:47)\n\tat org.mule.processor.AsyncInterceptingMessageProcessor.process(AsyncInterceptingMessageProcessor.java:101)\n\tat org.mule.execution.ExceptionToMessagingExceptionExecutionInterceptor.execute(ExceptionToMessagingExceptionExecutionInterceptor.java:27)\n\tat org.mule.execution.MessageProcessorNotificationExecutionInterceptor.execute(MessageProcessorNotificationExecutionInterceptor.java:61)\n\tat org.mule.execution.MessageProcessorExecutionTemplate.execute(MessageProcessorExecutionTemplate.java:47)\n\tat org.mule.execution.ExceptionToMessagingExceptionExecutionInterceptor.execute(ExceptionToMessagingExceptionExecutionInterceptor.java:27)\n\tat org.mule.execution.MessageProcessorExecutionTemplate.execute(MessageProcessorExecutionTemplate.java:47)\n\tat org.mule.interceptor.AbstractEnvelopeInterceptor.process(AbstractEnvelopeInterceptor.java:55)\n\tat org.mule.execution.ExceptionToMessagingExceptionExecutionInterceptor.execute(ExceptionToMessagingExceptionExecutionInterceptor.java:27)\n\tat org.mule.execution.MessageProcessorNotificationExecutionInterceptor.execute(MessageProcessorNotificationExecutionInterceptor.java:61)\n\tat org.mule.execution.MessageProcessorExecutionTemplate.execute(MessageProcessorExecutionTemplate.java:47)\n\tat org.mule.lifecycle.processor.ProcessIfStartedWaitIfSyncPausedMessageProcessor.process(ProcessIfStartedWaitIfSyncPausedMessageProcessor.java:56)\n\tat org.mule.execution.ExceptionToMessagingExceptionExecutionInterceptor.execute(ExceptionToMessagingExceptionExecutionInterceptor.java:27)\n\tat org.mule.execution.MessageProcessorNotificationExecutionInterceptor.execute(MessageProcessorNotificationExecutionInterceptor.java:61)\n\tat org.mule.execution.MessageProcessorExecutionTemplate.execute(MessageProcessorExecutionTemplate.java:47)\n\tat org.mule.execution.ExceptionToMessagingExceptionExecutionInterceptor.execute(ExceptionToMessagingExceptionExecutionInterceptor.java:27)\n\tat org.mule.execution.MessageProcessorNotificationExecutionInterceptor.execute(MessageProcessorNotificationExecutionInterceptor.java:61)\n\tat org.mule.execution.MessageProcessorExecutionTemplate.execute(MessageProcessorExecutionTemplate.java:47)\n\tat org.mule.service.AbstractService$7.process(AbstractService.java:443)\n\tat org.mule.execution.ExceptionToMessagingExceptionExecutionInterceptor.execute(ExceptionToMessagingExceptionExecutionInterceptor.java:27)\n\tat org.mule.execution.MessageProcessorNotificationExecutionInterceptor.execute(MessageProcessorNotificationExecutionInterceptor.java:61)\n\tat org.mule.execution.MessageProcessorExecutionTemplate.execute(MessageProcessorExecutionTemplate.java:47)\n\tat org.mule.service.ServiceCompositeMessageSource$1.process(ServiceCompositeMessageSource.java:125)\n\tat org.mule.execution.ExceptionToMessagingExceptionExecutionInterceptor.execute(ExceptionToMessagingExceptionExecutionInterceptor.java:27)\n\tat org.mule.execution.MessageProcessorNotificationExecutionInterceptor.execute(MessageProcessorNotificationExecutionInterceptor.java:61)\n\tat org.mule.execution.MessageProcessorExecutionTemplate.execute(MessageProcessorExecutionTemplate.java:47)\n\tat org.mule.processor.StopFurtherMessageProcessingMessageProcessor.process(StopFurtherMessageProcessingMessageProcessor.java:23)\n\tat org.mule.execution.ExceptionToMessagingExceptionExecutionInterceptor.execute(ExceptionToMessagingExceptionExecutionInterceptor.java:27)\n\tat org.mule.execution.MessageProcessorNotificationExecutionInterceptor.execute(MessageProcessorNotificationExecutionInterceptor.java:61)\n\tat org.mule.execution.MessageProcessorExecutionTemplate.execute(MessageProcessorExecutionTemplate.java:47)\n\tat org.mule.execution.ExceptionToMessagingExceptionExecutionInterceptor.execute(ExceptionToMessagingExceptionExecutionInterceptor.java:27)\n\tat org.mule.execution.MessageProcessorNotificationExecutionInterceptor.execute(MessageProcessorNotificationExecutionInterceptor.java:61)\n\tat org.mule.execution.MessageProcessorExecutionTemplate.execute(MessageProcessorExecutionTemplate.java:47)\n\tat org.mule.source.StartableCompositeMessageSource$InternalMessageProcessor.process(StartableCompositeMessageSource.java:243)\n\tat org.mule.execution.ExceptionToMessagingExceptionExecutionInterceptor.execute(ExceptionToMessagingExceptionExecutionInterceptor.java:27)\n\tat org.mule.execution.MessageProcessorNotificationExecutionInterceptor.execute(MessageProcessorNotificationExecutionInterceptor.java:61)\n\tat org.mule.execution.MessageProcessorExecutionTemplate.execute(MessageProcessorExecutionTemplate.java:47)\n\tat org.mule.execution.ExceptionToMessagingExceptionExecutionInterceptor.execute(ExceptionToMessagingExceptionExecutionInterceptor.java:27)\n\tat org.mule.execution.MessageProcessorNotificationExecutionInterceptor.execute(MessageProcessorNotificationExecutionInterceptor.java:61)\n\tat org.mule.execution.MessageProcessorExecutionTemplate.execute(MessageProcessorExecutionTemplate.java:47)\n\tat org.mule.execution.ExceptionToMessagingExceptionExecutionInterceptor.execute(ExceptionToMessagingExceptionExecutionInterceptor.java:27)\n\tat org.mule.execution.MessageProcessorNotificationExecutionInterceptor.execute(MessageProcessorNotificationExecutionInterceptor.java:61)\n\tat org.mule.execution.MessageProcessorExecutionTemplate.execute(MessageProcessorExecutionTemplate.java:47)\n\tat org.mule.execution.ExceptionToMessagingExceptionExecutionInterceptor.execute(ExceptionToMessagingExceptionExecutionInterceptor.java:27)\n\tat org.mule.execution.MessageProcessorNotificationExecutionInterceptor.execute(MessageProcessorNotificationExecutionInterceptor.java:61)\n\tat org.mule.execution.MessageProcessorExecutionTemplate.execute(MessageProcessorExecutionTemplate.java:47)\n\tat org.mule.transport.AbstractMessageReceiver.routeEvent(AbstractMessageReceiver.java:473)\n\tat org.mule.transport.AbstractMessageReceiver.routeMessage(AbstractMessageReceiver.java:226)\n\tat org.mule.transport.AbstractMessageReceiver.routeMessage(AbstractMessageReceiver.java:208)\n\tat org.mule.transport.AbstractMessageReceiver.routeMessage(AbstractMessageReceiver.java:200)\n\tat org.mule.transport.AbstractMessageReceiver.routeMessage(AbstractMessageReceiver.java:187)\n\tat org.mule.transport.vm.VMMessageReceiver$1.process(VMMessageReceiver.java:113)\n\tat org.mule.transport.vm.VMMessageReceiver$1.process(VMMessageReceiver.java:109)\n\tat org.mule.execution.ExecuteCallbackInterceptor.execute(ExecuteCallbackInterceptor.java:20)\n\tat org.mule.execution.HandleExceptionInterceptor.execute(HandleExceptionInterceptor.java:34)\n\tat org.mule.execution.HandleExceptionInterceptor.execute(HandleExceptionInterceptor.java:18)\n\tat org.mule.execution.BeginAndResolveTransactionInterceptor.execute(BeginAndResolveTransactionInterceptor.java:58)\n\tat org.mule.execution.ResolvePreviousTransactionInterceptor.execute(ResolvePreviousTransactionInterceptor.java:48)\n\tat org.mule.execution.SuspendXaTransactionInterceptor.execute(SuspendXaTransactionInterceptor.java:54)\n\tat org.mule.execution.ValidateTransactionalStateInterceptor.execute(ValidateTransactionalStateInterceptor.java:44)\n\tat org.mule.execution.IsolateCurrentTransactionInterceptor.execute(IsolateCurrentTransactionInterceptor.java:44)\n\tat org.mule.execution.ExternalTransactionInterceptor.execute(ExternalTransactionInterceptor.java:52)\n\tat org.mule.execution.RethrowExceptionInterceptor.execute(RethrowExceptionInterceptor.java:32)\n\tat org.mule.execution.RethrowExceptionInterceptor.execute(RethrowExceptionInterceptor.java:17)\n\tat org.mule.execution.TransactionalErrorHandlingExecutionTemplate.execute(TransactionalErrorHandlingExecutionTemplate.java:113)\n\tat org.mule.execution.TransactionalErrorHandlingExecutionTemplate.execute(TransactionalErrorHandlingExecutionTemplate.java:34)\n\tat org.mule.transport.vm.VMMessageReceiver.onCall(VMMessageReceiver.java:108)\n\tat org.mule.transport.vm.VMMessageDispatcher$1.process(VMMessageDispatcher.java:97)\n\tat org.mule.transport.vm.VMMessageDispatcher$1.process(VMMessageDispatcher.java:94)\n\tat org.mule.execution.ExecuteCallbackInterceptor.execute(ExecuteCallbackInterceptor.java:20)\n\tat org.mule.execution.BeginAndResolveTransactionInterceptor.execute(BeginAndResolveTransactionInterceptor.java:58)\n\tat org.mule.execution.ResolvePreviousTransactionInterceptor.execute(ResolvePreviousTransactionInterceptor.java:48)\n\tat org.mule.execution.SuspendXaTransactionInterceptor.execute(SuspendXaTransactionInterceptor.java:54)\n\tat org.mule.execution.ValidateTransactionalStateInterceptor.execute(ValidateTransactionalStateInterceptor.java:44)\n\tat org.mule.execution.IsolateCurrentTransactionInterceptor.execute(IsolateCurrentTransactionInterceptor.java:44)\n\tat org.mule.execution.ExternalTransactionInterceptor.execute(ExternalTransactionInterceptor.java:52)\n\tat org.mule.execution.TransactionalExecutionTemplate.execute(TransactionalExecutionTemplate.java:69)\n\tat org.mule.transport.vm.VMMessageDispatcher.doSend(VMMessageDispatcher.java:100)\n\tat org.mule.transport.AbstractMessageDispatcher.process(AbstractMessageDispatcher.java:81)\n\tat org.mule.transport.AbstractConnector$DispatcherMessageProcessor.process(AbstractConnector.java:2627)\n\tat org.mule.execution.ExceptionToMessagingExceptionExecutionInterceptor.execute(ExceptionToMessagingExceptionExecutionInterceptor.java:27)\n\tat org.mule.execution.MessageProcessorNotificationExecutionInterceptor.execute(MessageProcessorNotificationExecutionInterceptor.java:61)\n\tat org.mule.execution.MessageProcessorExecutionTemplate.execute(MessageProcessorExecutionTemplate.java:47)\n\tat org.mule.execution.ExceptionToMessagingExceptionExecutionInterceptor.execute(ExceptionToMessagingExceptionExecutionInterceptor.java:27)\n\tat org.mule.execution.MessageProcessorExecutionTemplate.execute(MessageProcessorExecutionTemplate.java:47)\n\tat org.mule.endpoint.outbound.OutboundResponsePropertiesMessageProcessor.process(OutboundResponsePropertiesMessageProcessor.java:39)\n\tat org.mule.execution.ExceptionToMessagingExceptionExecutionInterceptor.execute(ExceptionToMessagingExceptionExecutionInterceptor.java:27)\n\tat org.mule.execution.MessageProcessorNotificationExecutionInterceptor.execute(MessageProcessorNotificationExecutionInterceptor.java:61)\n\tat org.mule.execution.MessageProcessorExecutionTemplate.execute(MessageProcessorExecutionTemplate.java:47)\n\tat org.mule.execution.ExceptionToMessagingExceptionExecutionInterceptor.execute(ExceptionToMessagingExceptionExecutionInterceptor.java:27)\n\tat org.mule.execution.MessageProcessorExecutionTemplate.execute(MessageProcessorExecutionTemplate.java:47)\n\tat org.mule.processor.EndpointTransactionalInterceptingMessageProcessor$1.process(EndpointTransactionalInterceptingMessageProcessor.java:50)\n\tat org.mule.processor.EndpointTransactionalInterceptingMessageProcessor$1.process(EndpointTransactionalInterceptingMessageProcessor.java:47)\n\tat org.mule.execution.ExecuteCallbackInterceptor.execute(ExecuteCallbackInterceptor.java:20)\n\tat org.mule.execution.BeginAndResolveTransactionInterceptor.execute(BeginAndResolveTransactionInterceptor.java:58)\n\tat org.mule.execution.ResolvePreviousTransactionInterceptor.execute(ResolvePreviousTransactionInterceptor.java:48)\n\tat org.mule.execution.SuspendXaTransactionInterceptor.execute(SuspendXaTransactionInterceptor.java:54)\n\tat org.mule.execution.ValidateTransactionalStateInterceptor.execute(ValidateTransactionalStateInterceptor.java:44)\n\tat org.mule.execution.IsolateCurrentTransactionInterceptor.execute(IsolateCurrentTransactionInterceptor.java:44)\n\tat org.mule.execution.ExternalTransactionInterceptor.execute(ExternalTransactionInterceptor.java:52)\n\tat org.mule.execution.TransactionalExecutionTemplate.execute(TransactionalExecutionTemplate.java:69)\n\tat org.mule.processor.EndpointTransactionalInterceptingMessageProcessor.process(EndpointTransactionalInterceptingMessageProcessor.java:56)\n\tat org.mule.execution.ExceptionToMessagingExceptionExecutionInterceptor.execute(ExceptionToMessagingExceptionExecutionInterceptor.java:27)\n\tat org.mule.execution.MessageProcessorNotificationExecutionInterceptor.execute(MessageProcessorNotificationExecutionInterceptor.java:61)\n\tat org.mule.execution.MessageProcessorExecutionTemplate.execute(MessageProcessorExecutionTemplate.java:47)\n\tat org.mule.processor.AbstractFilteringMessageProcessor.process(AbstractFilteringMessageProcessor.java:44)\n\tat org.mule.execution.ExceptionToMessagingExceptionExecutionInterceptor.execute(ExceptionToMessagingExceptionExecutionInterceptor.java:27)\n\tat org.mule.execution.MessageProcessorNotificationExecutionInterceptor.execute(MessageProcessorNotificationExecutionInterceptor.java:61)\n\tat org.mule.execution.MessageProcessorExecutionTemplate.execute(MessageProcessorExecutionTemplate.java:47)\n\tat org.mule.execution.ExceptionToMessagingExceptionExecutionInterceptor.execute(ExceptionToMessagingExceptionExecutionInterceptor.java:27)\n\tat org.mule.execution.MessageProcessorNotificationExecutionInterceptor.execute(MessageProcessorNotificationExecutionInterceptor.java:61)\n\tat org.mule.execution.MessageProcessorExecutionTemplate.execute(MessageProcessorExecutionTemplate.java:47)\n\tat org.mule.execution.ExceptionToMessagingExceptionExecutionInterceptor.execute(ExceptionToMessagingExceptionExecutionInterceptor.java:27)\n\tat org.mule.execution.MessageProcessorNotificationExecutionInterceptor.execute(MessageProcessorNotificationExecutionInterceptor.java:61)\n\tat org.mule.execution.MessageProcessorExecutionTemplate.execute(MessageProcessorExecutionTemplate.java:47)\n\tat org.mule.execution.ExceptionToMessagingExceptionExecutionInterceptor.execute(ExceptionToMessagingExceptionExecutionInterceptor.java:27)\n\tat org.mule.execution.MessageProcessorNotificationExecutionInterceptor.execute(MessageProcessorNotificationExecutionInterceptor.java:61)\n\tat org.mule.execution.MessageProcessorExecutionTemplate.execute(MessageProcessorExecutionTemplate.java:47)\n\tat org.mule.endpoint.DefaultOutboundEndpoint.process(DefaultOutboundEndpoint.java:96)\n\tat org.mule.execution.MessageProcessorNotificationExecutionInterceptor.execute(MessageProcessorNotificationExecutionInterceptor.java:57)\n\tat org.mule.execution.MessageProcessorExecutionTemplate.execute(MessageProcessorExecutionTemplate.java:47)\n\tat org.mule.routing.outbound.AbstractOutboundRouter.sendRequestEvent(AbstractOutboundRouter.java:475)\n\tat org.mule.routing.outbound.AbstractOutboundRouter.sendRequest(AbstractOutboundRouter.java:176)\n\tat org.mule.routing.outbound.FilteringOutboundRouter.route(FilteringOutboundRouter.java:81)\n\tat org.mule.routing.outbound.AbstractOutboundRouter$1.process(AbstractOutboundRouter.java:102)\n\tat org.mule.routing.outbound.AbstractOutboundRouter$1.process(AbstractOutboundRouter.java:97)\n\tat org.mule.execution.ExecuteCallbackInterceptor.execute(ExecuteCallbackInterceptor.java:20)\n\tat org.mule.execution.BeginAndResolveTransactionInterceptor.execute(BeginAndResolveTransactionInterceptor.java:58)\n\tat org.mule.execution.ResolvePreviousTransactionInterceptor.execute(ResolvePreviousTransactionInterceptor.java:48)\n\tat org.mule.execution.SuspendXaTransactionInterceptor.execute(SuspendXaTransactionInterceptor.java:54)\n\tat org.mule.execution.ValidateTransactionalStateInterceptor.execute(ValidateTransactionalStateInterceptor.java:44)\n\tat org.mule.execution.IsolateCurrentTransactionInterceptor.execute(IsolateCurrentTransactionInterceptor.java:44)\n\tat org.mule.execution.ExternalTransactionInterceptor.execute(ExternalTransactionInterceptor.java:52)\n\tat org.mule.execution.TransactionalExecutionTemplate.execute(TransactionalExecutionTemplate.java:69)\n\tat org.mule.routing.outbound.AbstractOutboundRouter.process(AbstractOutboundRouter.java:116)\n\tat org.mule.routing.outbound.DefaultOutboundRouterCollection.process(DefaultOutboundRouterCollection.java:103)\n\tat org.mule.execution.ExceptionToMessagingExceptionExecutionInterceptor.execute(ExceptionToMessagingExceptionExecutionInterceptor.java:27)\n\tat org.mule.execution.MessageProcessorNotificationExecutionInterceptor.execute(MessageProcessorNotificationExecutionInterceptor.java:61)\n\tat org.mule.execution.MessageProcessorExecutionTemplate.execute(MessageProcessorExecutionTemplate.java:47)\n\tat org.mule.execution.ExceptionToMessagingExceptionExecutionInterceptor.execute(ExceptionToMessagingExceptionExecutionInterceptor.java:27)\n\tat org.mule.execution.MessageProcessorExecutionTemplate.execute(MessageProcessorExecutionTemplate.java:47)\n\tat org.mule.service.processor.ServiceOutboundMessageProcessor.process(ServiceOutboundMessageProcessor.java:74)\n\tat org.mule.execution.ExceptionToMessagingExceptionExecutionInterceptor.execute(ExceptionToMessagingExceptionExecutionInterceptor.java:27)\n\tat org.mule.execution.MessageProcessorNotificationExecutionInterceptor.execute(MessageProcessorNotificationExecutionInterceptor.java:61)\n\tat org.mule.execution.MessageProcessorExecutionTemplate.execute(MessageProcessorExecutionTemplate.java:47)\n\tat org.mule.service.processor.ServiceInternalMessageProcessor.process(ServiceInternalMessageProcessor.java:45)\n\tat org.mule.execution.ExceptionToMessagingExceptionExecutionInterceptor.execute(ExceptionToMessagingExceptionExecutionInterceptor.java:27)\n\tat org.mule.execution.MessageProcessorNotificationExecutionInterceptor.execute(MessageProcessorNotificationExecutionInterceptor.java:61)\n\tat org.mule.execution.MessageProcessorExecutionTemplate.execute(MessageProcessorExecutionTemplate.java:47)\n\tat org.mule.interceptor.AbstractEnvelopeInterceptor.process(AbstractEnvelopeInterceptor.java:55)\n\tat org.mule.processor.AsyncInterceptingMessageProcessor.processNextTimed(AsyncInterceptingMessageProcessor.java:122)\n\tat org.mule.processor.AsyncInterceptingMessageProcessor$AsyncMessageProcessorWorker$1.process(AsyncInterceptingMessageProcessor.java:192)\n\tat org.mule.processor.AsyncInterceptingMessageProcessor$AsyncMessageProcessorWorker$1.process(AsyncInterceptingMessageProcessor.java:185)\n\tat org.mule.execution.ExecuteCallbackInterceptor.execute(ExecuteCallbackInterceptor.java:20)\n\tat org.mule.execution.HandleExceptionInterceptor.execute(HandleExceptionInterceptor.java:34)\n\tat org.mule.execution.HandleExceptionInterceptor.execute(HandleExceptionInterceptor.java:18)\n\tat org.mule.execution.BeginAndResolveTransactionInterceptor.execute(BeginAndResolveTransactionInterceptor.java:58)\n\tat org.mule.execution.ResolvePreviousTransactionInterceptor.execute(ResolvePreviousTransactionInterceptor.java:48)\n\tat org.mule.execution.SuspendXaTransactionInterceptor.execute(SuspendXaTransactionInterceptor.java:54)\n\tat org.mule.execution.ValidateTransactionalStateInterceptor.execute(ValidateTransactionalStateInterceptor.java:44)\n\tat org.mule.execution.IsolateCurrentTransactionInterceptor.execute(IsolateCurrentTransactionInterceptor.java:44)\n\tat org.mule.execution.ExternalTransactionInterceptor.execute(ExternalTransactionInterceptor.java:52)\n\tat org.mule.execution.RethrowExceptionInterceptor.execute(RethrowExceptionInterceptor.java:32)\n\tat org.mule.execution.RethrowExceptionInterceptor.execute(RethrowExceptionInterceptor.java:17)\n\tat org.mule.execution.TransactionalErrorHandlingExecutionTemplate.execute(TransactionalErrorHandlingExecutionTemplate.java:113)\n\tat org.mule.execution.TransactionalErrorHandlingExecutionTemplate.execute(TransactionalErrorHandlingExecutionTemplate.java:34)\n\tat org.mule.processor.AsyncInterceptingMessageProcessor$AsyncMessageProcessorWorker.doRun(AsyncInterceptingMessageProcessor.java:184)\n\tat org.mule.work.AbstractMuleEventWork.run(AbstractMuleEventWork.java:43)\n\tat org.mule.work.WorkerContext.run(WorkerContext.java:311)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n\tat java.lang.Thread.run(Thread.java:724)\nCaused by: org.postgresql.util.PSQLException: ERROR: update or delete on table \"metadata_images\" violates foreign key constraint \"fk_ta414b0s2ahp2n969ri01f2pw\" on table \"metadata_instances\"\n  Detail: Key (id)=(8aef81b840de01b80140e24bffa31093) is still referenced from table \"metadata_instances\".\n\tat org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2157)\n\tat org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1886)\n\tat org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:255)\nCaused by: org.postgresql.util.PSQLException: ERROR: update or delete on table \"metadata_images\" violates foreign key constraint \"fk_ta414b0s2ahp2n969ri01f2pw\" on table \"metadata_instances\"\n  Detail: Key (id)=(8aef81b840de01b80140e24bffa31093) is still referenced from table \"metadata_instances\".\n\tat org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2157)\n\tat org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1886)\n\tat org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:255)\n</RequestID></Response>\n2013-09-02 23:08:21,301 DEBUG   DeregisterImage -- end of response content --\n2013-09-02 23:08:21,301 INFO    DeregisterImage result: failure\neuca-deregister: error (DeregisterImageType): could not execute statement\nTraceback (most recent call last):\n  File \"/usr/bin/euca-deregister\", line 6, in <module>\n    euca2ools.commands.euca.deregisterimage.DeregisterImage.run()\n  File \"/usr/lib/python2.6/site-packages/requestbuilder/command.py\", line 289, in run\n    cmd.handle_cli_exception(err)\n  File \"/usr/lib/python2.6/site-packages/requestbuilder/command.py\", line 286, in run\n    result = cmd.main()\n  File \"/usr/lib/python2.6/site-packages/requestbuilder/request.py\", line 181, in main\n    response = self.send()\n  File \"/usr/lib/python2.6/site-packages/requestbuilder/request.py\", line 143, in send\n    return self.handle_server_error(err)\n  File \"/usr/lib/python2.6/site-packages/requestbuilder/request.py\", line 130, in send\n    params=params, data=self.body)\n  File \"/usr/lib/python2.6/site-packages/requestbuilder/service.py\", line 234, in send_request\n    self.handle_http_error(response)\n  File \"/usr/lib/python2.6/site-packages/euca2ools/commands/euca/__init__.py\", line 204, in handle_http_error\n    raise AWSError(response)\neuca2ools.exceptions.AWSError: (406, 'Not Acceptable', 'DeregisterImageType', 'could not execute statement')\n{noformat}\n\nNo. 3 and 4 is working as expected (from both image owner account and eucalyptus admin account),\n{noformat}\n[root@c-21 eucalyptus_iam]# euca-deregister emi-28DA3BCF\neuca-deregister: error (InvalidAMIID.NotFound): The image ID 'emi-28DA3BCF' does not exist\n{noformat}\n\n[~mmunn1], let me know, what do you think about it. Feel free to ask if more info is needed.\n\nTest steps:\n* Registered image with non-eucalyptus account admin\n** Ran instance\n** Deregistered image once\n** Tried to deregister again\n** Terminated instance and image was gone afterwards\n* Did the same with eucalyptus admin account, the result was same\n\nInstalled Packages\n{noformat}\nName        : eucalyptus\nArch        : x86_64\nVersion     : 3.4.0\nRelease     : 0.0.1443.20130831gite1de8487.el6\nSize        : 2.4 M\nRepo        : installed\n{noformat}","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=shaon","name":"shaon","key":"shaon","accountId":"557058:1e5e1aa5-5986-4a9e-b9ed-814f7000cd4f","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/70d1c1681d03ea38518d3b4f59db4385?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dshaon%26avatarId%3D11900%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/70d1c1681d03ea38518d3b4f59db4385?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dshaon%26avatarId%3D11900%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/70d1c1681d03ea38518d3b4f59db4385?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dshaon%26avatarId%3D11900%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/70d1c1681d03ea38518d3b4f59db4385?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dshaon%26avatarId%3D11900%26noRedirect%3Dtrue"},"displayName":"Imran Hossain Shaon","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-09-03T01:39:49.036-0500","updated":"2013-09-03T01:39:49.036-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/21913/comment/52643","id":"52643","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=mmunn1","name":"mmunn1","key":"mmunn1","accountId":"557058:6e62b7e8-e48f-469d-ac54-e9449dec5cd9","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue"},"displayName":"Michael Munn","active":true,"timeZone":"America/Los_Angeles"},"body":"[~mdshaonimran] Good catch!   This is in fact broken it was working correctly but the code was changed by a later commit  i.e commit 02ded6bd39ec9cdddce4992c0d3a7577df265f40\nI am working with Chris to get this figured out.","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=mmunn1","name":"mmunn1","key":"mmunn1","accountId":"557058:6e62b7e8-e48f-469d-ac54-e9449dec5cd9","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue"},"displayName":"Michael Munn","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-09-03T20:31:26.093-0500","updated":"2013-09-03T20:31:26.093-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/21913/comment/52649","id":"52649","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=mmunn1","name":"mmunn1","key":"mmunn1","accountId":"557058:6e62b7e8-e48f-469d-ac54-e9449dec5cd9","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue"},"displayName":"Michael Munn","active":true,"timeZone":"America/Los_Angeles"},"body":"[~shaon] This is now fixed again with:\n\ncommit 4d2dd2b75703572f18acf92b9944c8ae7f567360\nAuthor: mmunn <mmunn@eucalyptus.com>\nDate:   Wed Sep 4 01:20:05 2013 -0700\n\n    EUCA-6559 fix problems created by commit 02ded6bd39ec9cdddce4992c0d3a7577df265f40","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=mmunn1","name":"mmunn1","key":"mmunn1","accountId":"557058:6e62b7e8-e48f-469d-ac54-e9449dec5cd9","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue"},"displayName":"Michael Munn","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-09-04T03:28:41.290-0500","updated":"2013-09-04T03:28:41.290-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/21913/comment/52663","id":"52663","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=sjones","name":"sjones","key":"sjones","accountId":"557058:f5dce1b0-db45-4dd6-a0e8-3cea5effb5ce","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue"},"displayName":"Steve Jones","active":true,"timeZone":"America/Los_Angeles"},"body":"[~mmunn1], please update the fix to close the transaction on all paths. If you want to rollback on failure you can use:\n\n{code}\n    } finally {\n      if ( db.isActive() ) db.rollback();\n    }\n{code}","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=sjones","name":"sjones","key":"sjones","accountId":"557058:f5dce1b0-db45-4dd6-a0e8-3cea5effb5ce","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue"},"displayName":"Steve Jones","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-09-04T10:25:29.112-0500","updated":"2013-09-04T10:25:29.112-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/21913/comment/52689","id":"52689","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=mmunn1","name":"mmunn1","key":"mmunn1","accountId":"557058:6e62b7e8-e48f-469d-ac54-e9449dec5cd9","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue"},"displayName":"Michael Munn","active":true,"timeZone":"America/Los_Angeles"},"body":"[~sjones]   added the following to both deregister methods\n{code}\n } finally {\n      if ( tx.isActive() ) tx.rollback();\n }\n{code}","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=mmunn1","name":"mmunn1","key":"mmunn1","accountId":"557058:6e62b7e8-e48f-469d-ac54-e9449dec5cd9","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/6638eee119e9c0bdcca16883c5415349?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dmmunn1%26avatarId%3D11300%26noRedirect%3Dtrue"},"displayName":"Michael Munn","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-09-04T14:05:49.543-0500","updated":"2013-09-04T14:05:49.543-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/21913/comment/53394","id":"53394","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=shaon","name":"shaon","key":"shaon","accountId":"557058:1e5e1aa5-5986-4a9e-b9ed-814f7000cd4f","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/70d1c1681d03ea38518d3b4f59db4385?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dshaon%26avatarId%3D11900%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/70d1c1681d03ea38518d3b4f59db4385?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dshaon%26avatarId%3D11900%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/70d1c1681d03ea38518d3b4f59db4385?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dshaon%26avatarId%3D11900%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/70d1c1681d03ea38518d3b4f59db4385?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dshaon%26avatarId%3D11900%26noRedirect%3Dtrue"},"displayName":"Imran Hossain Shaon","active":true,"timeZone":"America/Los_Angeles"},"body":"Thanks. It shows the correct message now.\r\n\r\n{noformat}\r\n[root@d-35 eucalyptus_iam]# euca-deregister emi-8DB93A8B --debug\r\n2013-09-17 11:19:11,877 DEBUG   DeregisterImage parsed arguments: {'userregion': None, 'url': None, 'ImageId': 'emi-8DB93A8B', 'shell_configfile': '', 'deprecated_sec_key': None, 'deprecated_key_id': None, 'show_empty_fields': False, 'key_id': None, 'secret_key': None}\r\n2013-09-17 11:19:11,877 DEBUG   Config searching regions for option 'ec2-url'\r\n2013-09-17 11:19:11,877 DEBUG   Config   section 'aws:us-east-1'\r\n2013-09-17 11:19:11,877 INFO    Config option 'ec2-url' = 'https://ec2.us-east-1.amazonaws.com/'\r\n2013-09-17 11:19:11,877 DEBUG   Config searching regions for option 'verify-ssl'\r\n2013-09-17 11:19:11,877 DEBUG   Config   section 'aws:us-east-1'\r\n2013-09-17 11:19:11,878 DEBUG   Config   section 'aws:*'\r\n2013-09-17 11:19:11,878 INFO    Config option 'verify-ssl' = 'true'\r\n2013-09-17 11:19:11,881 INFO    DeregisterImage parameters: {'Action': 'DeregisterImage', 'Version': '2013-02-01', 'ImageId': 'emi-8DB93A8B'}\r\n2013-09-17 11:19:11,881 INFO    Eucalyptus sending request (attempt 1 of 3)\r\n2013-09-17 11:19:11,882 DEBUG   EC2CompatibleQuerySigV2Auth string to sign: 'POST\\n10.111.1.105:8773\\n/services/Eucalyptus\\nAWSAccessKeyId=AKITQ4ZXJEJ7PGC4IZCP&Action=DeregisterImage&ImageId=emi-8DB93A8B&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2013-09-17T18%3A19%3A11Z&Version=2013-02-01'\r\n2013-09-17 11:19:11,883 DEBUG   EC2CompatibleQuerySigV2Auth b64-encoded signature: L/AESfIE39MY/D5KbA9Bjinzh4vlpa6mRFcnubUSgAs=\r\n2013-09-17 11:19:11,883 DEBUG   EC2CompatibleQuerySigV2Auth converting params to POST data\r\n2013-09-17 11:19:11,890 DEBUG   Eucalyptus request method: POST\r\n2013-09-17 11:19:11,890 DEBUG   Eucalyptus request url:    http://10.111.1.105:8773/services/Eucalyptus\r\n2013-09-17 11:19:11,890 DEBUG   Eucalyptus request header: Content-Length: 240\r\n2013-09-17 11:19:11,890 DEBUG   Eucalyptus request header: Content-Type: application/x-www-form-urlencoded\r\n2013-09-17 11:19:11,891 DEBUG   Eucalyptus request header: Host: 10.111.1.105:8773\r\n2013-09-17 11:19:11,891 DEBUG   Eucalyptus request header: User-Agent: euca2ools/3.0.1-5-ged969af (CPython 2.6.6; Linux 2.6.32-358.14.1.el6.x86_64; x86_64) requestbuilder/0.1.0 requests/1.1.0\r\n2013-09-17 11:19:11,891 DEBUG   Eucalyptus request data:   AWSAccessKeyId: AKITQ4ZXJEJ7PGC4IZCP\r\n2013-09-17 11:19:11,891 DEBUG   Eucalyptus request data:   Action: DeregisterImage\r\n2013-09-17 11:19:11,891 DEBUG   Eucalyptus request data:   ImageId: emi-8DB93A8B\r\n2013-09-17 11:19:11,891 DEBUG   Eucalyptus request data:   Signature: L/AESfIE39MY/D5KbA9Bjinzh4vlpa6mRFcnubUSgAs=\r\n2013-09-17 11:19:11,891 DEBUG   Eucalyptus request data:   SignatureMethod: HmacSHA256\r\n2013-09-17 11:19:11,891 DEBUG   Eucalyptus request data:   SignatureVersion: 2\r\n2013-09-17 11:19:11,891 DEBUG   Eucalyptus request data:   Timestamp: 2013-09-17T18:19:11Z\r\n2013-09-17 11:19:11,891 DEBUG   Eucalyptus request data:   Version: 2013-02-01\r\n2013-09-17 11:19:12,037 DEBUG   Eucalyptus response time: 0.145 seconds\r\n2013-09-17 11:19:12,037 ERROR   Eucalyptus response status: 400\r\n2013-09-17 11:19:12,038 DEBUG   Eucalyptus response header: content-length: 239\r\n2013-09-17 11:19:12,038 DEBUG   Eucalyptus response header: content-type: application/xml; charset=UTF-8\r\n2013-09-17 11:19:12,051 DEBUG   DeregisterImage -- response content --\r\n<?xml version=\"1.0\"?><Response><Errors><Error><Code>InvalidAMIID.Unavailable</Code><Message>The image ID 'emi-8DB93A8B' is no longer available</Message></Error></Errors><RequestID>bac4e40a-9e5d-4371-a27d-bbd622a1905a</RequestID></Response>\r\n2013-09-17 11:19:12,052 DEBUG   DeregisterImage -- end of response content --\r\n2013-09-17 11:19:12,052 INFO    DeregisterImage result: failure\r\neuca-deregister: error (InvalidAMIID.Unavailable): The image ID 'emi-8DB93A8B' is no longer available\r\nTraceback (most recent call last):\r\n  File \"/usr/bin/euca-deregister\", line 6, in <module>\r\n    euca2ools.commands.euca.deregisterimage.DeregisterImage.run()\r\n  File \"/usr/lib/python2.6/site-packages/requestbuilder/command.py\", line 289, in run\r\n    cmd.handle_cli_exception(err)\r\n  File \"/usr/lib/python2.6/site-packages/requestbuilder/command.py\", line 286, in run\r\n    result = cmd.main()\r\n  File \"/usr/lib/python2.6/site-packages/requestbuilder/request.py\", line 181, in main\r\n    response = self.send()\r\n  File \"/usr/lib/python2.6/site-packages/requestbuilder/request.py\", line 143, in send\r\n    return self.handle_server_error(err)\r\n  File \"/usr/lib/python2.6/site-packages/requestbuilder/request.py\", line 130, in send\r\n    params=params, data=self.body)\r\n  File \"/usr/lib/python2.6/site-packages/requestbuilder/service.py\", line 234, in send_request\r\n    self.handle_http_error(response)\r\n  File \"/usr/lib/python2.6/site-packages/euca2ools/commands/euca/__init__.py\", line 204, in handle_http_error\r\n    raise AWSError(response)\r\neuca2ools.exceptions.AWSError: (400, '', 'InvalidAMIID.Unavailable', \"The image ID 'emi-8DB93A8B' is no longer available\")\r\n{noformat}\r\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=shaon","name":"shaon","key":"shaon","accountId":"557058:1e5e1aa5-5986-4a9e-b9ed-814f7000cd4f","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/70d1c1681d03ea38518d3b4f59db4385?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dshaon%26avatarId%3D11900%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/70d1c1681d03ea38518d3b4f59db4385?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dshaon%26avatarId%3D11900%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/70d1c1681d03ea38518d3b4f59db4385?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dshaon%26avatarId%3D11900%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/70d1c1681d03ea38518d3b4f59db4385?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dshaon%26avatarId%3D11900%26noRedirect%3Dtrue"},"displayName":"Imran Hossain Shaon","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-09-17T13:40:35.664-0500","updated":"2013-09-17T13:40:35.664-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/21913/comment/53395","id":"53395","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=shaon","name":"shaon","key":"shaon","accountId":"557058:1e5e1aa5-5986-4a9e-b9ed-814f7000cd4f","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/70d1c1681d03ea38518d3b4f59db4385?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dshaon%26avatarId%3D11900%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/70d1c1681d03ea38518d3b4f59db4385?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dshaon%26avatarId%3D11900%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/70d1c1681d03ea38518d3b4f59db4385?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dshaon%26avatarId%3D11900%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/70d1c1681d03ea38518d3b4f59db4385?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dshaon%26avatarId%3D11900%26noRedirect%3Dtrue"},"displayName":"Imran Hossain Shaon","active":true,"timeZone":"America/Los_Angeles"},"body":"Installed Packages\r\n{noformat}\r\nName        : eucalyptus\r\nArch        : x86_64\r\nVersion     : 3.4.0\r\nRelease     : 0.0.1475.20130913git5952d486.el6\r\nSize        : 2.4 M\r\nRepo        : installed\r\n{noformat}","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=shaon","name":"shaon","key":"shaon","accountId":"557058:1e5e1aa5-5986-4a9e-b9ed-814f7000cd4f","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/70d1c1681d03ea38518d3b4f59db4385?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dshaon%26avatarId%3D11900%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/70d1c1681d03ea38518d3b4f59db4385?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dshaon%26avatarId%3D11900%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/70d1c1681d03ea38518d3b4f59db4385?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dshaon%26avatarId%3D11900%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/70d1c1681d03ea38518d3b4f59db4385?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dshaon%26avatarId%3D11900%26noRedirect%3Dtrue"},"displayName":"Imran Hossain Shaon","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-09-17T13:41:24.900-0500","updated":"2013-09-17T13:41:24.900-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/21913/comment/62333","id":"62333","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=hspencer","name":"hspencer","key":"hspencer","accountId":"557058:4a3a93bc-21f8-4658-9f5b-9cb484c910a7","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue"},"displayName":"Harold Spencer Jr.","active":true,"timeZone":"America/Los_Angeles"},"body":"*Assessment*\r\n\r\nTested this on 3.4.1, and it failed for non-admin, non-eucalyptus account users who had the ability to deregister EBS-backed images.  The weird thing here is that once the non-admin, non-eucalyptus account user deregisters the EBS-backed  image, the user no longer sees it. However the cloud administrator (i.e. admin user of the eucalyptus account) sees the image as 'deregistered'.\r\n\r\n*Signs*\r\n\r\n_Viewing EBS image as non-admin, non-eucalyptus user that the user registered_\r\n{code}\r\n$ euca-describe-images emi-6997427B --region account1-user01@\r\nIMAGE\temi-6997427B\t961915002812/EBS-Precise-RAW-v2\t961915002812\tavailable\tprivate\tx86_64\tmachine\t\t\t\teb\thvm\r\nBLOCKDEVICEMAPPING\t/dev/vda\tsnap-EFDB40A1\t6\ttrue\r\n{code}\r\n_Deregister the image_\r\n{code}\r\n$ euca-deregister emi-6997427B --region account1-user01@\r\nIMAGE\temi-6997427B\r\n{code}\r\n_View image as non-admin, non-eucalyptus account user_\r\n{code}\r\n$ euca-describe-images emi-6997427B --region account1-user01@\r\n$\r\n{code}\r\n_View image as admin, eucalyptus account user_\r\n{code}\r\n$ euca-describe-images verbose --region admin@ | grep emi-6997427B\r\nIMAGE\temi-6997427B\t961915002812/EBS-Precise-RAW-v2\t961915002812\tderegistered\tprivate\tx86_64\tmachine\t\t\t\teb\thvm\r\n{code}\r\n_Re-run deregistration again with non-admin, non-eucalyptus account user_\r\n{code}\r\n$ euca-deregister emi-6997427B --region account1-user01@\r\nIMAGE\temi-6997427B\r\n{code}\r\n_Describe image again as admin, eucalyptus account user_\r\n{code}\r\n$ euca-describe-images verbose --region admin@ | grep emi-6997427B\r\n$\r\n{code}\r\n\r\n*Pertinent Data*\r\n\r\nThis only happens with EBS-backed EMIs.  Instance store-backed EMIs work .\r\n\r\n*Steps*\r\n\r\n* Set up Eucalyptus 3.4.1 cloud\r\n* Download and source credentials of admin user of eucalyptus account\r\n{code}\r\n$ euca-get-credentials -a eucalyptus -u admin admin.zip\r\n$ unzip admin.zip\r\n$ source eucarc\r\n{code}\r\n* Create an account, and a user.  For example, foobar account, acme user:\r\n{code}\r\n$ euare-accountcreate -a foobar\r\n$ euare-usercreate --as-account foobar -u acme\r\n{code}\r\n* Add policy to allow all EC2 actions to 'acme' user:\r\n{code}\r\n$ cat all-actions\r\n{\r\n   \"Statement\":\r\n    [\r\n      {\r\n         \"Effect\":\"Allow\",\r\n         \"Action\":[\"*\"],\r\n         \"Resource\":[\"*\"]\r\n      }\r\n    ]\r\n}\r\n$ euare-useruploadpolicy --as-account foobar -u acme -p all-actions -f all-actions\r\n{code}\r\n* Add keys to 'acme' user, and note access key ID and secret key for later use.\r\n{code}\r\n$ euare-useraddkey --as-account foobar -u acme \r\n{code}\r\n* Download Ubuntu Cloud image:\r\n{code}\r\n$ wget http://cloud-images.ubuntu.com/precise/current/precise-server-cloudimg-amd64.tar.gz\r\n{code}\r\n* Use eustore to bundle, upload and register the image:\r\n{code}\r\n$ eustore-install-image -t precise-server-cloudimg-amd64.tar.gz -b ubuntu-latest-precise-x86_64 --hypervisor universal -s \"Ubuntu Cloud Image - Precise Pangolin - 12.04 LTS\"\r\n{code}\r\n* Make sure launch permissions for EKI, ERI, and EMI are set to 'all'\r\n* Create keypair for 'acme' user:\r\n{code}\r\n$ euca-create-keypair -I <access-key-id> -S <secret-key> foobar-acme > foobar-acme.priv\r\n{code}\r\n* Run the instance as 'acme' user. For example:\r\n{code}\r\n$ euca-run-instances -I <access-key-id> -S <secret-key> -k foobar-acme emi-5C8C3909\r\n{code}\r\n* Authorize SSH traffic to the instance\r\n* Create a volume based upon the size of how big you want the root filesystem to be as 'acme' user:\r\n{code}\r\n$ euca-create-volume -s 6 -z LayinDaSmackDown  -I <access-key-id> -S <secret-key>\r\n{code}\r\n* Attach volume to running instance.  For example:\r\n{code}\r\n$ euca-attach-volume -d /dev/vdd -i i-839E3FB0 vol-B5863B3B -I <access-key-id> -S <secret-key>\r\n{code}\r\n* SSH into the instance and download Ubuntu Cloud Image (qcow2 format):\r\n{code}\r\n$ ssh -i foobar-acme.priv ubuntu@euca-10-104-7-10.eucalyptus.euca-hasp.eucalyptus-systems.com\r\n# sudo -s\r\n# wget http://cloud-images.ubuntu.com/precise/current/precise-server-cloudimg-amd64-disk1.img\r\n{code}\r\n* Install qemu-utils\r\n{code}\r\n# apt-get install -y qemu-utils\r\n{code}\r\n* Convert image from qcow2 to raw:\r\n{code}\r\n# qemu-img convert -O raw precise-server-cloudimg-amd64-disk1.img precise-server-cloudimg-amd64-disk1-raw.img\r\n{code}\r\n* dd raw image to block device where volume is attached:\r\n{code}\r\n# dmesg | tail\r\n[ 7026.943212] virtio-pci 0000:00:05.0: using default PCI settings\r\n[ 7026.943249] pci 0000:00:07.0: no hotplug settings from platform\r\n[ 7026.943251] pci 0000:00:07.0: using default PCI settings\r\n[ 7026.945964] virtio-pci 0000:00:07.0: enabling device (0000 -> 0003)\r\n[ 7026.955143] virtio-pci 0000:00:07.0: PCI INT A -> Link[LNKC] -> GSI 10 (level, high) -> IRQ 10\r\n[ 7026.955180] virtio-pci 0000:00:07.0: setting latency timer to 64\r\n[ 7026.955429] virtio-pci 0000:00:07.0: irq 45 for MSI/MSI-X\r\n[ 7026.955456] virtio-pci 0000:00:07.0: irq 46 for MSI/MSI-X\r\n[ 7026.986990]  vdb: unknown partition table\r\n[10447.093426] virtio-pci 0000:00:07.0: PCI INT A disabled\r\n\r\n# dd if=/mnt/precise-server-cloudimg-amd64-disk1-raw.img of=/dev/vdb bs=1M\r\n{code}\r\n* Detach volume as 'acme' user:\r\n{code}\r\n$ euca-detach-volume vol-B5863B3B -I <access-key-id> -S <secret-key>\r\n{code}\r\n* Create snapshot of volume as 'acme' user:\r\n{code}\r\n$ euca-create-snapshot vol-B5863B3B -I <access-key-id> -S <secret-key>\r\n{code}\r\n* Register the snapshot to create an EBS-backed EMI as 'acme' user:\r\n{code}\r\n$ euca-register --name ebs-precise --snapshot snap-EFDB40A1 --root-device-name /dev/sda  -I <access-key-id> -S <secret-key>\r\n{code}\r\n* De-register the EBS-backed EMI as 'acme' user:\r\n{code}\r\n$ euca-deregister emi-6997427B  -I <access-key-id> -S <secret-key>\r\n{code}\r\n* Run euca-describe-images as 'acme' user\r\n* Run euca-describe-images verbose as admin user of eucalyptus account\r\n* Observe status of EBS-backed EMI","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=hspencer","name":"hspencer","key":"hspencer","accountId":"557058:4a3a93bc-21f8-4658-9f5b-9cb484c910a7","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue"},"displayName":"Harold Spencer Jr.","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-02-03T20:04:32.340-0600","updated":"2014-02-03T20:04:32.340-0600"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/21913/comment/62334","id":"62334","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=hspencer","name":"hspencer","key":"hspencer","accountId":"557058:4a3a93bc-21f8-4658-9f5b-9cb484c910a7","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue"},"displayName":"Harold Spencer Jr.","active":true,"timeZone":"America/Los_Angeles"},"body":"sosreport taken when EBS-backed EMI was being deregistered (shows the bug occurring).  CLC/Walrus machine was set to TRACE debugging mode.","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=hspencer","name":"hspencer","key":"hspencer","accountId":"557058:4a3a93bc-21f8-4658-9f5b-9cb484c910a7","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue"},"displayName":"Harold Spencer Jr.","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-02-03T20:17:29.785-0600","updated":"2014-02-03T20:17:29.785-0600"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/21913/comment/62335","id":"62335","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=hspencer","name":"hspencer","key":"hspencer","accountId":"557058:4a3a93bc-21f8-4658-9f5b-9cb484c910a7","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue"},"displayName":"Harold Spencer Jr.","active":true,"timeZone":"America/Los_Angeles"},"body":"sosreport for deregistration of instance store-backed EMI.  Shows that the issue doesn't happen.","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=hspencer","name":"hspencer","key":"hspencer","accountId":"557058:4a3a93bc-21f8-4658-9f5b-9cb484c910a7","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue"},"displayName":"Harold Spencer Jr.","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-02-03T20:18:22.721-0600","updated":"2014-02-03T20:18:22.721-0600"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/21913/comment/62336","id":"62336","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=hspencer","name":"hspencer","key":"hspencer","accountId":"557058:4a3a93bc-21f8-4658-9f5b-9cb484c910a7","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue"},"displayName":"Harold Spencer Jr.","active":true,"timeZone":"America/Los_Angeles"},"body":"On AWS, the behavior is as follows:\r\n{code}\r\n$ aws ec2 describe-images --image-ids ami-39516950 --profile harold-work --output text\r\nIMAGES\tx86_64\txen\tami-39516950\t048212016277/ebs-precise-x86_64-test\tmachine\taki-88aa75e1\tebs-precise-x86_64-test\t048212016277\tFalse\t/dev/sda1\tebs\tpending\tparavirtual\r\nBLOCKDEVICEMAPPINGS\t/dev/sda1\r\nEBS\tTrue\tsnap-8b1a0f9c\t8\tstandard\r\nBLOCKDEVICEMAPPINGS\t/dev/sdc\tephemeral0\r\n\r\n$ aws ec2 deregister-image --image-id ami-39516950 --profile harold-work --output text\r\ntrue\r\n\r\n$ aws ec2 describe-images --image-ids ami-39516950 --profile harold-work --output text\r\n$\r\n{code}","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=hspencer","name":"hspencer","key":"hspencer","accountId":"557058:4a3a93bc-21f8-4658-9f5b-9cb484c910a7","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue"},"displayName":"Harold Spencer Jr.","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-02-03T20:24:22.317-0600","updated":"2014-02-03T20:24:22.317-0600"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/21913/comment/62337","id":"62337","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=viglesias","name":"viglesias","key":"viglesias","accountId":"557058:49b276ff-ebf9-4dd6-ada3-b568a2898707","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/5608e0aa05bd6e5d73b855a08079cceb?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dviglesias%26avatarId%3D10405%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/5608e0aa05bd6e5d73b855a08079cceb?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dviglesias%26avatarId%3D10405%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/5608e0aa05bd6e5d73b855a08079cceb?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dviglesias%26avatarId%3D10405%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/5608e0aa05bd6e5d73b855a08079cceb?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dviglesias%26avatarId%3D10405%26noRedirect%3Dtrue"},"displayName":"Victor Iglesias","active":true,"timeZone":"America/Los_Angeles"},"body":"[~hspencer]\r\n\r\nWas an instance from this image still running in the cloud perchance? I think the behavior was that we left it in deregistered until all instances from that image were deregistered. Here is what [~shaon] wrote up:\r\nhttps://github.com/eucalyptus/eucalyptus/wiki/Behavioral-Changes-in-Eucalyptus-3.4.0#wiki-deregister-image","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=viglesias","name":"viglesias","key":"viglesias","accountId":"557058:49b276ff-ebf9-4dd6-ada3-b568a2898707","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/5608e0aa05bd6e5d73b855a08079cceb?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dviglesias%26avatarId%3D10405%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/5608e0aa05bd6e5d73b855a08079cceb?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dviglesias%26avatarId%3D10405%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/5608e0aa05bd6e5d73b855a08079cceb?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dviglesias%26avatarId%3D10405%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/5608e0aa05bd6e5d73b855a08079cceb?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dviglesias%26avatarId%3D10405%26noRedirect%3Dtrue"},"displayName":"Victor Iglesias","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-02-03T20:32:24.864-0600","updated":"2014-02-03T20:32:24.864-0600"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/21913/comment/62338","id":"62338","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=hspencer","name":"hspencer","key":"hspencer","accountId":"557058:4a3a93bc-21f8-4658-9f5b-9cb484c910a7","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue"},"displayName":"Harold Spencer Jr.","active":true,"timeZone":"America/Los_Angeles"},"body":"Nope, no instances running with that EMI. \r\n{code}\r\n$ grep emi-6997427B odc-d-06-07-2014020321501391464242/sos_commands/eucafrontend/euca-describe-instances-verbose\r\n$\r\n$ grep emi-6997427B odc-d-06-07-2014020321501391464242/var/log/eucalyptus/*\r\nodc-d-06-07-2014020321501391464242/var/log/eucalyptus/cloud-debug.log.1:AWSAccessKeyId=AKIYO5GIWPS4VIRN7ZU2&Action=DescribeImages&ImageId.1=emi-6997427B&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2014-02-03T21%3A42%3A04Z&Version=2013-02-01\r\nodc-d-06-07-2014020321501391464242/var/log/eucalyptus/cloud-debug.log.1:AWSAccessKeyId=AKIYO5GIWPS4VIRN7ZU2&Action=DescribeImages&ImageId.1=emi-6997427B&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2014-02-03T21%3A42%3A04Z&Version=2013-02-01\r\nodc-d-06-07-2014020321501391464242/var/log/eucalyptus/cloud-debug.log.1:AWSAccessKeyId=AKIYO5GIWPS4VIRN7ZU2&Action=DescribeImages&ImageId.1=emi-6997427B&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2014-02-03T21%3A42%3A04Z&Version=2013-02-01\r\nodc-d-06-07-2014020321501391464242/var/log/eucalyptus/cloud-debug.log.1:AWSAccessKeyId=AKIYO5GIWPS4VIRN7ZU2&Action=DeregisterImage&ImageId=emi-6997427B&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2014-02-03T21%3A43%3A40Z&Version=2013-02-01\r\nodc-d-06-07-2014020321501391464242/var/log/eucalyptus/cloud-debug.log.1:AWSAccessKeyId=AKIYO5GIWPS4VIRN7ZU2&Action=DeregisterImage&ImageId=emi-6997427B&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2014-02-03T21%3A43%3A40Z&Version=2013-02-01\r\nodc-d-06-07-2014020321501391464242/var/log/eucalyptus/cloud-debug.log.1:AWSAccessKeyId=AKIYO5GIWPS4VIRN7ZU2&Action=DeregisterImage&ImageId=emi-6997427B&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2014-02-03T21%3A43%3A40Z&Version=2013-02-01\r\nodc-d-06-07-2014020321501391464242/var/log/eucalyptus/cloud-debug.log.1:AWSAccessKeyId=AKIYO5GIWPS4VIRN7ZU2&Action=DescribeImages&ImageId.1=emi-6997427B&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2014-02-03T21%3A43%3A48Z&Version=2013-02-01\r\nodc-d-06-07-2014020321501391464242/var/log/eucalyptus/cloud-debug.log.1:AWSAccessKeyId=AKIYO5GIWPS4VIRN7ZU2&Action=DescribeImages&ImageId.1=emi-6997427B&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2014-02-03T21%3A43%3A48Z&Version=2013-02-01\r\nodc-d-06-07-2014020321501391464242/var/log/eucalyptus/cloud-debug.log.1:AWSAccessKeyId=AKIYO5GIWPS4VIRN7ZU2&Action=DescribeImages&ImageId.1=emi-6997427B&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2014-02-03T21%3A43%3A48Z&Version=2013-02-01\r\nodc-d-06-07-2014020321501391464242/var/log/eucalyptus/cloud-debug.log.1:AWSAccessKeyId=AKIYO5GIWPS4VIRN7ZU2&Action=DescribeImages&ImageId.1=emi-6997427B&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2014-02-03T21%3A49%3A20Z&Version=2013-02-01\r\nodc-d-06-07-2014020321501391464242/var/log/eucalyptus/cloud-debug.log.1:AWSAccessKeyId=AKIYO5GIWPS4VIRN7ZU2&Action=DescribeImages&ImageId.1=emi-6997427B&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2014-02-03T21%3A49%3A20Z&Version=2013-02-01\r\nodc-d-06-07-2014020321501391464242/var/log/eucalyptus/cloud-debug.log.1:AWSAccessKeyId=AKIYO5GIWPS4VIRN7ZU2&Action=DescribeImages&ImageId.1=emi-6997427B&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2014-02-03T21%3A49%3A20Z&Version=2013-02-01\r\nodc-d-06-07-2014020321501391464242/var/log/eucalyptus/cloud-debug.log.1:AWSAccessKeyId=AKIYO5GIWPS4VIRN7ZU2&Action=DeregisterImage&ImageId=emi-6997427B&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2014-02-03T21%3A49%3A45Z&Version=2013-02-01\r\nodc-d-06-07-2014020321501391464242/var/log/eucalyptus/cloud-debug.log.1:AWSAccessKeyId=AKIYO5GIWPS4VIRN7ZU2&Action=DeregisterImage&ImageId=emi-6997427B&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2014-02-03T21%3A49%3A45Z&Version=2013-02-01\r\nodc-d-06-07-2014020321501391464242/var/log/eucalyptus/cloud-debug.log.1:AWSAccessKeyId=AKIYO5GIWPS4VIRN7ZU2&Action=DeregisterImage&ImageId=emi-6997427B&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2014-02-03T21%3A49%3A45Z&Version=2013-02-01\r\nodc-d-06-07-2014020321501391464242/var/log/eucalyptus/cloud-output.log:                          | AWSAccessKeyId=AKIYO5GIWPS4VIRN7ZU2&Action=DescribeImages&ImageId.1=emi-6997427B&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2014-02-03T21%3A42%3A04Z&Version=2013-02-01\r\nodc-d-06-07-2014020321501391464242/var/log/eucalyptus/cloud-output.log:                          | AWSAccessKeyId=AKIYO5GIWPS4VIRN7ZU2&Action=DescribeImages&ImageId.1=emi-6997427B&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2014-02-03T21%3A42%3A04Z&Version=2013-02-01\r\nodc-d-06-07-2014020321501391464242/var/log/eucalyptus/cloud-output.log:                          | AWSAccessKeyId=AKIYO5GIWPS4VIRN7ZU2&Action=DescribeImages&ImageId.1=emi-6997427B&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2014-02-03T21%3A42%3A04Z&Version=2013-02-01\r\nodc-d-06-07-2014020321501391464242/var/log/eucalyptus/cloud-output.log:                          | AWSAccessKeyId=AKIYO5GIWPS4VIRN7ZU2&Action=DeregisterImage&ImageId=emi-6997427B&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2014-02-03T21%3A43%3A40Z&Version=2013-02-01\r\nodc-d-06-07-2014020321501391464242/var/log/eucalyptus/cloud-output.log:                          | AWSAccessKeyId=AKIYO5GIWPS4VIRN7ZU2&Action=DeregisterImage&ImageId=emi-6997427B&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2014-02-03T21%3A43%3A40Z&Version=2013-02-01\r\nodc-d-06-07-2014020321501391464242/var/log/eucalyptus/cloud-output.log:                          | AWSAccessKeyId=AKIYO5GIWPS4VIRN7ZU2&Action=DeregisterImage&ImageId=emi-6997427B&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2014-02-03T21%3A43%3A40Z&Version=2013-02-01\r\nodc-d-06-07-2014020321501391464242/var/log/eucalyptus/cloud-output.log:                          | AWSAccessKeyId=AKIYO5GIWPS4VIRN7ZU2&Action=DescribeImages&ImageId.1=emi-6997427B&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2014-02-03T21%3A43%3A48Z&Version=2013-02-01\r\nodc-d-06-07-2014020321501391464242/var/log/eucalyptus/cloud-output.log:                          | AWSAccessKeyId=AKIYO5GIWPS4VIRN7ZU2&Action=DescribeImages&ImageId.1=emi-6997427B&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2014-02-03T21%3A43%3A48Z&Version=2013-02-01\r\nodc-d-06-07-2014020321501391464242/var/log/eucalyptus/cloud-output.log:                          | AWSAccessKeyId=AKIYO5GIWPS4VIRN7ZU2&Action=DescribeImages&ImageId.1=emi-6997427B&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2014-02-03T21%3A43%3A48Z&Version=2013-02-01\r\nodc-d-06-07-2014020321501391464242/var/log/eucalyptus/cloud-output.log:                          | AWSAccessKeyId=AKIYO5GIWPS4VIRN7ZU2&Action=DescribeImages&ImageId.1=emi-6997427B&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2014-02-03T21%3A49%3A20Z&Version=2013-02-01\r\nodc-d-06-07-2014020321501391464242/var/log/eucalyptus/cloud-output.log:                          | AWSAccessKeyId=AKIYO5GIWPS4VIRN7ZU2&Action=DescribeImages&ImageId.1=emi-6997427B&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2014-02-03T21%3A49%3A20Z&Version=2013-02-01\r\nodc-d-06-07-2014020321501391464242/var/log/eucalyptus/cloud-output.log:                          | AWSAccessKeyId=AKIYO5GIWPS4VIRN7ZU2&Action=DescribeImages&ImageId.1=emi-6997427B&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2014-02-03T21%3A49%3A20Z&Version=2013-02-01\r\nodc-d-06-07-2014020321501391464242/var/log/eucalyptus/cloud-output.log:                          | AWSAccessKeyId=AKIYO5GIWPS4VIRN7ZU2&Action=DeregisterImage&ImageId=emi-6997427B&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2014-02-03T21%3A49%3A45Z&Version=2013-02-01\r\nodc-d-06-07-2014020321501391464242/var/log/eucalyptus/cloud-output.log:                          | AWSAccessKeyId=AKIYO5GIWPS4VIRN7ZU2&Action=DeregisterImage&ImageId=emi-6997427B&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2014-02-03T21%3A49%3A45Z&Version=2013-02-01\r\nodc-d-06-07-2014020321501391464242/var/log/eucalyptus/cloud-output.log:                          | AWSAccessKeyId=AKIYO5GIWPS4VIRN7ZU2&Action=DeregisterImage&ImageId=emi-6997427B&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2014-02-03T21%3A49%3A45Z&Version=2013-02-01\r\n{code}","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=hspencer","name":"hspencer","key":"hspencer","accountId":"557058:4a3a93bc-21f8-4658-9f5b-9cb484c910a7","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue"},"displayName":"Harold Spencer Jr.","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-02-03T20:48:22.148-0600","updated":"2014-02-03T20:48:22.148-0600"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/21913/comment/62351","id":"62351","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=shaon","name":"shaon","key":"shaon","accountId":"557058:1e5e1aa5-5986-4a9e-b9ed-814f7000cd4f","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/70d1c1681d03ea38518d3b4f59db4385?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dshaon%26avatarId%3D11900%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/70d1c1681d03ea38518d3b4f59db4385?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dshaon%26avatarId%3D11900%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/70d1c1681d03ea38518d3b4f59db4385?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dshaon%26avatarId%3D11900%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/70d1c1681d03ea38518d3b4f59db4385?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dshaon%26avatarId%3D11900%26noRedirect%3Dtrue"},"displayName":"Imran Hossain Shaon","active":true,"timeZone":"America/Los_Angeles"},"body":"Hi [~hspencer],\r\n\r\nI just tried to reproduce this with 3.4.1, but to me it looks like working as expected.\r\nThe default image cleanup time is set to 10 minutes, changing this time to 1 minute for testing purpose,\r\n{noformat}\r\n[root@h-31 acmecreds]# euca-describe-properties | grep cleanupperiod\r\nPROPERTY\tcloud.images.cleanupperiod\t10m\r\n[root@h-31 acmecreds]# euca-modify-property -p cloud.images.cleanupperiod=2m\r\nPROPERTY\tcloud.images.cleanupperiod\t2m was 10m\r\n{noformat}\r\n\r\nUsing _acme_'s credential,\r\n{noformat}\r\n[root@h-31 acmecreds]# source eucarc\r\n[root@h-31 acmecreds]# euca-register --name ebs-precise --snapshot snap-E99640E6 --root-device-name /dev/sda\r\nIMAGE\temi-E3734719\r\n[root@h-31 acmecreds]#\r\n[root@h-31 acmecreds]#\r\n[root@h-31 acmecreds]#\r\n[root@h-31 acmecreds]#\r\n[root@h-31 acmecreds]# date; euca-deregister emi-E3734719; source ../eucarc; while(true); do date; euca-describe-images verbose | grep emi-E3734719; sleep 10; done\r\nTue Feb  4 00:42:48 PST 2014\r\nIMAGE\temi-E3734719\r\nWARN: Load Balancing service URL is not configured.\r\nTue Feb  4 00:42:48 PST 2014\r\nIMAGE\temi-E3734719\t352836605893/ebs-precise\t352836605893\tderegistered\tprivate\tx86_64\tmachine\t\t\t\tebs\thvm\r\nTue Feb  4 00:42:58 PST 2014\r\nIMAGE\temi-E3734719\t352836605893/ebs-precise\t352836605893\tderegistered\tprivate\tx86_64\tmachine\t\t\t\tebs\thvm\r\nTue Feb  4 00:43:08 PST 2014\r\nIMAGE\temi-E3734719\t352836605893/ebs-precise\t352836605893\tderegistered\tprivate\tx86_64\tmachine\t\t\t\tebs\thvm\r\nTue Feb  4 00:43:19 PST 2014\r\nIMAGE\temi-E3734719\t352836605893/ebs-precise\t352836605893\tderegistered\tprivate\tx86_64\tmachine\t\t\t\tebs\thvm\r\nTue Feb  4 00:43:29 PST 2014\r\nIMAGE\temi-E3734719\t352836605893/ebs-precise\t352836605893\tderegistered\tprivate\tx86_64\tmachine\t\t\t\tebs\thvm\r\nTue Feb  4 00:43:39 PST 2014\r\nIMAGE\temi-E3734719\t352836605893/ebs-precise\t352836605893\tderegistered\tprivate\tx86_64\tmachine\t\t\t\tebs\thvm\r\nTue Feb  4 00:43:49 PST 2014\r\nTue Feb  4 00:44:00 PST 2014\r\nTue Feb  4 00:44:10 PST 2014\r\nTue Feb  4 00:44:20 PST 2014\r\nTue Feb  4 00:44:30 PST 2014\r\nTue Feb  4 00:44:41 PST 2014\r\n{noformat}\r\n\r\nAccording to the fix this behavior is expected. But if we want the behavior to be different, I think, we should open an _improvement_ ticket. Let me know if I am missing some points here. However, the problem I found is, it takes half of the allocated time for image cleanup. [~sjones] may be able to provide some light on this. ( related: EUCA-6962 )","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=shaon","name":"shaon","key":"shaon","accountId":"557058:1e5e1aa5-5986-4a9e-b9ed-814f7000cd4f","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/70d1c1681d03ea38518d3b4f59db4385?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dshaon%26avatarId%3D11900%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/70d1c1681d03ea38518d3b4f59db4385?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dshaon%26avatarId%3D11900%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/70d1c1681d03ea38518d3b4f59db4385?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dshaon%26avatarId%3D11900%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/70d1c1681d03ea38518d3b4f59db4385?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dshaon%26avatarId%3D11900%26noRedirect%3Dtrue"},"displayName":"Imran Hossain Shaon","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-02-04T03:13:51.615-0600","updated":"2014-02-04T03:13:51.615-0600"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/21913/comment/62352","id":"62352","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=hspencer","name":"hspencer","key":"hspencer","accountId":"557058:4a3a93bc-21f8-4658-9f5b-9cb484c910a7","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue"},"displayName":"Harold Spencer Jr.","active":true,"timeZone":"America/Los_Angeles"},"body":"Hey [~shaon],\r\n\r\nI talked to [~viglesias] about it and he educated me on the new behavior.  I wasn't aware we left the resources in the 'deregistered' state that only the cloud administrator could view.  I tested it again with both EBS-backed EMI and instance store-backed EMI and the behavior was exactly the same.  Thanks for the help on this.  I will create a KB article (highlighting the [github wiki entry|https://github.com/eucalyptus/eucalyptus/wiki/Behavioral-Changes-in-Eucalyptus-3.4.0#wiki-deregister-image]).  ","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=hspencer","name":"hspencer","key":"hspencer","accountId":"557058:4a3a93bc-21f8-4658-9f5b-9cb484c910a7","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue"},"displayName":"Harold Spencer Jr.","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-02-04T08:11:57.153-0600","updated":"2014-02-04T08:12:58.119-0600"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/21913/comment/62353","id":"62353","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=hspencer","name":"hspencer","key":"hspencer","accountId":"557058:4a3a93bc-21f8-4658-9f5b-9cb484c910a7","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue"},"displayName":"Harold Spencer Jr.","active":true,"timeZone":"America/Los_Angeles"},"body":"After talking with [~viglesias] and [~shaon], the bug was fixed.  There was a misunderstanding of the behavioral change regarding the cloud user vs. cloud administrator point-of-view.  ","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=hspencer","name":"hspencer","key":"hspencer","accountId":"557058:4a3a93bc-21f8-4658-9f5b-9cb484c910a7","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue"},"displayName":"Harold Spencer Jr.","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-02-04T08:51:33.896-0600","updated":"2014-02-04T08:51:33.896-0600"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/21913/comment/62632","id":"62632","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=hspencer","name":"hspencer","key":"hspencer","accountId":"557058:4a3a93bc-21f8-4658-9f5b-9cb484c910a7","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue"},"displayName":"Harold Spencer Jr.","active":true,"timeZone":"America/Los_Angeles"},"body":"Added KB article - [Image Deregistration Difference Between Cloud Administrators and Cloud Users|https://eucalyptus.zendesk.com/hc/en-us/articles/200898470-Image-Deregistration-Difference-Between-Cloud-Administrators-and-Cloud-Users].","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=hspencer","name":"hspencer","key":"hspencer","accountId":"557058:4a3a93bc-21f8-4658-9f5b-9cb484c910a7","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue"},"displayName":"Harold Spencer Jr.","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-02-09T09:22:01.204-0600","updated":"2014-02-09T09:22:29.905-0600"}],"maxResults":49,"total":49,"startAt":0},"votes":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/EUCA-6559/votes","votes":1,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_11808":null}}
{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"38032","self":"https://eucalyptus.atlassian.net/rest/api/2/issue/38032","key":"EUCA-11328","fields":{"issuetype":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://eucalyptus.atlassian.net/secure/viewavatar?size=xsmall&avatarId=14803&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":14803},"timespent":null,"customfield_13100":null,"project":{"self":"https://eucalyptus.atlassian.net/rest/api/2/project/10000","id":"10000","key":"EUCA","name":"Eucalyptus","avatarUrls":{"48x48":"https://eucalyptus.atlassian.net/secure/projectavatar?pid=10000&avatarId=10011","24x24":"https://eucalyptus.atlassian.net/secure/projectavatar?size=small&pid=10000&avatarId=10011","16x16":"https://eucalyptus.atlassian.net/secure/projectavatar?size=xsmall&pid=10000&avatarId=10011","32x32":"https://eucalyptus.atlassian.net/secure/projectavatar?size=medium&pid=10000&avatarId=10011"}},"customfield_11000":null,"fixVersions":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/version/14801","id":"14801","description":"Eucalyptus 4.2.0","name":"4.2.0","archived":false,"released":true,"releaseDate":"2015-10-22"}],"customfield_11001":null,"aggregatetimespent":null,"resolution":{"self":"https://eucalyptus.atlassian.net/rest/api/2/resolution/7","id":"7","description":"Signifies completion of tasks, info requests, etc.","name":"Completed"},"customfield_10310":null,"customfield_10311":null,"customfield_11401":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=mclark","name":"mclark","key":"mclark","accountId":"557058:9b68e4d6-90d8-47d3-9c86-519770009164","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/4227b07e7ea0ea725670fc4e987ed04d?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FavatarId%3D10122%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/4227b07e7ea0ea725670fc4e987ed04d?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26avatarId%3D10122%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/4227b07e7ea0ea725670fc4e987ed04d?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26avatarId%3D10122%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/4227b07e7ea0ea725670fc4e987ed04d?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26avatarId%3D10122%26noRedirect%3Dtrue"},"displayName":"Matt Clark","active":true,"timeZone":"America/Los_Angeles"},"customfield_11400":null,"customfield_10302":null,"customfield_10104":["com.atlassian.greenhopper.service.sprint.Sprint@49bcf764[id=128,rapidViewId=92,state=CLOSED,name=4.2.0 Sprint 10,goal=<null>,startDate=2015-09-09T20:38:52.383Z,endDate=2015-10-02T20:38:00.000Z,completeDate=2015-11-03T02:34:19.117Z,sequence=128]"],"customfield_10500":{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/10403","value":"Not Applicable","id":"10403"},"customfield_10105":null,"customfield_10303":null,"customfield_10304":null,"customfield_10700":null,"customfield_10701":null,"customfield_10702":null,"customfield_10306":null,"customfield_10703":null,"resolutiondate":"2015-10-26T16:00:58.548-0500","customfield_10704":null,"customfield_10308":null,"customfield_10309":null,"customfield_10705":null,"workratio":-1,"watches":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/EUCA-11328/watchers","watchCount":2,"isWatching":false},"lastViewed":null,"created":"2015-09-03T00:24:29.602-0500","customfield_12000":null,"priority":{"self":"https://eucalyptus.atlassian.net/rest/api/2/priority/2","iconUrl":"https://eucalyptus.atlassian.net/images/icons/priorities/critical.svg","name":"Critical","id":"2"},"customfield_12400":null,"customfield_12201":null,"customfield_10300":null,"customfield_12600":"{repository={count=2, dataType=repository}, json={\"cachedValue\":{\"errors\":[],\"summary\":{\"repository\":{\"overall\":{\"count\":2,\"lastUpdated\":\"2015-10-07T11:04:43.000-0500\",\"dataType\":\"repository\"},\"byInstanceType\":{\"github\":{\"count\":2,\"name\":\"GitHub\"}}}}},\"isStale\":true}}","customfield_10102":null,"labels":[],"customfield_10301":null,"customfield_11700":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"versions":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/version/14801","id":"14801","description":"Eucalyptus 4.2.0","name":"4.2.0","archived":false,"released":true,"releaseDate":"2015-10-22"}],"customfield_11901":null,"issuelinks":[{"id":"32722","self":"https://eucalyptus.atlassian.net/rest/api/2/issueLink/32722","type":{"id":"10103","name":"Relates","inward":"relates to","outward":"relates to","self":"https://eucalyptus.atlassian.net/rest/api/2/issueLinkType/10103"},"inwardIssue":{"id":"38142","key":"EUCA-11358","self":"https://eucalyptus.atlassian.net/rest/api/2/issue/38142","fields":{"summary":"VPC - VM network is not restored after stop/start","status":{"self":"https://eucalyptus.atlassian.net/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://eucalyptus.atlassian.net/images/icons/statuses/generic.png","name":"Closed","id":"6","statusCategory":{"self":"https://eucalyptus.atlassian.net/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://eucalyptus.atlassian.net/rest/api/2/priority/2","iconUrl":"https://eucalyptus.atlassian.net/images/icons/priorities/critical.svg","name":"Critical","id":"2"},"issuetype":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://eucalyptus.atlassian.net/secure/viewavatar?size=xsmall&avatarId=14803&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":14803}}}}],"assignee":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=mclark","name":"mclark","key":"mclark","accountId":"557058:9b68e4d6-90d8-47d3-9c86-519770009164","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/4227b07e7ea0ea725670fc4e987ed04d?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FavatarId%3D10122%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/4227b07e7ea0ea725670fc4e987ed04d?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26avatarId%3D10122%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/4227b07e7ea0ea725670fc4e987ed04d?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26avatarId%3D10122%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/4227b07e7ea0ea725670fc4e987ed04d?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26avatarId%3D10122%26noRedirect%3Dtrue"},"displayName":"Matt Clark","active":true,"timeZone":"America/Los_Angeles"},"updated":"2016-06-06T16:25:59.281-0500","status":{"self":"https://eucalyptus.atlassian.net/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://eucalyptus.atlassian.net/images/icons/statuses/generic.png","name":"Closed","id":"6","statusCategory":{"self":"https://eucalyptus.atlassian.net/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/component/12800","id":"12800","name":"eucanetd","description":"Used to track component level items associated with Edge."}],"timeoriginalestimate":null,"description":"(Changed title to reflect the issue. This will likely happen across any two subnets due to snat rules on the VPC router). \r\n\r\nFound this during nettest's multi zone tests  sample (results: http://jenkins.qa1.eucalyptus-systems.com:8080/view/Matts/job/matt-net-test/38/parsed_console/)\r\n\r\nFailing Test: VM1(security group1: zone1)  <-- to -->  VM2(security group1:zone2).private_ip \r\nThis same test appears to work for ICMP and UDP just not TCP \r\n\r\n\r\n\r\nIn the test ssh between vm1(security group1: zone1) to vm2(security group1:zone2).private_ip fails. \r\nTest log output for failure:\r\n{code}\r\n[2015-09-03 03:21:42,754] [net_tests] [DEBUG]: (does_sec_group_allow:3858): sec_group DOES allow: group:\"net_tests_group1_1441250197.01\", src:\"172.31.15.30\", proto:\"tcp\", port:\"22\"\r\n[2015-09-03 03:21:42,759] [net_tests] [DEBUG]: (does_instance_sec_group_allow:3682): Sec allows from test source addr: 172.31.15.30, src_group:None, protocol:tcp, port:22\r\n[2015-09-03 03:21:42,764] [net_tests] [DEBUG]: (test5_test_ssh_between_instances_in_same_sec_groups_different_zone:896): Now Running the ssh command...\r\n[2015-09-03 03:21:42,765] [i-e01884b7] [DEBUG]: [root@10.116.170.10]# ssh -o StrictHostKeyChecking=no -i net_tests_key_1441250197.76.pem root@172.31.27.77 ' uname -a'\r\n[2015-09-03 03:22:45,891] [i-e01884b7] [DEBUG]: \r\nssh: connect to host 172.31.27.77 port 22: Connection timed out\r\n{code}\r\n\r\n\r\nI was able to reproduce this manually and narrow this down to TCP traffic on pretty much any port over the private ip addrs, test output below...\r\n\r\n\r\nRUN 1 INSTANCE FROM THE SAME SECURITY GROUP IN TWO DIFFERENT ZONES....\r\n{code}\r\nIn [123]: ins1 = tester.run_image(image=emi, group=group, keypair=key, type='m1.medium', zone='one')[0]\r\nIn [124]: ins1 = tester.run_image(image=emi, group=group, keypair=key, type='m1.medium', zone='two')[0]\r\nIn [125]: ins = [ins1, ins2]\r\nIn [116]: tester.show_instances(ins)\r\n \r\n+---------------------+--------------------------+-------------------+----------------------------------------------------------------------------+\r\n|INSTANCE ID          |INSTANCE IMAGE            |INSTANCE STATE     |INSTANCE NETWORK INFO:                                                      |\r\n+---------------------+--------------------------+-------------------+----------------------------------------------------------------------------+\r\n|ID: i-b27dd3bd       |EMI: emi-aec40657         |STATE: running     |+------------+---------------+-----------+-+---------------+---------------+|\r\n|VMTYPE: m1.medium    |OS: linux                 |AGE: 3131          ||    VPC     |     SUBNET    |  SEC GRPS |P|    PRIV IP    |     PUB IP    ||\r\n|RES: r-52cfcfe4      |VIRT: HVM                 |ZONE: one          |+------------+---------------+-----------+-+---------------+---------------+|\r\n|KEYPAIR:             |(preciseservercloudimga..)|ROOTDEV:           ||vpc-c6e016fe|subnet-4e7eed48|sg-dd9a7e0e|N|  172.31.10.84 | 10.116.170.10 ||\r\n|mattstress           |                          |instance-store     |+------------+---------------+-----------+-+---------------+---------------+|\r\n+---------------------+--------------------------+-------------------+----------------------------------------------------------------------------+\r\n|ID: i-ef17720c       |EMI: emi-aec40657         |STATE: running     |+------------+---------------+-----------+-+---------------+---------------+|\r\n|VMTYPE: m1.medium    |OS: linux                 |AGE: 2869          ||    VPC     |     SUBNET    |  SEC GRPS |P|    PRIV IP    |     PUB IP    ||\r\n|RES: r-8cd65ab1      |VIRT: HVM                 |ZONE: two          |+------------+---------------+-----------+-+---------------+---------------+|\r\n|KEYPAIR:             |(preciseservercloudimga..)|ROOTDEV:           ||vpc-c6e016fe|subnet-321bd6b0|sg-dd9a7e0e|N| 172.31.26.122 | 10.116.170.100||\r\n|mattstress           |                          |instance-store     |+------------+---------------+-----------+-+---------------+---------------+|\r\n+---------------------+--------------------------+-------------------+----------------------------------------------------------------------------+\r\n\r\n\r\n\r\n\r\nIn [117]: tester.show_security_group(group)\r\n[2015-09-02 21:57:19,390] [EUCAOPS] [DEBUG]: Found matching security group for name:None and id:sg-dd9a7e0e\r\n[2015-09-02 21:57:19,394] [EUCAOPS] [DEBUG]: \r\n+--------------------------------------------------------------------------------+\r\n|              Security Group: matt/sg-dd9a7e0e, VPC: vpc-c6e016fe               |\r\n+--------------------------------------------------------------------------------+\r\n| +-----------+--------------+------------+----------+------+----------+-------+ |\r\n| |  CIDR_IP  | SRC_GRP_NAME | SRC_GRP_ID | OWNER_ID | PORT | END_PORT | PROTO | |\r\n| +-----------+--------------+------------+----------+------+----------+-------+ |\r\n| | 0.0.0.0/0 |     None     |    None    |   None   | 101  |   201    |  tcp  | |\r\n| +-----------+--------------+------------+----------+------+----------+-------+ |\r\n| | 0.0.0.0/0 |     None     |    None    |   None   |  22  |    22    |  tcp  | |\r\n| +-----------+--------------+------------+----------+------+----------+-------+ |\r\n| | 0.0.0.0/0 |     None     |    None    |   None   |  -1  |    -1    |  icmp | |\r\n| +-----------+--------------+------------+----------+------+----------+-------+ |\r\n| | 0.0.0.0/0 |     None     |    None    |   None   |  0   |  65000   |  udp  | |\r\n| +-----------+--------------+------------+----------+------+----------+-------+ |\r\n+--------------------------------------------------------------------------------+ \r\n\r\n{code}\r\n\r\nMIDO TO EUCA SECURITY GROUP MAPPINGS....\r\n\r\n{code}\r\nIn [118]: md.show_\r\nmd.show_bgps                                 md.show_chain                                md.show_hosts_summary                        md.show_routers\r\nmd.show_bridge_arp_table                     md.show_chain_for_security_group             md.show_instance_network_summary             md.show_routers_brief\r\nmd.show_bridge_dhcp_subnets                  md.show_chains_for_instance_security_groups  md.show_ip_addr_group_addrs                  md.show_routes\r\nmd.show_bridge_for_instance                  md.show_host_for_instance                    md.show_port_summary                         md.show_rules\r\nmd.show_bridge_mac_table                     md.show_host_interfaces                      md.show_ports                                md.show_security_group\r\nmd.show_bridge_port_for_instance             md.show_host_ports                           md.show_router_for_instance                  md.show_security_groups_for_instance\r\nmd.show_bridges                              md.show_hosts                                md.show_router_summary                       md.show_tunnel_zones\r\n\r\n\r\n\r\n\r\nIn [119]: md.show_chains_for_instance_security_groups(ins1)\r\n[2015-09-02 21:58:22,692][INFO][MidoDebug:10.111.5.10]: Found matching security group for name:None and id:sg-dd9a7e0e\r\n[2015-09-02 21:58:22,866][INFO][MidoDebug:10.111.5.10]: \r\nSECURITY GROUP/MIDO CHAIN RULE MAPPING for INSTANCE: 'i-b27dd3bd'\r\n+--------------------------------------------------------------------------------------------------------------+\r\n| MIDO CHAIN RULES FOR EUCA SECURITY GROUP:sg-dd9a7e0e (matt)                                                  |\r\n+--------------------------------------------------------------------------------------------------------------+\r\n|                                                                                                              |\r\n| +----------------------------------------------------------------+                                           |\r\n| |      Security Group: matt/sg-dd9a7e0e, VPC: vpc-c6e016fe       |                                           |\r\n| +----------------------------------------------------------------+                                           |\r\n| |----------------------------------------------------------------|                                           |\r\n| |  CIDR_IP  SRC_GRP_NAME SRC_GRP_ID OWNER_ID PORT END_PORT PROTO |                                           |\r\n| |----------------------------------------------------------------|                                           |\r\n| | 0.0.0.0/0     None        None      None   101    201     tcp  |                                           |\r\n| |----------------------------------------------------------------|                                           |\r\n| | 0.0.0.0/0     None        None      None    22     22     tcp  |                                           |\r\n| |----------------------------------------------------------------|                                           |\r\n| | 0.0.0.0/0     None        None      None    -1     -1     icmp |                                           |\r\n| |----------------------------------------------------------------|                                           |\r\n| | 0.0.0.0/0     None        None      None    0    65000    udp  |                                           |\r\n| |----------------------------------------------------------------|                                           |\r\n| +----------------------------------------------------------------+                                           |\r\n| +----------------------------------------------------------------------------------------------------------+ |\r\n| | CHAIN NAME:sg_ingress_sg-dd9a7e0e, ID:fb8db85e-4535-4e42-91e0-34f4bab0c263 TENANT ID:euca_tenant_1       | |\r\n| +----------------------------------------------------------------------------------------------------------+ |\r\n| | +-----------------------+---------+------+-----+-------+---+---------+--------+---+------+------+------+ | |\r\n| | |RULES FOR CHAIN:..0c263|   SRC   | DST  |PROTO| DPORTS|TOS|GRP ADDRS|FRAG POL|POS| TYPE |ACTION|TARGET| | |\r\n| | +-----------------------+---------+------+-----+-------+---+---------+--------+---+------+------+------+ | |\r\n| | |RULE#:1                |0.0.0.0/0|None/0| TCP | 22:22 | 0 |None     | header | 1 |accept|      |      | | |\r\n| | |de35358b-2422-4d73     |         |      |     |       |   |         |        |   |      |      |      | | |\r\n| | |-bbbc-b058024d5dce     |         |      |     |       |   |         |        |   |      |      |      | | |\r\n| | +-----------------------+---------+------+-----+-------+---+---------+--------+---+------+------+------+ | |\r\n| | |RULE#:2                |0.0.0.0/0|None/0| TCP |101:201| 0 |None     | header | 2 |accept|      |      | | |\r\n| | |a5571968-8fd2-43b0-8bb1|         |      |     |       |   |         |        |   |      |      |      | | |\r\n| | |-91d894883926          |         |      |     |       |   |         |        |   |      |      |      | | |\r\n| | +-----------------------+---------+------+-----+-------+---+---------+--------+---+------+------+------+ | |\r\n| | |RULE#:3                |0.0.0.0/0|None/0| UDP |0:65000| 0 |None     | header | 3 |accept|      |      | | |\r\n| | |9df98da1-af19-4132     |         |      |     |       |   |         |        |   |      |      |      | | |\r\n| | |-abce-df3c811f0e16     |         |      |     |       |   |         |        |   |      |      |      | | |\r\n| | +-----------------------+---------+------+-----+-------+---+---------+--------+---+------+------+------+ | |\r\n| | |RULE#:4                |0.0.0.0/0|None/0| ICMP|  None | 0 |None     |  any   | 4 |accept|      |      | | |\r\n| | |0f48122d-3dcc-         |         |      |     |       |   |         |        |   |      |      |      | | |\r\n| | |4fe1-98c3-7ff5e3b200cb |         |      |     |       |   |         |        |   |      |      |      | | |\r\n| | +-----------------------+---------+------+-----+-------+---+---------+--------+---+------+------+------+ | |\r\n| +----------------------------------------------------------------------------------------------------------+ |\r\n+--------------------------------------------------------------------------------------------------------------+\r\n\r\n{code}\r\n\r\nRUN A SET OF PACKET TESTS USING DIFFERENT PROTOS, PORTS, ETC BETWEEN EACH VM...\r\n\r\nTEST 1 VM1 TO VM2 USING VM2'S PUB IP, PROTO=TCP - SUCCESS\r\n\r\n{code}\r\nIn [120]: packet_test(ins1.ssh, ins2.ssh, dest_ip=ins2.ip_address, protocol=6, port=101, bind=True, count=3, verbose=2)\r\n[2015-09-02 21:58:57,205] [i-ef17720c] [DEBUG]: Starting receiver...\r\n\r\n# Done Copying script:\"ip_rx.py\" to \"10.116.170.100\"\r\n[2015-09-02 21:58:57,411] [i-ef17720c] [DEBUG]: [root@10.116.170.100]# python ip_rx.py -o 6 -c 3 -v1  -p '101'  -t 5  --bind \r\n[2015-09-02 21:58:57,582] [i-b27dd3bd] [DEBUG]: Starting Sender...\r\n\r\n[2015-09-02 21:58:57,582] [i-ef17720c] [DEBUG]: # Begin Capture For Protocol:TCP/6\r\n\r\n[2015-09-02 21:58:57,582] [i-ef17720c] [DEBUG]: \r\n\r\n# Done Copying script:\"ip_tx.py\" to \"10.116.170.10\"\r\n# CMD: python ip_tx.py -o 6 -c 3 -d 10.116.170.100 -i 0.1 -t 4  -p 101 \r\n[2015-09-02 21:58:57,843] [i-b27dd3bd] [DEBUG]: [root@10.116.170.10]# python ip_tx.py -o 6 -c 3 -d 10.116.170.100 -i 0.1 -t 4  -p 101 \r\n[2015-09-02 21:58:57,992] [i-ef17720c] [DEBUG]: # --------------------------------------------------------------------------------\r\n\r\n[2015-09-02 21:58:57,993] [i-ef17720c] [DEBUG]: # IP ver:None, HDR LEN:None, TTL:None, PROTO:6, SRC ADDR:10.116.170.10, DST ADDR:\r\n# Src Port:100, Dst Port:101\r\n\r\n[2015-09-02 21:58:58,002] [i-b27dd3bd] [DEBUG]: # send_packet: destip:10.116.170.100, dstport:101, proto:6, ptype:None, count:3, interval:0.1\r\n\r\n[2015-09-02 21:58:58,002] [i-b27dd3bd] [DEBUG]: \r\n\r\n[2015-09-02 21:58:58,093] [i-ef17720c] [DEBUG]: # --------------------------------------------------------------------------------\r\n\r\n[2015-09-02 21:58:58,093] [i-ef17720c] [DEBUG]: # IP ver:None, HDR LEN:None, TTL:None, PROTO:6, SRC ADDR:10.116.170.10, DST ADDR:\r\n\r\n[2015-09-02 21:58:58,145] [i-ef17720c] [DEBUG]: # Src Port:100, Dst Port:101\r\n\r\n[2015-09-02 21:58:58,196] [i-ef17720c] [DEBUG]: # --------------------------------------------------------------------------------\r\n# IP ver:None, HDR LEN:None, TTL:None, PROTO:6, SRC ADDR:10.116.170.10, DST ADDR:\r\n# Src Port:100, Dst Port:101\r\n\r\n{\r\n    \"count\": 3, \r\n    \"date\": \"Thu Sep  3 04:59:18 2015\", \r\n    \"elapsed\": 0.63, \r\n    \"error\": \"\", \r\n    \"name\": \"PROTO:6, SRCADDRS:{}, DSTADDRS:{}, PORTS:{101: 0}\", \r\n    \"packets\": {\r\n        \"10.116.170.10\": {\r\n            \"\": {\r\n                \"101\": 3\r\n            }\r\n        }\r\n    }, \r\n    \"protocol\": 6\r\n}\r\n\r\n[2015-09-02 21:58:58,348] [i-b27dd3bd] [DEBUG]: done with exec\r\n# # send_packet: destip:10.116.170.100, dstport:101, proto:6, ptype:None, count:3, interval:0.1\r\n\r\n[2015-09-02 21:58:58,248] [i-ef17720c] [DEBUG]: done with exec\r\nOut[120]: \r\n{u'count': 3,\r\n u'date': u'Thu Sep  3 04:59:18 2015',\r\n u'elapsed': 0.63,\r\n u'error': u'',\r\n u'name': u'PROTO:6, SRCADDRS:{}, DSTADDRS:{}, PORTS:{101: 0}',\r\n u'packets': {u'10.116.170.10': {u'': {u'101': 3}}},\r\n u'protocol': 6}\r\n\r\nIn [121]: \r\n\r\n{code}\r\n\r\nTEST 2 VM1 TO VM2 USING VM2'S PRIVATE IP, PROTO=TCP - FAILURE\r\n\r\n{code}\r\nIn [121]: packet_test(ins1.ssh, ins2.ssh, dest_ip=ins2.private_ip_address, protocol=6, port=101, bind=True, verbose=2)\r\n[2015-09-02 21:59:22,293] [i-ef17720c] [DEBUG]: Starting receiver...\r\n\r\n# Done Copying script:\"ip_rx.py\" to \"10.116.170.100\"\r\n[2015-09-02 21:59:22,502] [i-ef17720c] [DEBUG]: [root@10.116.170.100]# python ip_rx.py -o 6 -c 1 -v1  -p '101'  -t 5  --bind \r\n[2015-09-02 21:59:22,672] [i-b27dd3bd] [DEBUG]: Starting Sender...\r\n\r\n[2015-09-02 21:59:22,672] [i-ef17720c] [DEBUG]: # Begin Capture For Protocol:TCP/6\r\n\r\n[2015-09-02 21:59:22,672] [i-ef17720c] [DEBUG]: \r\n\r\n# Done Copying script:\"ip_tx.py\" to \"10.116.170.10\"\r\n# CMD: python ip_tx.py -o 6 -c 1 -d 172.31.26.122 -i 0.1 -t 4  -p 101 \r\n[2015-09-02 21:59:22,921] [i-b27dd3bd] [DEBUG]: [root@10.116.170.10]# python ip_tx.py -o 6 -c 1 -d 172.31.26.122 -i 0.1 -t 4  -p 101 \r\n[2015-09-02 21:59:23,080] [i-b27dd3bd] [DEBUG]: # send_packet: destip:172.31.26.122, dstport:101, proto:6, ptype:None, count:1, interval:0.1\r\n\r\n[2015-09-02 21:59:23,081] [i-b27dd3bd] [DEBUG]: \r\n\r\n[2015-09-02 21:59:27,152] [i-b27dd3bd] [DEBUG]: Traceback (most recent call last):\r\n\r\n[2015-09-02 21:59:27,152] [i-b27dd3bd] [DEBUG]:   File \"ip_tx.py\", line 759, in <module>\r\n\r\n[2015-09-02 21:59:27,203] [i-b27dd3bd] [DEBUG]:     count=count, interval=interval, timeout=socktimeout)\r\n  File \"ip_tx.py\", line 327, in send_packet\r\n    count=count, interval=interval, timeout=timeout)\r\n  File \"ip_tx.py\", line 255, in send_tcp_packet\r\n    s.connect((destip, dstport))\r\n  File \"/usr/lib/python2.7/socket.py\", line 224, in meth\r\n    return getattr(self._sock,name)(*args)\r\nsocket.timeout: timed out\r\n\r\n[2015-09-02 21:59:27,204] [i-b27dd3bd] [DEBUG]: done with exec\r\n[2015-09-02 21:59:27,664] [i-ef17720c] [DEBUG]: Sender is Done. Setting command timer to 5 seconds\r\n[2015-09-02 21:59:27,664] [i-ef17720c] [DEBUG]: \r\n{\r\n    \"count\": 0, \r\n    \"date\": \"Thu Sep  3 04:59:43 2015\", \r\n    \"elapsed\": 5.01, \r\n    \"error\": \"Traceback (most recent call last):\\n  File \\\"ip_rx.py\\\", line 448, in <module>\\n    connection, ip_info = sock.accept()\\n  File \\\"/usr/lib/python2.7/socket.py\\\", line 202, in accept\\n    sock, addr = self._sock.accept()\\ntimeout: timed out\\n\", \r\n    \"name\": \"PROTO:6, SRCADDRS:{}, DSTADDRS:{}, PORTS:{101: 0}\", \r\n    \"packets\": {}, \r\n    \"protocol\": 6\r\n}\r\n\r\n\r\n{code}\r\n\r\nTEST 3 VM1 TO VM2 USING VM2'S PRIVATE IP, PROTO=UDP - SUCCESS\r\n\r\n{code}\r\n\r\n\r\nIn [122]: packet_test(ins1.ssh, ins2.ssh, dest_ip=ins2.private_ip_address, protocol=17, port=101, bind=True, count=3, verbose=2)\r\n[2015-09-02 21:59:36,441] [i-ef17720c] [DEBUG]: Starting receiver...\r\n\r\n# Done Copying script:\"ip_rx.py\" to \"10.116.170.100\"\r\n[2015-09-02 21:59:36,693] [i-ef17720c] [DEBUG]: [root@10.116.170.100]# python ip_rx.py -o 17 -c 3 -v1  -p '101'  -t 5  --bind \r\n[2015-09-02 21:59:36,882] [i-b27dd3bd] [DEBUG]: Starting Sender...\r\n\r\n[2015-09-02 21:59:36,883] [i-ef17720c] [DEBUG]: # Begin Capture For Protocol:UDP/17\r\n\r\n[2015-09-02 21:59:36,883] [i-ef17720c] [DEBUG]: \r\n\r\n# Done Copying script:\"ip_tx.py\" to \"10.116.170.10\"\r\n# CMD: python ip_tx.py -o 17 -c 3 -d 172.31.26.122 -i 0.1 -t 4  -p 101 \r\n[2015-09-02 21:59:37,108] [i-b27dd3bd] [DEBUG]: [root@10.116.170.10]# python ip_tx.py -o 17 -c 3 -d 172.31.26.122 -i 0.1 -t 4  -p 101 \r\n[2015-09-02 21:59:37,253] [i-ef17720c] [DEBUG]: # --------------------------------------------------------------------------------\r\n\r\n[2015-09-02 21:59:37,270] [i-b27dd3bd] [DEBUG]: # send_packet: destip:172.31.26.122, dstport:101, proto:17, ptype:None, count:3, interval:0.1\r\n\r\n[2015-09-02 21:59:37,270] [i-b27dd3bd] [DEBUG]: \r\n\r\n[2015-09-02 21:59:37,305] [i-ef17720c] [DEBUG]: # IP ver:4, HDR LEN:20, TTL:63, PROTO:17, SRC ADDR:10.116.170.10, DST ADDR:172.31.26.122\r\n# Src Port:100, Dst Port:101\r\n\r\n[2015-09-02 21:59:37,356] [i-ef17720c] [DEBUG]: # --------------------------------------------------------------------------------\r\n# IP ver:4, HDR LEN:20, TTL:63, PROTO:17, SRC ADDR:10.116.170.10, DST ADDR:172.31.26.122\r\n# Src Port:100, Dst Port:101\r\n\r\n[2015-09-02 21:59:37,452] [i-ef17720c] [DEBUG]: # --------------------------------------------------------------------------------\r\n\r\n[2015-09-02 21:59:37,504] [i-ef17720c] [DEBUG]: # IP ver:4, HDR LEN:20, TTL:63, PROTO:17, SRC ADDR:10.116.170.10, DST ADDR:172.31.26.122\r\n# Src Port:100, Dst Port:101\r\n\r\n{\r\n    \"count\": 3, \r\n    \"date\": \"Thu Sep  3 04:59:57 2015\", \r\n    \"elapsed\": 0.62, \r\n    \"error\": \"\", \r\n    \"name\": \"PROTO:17, SRCADDRS:{}, DSTADDRS:{}, PORTS:{101: 0}\", \r\n    \"packets\": {\r\n        \"10.116.170.10\": {\r\n            \"172.31.26.122\": {\r\n                \"101\": 3\r\n            }\r\n        }\r\n    }, \r\n    \"protocol\": 17\r\n}\r\n\r\n\r\n[2015-09-02 21:59:37,504] [i-ef17720c] [DEBUG]: done with exec\r\nOut[122]: \r\n{u'count': 3,\r\n u'date': u'Thu Sep  3 04:59:57 2015',\r\n u'elapsed': 0.62,\r\n u'error': u'',\r\n u'name': u'PROTO:17, SRCADDRS:{}, DSTADDRS:{}, PORTS:{101: 0}',\r\n u'packets': {u'10.116.170.10': {u'172.31.26.122': {u'101': 3}}},\r\n u'protocol': 17}\r\n\r\n{code}\r\n\r\n\r\n\r\nTEST 4 VM1 TO VM2 USING VM2'S PRIVATE IP, PROTO=ICMP - SUCCESS\r\n\r\n{code}\r\n\r\nIn [123]: packet_test(ins1.ssh, ins2.ssh, dest_ip=ins2.private_ip_address, protocol=1, count=3, verbose=2)\r\n[2015-09-02 21:59:51,824] [i-ef17720c] [DEBUG]: Starting receiver...\r\n\r\n# Done Copying script:\"ip_rx.py\" to \"10.116.170.100\"\r\n[2015-09-02 21:59:52,052] [i-ef17720c] [DEBUG]: [root@10.116.170.100]# python ip_rx.py -o 1 -c 3 -v1  -t 5 \r\n[2015-09-02 21:59:52,213] [i-b27dd3bd] [DEBUG]: Starting Sender...\r\n\r\n[2015-09-02 21:59:52,213] [i-ef17720c] [DEBUG]: # Begin Capture For Protocol:ICMP/1\r\n\r\n[2015-09-02 21:59:52,213] [i-ef17720c] [DEBUG]: \r\n\r\n# Done Copying script:\"ip_tx.py\" to \"10.116.170.10\"\r\n# CMD: python ip_tx.py -o 1 -c 3 -d 172.31.26.122 -i 0.1 -t 4 \r\n[2015-09-02 21:59:52,447] [i-b27dd3bd] [DEBUG]: [root@10.116.170.10]# python ip_tx.py -o 1 -c 3 -d 172.31.26.122 -i 0.1 -t 4 \r\n[2015-09-02 21:59:52,594] [i-ef17720c] [DEBUG]: # --------------------------------------------------------------------------------\r\n\r\n[2015-09-02 21:59:52,612] [i-b27dd3bd] [DEBUG]: # send_packet: destip:172.31.26.122, dstport:101, proto:1, ptype:None, count:3, interval:0.1\r\n\r\n[2015-09-02 21:59:52,612] [i-b27dd3bd] [DEBUG]: \r\n\r\n[2015-09-02 21:59:52,645] [i-ef17720c] [DEBUG]: # IP ver:4, HDR LEN:20, TTL:63, PROTO:1, SRC ADDR:10.116.170.10, DST ADDR:172.31.26.122\r\n\r\n[2015-09-02 21:59:52,696] [i-ef17720c] [DEBUG]: # --------------------------------------------------------------------------------\r\n# IP ver:4, HDR LEN:20, TTL:63, PROTO:1, SRC ADDR:10.116.170.10, DST ADDR:172.31.26.122\r\n\r\n[2015-09-02 21:59:52,795] [i-ef17720c] [DEBUG]: # --------------------------------------------------------------------------------\r\n\r\n[2015-09-02 21:59:52,847] [i-ef17720c] [DEBUG]: # IP ver:4, HDR LEN:20, TTL:63, PROTO:1, SRC ADDR:10.116.170.10, DST ADDR:172.31.26.122\r\n\r\n{\r\n    \"count\": 3, \r\n    \"date\": \"Thu Sep  3 05:00:13 2015\", \r\n    \"elapsed\": 0.6, \r\n    \"error\": \"\", \r\n    \"name\": \"PROTO:1, SRCADDRS:{}, DSTADDRS:{}, PORTS:{}\", \r\n    \"packets\": {\r\n        \"10.116.170.10\": {\r\n            \"172.31.26.122\": {\r\n                \"unknown\": 3\r\n            }\r\n        }\r\n    }, \r\n    \"protocol\": 1\r\n}\r\n\r\n{code} \r\n\r\nINFO ABOUT THIS TEST ('packet_test')...\r\n{code}\r\nIn [124]: packet_test?\r\n\r\n>>packet_test(None, ins2.ssh, protocol=1, count=2, timeout=10, dest_ip=ins2.ip_address)\r\n\r\n    {u'count': 2,  # Number of packets received which met filter criteria\r\n     u'date': u'Wed Jul  8 03:23:31 2015',  # Timestamp of capture\r\n     u'elapsed': 0.13,  # time elapsed for capture\r\n     u'error': u'', # Any errors which were caught during the capture\r\n     u'name': u'PROTO:1, SRCADDRS:{}, DSTADDRS:{}, PORTS:{}', # Name of this capture test\r\n     u'packets': {u'10.5.1.86': {u'10.111.75.155': {u'unknown': 2}}}, # Dict of packets in\r\n     u'protocol': 1} # protocol number/id\r\n\r\n# Example 1) UDP test between 2 remote hosts using:\r\n#    - the UDP protocol number 17\r\n#    - port 101\r\n#    - 10 packets\r\n>>packet_test(ssh_tx, ssh_rx, protocol=17, port=101, count=10, timeout=10, verbose=False)\r\n\r\n# Example 2) SCTP between 2 eutester Instance objects using:\r\n#    -the SCTP protocol number 132\r\n#    -sending to the instance's private ip address\r\n#    -filtering on the senders ip address\r\n#    -binding the receiver to the provided port\r\n>> packet_test(ins1.ssh, ins2.ssh, protocol=132, port=100, count=2,\r\n               dest_ip=ins2.private_ip_address, src_addrs=ins1.ip_address, bind=True)\r\n\r\n:param sender_ssh: sshconnection object to send packets from, if this is 'None' then\r\n                   packets will be sent from the local machine instead\r\n:param receiver_ssh: sshconnection object to receive packets\r\n:param protocol: protocol number for packets ie: 1=icmp, 6=tcp, 17=udp, 132=sctp, etc..\r\n:param dest_ip: Optional IP for the sender to send packets to, defaults to receiver_ssh.host\r\n:param src_addrs: Source addresses the receiver will use to filter rx'd packets\r\n:param port: optional port to use for sending packets to\r\n:param bind: option to bind receiver to provided port, maybe needed to rx certain packet types\r\n:param count: number of packets to send and expect\r\n:param interval: time to pause between sending packets, default=.1 seconds.\r\n:param payload: optional payload to include in the sent packets (string buffer)\r\n:param timeout: time in seconds to allow\r\n:param verbose: boolean, used to control verbose logging of info\r\n:return: json result of receiver\r\n:raise RuntimeError:\r\n\r\n{code}\r\n\r\nRegular ssh test showing vm1 can not ssh to vm2's private ip, but can ping it ....\r\n\r\n{code}\r\nIn [126]: ins2.keypath\r\nOut[126]: u'/Users/clarkmatthew/Documents/python_workspace/eutester_qa/eutester/mattstress.pem'\r\n\r\nIn [127]: ins1.ssh.sftp_put(ins2.keypath, 'mattstress.pem')\r\n\r\nIn [128]: ins1.sys('ls *.pem')\r\n[2015-09-02 22:14:39,909] [i-b27dd3bd] [DEBUG]: [root@10.116.170.10]# ls *.pem\r\n[2015-09-02 22:14:40,038] [i-b27dd3bd] [DEBUG]: \r\nmattstress.pem\r\n\r\n[2015-09-02 22:14:40,038] [i-b27dd3bd] [DEBUG]: done with exec\r\nOut[128]: ['mattstress.pem']\r\n\r\n\r\nIn [129]: ins2.printself()\r\n\r\n+---------------------+--------------------------+-------------------+----------------------------------------------------------------------------+\r\n|INSTANCE ID          |INSTANCE IMAGE            |INSTANCE STATE     |INSTANCE NETWORK INFO:                                                      |\r\n+---------------------+--------------------------+-------------------+----------------------------------------------------------------------------+\r\n|ID: i-ef17720c       |EMI: emi-aec40657         |STATE: running     |+------------+---------------+-----------+-+---------------+---------------+|\r\n|VMTYPE: m1.medium    |OS: linux                 |AGE: 3945          ||    VPC     |     SUBNET    |  SEC GRPS |P|    PRIV IP    |     PUB IP    ||\r\n|RES: r-8cd65ab1      |VIRT: HVM                 |ZONE: two          |+------------+---------------+-----------+-+---------------+---------------+|\r\n|KEYPAIR:             |(preciseservercloudimga..)|ROOTDEV:           ||vpc-c6e016fe|subnet-321bd6b0|sg-dd9a7e0e|N| 172.31.26.122 | 10.116.170.100||\r\n|mattstress           |                          |instance-store     |+------------+---------------+-----------+-+---------------+---------------+|\r\n+---------------------+--------------------------+-------------------+----------------------------------------------------------------------------+\r\n\r\n\r\nIn [130]: ins1.start_interactive_ssh()\r\nOpened channel, starting interactive mode...\r\nLast login: Thu Sep  3 05:15:01 2015 from 10.5.1.74\r\n\r\nroot@i:~# ssh -o StrictHostKeyChecking=no -i mattstress.pem root@10.116.170.100 'uname -a'\r\nLinux i 3.2.0-58-virtual #88-Ubuntu SMP Tue Dec 3 17:58:13 UTC 2013 x86_64 x86_64 x86_64 GNU/Linux\r\n\r\nroot@i:~# ssh -o StrictHostKeyChecking=no -i mattstress.pem root@10.116.170.100 'ifconfig'\r\n\r\neth0      Link encap:Ethernet  HWaddr d0:0d:4a:06:f4:95  \r\n          inet addr:172.31.26.122  Bcast:172.31.31.255  Mask:255.255.240.0\r\n          inet6 addr: fe80::d20d:4aff:fe06:f495/64 Scope:Link\r\n          UP BROADCAST RUNNING MULTICAST  MTU:1450  Metric:1\r\n          RX packets:1136 errors:0 dropped:0 overruns:0 frame:0\r\n          TX packets:865 errors:0 dropped:0 overruns:0 carrier:0\r\n          collisions:0 txqueuelen:1000 \r\n          RX bytes:439449 (439.4 KB)  TX bytes:109799 (109.7 KB)\r\n\r\nlo        Link encap:Local Loopback  \r\n          inet addr:127.0.0.1  Mask:255.0.0.0\r\n          inet6 addr: ::1/128 Scope:Host\r\n          UP LOOPBACK RUNNING  MTU:16436  Metric:1\r\n          RX packets:0 errors:0 dropped:0 overruns:0 frame:0\r\n          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0\r\n          collisions:0 txqueuelen:0 \r\n          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)\r\n\r\nroot@i:~# ssh -o StrictHostKeyChecking=no -i mattstress.pem root@172.31.26.122 'ifconfig'\r\n\r\n   <timed out>\r\n\r\nIn [131]: ins1.start_interactive_ssh()\r\nOpened channel, starting interactive mode...\r\nLast login: Thu Sep  3 05:15:31 2015 from 10.5.1.74\r\nroot@i:~# ping 172.31.26.122\r\nPING 172.31.26.122 (172.31.26.122) 56(84) bytes of data.\r\n64 bytes from 10.116.170.100: icmp_req=1 ttl=63 time=5.74 ms\r\n64 bytes from 10.116.170.100: icmp_req=2 ttl=63 time=3.39 ms\r\n^C\r\n--- 172.31.26.122 ping statistics ---\r\n2 packets transmitted, 2 received, 0% packet loss, time 1002ms\r\nrtt min/avg/max/mdev = 3.392/4.568/5.744/1.176 ms\r\nroot@i:~# exit\r\nlogout\r\n[2015-09-02 22:23:13,062] [i-b27dd3bd] [DEBUG]: Session closing (chan)...\r\n\r\n{code}\r\n","customfield_13000":null,"customfield_13200":null,"customfield_11300":null,"customfield_11500":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=tsugawa","name":"tsugawa","key":"tsugawa","accountId":"557058:619bab88-9b87-4778-995a-1e8a85d8b899","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/c16b1da4b6426cad544b6eddd78d76b1?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FavatarId%3D10122%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/c16b1da4b6426cad544b6eddd78d76b1?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26avatarId%3D10122%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/c16b1da4b6426cad544b6eddd78d76b1?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26avatarId%3D10122%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/c16b1da4b6426cad544b6eddd78d76b1?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26avatarId%3D10122%26noRedirect%3Dtrue"},"displayName":"M Tsugawa","active":true,"timeZone":"America/New_York"},"timetracking":{},"customfield_10401":null,"customfield_10005":null,"customfield_10600":null,"customfield_12900":null,"aggregatetimeestimate":null,"attachment":[],"summary":"VPC- Can not send TCP from vm to vm using private IPs across Subnets due to snat","creator":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=mclark","name":"mclark","key":"mclark","accountId":"557058:9b68e4d6-90d8-47d3-9c86-519770009164","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/4227b07e7ea0ea725670fc4e987ed04d?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FavatarId%3D10122%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/4227b07e7ea0ea725670fc4e987ed04d?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26avatarId%3D10122%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/4227b07e7ea0ea725670fc4e987ed04d?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26avatarId%3D10122%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/4227b07e7ea0ea725670fc4e987ed04d?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26avatarId%3D10122%26noRedirect%3Dtrue"},"displayName":"Matt Clark","active":true,"timeZone":"America/Los_Angeles"},"subtasks":[],"reporter":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=mclark","name":"mclark","key":"mclark","accountId":"557058:9b68e4d6-90d8-47d3-9c86-519770009164","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/4227b07e7ea0ea725670fc4e987ed04d?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FavatarId%3D10122%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/4227b07e7ea0ea725670fc4e987ed04d?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26avatarId%3D10122%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/4227b07e7ea0ea725670fc4e987ed04d?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26avatarId%3D10122%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/4227b07e7ea0ea725670fc4e987ed04d?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26avatarId%3D10122%26noRedirect%3Dtrue"},"displayName":"Matt Clark","active":true,"timeZone":"America/Los_Angeles"},"customfield_10000":"3_*:*_1_*:*_696268856_*|*_10000_*:*_1_*:*_56532261_*|*_10001_*:*_1_*:*_2328395331_*|*_10003_*:*_1_*:*_287086932_*|*_10006_*:*_1_*:*_0","aggregateprogress":{"progress":0,"total":0},"customfield_12100":"0|i0025r:","customfield_10001":"2015-09-30T14:53:17.188-0500","customfield_10200":null,"customfield_10002":null,"customfield_10003":null,"customfield_12500":null,"customfield_10400":null,"customfield_10116":null,"customfield_11600":["mclark(mclark)"],"environment":null,"customfield_10117":null,"customfield_11800":null,"customfield_11802":null,"customfield_11805":null,"duedate":null,"customfield_11806":null,"progress":{"progress":0,"total":0},"votes":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/EUCA-11328/votes","votes":0,"hasVoted":false},"comment":{"comments":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/38032/comment/91176","id":"91176","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=mclark","name":"mclark","key":"mclark","accountId":"557058:9b68e4d6-90d8-47d3-9c86-519770009164","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/4227b07e7ea0ea725670fc4e987ed04d?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FavatarId%3D10122%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/4227b07e7ea0ea725670fc4e987ed04d?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26avatarId%3D10122%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/4227b07e7ea0ea725670fc4e987ed04d?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26avatarId%3D10122%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/4227b07e7ea0ea725670fc4e987ed04d?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26avatarId%3D10122%26noRedirect%3Dtrue"},"displayName":"Matt Clark","active":true,"timeZone":"America/Los_Angeles"},"body":"Same security group seems to work fine...\r\n\r\n\r\n\r\n{code}\r\nIn [184]: tester.show_instances([ins1, ins2])\r\n\r\n+---------------------+--------------------------+-------------------+----------------------------------------------------------------------------+\r\n|INSTANCE ID          |INSTANCE IMAGE            |INSTANCE STATE     |INSTANCE NETWORK INFO:                                                      |\r\n+---------------------+--------------------------+-------------------+----------------------------------------------------------------------------+\r\n|ID: i-430deb13       |EMI: emi-aec40657         |STATE: running     |+------------+---------------+-----------+-+---------------+---------------+|\r\n|VMTYPE: m1.medium    |OS: linux                 |AGE: 787           ||    VPC     |     SUBNET    |  SEC GRPS |P|    PRIV IP    |     PUB IP    ||\r\n|RES: r-60fba947      |VIRT: HVM                 |ZONE: two          |+------------+---------------+-----------+-+---------------+---------------+|\r\n|KEYPAIR:             |(preciseservercloudimga..)|ROOTDEV:           ||vpc-c6e016fe|subnet-321bd6b0|sg-dd9a7e0e|N|  172.31.29.82 | 10.116.170.100||\r\n|mattstress           |                          |instance-store     |+------------+---------------+-----------+-+---------------+---------------+|\r\n+---------------------+--------------------------+-------------------+----------------------------------------------------------------------------+\r\n|ID: i-7e5b2a23       |EMI: emi-aec40657         |STATE: running     |+------------+---------------+-----------+-+---------------+---------------+|\r\n|VMTYPE: m1.medium    |OS: linux                 |AGE: 787           ||    VPC     |     SUBNET    |  SEC GRPS |P|    PRIV IP    |     PUB IP    ||\r\n|RES: r-60fba947      |VIRT: HVM                 |ZONE: two          |+------------+---------------+-----------+-+---------------+---------------+|\r\n|KEYPAIR:             |(preciseservercloudimga..)|ROOTDEV:           ||vpc-c6e016fe|subnet-321bd6b0|sg-dd9a7e0e|N| 172.31.23.109 | 10.116.170.10 ||\r\n|mattstress           |                          |instance-store     |+------------+---------------+-----------+-+---------------+---------------+|\r\n+---------------------+--------------------------+-------------------+----------------------------------------------------------------------------+\r\n\r\n\r\nIn [185]: [2015-09-02 22:56:48,743] [i-430deb13] [DEBUG]: done with exec\r\n# # send_packet: destip:172.31.23.109, dstport:101, proto:1, ptype:None, count:3, interval:0.1\r\npacket_test(ins1.ssh, ins2.ssh, dest_ip=ins2.private_ip_address, protocol=1, count=3)\r\nOut[185]: \r\n{u'count': 3,\r\n u'date': u'Thu Sep  3 05:56:52 2015',\r\n u'elapsed': 0.57,\r\n u'error': u'',\r\n u'name': u'PROTO:1, SRCADDRS:{}, DSTADDRS:{}, PORTS:{}',\r\n u'packets': {u'172.31.29.82': {u'172.31.23.109': {u'unknown': 3}}},\r\n u'protocol': 1}\r\n\r\nIn [186]: packet_test(ins1.ssh, ins2.ssh, dest_ip=ins2.private_ip_address, protocol=6, bind=True, port=105, count=3)\r\nOut[186]: \r\n{u'count': 3,\r\n u'date': u'Thu Sep  3 05:57:05 2015',\r\n u'elapsed': 0.57,\r\n u'error': u'',\r\n u'name': u'PROTO:6, SRCADDRS:{}, DSTADDRS:{}, PORTS:{105: 0}',\r\n u'packets': {u'172.31.29.82': {u'': {u'105': 3}}},\r\n u'protocol': 6}\r\n\r\nIn [187]: packet_test(ins1.ssh, ins2.ssh, dest_ip=ins2.private_ip_address, protocol=6, bind=True, port=101, count=3)\r\nOut[187]: \r\n{u'count': 3,\r\n u'date': u'Thu Sep  3 05:57:12 2015',\r\n u'elapsed': 0.56,\r\n u'error': u'',\r\n u'name': u'PROTO:6, SRCADDRS:{}, DSTADDRS:{}, PORTS:{101: 0}',\r\n u'packets': {u'172.31.29.82': {u'': {u'101': 3}}},\r\n u'protocol': 6}\r\n\r\n\r\n{code}","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=mclark","name":"mclark","key":"mclark","accountId":"557058:9b68e4d6-90d8-47d3-9c86-519770009164","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/4227b07e7ea0ea725670fc4e987ed04d?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FavatarId%3D10122%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/4227b07e7ea0ea725670fc4e987ed04d?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26avatarId%3D10122%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/4227b07e7ea0ea725670fc4e987ed04d?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26avatarId%3D10122%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/4227b07e7ea0ea725670fc4e987ed04d?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26avatarId%3D10122%26noRedirect%3Dtrue"},"displayName":"Matt Clark","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-09-03T00:59:35.510-0500","updated":"2015-09-03T00:59:35.510-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/38032/comment/93410","id":"93410","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=mclark","name":"mclark","key":"mclark","accountId":"557058:9b68e4d6-90d8-47d3-9c86-519770009164","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/4227b07e7ea0ea725670fc4e987ed04d?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FavatarId%3D10122%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/4227b07e7ea0ea725670fc4e987ed04d?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26avatarId%3D10122%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/4227b07e7ea0ea725670fc4e987ed04d?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26avatarId%3D10122%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/4227b07e7ea0ea725670fc4e987ed04d?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26avatarId%3D10122%26noRedirect%3Dtrue"},"displayName":"Matt Clark","active":true,"timeZone":"America/Los_Angeles"},"body":"Tested across 4 subnets, 2 zones in the same VPC and same sec group using 4 instances. \r\nTested private and public w/ tcp and udp. \r\n\r\n\r\n{code}\r\nIn [38]: user.ec2.show_instances(ins)\r\n[2015-10-11 22:00:14,686][INFO][EC2ops(nephotest:admin)]: \r\n+---------------------+--------------------+-------------------+----------------------------------------------------------------------------+\r\n|INSTANCE ID          |INSTANCE IMAGE      |INSTANCE STATE     |INSTANCE NETWORK INFO:                                                      |\r\n+---------------------+--------------------+-------------------+----------------------------------------------------------------------------+\r\n|ID: i-cd7071d5       |EMI: emi-c30f6917   |STATE: running     |NODE:???\tKEYPAIR:vpcbasics_key_98298                                 |\r\n|TYPE: m1.small       |OS: linux           |AGE: 891           |+------------+---------------+-----------+-+---------------+---------------+|\r\n|RES: r-ee235d02      |VIRT: HVM           |ZONE: two          ||    VPC     |     SUBNET    |  SEC GRPS |P|    PRIV IP    |     PUB IP    ||\r\n|ACCOUNT ID:          |IMAGE NAME:         |ROOTDEV:           |+------------+---------------+-----------+-+---------------+---------------+|\r\n|000680023399         |image-import-i-7ac..|ebs:vol-d22baed1   ||vpc-1ed5d912|subnet-7abc6f46|sg-885ec1f6|N| 172.31.32.221 | 10.116.170.64 ||\r\n+---------------------+--------------------+-------------------+----------------------------------------------------------------------------+\r\n|ID: i-b2908fa5       |EMI: emi-c30f6917   |STATE: running     |NODE:???\tKEYPAIR:vpcbasics_key_98298                                 |\r\n|TYPE: m1.small       |OS: linux           |AGE: 889           |+------------+---------------+-----------+-+---------------+---------------+|\r\n|RES: r-62827f38      |VIRT: HVM           |ZONE: one          ||    VPC     |     SUBNET    |  SEC GRPS |P|    PRIV IP    |     PUB IP    ||\r\n|ACCOUNT ID:          |IMAGE NAME:         |ROOTDEV:           |+------------+---------------+-----------+-+---------------+---------------+|\r\n|000680023399         |image-import-i-7ac..|ebs:vol-74514227   ||vpc-1ed5d912|subnet-c541bdc2|sg-885ec1f6|N|  172.31.33.4  | 10.116.170.167||\r\n+---------------------+--------------------+-------------------+----------------------------------------------------------------------------+\r\n|ID: i-4a0267a6       |EMI: emi-c30f6917   |STATE: running     |NODE:???\tKEYPAIR:vpcbasics_key_98298                                 |\r\n|TYPE: m1.small       |OS: linux           |AGE: 886           |+------------+---------------+-----------+-+---------------+---------------+|\r\n|RES: r-9d4932cd      |VIRT: HVM           |ZONE: two          ||    VPC     |     SUBNET    |  SEC GRPS |P|    PRIV IP    |     PUB IP    ||\r\n|ACCOUNT ID:          |IMAGE NAME:         |ROOTDEV:           |+------------+---------------+-----------+-+---------------+---------------+|\r\n|000680023399         |image-import-i-7ac..|ebs:vol-4e53712b   ||vpc-1ed5d912|subnet-0543c665|sg-885ec1f6|N| 172.31.34.213 | 10.116.170.207||\r\n+---------------------+--------------------+-------------------+----------------------------------------------------------------------------+\r\n|ID: i-ec76005a       |EMI: emi-c30f6917   |STATE: running     |NODE:???\tKEYPAIR:vpcbasics_key_98298                                 |\r\n|TYPE: m1.small       |OS: linux           |AGE: 883           |+------------+---------------+-----------+-+---------------+---------------+|\r\n|RES: r-12320b6a      |VIRT: HVM           |ZONE: one          ||    VPC     |     SUBNET    |  SEC GRPS |P|    PRIV IP    |     PUB IP    ||\r\n|ACCOUNT ID:          |IMAGE NAME:         |ROOTDEV:           |+------------+---------------+-----------+-+---------------+---------------+|\r\n|000680023399         |image-import-i-7ac..|ebs:vol-56013ace   ||vpc-1ed5d912|subnet-b220996d|sg-885ec1f6|N| 172.31.35.149 | 10.116.170.228||\r\n+---------------------+--------------------+-------------------+----------------------------------------------------------------------------+\r\n\r\n\r\nIn [39]: user.ec2.show_security_groups_for_instance(ins[0])\r\n[2015-10-11 22:00:21,373][DEBUG][EC2ops(nephotest:admin)]: Found matching security group for name:None and id:sg-885ec1f6\r\n[2015-10-11 22:00:21,380][INFO][EC2ops(nephotest:admin)]: \r\n+------------------------------------------------------------------------------------+\r\n|                    EUCA SECURITY GROUPS FOR INSTANCE:i-cd7071d5                    |\r\n+------------------------------------------------------------------------------------+\r\n| +--------------------------------------------------------------------------------+ |\r\n| |        Security Group: VpcBasics_1_98298/sg-885ec1f6, VPC: vpc-1ed5d912        | |\r\n| +--------------------------------------------------------------------------------+ |\r\n| | +-----------+--------------+------------+----------+------+----------+-------+ | |\r\n| | |  CIDR_IP  | SRC_GRP_NAME | SRC_GRP_ID | OWNER_ID | PORT | END_PORT | PROTO | | |\r\n| | +-----------+--------------+------------+----------+------+----------+-------+ | |\r\n| | | 0.0.0.0/0 |     None     |    None    |   None   |  -1  |    -1    |  icmp | | |\r\n| | +-----------+--------------+------------+----------+------+----------+-------+ | |\r\n| | | 0.0.0.0/0 |     None     |    None    |   None   |  22  |    22    |  tcp  | | |\r\n| | +-----------+--------------+------------+----------+------+----------+-------+ | |\r\n| | | 0.0.0.0/0 |     None     |    None    |   None   | None |   None   |  132  | | |\r\n| | +-----------+--------------+------------+----------+------+----------+-------+ | |\r\n| | | 0.0.0.0/0 |     None     |    None    |   None   | 100  |   110    |  tcp  | | |\r\n| | +-----------+--------------+------------+----------+------+----------+-------+ | |\r\n| | | 0.0.0.0/0 |     None     |    None    |   None   | 100  |   110    |  udp  | | |\r\n| | +-----------+--------------+------------+----------+------+----------+-------+ | |\r\n| +--------------------------------------------------------------------------------+ |\r\n+------------------------------------------------------------------------------------+\r\n\r\n\r\n\r\nIn [40]: for src in ins:\r\n    for dst in ins:\r\n        if src != dst:\r\n            print 'testing {0}:{1} -> {2}:{3}'.format(src.id, src.ip_address, dst.id, dst.ip_address)\r\n   ....:             res = packet_test(src.ssh, dst.ssh, protocol=6, bind=True, port=105, count=2)\r\n   ....:             print res\r\n   ....:             if res.get('count') != 2:\r\n   ....:                 raise Run\r\nRuntimeError    RuntimeWarning  \r\n   ....:                 raise RuntimeError('Count was not equal')\r\n   ....:             \r\ntesting i-cd7071d5:10.116.170.64 -> i-b2908fa5:10.116.170.167\r\n{u'count': 2, u'protocol': 6, u'name': u'PROTO:6, SRCADDRS:{}, DSTADDRS:{}, PORTS:{105: 0}', u'packets': {u'10.116.170.64': {u'': {u'105': 2}}}, u'elapsed': 0.47, u'error': u'', u'date': u'Mon Oct 12 04:56:08 2015'}\r\ntesting i-cd7071d5:10.116.170.64 -> i-4a0267a6:10.116.170.207\r\n{u'count': 2, u'protocol': 6, u'name': u'PROTO:6, SRCADDRS:{}, DSTADDRS:{}, PORTS:{105: 0}', u'packets': {u'10.116.170.64': {u'': {u'105': 2}}}, u'elapsed': 0.45, u'error': u'', u'date': u'Mon Oct 12 04:56:09 2015'}\r\ntesting i-cd7071d5:10.116.170.64 -> i-ec76005a:10.116.170.228\r\n{u'count': 2, u'protocol': 6, u'name': u'PROTO:6, SRCADDRS:{}, DSTADDRS:{}, PORTS:{105: 0}', u'packets': {u'10.116.170.64': {u'': {u'105': 2}}}, u'elapsed': 0.45, u'error': u'', u'date': u'Mon Oct 12 04:56:10 2015'}\r\ntesting i-b2908fa5:10.116.170.167 -> i-cd7071d5:10.116.170.64\r\n{u'count': 2, u'protocol': 6, u'name': u'PROTO:6, SRCADDRS:{}, DSTADDRS:{}, PORTS:{105: 0}', u'packets': {u'10.116.170.167': {u'': {u'105': 2}}}, u'elapsed': 0.47, u'error': u'', u'date': u'Mon Oct 12 04:56:11 2015'}\r\ntesting i-b2908fa5:10.116.170.167 -> i-4a0267a6:10.116.170.207\r\n{u'count': 2, u'protocol': 6, u'name': u'PROTO:6, SRCADDRS:{}, DSTADDRS:{}, PORTS:{105: 0}', u'packets': {u'10.116.170.167': {u'': {u'105': 2}}}, u'elapsed': 0.44, u'error': u'', u'date': u'Mon Oct 12 04:56:12 2015'}\r\ntesting i-b2908fa5:10.116.170.167 -> i-ec76005a:10.116.170.228\r\n{u'count': 2, u'protocol': 6, u'name': u'PROTO:6, SRCADDRS:{}, DSTADDRS:{}, PORTS:{105: 0}', u'packets': {u'10.116.170.167': {u'': {u'105': 2}}}, u'elapsed': 0.45, u'error': u'', u'date': u'Mon Oct 12 04:56:13 2015'}\r\ntesting i-4a0267a6:10.116.170.207 -> i-cd7071d5:10.116.170.64\r\n{u'count': 2, u'protocol': 6, u'name': u'PROTO:6, SRCADDRS:{}, DSTADDRS:{}, PORTS:{105: 0}', u'packets': {u'10.116.170.207': {u'': {u'105': 2}}}, u'elapsed': 0.52, u'error': u'', u'date': u'Mon Oct 12 04:56:14 2015'}\r\ntesting i-4a0267a6:10.116.170.207 -> i-b2908fa5:10.116.170.167\r\n{u'count': 2, u'protocol': 6, u'name': u'PROTO:6, SRCADDRS:{}, DSTADDRS:{}, PORTS:{105: 0}', u'packets': {u'10.116.170.207': {u'': {u'105': 2}}}, u'elapsed': 0.45, u'error': u'', u'date': u'Mon Oct 12 04:56:15 2015'}\r\ntesting i-4a0267a6:10.116.170.207 -> i-ec76005a:10.116.170.228\r\n{u'count': 2, u'protocol': 6, u'name': u'PROTO:6, SRCADDRS:{}, DSTADDRS:{}, PORTS:{105: 0}', u'packets': {u'10.116.170.207': {u'': {u'105': 2}}}, u'elapsed': 0.45, u'error': u'', u'date': u'Mon Oct 12 04:56:15 2015'}\r\ntesting i-ec76005a:10.116.170.228 -> i-cd7071d5:10.116.170.64\r\n{u'count': 2, u'protocol': 6, u'name': u'PROTO:6, SRCADDRS:{}, DSTADDRS:{}, PORTS:{105: 0}', u'packets': {u'10.116.170.228': {u'': {u'105': 2}}}, u'elapsed': 0.47, u'error': u'', u'date': u'Mon Oct 12 04:56:16 2015'}\r\ntesting i-ec76005a:10.116.170.228 -> i-b2908fa5:10.116.170.167\r\n{u'count': 2, u'protocol': 6, u'name': u'PROTO:6, SRCADDRS:{}, DSTADDRS:{}, PORTS:{105: 0}', u'packets': {u'10.116.170.228': {u'': {u'105': 2}}}, u'elapsed': 0.45, u'error': u'', u'date': u'Mon Oct 12 04:56:17 2015'}\r\ntesting i-ec76005a:10.116.170.228 -> i-4a0267a6:10.116.170.207\r\n{u'count': 2, u'protocol': 6, u'name': u'PROTO:6, SRCADDRS:{}, DSTADDRS:{}, PORTS:{105: 0}', u'packets': {u'10.116.170.228': {u'': {u'105': 2}}}, u'elapsed': 0.45, u'error': u'', u'date': u'Mon Oct 12 04:56:18 2015'}\r\n\r\nIn [41]: for src in ins:\r\n    for dst in ins:\r\n        if src != dst:\r\n            print 'testing {0}:{1} -> {2}:{3}'.format(src.id, src.ip_address, dst.id, dst.ip_address)\r\n            res = packet_test(src.ssh, dst.ssh, protocol=17, bind=True, port=105, count=2)\r\n            print res\r\n            if res.get('count') != 2:\r\n                raise RuntimeError('Count was not equal')\r\n   ....:             \r\ntesting i-cd7071d5:10.116.170.64 -> i-b2908fa5:10.116.170.167\r\n{u'count': 2, u'protocol': 17, u'name': u'PROTO:17, SRCADDRS:{}, DSTADDRS:{}, PORTS:{105: 0}', u'packets': {u'10.116.170.64': {u'172.31.33.4': {u'105': 2}}}, u'elapsed': 0.48, u'error': u'', u'date': u'Mon Oct 12 04:56:40 2015'}\r\ntesting i-cd7071d5:10.116.170.64 -> i-4a0267a6:10.116.170.207\r\n{u'count': 2, u'protocol': 17, u'name': u'PROTO:17, SRCADDRS:{}, DSTADDRS:{}, PORTS:{105: 0}', u'packets': {u'10.116.170.64': {u'172.31.34.213': {u'105': 2}}}, u'elapsed': 0.44, u'error': u'', u'date': u'Mon Oct 12 04:56:41 2015'}\r\ntesting i-cd7071d5:10.116.170.64 -> i-ec76005a:10.116.170.228\r\n{u'count': 2, u'protocol': 17, u'name': u'PROTO:17, SRCADDRS:{}, DSTADDRS:{}, PORTS:{105: 0}', u'packets': {u'10.116.170.64': {u'172.31.35.149': {u'105': 2}}}, u'elapsed': 0.48, u'error': u'', u'date': u'Mon Oct 12 04:56:42 2015'}\r\ntesting i-b2908fa5:10.116.170.167 -> i-cd7071d5:10.116.170.64\r\n{u'count': 2, u'protocol': 17, u'name': u'PROTO:17, SRCADDRS:{}, DSTADDRS:{}, PORTS:{105: 0}', u'packets': {u'10.116.170.167': {u'172.31.32.221': {u'105': 2}}}, u'elapsed': 0.48, u'error': u'', u'date': u'Mon Oct 12 04:56:43 2015'}\r\ntesting i-b2908fa5:10.116.170.167 -> i-4a0267a6:10.116.170.207\r\n{u'count': 2, u'protocol': 17, u'name': u'PROTO:17, SRCADDRS:{}, DSTADDRS:{}, PORTS:{105: 0}', u'packets': {u'10.116.170.167': {u'172.31.34.213': {u'105': 2}}}, u'elapsed': 0.45, u'error': u'', u'date': u'Mon Oct 12 04:56:44 2015'}\r\ntesting i-b2908fa5:10.116.170.167 -> i-ec76005a:10.116.170.228\r\n{u'count': 2, u'protocol': 17, u'name': u'PROTO:17, SRCADDRS:{}, DSTADDRS:{}, PORTS:{105: 0}', u'packets': {u'10.116.170.167': {u'172.31.35.149': {u'105': 2}}}, u'elapsed': 0.44, u'error': u'', u'date': u'Mon Oct 12 04:56:44 2015'}\r\ntesting i-4a0267a6:10.116.170.207 -> i-cd7071d5:10.116.170.64\r\n{u'count': 2, u'protocol': 17, u'name': u'PROTO:17, SRCADDRS:{}, DSTADDRS:{}, PORTS:{105: 0}', u'packets': {u'10.116.170.207': {u'172.31.32.221': {u'105': 2}}}, u'elapsed': 0.47, u'error': u'', u'date': u'Mon Oct 12 04:56:45 2015'}\r\ntesting i-4a0267a6:10.116.170.207 -> i-b2908fa5:10.116.170.167\r\n{u'count': 2, u'protocol': 17, u'name': u'PROTO:17, SRCADDRS:{}, DSTADDRS:{}, PORTS:{105: 0}', u'packets': {u'10.116.170.207': {u'172.31.33.4': {u'105': 2}}}, u'elapsed': 0.45, u'error': u'', u'date': u'Mon Oct 12 04:56:46 2015'}\r\ntesting i-4a0267a6:10.116.170.207 -> i-ec76005a:10.116.170.228\r\n{u'count': 2, u'protocol': 17, u'name': u'PROTO:17, SRCADDRS:{}, DSTADDRS:{}, PORTS:{105: 0}', u'packets': {u'10.116.170.207': {u'172.31.35.149': {u'105': 2}}}, u'elapsed': 0.44, u'error': u'', u'date': u'Mon Oct 12 04:56:47 2015'}\r\ntesting i-ec76005a:10.116.170.228 -> i-cd7071d5:10.116.170.64\r\n{u'count': 2, u'protocol': 17, u'name': u'PROTO:17, SRCADDRS:{}, DSTADDRS:{}, PORTS:{105: 0}', u'packets': {u'10.116.170.228': {u'172.31.32.221': {u'105': 2}}}, u'elapsed': 0.48, u'error': u'', u'date': u'Mon Oct 12 04:56:48 2015'}\r\ntesting i-ec76005a:10.116.170.228 -> i-b2908fa5:10.116.170.167\r\n{u'count': 2, u'protocol': 17, u'name': u'PROTO:17, SRCADDRS:{}, DSTADDRS:{}, PORTS:{105: 0}', u'packets': {u'10.116.170.228': {u'172.31.33.4': {u'105': 2}}}, u'elapsed': 0.45, u'error': u'', u'date': u'Mon Oct 12 04:56:49 2015'}\r\ntesting i-ec76005a:10.116.170.228 -> i-4a0267a6:10.116.170.207\r\n{u'count': 2, u'protocol': 17, u'name': u'PROTO:17, SRCADDRS:{}, DSTADDRS:{}, PORTS:{105: 0}', u'packets': {u'10.116.170.228': {u'172.31.34.213': {u'105': 2}}}, u'elapsed': 0.44, u'error': u'', u'date': u'Mon Oct 12 04:56:49 2015'}\r\n\r\n\r\nIn [43]: for src in ins:\r\n    for dst in ins:\r\n        if src != dst:\r\n            print 'testing {0}:{1} -> {2}:{3}'.format(src.id, src.ip_address, dst.id, dst.private_ip_address)\r\n            res = packet_test(src.ssh, dst.ssh, dest_ip=dst.private_ip_address,  protocol=6, bind=True, port=105, count=2)\r\n            print res\r\n            if res.get('count') != 2:\r\n                raise RuntimeError('Count was not equal')\r\n   ....:             \r\ntesting i-cd7071d5:10.116.170.64 -> i-b2908fa5:172.31.33.4\r\n{u'count': 2, u'protocol': 6, u'name': u'PROTO:6, SRCADDRS:{}, DSTADDRS:{}, PORTS:{105: 0}', u'packets': {u'172.31.32.221': {u'': {u'105': 2}}}, u'elapsed': 0.48, u'error': u'', u'date': u'Mon Oct 12 04:57:58 2015'}\r\ntesting i-cd7071d5:10.116.170.64 -> i-4a0267a6:172.31.34.213\r\n{u'count': 2, u'protocol': 6, u'name': u'PROTO:6, SRCADDRS:{}, DSTADDRS:{}, PORTS:{105: 0}', u'packets': {u'172.31.32.221': {u'': {u'105': 2}}}, u'elapsed': 0.44, u'error': u'', u'date': u'Mon Oct 12 04:57:59 2015'}\r\ntesting i-cd7071d5:10.116.170.64 -> i-ec76005a:172.31.35.149\r\n{u'count': 2, u'protocol': 6, u'name': u'PROTO:6, SRCADDRS:{}, DSTADDRS:{}, PORTS:{105: 0}', u'packets': {u'172.31.32.221': {u'': {u'105': 2}}}, u'elapsed': 0.46, u'error': u'', u'date': u'Mon Oct 12 04:58:00 2015'}\r\ntesting i-b2908fa5:10.116.170.167 -> i-cd7071d5:172.31.32.221\r\n{u'count': 2, u'protocol': 6, u'name': u'PROTO:6, SRCADDRS:{}, DSTADDRS:{}, PORTS:{105: 0}', u'packets': {u'172.31.33.4': {u'': {u'105': 2}}}, u'elapsed': 0.48, u'error': u'', u'date': u'Mon Oct 12 04:58:01 2015'}\r\ntesting i-b2908fa5:10.116.170.167 -> i-4a0267a6:172.31.34.213\r\n{u'count': 2, u'protocol': 6, u'name': u'PROTO:6, SRCADDRS:{}, DSTADDRS:{}, PORTS:{105: 0}', u'packets': {u'172.31.33.4': {u'': {u'105': 2}}}, u'elapsed': 0.44, u'error': u'', u'date': u'Mon Oct 12 04:58:02 2015'}\r\ntesting i-b2908fa5:10.116.170.167 -> i-ec76005a:172.31.35.149\r\n{u'count': 2, u'protocol': 6, u'name': u'PROTO:6, SRCADDRS:{}, DSTADDRS:{}, PORTS:{105: 0}', u'packets': {u'172.31.33.4': {u'': {u'105': 2}}}, u'elapsed': 0.45, u'error': u'', u'date': u'Mon Oct 12 04:58:02 2015'}\r\ntesting i-4a0267a6:10.116.170.207 -> i-cd7071d5:172.31.32.221\r\n{u'count': 2, u'protocol': 6, u'name': u'PROTO:6, SRCADDRS:{}, DSTADDRS:{}, PORTS:{105: 0}', u'packets': {u'172.31.34.213': {u'': {u'105': 2}}}, u'elapsed': 0.47, u'error': u'', u'date': u'Mon Oct 12 04:58:03 2015'}\r\ntesting i-4a0267a6:10.116.170.207 -> i-b2908fa5:172.31.33.4\r\n{u'count': 2, u'protocol': 6, u'name': u'PROTO:6, SRCADDRS:{}, DSTADDRS:{}, PORTS:{105: 0}', u'packets': {u'172.31.34.213': {u'': {u'105': 2}}}, u'elapsed': 0.44, u'error': u'', u'date': u'Mon Oct 12 04:58:04 2015'}\r\ntesting i-4a0267a6:10.116.170.207 -> i-ec76005a:172.31.35.149\r\n{u'count': 2, u'protocol': 6, u'name': u'PROTO:6, SRCADDRS:{}, DSTADDRS:{}, PORTS:{105: 0}', u'packets': {u'172.31.34.213': {u'': {u'105': 2}}}, u'elapsed': 0.7, u'error': u'', u'date': u'Mon Oct 12 04:58:05 2015'}\r\ntesting i-ec76005a:10.116.170.228 -> i-cd7071d5:172.31.32.221\r\n{u'count': 2, u'protocol': 6, u'name': u'PROTO:6, SRCADDRS:{}, DSTADDRS:{}, PORTS:{105: 0}', u'packets': {u'172.31.35.149': {u'': {u'105': 2}}}, u'elapsed': 0.46, u'error': u'', u'date': u'Mon Oct 12 04:58:06 2015'}\r\ntesting i-ec76005a:10.116.170.228 -> i-b2908fa5:172.31.33.4\r\n{u'count': 2, u'protocol': 6, u'name': u'PROTO:6, SRCADDRS:{}, DSTADDRS:{}, PORTS:{105: 0}', u'packets': {u'172.31.35.149': {u'': {u'105': 2}}}, u'elapsed': 0.44, u'error': u'', u'date': u'Mon Oct 12 04:58:07 2015'}\r\ntesting i-ec76005a:10.116.170.228 -> i-4a0267a6:172.31.34.213\r\n{u'count': 2, u'protocol': 6, u'name': u'PROTO:6, SRCADDRS:{}, DSTADDRS:{}, PORTS:{105: 0}', u'packets': {u'172.31.35.149': {u'': {u'105': 2}}}, u'elapsed': 0.45, u'error': u'', u'date': u'Mon Oct 12 04:58:08 2015'}\r\n\r\n\r\n{code}","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=mclark","name":"mclark","key":"mclark","accountId":"557058:9b68e4d6-90d8-47d3-9c86-519770009164","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/4227b07e7ea0ea725670fc4e987ed04d?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FavatarId%3D10122%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/4227b07e7ea0ea725670fc4e987ed04d?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26avatarId%3D10122%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/4227b07e7ea0ea725670fc4e987ed04d?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26avatarId%3D10122%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/4227b07e7ea0ea725670fc4e987ed04d?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26avatarId%3D10122%26noRedirect%3Dtrue"},"displayName":"Matt Clark","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-10-12T00:02:32.961-0500","updated":"2015-10-12T00:02:32.961-0500"}],"maxResults":2,"total":2,"startAt":0},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_11808":null}}
{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"14231","self":"https://eucalyptus.atlassian.net/rest/api/2/issue/14231","key":"EUCA-2654","fields":{"issuetype":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://eucalyptus.atlassian.net/secure/viewavatar?size=xsmall&avatarId=14803&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":14803},"timespent":null,"customfield_13100":null,"project":{"self":"https://eucalyptus.atlassian.net/rest/api/2/project/10000","id":"10000","key":"EUCA","name":"Eucalyptus","avatarUrls":{"48x48":"https://eucalyptus.atlassian.net/secure/projectavatar?pid=10000&avatarId=10011","24x24":"https://eucalyptus.atlassian.net/secure/projectavatar?size=small&pid=10000&avatarId=10011","16x16":"https://eucalyptus.atlassian.net/secure/projectavatar?size=xsmall&pid=10000&avatarId=10011","32x32":"https://eucalyptus.atlassian.net/secure/projectavatar?size=medium&pid=10000&avatarId=10011"}},"customfield_11000":null,"customfield_11001":null,"fixVersions":[],"aggregatetimespent":null,"customfield_10310":null,"resolution":{"self":"https://eucalyptus.atlassian.net/rest/api/2/resolution/7","id":"7","description":"Signifies completion of tasks, info requests, etc.","name":"Completed"},"customfield_10311":null,"customfield_11401":null,"customfield_11400":null,"customfield_10500":{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/10403","value":"Not Applicable","id":"10403"},"customfield_10104":[],"customfield_10302":null,"customfield_10303":null,"customfield_10105":null,"customfield_10304":null,"customfield_10700":null,"customfield_10701":null,"customfield_10702":null,"customfield_10306":null,"customfield_10703":null,"customfield_10308":null,"customfield_10704":null,"resolutiondate":"2014-05-21T23:24:32.303-0500","customfield_10309":null,"customfield_10705":null,"workratio":-1,"lastViewed":null,"watches":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/EUCA-2654/watchers","watchCount":1,"isWatching":false},"created":"2012-07-11T07:44:23.326-0500","customfield_12000":null,"customfield_12400":null,"priority":{"self":"https://eucalyptus.atlassian.net/rest/api/2/priority/5","iconUrl":"https://eucalyptus.atlassian.net/images/icons/priorities/trivial.svg","name":"Trivial","id":"5"},"customfield_12201":null,"customfield_10102":null,"customfield_12600":"{}","customfield_10300":null,"customfield_10301":null,"labels":["LP"],"customfield_11700":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_11901":null,"versions":[],"issuelinks":[],"assignee":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=decker","name":"decker","key":"decker","accountId":"557058:518b1ab0-12c2-4e72-b694-6c07036941a8","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/a84cbf1ecec07d9320b42ae4fc90ccce?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Ddecker%26avatarId%3D16203%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/a84cbf1ecec07d9320b42ae4fc90ccce?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Ddecker%26avatarId%3D16203%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/a84cbf1ecec07d9320b42ae4fc90ccce?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Ddecker%26avatarId%3D16203%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/a84cbf1ecec07d9320b42ae4fc90ccce?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Ddecker%26avatarId%3D16203%26noRedirect%3Dtrue"},"displayName":"do not want! (use @grze, please)","active":false,"timeZone":"America/Los_Angeles"},"updated":"2015-05-08T17:12:21.699-0500","status":{"self":"https://eucalyptus.atlassian.net/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://eucalyptus.atlassian.net/images/icons/statuses/generic.png","name":"Closed","id":"6","statusCategory":{"self":"https://eucalyptus.atlassian.net/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[],"timeoriginalestimate":null,"customfield_13000":null,"description":"Originally posted by robb1e on 2009-07-30 13:17:28.886450+00:00\n\nSteps to reproduce:\n\n1. launch an image\n2. wait for instance to start processing (doesn't have to be running state)\n3. De-register the image\n4. Restart Cloud Controller\n5. Use API to describe image\n\nGet this response:\n\n\"Server: unknown\"\n\nAt this point, you can't use the euca-describe-image API call from admin or this user, but you can kill it.  Then restarting the Cloud Controller restores access to the API.\n\nWhat's happening, is when the ImageManager does the lookup in the DB, get throws an exception, but outside of the try/catch block, it uses the object which would have been initialised but is null and throws a NullPointerException, here on diskInfo.\n\nArrayList<String> ancestorIds = this.getAncestors(vmInfo.getOwnerId(), diskInfo.getImageLocation());\n\nThis then gets to ReplyQueue via Mule (how, I don't know), and throws a cast exception in parsePayload as VmInfo isn't of type EucalyptusMessage, VmAllocationInfo or String.  I'm not quite sure what the correct fix is here, but ImageManager should be using diskInfo inside the try block.  I don't know if that'll change the exception handling, but that should be more graceful to handle exceptions it doesn't know about.  Would control then pass down to SystemState handle method to loop through to the next instance.  \n\nCan you recomend a patch to apply here?  I think I'm going to try changing the exception handling in ReplyQueue and see how that goes.\n\nGet these exception:\n\n[30 07 2009 13:23:58] [edu.ucsb.eucalyptus.cloud.ws.ImageManager:ClusterMessageQueue-playpen@6C08FFAF]  INFO  Error locating information for emi-74DB0EE2\nedu.ucsb.eucalyptus.cloud.EucalyptusCloudException: Error locating information for emi-74DB0EE2\n        at edu.ucsb.eucalyptus.cloud.entities.EntityWrapper.getUnique(EntityWrapper.java:105)\n        at edu.ucsb.eucalyptus.cloud.entities.ImageInfo.named(ImageInfo.java:333)\n        at edu.ucsb.eucalyptus.cloud.ws.ImageManager.verify(ImageManager.java:126)\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n        at java.lang.reflect.Method.invoke(Method.java:597)\n        at org.mule.model.resolvers.AbstractEntryPointResolver.invokeMethod(AbstractEntryPointResolver.java:147)\n        at org.mule.model.resolvers.ReflectionEntryPointResolver.invoke(ReflectionEntryPointResolver.java:178)\n        at org.mule.model.resolvers.DefaultEntryPointResolverSet.invoke(DefaultEntryPointResolverSet.java:50)\n        at org.mule.component.DefaultLifecycleAdapter.intercept(DefaultLifecycleAdapter.java:202)\n        at org.mule.component.AbstractJavaComponent.invokeComponentInstance(AbstractJavaComponent.java:82)\n        at org.mule.component.AbstractJavaComponent.doOnCall(AbstractJavaComponent.java:73)\n        at org.mule.component.AbstractComponent.onCall(AbstractComponent.java:87)\n        at org.mule.model.seda.SedaService.doSend(SedaService.java:234)\n        at org.mule.service.AbstractService.sendEvent(AbstractService.java:510)\n        at org.mule.DefaultMuleSession.sendEvent(DefaultMuleSession.java:351)\n        at org.mule.routing.inbound.DefaultInboundRouterCollection.send(DefaultInboundRouterCollection.java:196)\n        at org.mule.routing.inbound.DefaultInboundRouterCollection.route(DefaultInboundRouterCollection.java:164)\n        at org.mule.transport.AbstractMessageReceiver$DefaultInternalMessageListener.onMessage(AbstractMessageReceiver.java:604)\n        at org.mule.transport.AbstractMessageReceiver.routeMessage(AbstractMessageReceiver.java:346)\n        at org.mule.transport.AbstractMessageReceiver.routeMessage(AbstractMessageReceiver.java:269)\n        at org.mule.transport.vm.VMMessageReceiver.onCall(VMMessageReceiver.java:106)\n        at org.mule.transport.vm.VMMessageDispatcher.doSend(VMMessageDispatcher.java:104)\n        at org.mule.transport.AbstractMessageDispatcher.send(AbstractMessageDispatcher.java:157)\n        at org.mule.transport.AbstractConnector.send(AbstractConnector.java:1889)\n        at org.mule.endpoint.DefaultOutboundEndpoint.send(DefaultOutboundEndpoint.java:76)\n        at org.mule.DefaultMuleSession.sendEvent(DefaultMuleSession.java:324)\n        at org.mule.module.client.MuleClient.send(MuleClient.java:653)\n        at org.mule.module.client.MuleClient.send(MuleClient.java:630)\n        at org.mule.module.client.MuleClient.send(MuleClient.java:583)\n        at edu.ucsb.eucalyptus.util.Messaging.send(Messaging.java:67)\n        at edu.ucsb.eucalyptus.cloud.ws.SystemState.restoreInstance(SystemState.java:322)\n        at edu.ucsb.eucalyptus.cloud.ws.SystemState.updateVmInstance(SystemState.java:293)\n        at edu.ucsb.eucalyptus.cloud.ws.SystemState.handle(SystemState.java:100)\n        at edu.ucsb.eucalyptus.cloud.cluster.VmUpdateCallback.process(VmUpdateCallback.java:65)\n        at edu.ucsb.eucalyptus.cloud.cluster.VmUpdateCallback.process(VmUpdateCallback.java:16)\n        at edu.ucsb.eucalyptus.cloud.cluster.QueuedEvent.trigger(QueuedEvent.java:31)\n        at edu.ucsb.eucalyptus.cloud.cluster.ClusterMessageQueue.run(ClusterMessageQueue.java:117)\n        at java.lang.Thread.run(Thread.java:619)\n[30 07 2009 13:23:58] [org.mule.service.DefaultServiceExceptionStrategy:ClusterMessageQueue-playpen@6C08FFAF]  ERROR\n********************************************************************************\nMessage               : Component that caused exception is: ImageResolve. Message payload is of type: VmInfo\nType                  : org.mule.api.service.ServiceException\nCode                  : MULE_ERROR--2\nPayload               : [\"placement\":\"playpen\", \"launchIndex\":\"0\", \"ownerId\":\"admin\", \"groupNames\":[\"default\"], \"instanceId\":\"i-426707DE\", \"class\":class edu.ucsb.eucalyptus.cloud.VmInfo, \"kernelId\":\"eki-F4DB10D7\", \"reservationId\":\"r-31FD0667\", \"volumes\":[], \"userData\":\"\", \"metaClass\":groovy.lang.MetaClassImpl@6f3a342a[class edu.ucsb.eucalyptus.cloud.VmInfo], \"instanceType\":VmTypeInfo{name='m1.small', memory=128, disk=1, cores=1}, \"serviceTag\":\"http://vm-container-0-0:8775/axis2/services/EucalyptusNC\", \"imageId\":\"emi-74DB0EE2\", \"productCodes\":[], \"launchTime\":Thu Jul 30 13:22:47 BST 2009, \"ramdiskId\":\"\", \"stateName\":\"Extant\", \"netParams\":NetworkConfigType{macAddress='d0:0d:42:67:07:DE', ipAddress='172.29.23.2', publicIp='0.0.0.0', vlan=370}, \"keyValue\":\"\"]\nJavaDoc               : http://mule.mulesource.org/docs/apidocs/org/mule/api/service/ServiceException.html\n********************************************************************************\nException stack is:\n1. null (java.lang.NullPointerException)\n  edu.ucsb.eucalyptus.cloud.ws.ImageManager:140 (null)\n2. Component that caused exception is: ImageResolve. Message payload is of type: VmInfo (org.mule.api.service.ServiceException)\n  org.mule.component.DefaultLifecycleAdapter:214 (http://mule.mulesource.org/docs/apidocs/org/mule/api/service/ServiceException.html)\n********************************************************************************\nRoot Exception stack trace:\njava.lang.NullPointerException\n        at edu.ucsb.eucalyptus.cloud.ws.ImageManager.verify(ImageManager.java:140)\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n        at java.lang.reflect.Method.invoke(Method.java:597)\n        at org.mule.model.resolvers.AbstractEntryPointResolver.invokeMethod(AbstractEntryPointResolver.java:147)\n        at org.mule.model.resolvers.ReflectionEntryPointResolver.invoke(ReflectionEntryPointResolver.java:178)\n        at org.mule.model.resolvers.DefaultEntryPointResolverSet.invoke(DefaultEntryPointResolverSet.java:50)\n        at org.mule.component.DefaultLifecycleAdapter.intercept(DefaultLifecycleAdapter.java:202)\n        at org.mule.component.AbstractJavaComponent.invokeComponentInstance(AbstractJavaComponent.java:82)\n        at org.mule.component.AbstractJavaComponent.doOnCall(AbstractJavaComponent.java:73)\n        at org.mule.component.AbstractComponent.onCall(AbstractComponent.java:87)\n        at org.mule.model.seda.SedaService.doSend(SedaService.java:234)\n        at org.mule.service.AbstractService.sendEvent(AbstractService.java:510)\n        at org.mule.DefaultMuleSession.sendEvent(DefaultMuleSession.java:351)\n        at org.mule.routing.inbound.DefaultInboundRouterCollection.send(DefaultInboundRouterCollection.java:196)\n        at org.mule.routing.inbound.DefaultInboundRouterCollection.route(DefaultInboundRouterCollection.java:164)\n        at org.mule.transport.AbstractMessageReceiver$DefaultInternalMessageListener.onMessage(AbstractMessageReceiver.java:604)\n        at org.mule.transport.AbstractMessageReceiver.routeMessage(AbstractMessageReceiver.java:346)\n        at org.mule.transport.AbstractMessageReceiver.routeMessage(AbstractMessageReceiver.java:269)\n        a.lang.ClassCastException: edu.ucsb.eucalyptus.cloud.VmInfo cannot be cast to java.lang.String\n        at edu.ucsb.eucalyptus.ic.ReplyQueue.parsePayload(ReplyQueue.java:113)\n        at edu.ucsb.eucalyptus.ic.ReplyQueue.handle(ReplyQueue.java:78)\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n        at java.lang.reflect.Method.invoke(Method.java:597)\n        at org.mule.model.resolvers.AbstractEntryPointResolver.invokeMethod(AbstractEntryPointResolver.java:147)\n        at org.mule.model.resolvers.ReflectionEntryPointResolver.invoke(ReflectionEntryPointResolver.java:178)\n        at org.mule.model.resolvers.DefaultEntryPointResolverSet.invoke(DefaultEntryPointResolverSet.java:50)\n        at org.mule.component.DefaultLifecycleAdapter.intercept(DefaultLifecycleAdapter.java:202)\n        at org.mule.component.AbstractJavaComponent.invokeComponentInstance(AbstractJavaComponent.java:82)\n        at org.mule.component.AbstractJavaComponent.doOnCall(AbstractJavaComponent.java:73)\n        at org.mule.component.AbstractComponent.onCall(AbstractComponent.java:87)\n        at org.mule.model.seda.SedaService.doSend(SedaService.java:234)\n        at org.mule.service.AbstractService.sendEvent(AbstractService.java:510)\n        at org.mule.DefaultMuleSession.sendEvent(DefaultMuleSession.java:351)\n        at org.mule.routing.inbound.DefaultInboundRouterCollection.send(DefaultInboundRouterCollection.java:196)\n        at org.mule.routing.inbound.DefaultInboundRouterCollection.route(DefaultInboundRouterCollection.java:164)\n        at org.mule.transport.AbstractMessageReceiver$DefaultInternalMessageListener.onMessage(AbstractMessageReceiver.java:604)\n        at org.mule.transport.AbstractMessageReceiver.routeMessage(AbstractMessageReceiver.java:346)\n        at org.mule.transport.AbstractMessageReceiver.routeMessage(AbstractMessageReceiver.java:269)\nat org.mule.transport.vm.VMMessageReceiver.onCall(VMMessageReceiver.java:106)\n        at org.mule.transport.vm.VMMessageDispatcher.doSend(VMMessageDispatcher.java:104)\n        at org.mule.transport.AbstractMessageDispatcher.send(AbstractMessageDispatcher.java:157)\n        at org.mule.transport.AbstractConnector.send(AbstractConnector.java:1889)\n        at org.mule.endpoint.DefaultOutboundEndpoint.send(DefaultOutboundEndpoint.java:76)\n        at org.mule.AbstractExceptionListener.routeException(AbstractExceptionListener.java:307)\n        at org.mule.service.DefaultServiceExceptionStrategy.routeException(DefaultServiceExceptionStrategy.java:60)\n        at org.mule.DefaultExceptionStrategy.handleMessagingException(DefaultExceptionStrategy.java:30)\n        at org.mule.AbstractExceptionListener.exceptionThrown(AbstractExceptionListener.java:144)\n        at org.mule.service.AbstractService.handleException(AbstractService.java:561)\n        at org.mule.model.seda.SedaService.doSend(SedaService.java:249)\n        at org.mule.service.AbstractService.sendEvent(AbstractService.java:510)\n        at org.mule.DefaultMuleSession.sendEvent(DefaultMuleSession.java:351)\n        at org.mule.routing.inbound.DefaultInboundRouterCollection.send(DefaultInboundRouterCollection.java:196)\n        at org.mule.routing.inbound.DefaultInboundRouterCollection.route(DefaultInboundRouterCollection.java:164)\n        at org.mule.transport.AbstractMessageReceiver$DefaultInternalMessageListener.onMessage(AbstractMessageReceiver.java:604)\n        at org.mule.transport.AbstractMessageReceiver.routeMessage(AbstractMessageReceiver.java:346)\n        at org.mule.transport.AbstractMessageReceiver.routeMessage(AbstractMessageReceiver.java:269)\n        at org.mule.transport.vm.VMMessageReceiver.onCall(VMMessageReceiver.java:106)\n        at org.mule.transport.vm.VMMessageDispatcher.doSend(VMMessageDispatcher.java:104)\n        at org.mule.transport.AbstractMessageDispatcher.send(AbstractMessageDispatcher.java:157)\n        at org.mule.transport.AbstractConnector.send(AbstractConnector.java:1889)\n        at org.mule.endpoint.DefaultOutboundEndpoint.send(DefaultOutboundEndpoint.java:76)\n        at org.mule.DefaultMuleSession.sendEvent(DefaultMuleSession.java:324)\n        at org.mule.module.client.MuleClient.send(MuleClient.java:653)\n        at org.mule.module.client.MuleClient.send(MuleClient.java:630)\n        at org.mule.module.client.MuleClient.send(MuleClient.java:583)\n        at edu.ucsb.eucalyptus.util.Messaging.send(Messaging.java:67)\n        at edu.ucsb.eucalyptus.cloud.ws.SystemState.restoreInstance(SystemState.java:322)\n        at edu.ucsb.eucalyptus.cloud.ws.SystemState.updateVmInstance(SystemState.java:293)\n        at edu.ucsb.eucalyptus.cloud.ws.SystemState.handle(SystemState.java:100)\n        at edu.ucsb.eucalyptus.cloud.cluster.VmUpdateCallback.process(VmUpdateCallback.java:65)\n        at edu.ucsb.eucalyptus.cloud.cluster.VmUpdateCallback.process(VmUpdateCallback.java:16)\n        at edu.ucsb.eucalyptus.cloud.cluster.QueuedEvent.trigger(QueuedEvent.java:31)\n        at edu.ucsb.eucalyptus.cloud.cluster.ClusterMessageQueue.run(ClusterMessageQueue.java:117)\n        at java.lang.Thread.run(Thread.java:619)t org.mule.transport.vm.VMMessageReceiver.onCall(VMMessageReceiver.java:106)\n        at org.mule.transport.vm.VMMessageDispatcher.doSend(VMMessageDispatcher.java:104)\n        at org.mule.transport.AbstractMessageDispatcher.send(AbstractMessageDispatcher.java:157)\n        at org.mule.transport.AbstractConnector.send(AbstractConnector.java:1889)\n        at org.mule.endpoint.DefaultOutboundEndpoint.send(DefaultOutboundEndpoint.java:76)\n        at org.mule.DefaultMuleSession.sendEvent(DefaultMuleSession.java:324)\n        at org.mule.module.client.MuleClient.send(MuleClient.java:653)\n        at org.mule.module.client.MuleClient.send(MuleClient.java:630)\n        at org.mule.module.client.MuleClient.send(MuleClient.java:583)\n        at edu.ucsb.eucalyptus.util.Messaging.send(Messaging.java:67)\n        at edu.ucsb.eucalyptus.cloud.ws.SystemState.restoreInstance(SystemState.java:322)\n        at edu.ucsb.eucalyptus.cloud.ws.SystemState.updateVmInstance(SystemState.java:293)\n        at edu.ucsb.eucalyptus.cloud.ws.SystemState.handle(SystemState.java:100)\n        at edu.ucsb.eucalyptus.cloud.cluster.VmUpdateCallback.process(VmUpdateCallback.java:65)\n        at edu.ucsb.eucalyptus.cloud.cluster.VmUpdateCallback.process(VmUpdateCallback.java:16)\n        at edu.ucsb.eucalyptus.cloud.cluster.QueuedEvent.trigger(QueuedEvent.java:31)\n        at edu.ucsb.eucalyptus.cloud.cluster.ClusterMessageQueue.run(ClusterMessageQueue.java:117)\n        at java.lang.Thread.run(Thread.java:619)\n********************************************************************************\n\n[30 07 2009 13:23:58] [org.mule.service.DefaultServiceExceptionStrategy:ClusterMessageQueue-playpen@6C08FFAF]  ERROR Message being processed is: org.mule.transport.DefaultMessageAdapter/org.mule.transport.DefaultMessageAdapter@373bc99b{id=db25e0a4-7d03-11de-837c-2f62592abd08, payload=edu.ucsb.eucalyptus.cloud.VmInfo, correlationId=null, correlationGroup=-1, correlationSeq=-1, encoding=UTF-8, exceptionPayload=org.mule.message.DefaultExceptionPayload@3630fb71}\n[30 07 2009 13:23:58] [edu.ucsb.eucalyptus.ic.ReplyQueue:ClusterMessageQueue-playpen@6C08FFAF]  ERROR Bailing out of error handling: don't have the correlationId for the caller!\n[30 07 2009 13:23:58] [edu.ucsb.eucalyptus.ic.ReplyQueue:ClusterMessageQueue-playpen@6C08FFAF]  ERROR java.lang.ClassCastException: edu.ucsb.eucalyptus.cloud.VmInfo cannot be cast to java.lang.String\njava.lang.ClassCastException: edu.ucsb.eucalyptus.cloud.VmInfo cannot be cast to java.lang.String\n        at edu.ucsb.eucalyptus.ic.ReplyQueue.parsePayload(ReplyQueue.java:113)\n        at edu.ucsb.eucalyptus.ic.ReplyQueue.handle(ReplyQueue.java:78)\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n        at java.lang.reflect.Method.invoke(Method.java:597)\n        at org.mule.model.resolvers.AbstractEntryPointResolver.invokeMethod(AbstractEntryPointResolver.java:147)\n        at org.mule.model.resolvers.ReflectionEntryPointResolver.invoke(ReflectionEntryPointResolver.java:178)\n        at org.mule.model.resolvers.DefaultEntryPointResolverSet.invoke(DefaultEntryPointResolverSet.java:50)\n        at org.mule.component.DefaultLifecycleAdapter.intercept(DefaultLifecycleAdapter.java:202)\n        at org.mule.component.AbstractJavaComponent.invokeComponentInstance(AbstractJavaComponent.java:82)\n        at org.mule.component.AbstractJavaComponent.doOnCall(AbstractJavaComponent.java:73)\n        at org.mule.component.AbstractComponent.onCall(AbstractComponent.java:87)\n        at org.mule.model.seda.SedaService.doSend(SedaService.java:234)\n        at org.mule.service.AbstractService.sendEvent(AbstractService.java:510)\n        at org.mule.DefaultMuleSession.sendEvent(DefaultMuleSession.java:351)\n        at org.mule.routing.inbound.DefaultInboundRouterCollection.send(DefaultInboundRouterCollection.java:196)\n        at org.mule.routing.inbound.DefaultInboundRouterCollection.route(DefaultInboundRouterCollection.java:164)\n        at org.mule.transport.AbstractMessageReceiver$DefaultInternalMessageListener.onMessage(AbstractMessageReceiver.java:604)\n        at org.mule.transport.AbstractMessageReceiver.routeMessage(AbstractMessageReceiver.java:346)\n        at org.mule.transport.AbstractMessageReceiver.routeMessage(AbstractMessageReceiver.java:269)\n        at org.mule.transport.vm.VMMessageReceiver.onCall(VMMessageReceiver.java:106)\n        at org.mule.transport.vm.VMMessageDispatcher.doSend(VMMessageDispatcher.java:104)\n        at org.mule.transport.AbstractMessageDispatcher.send(AbstractMessageDispatcher.java:157)\n        at org.mule.transport.AbstractConnector.send(AbstractConnector.java:1889)\n        at org.mule.endpoint.DefaultOutboundEndpoint.send(DefaultOutboundEndpoint.java:76)\n        at org.mule.AbstractExceptionListener.routeException(AbstractExceptionListener.java:307)\n        at org.mule.service.DefaultServiceExceptionStrategy.routeException(DefaultServiceExceptionStrategy.java:60)\n        at org.mule.DefaultExceptionStrategy.handleMessagingException(DefaultExceptionStrategy.java:30)\n        at org.mule.AbstractExceptionListener.exceptionThrown(AbstractExceptionListener.java:144)\n        at org.mule.service.AbstractService.handleException(AbstractService.java:561)\n        at org.mule.model.seda.SedaService.doSend(SedaService.java:249)\n        at org.mule.service.AbstractService.sendEvent(AbstractService.java:510)\n        at org.mule.DefaultMuleSession.sendEvent(DefaultMuleSession.java:351)\n        at org.mule.routing.inbound.DefaultInboundRouterCollection.send(DefaultInboundRouterCollection.java:196)\n        at org.mule.routing.inbound.DefaultInboundRouterCollection.route(DefaultInboundRouterCollection.java:164)\n        at org.mule.transport.AbstractMessageReceiver$DefaultInternalMessageListener.onMessage(AbstractMessageReceiver.java:604)\n        at org.mule.transport.AbstractMessageReceiver.routeMessage(AbstractMessageReceiver.java:346)\n        at org.mule.transport.AbstractMessageReceiver.routeMessage(AbstractMessageReceiver.java:269)\n        at org.mule.transport.vm.VMMessageReceiver.onCall(VMMessageReceiver.java:106)\n        at org.mule.transport.vm.VMMessageDispatcher.doSend(VMMessageDispatcher.java:104)\n        at org.mule.transport.AbstractMessageDispatcher.send(AbstractMessageDispatcher.java:157)\n        at org.mule.transport.AbstractConnector.send(AbstractConnector.java:1889)\n        at org.mule.endpoint.DefaultOutboundEndpoint.send(DefaultOutboundEndpoint.java:76)\n        at org.mule.DefaultMuleSession.sendEvent(DefaultMuleSession.java:324)\n        at org.mule.module.client.MuleClient.send(MuleClient.java:653)\n        at org.mule.module.client.MuleClient.send(MuleClient.java:630)\n        at org.mule.module.client.MuleClient.send(MuleClient.java:583)\n        at edu.ucsb.eucalyptus.util.Messaging.send(Messaging.java:67)\n        at edu.ucsb.eucalyptus.cloud.ws.SystemState.restoreInstance(SystemState.java:322)\n        at edu.ucsb.eucalyptus.cloud.ws.SystemState.updateVmInstance(SystemState.java:293)\n        at edu.ucsb.eucalyptus.cloud.ws.SystemState.handle(SystemState.java:100)\n        at edu.ucsb.eucalyptus.cloud.cluster.VmUpdateCallback.process(VmUpdateCallback.java:65)\n        at edu.ucsb.eucalyptus.cloud.cluster.VmUpdateCallback.process(VmUpdateCallback.java:16)\n        at edu.ucsb.eucalyptus.cloud.cluster.QueuedEvent.trigger(QueuedEvent.java:31)\n        at edu.ucsb.eucalyptus.cloud.cluster.ClusterMessageQueue.run(ClusterMessageQueue.java:117)\n        at java.lang.Thread.run(Thread.java:619)\n[30 07 2009 13:23:58] [org.mule.config.ExceptionHelper:ClusterMessageQueue-playpen@6C08FFAF]  WARN  Failed to load error mappings from: META-INF/services/org/mule/config/vm-exception-mappings.properties This may be because there are no error code mappings for protocol: vm","customfield_13200":null,"customfield_11300":null,"customfield_11500":null,"timetracking":{},"customfield_10401":null,"customfield_10005":null,"customfield_10600":null,"customfield_12900":null,"aggregatetimeestimate":null,"attachment":[],"summary":"'Server: unknown' on startup after deregistering a running image","creator":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=eucabot","name":"eucabot","key":"eucabot","accountId":"557058:007ef05d-c772-4437-b383-d2b42d2a88a7","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/9e6d2b33ee28ce1387b2aa6cbe935cf3?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Deucabot%26avatarId%3D12000%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/9e6d2b33ee28ce1387b2aa6cbe935cf3?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Deucabot%26avatarId%3D12000%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/9e6d2b33ee28ce1387b2aa6cbe935cf3?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Deucabot%26avatarId%3D12000%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/9e6d2b33ee28ce1387b2aa6cbe935cf3?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Deucabot%26avatarId%3D12000%26noRedirect%3Dtrue"},"displayName":"Eucalyptus Bot","active":true,"timeZone":"Etc/GMT"},"subtasks":[],"reporter":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=eucabot","name":"eucabot","key":"eucabot","accountId":"557058:007ef05d-c772-4437-b383-d2b42d2a88a7","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/9e6d2b33ee28ce1387b2aa6cbe935cf3?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Deucabot%26avatarId%3D12000%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/9e6d2b33ee28ce1387b2aa6cbe935cf3?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Deucabot%26avatarId%3D12000%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/9e6d2b33ee28ce1387b2aa6cbe935cf3?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Deucabot%26avatarId%3D12000%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/9e6d2b33ee28ce1387b2aa6cbe935cf3?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Deucabot%26avatarId%3D12000%26noRedirect%3Dtrue"},"displayName":"Eucalyptus Bot","active":true,"timeZone":"Etc/GMT"},"aggregateprogress":{"progress":0,"total":0},"customfield_12100":"0|i01f0n:","customfield_10000":"10000_*:*_1_*:*_58722009015_*|*_5_*:*_1_*:*_0","customfield_10001":null,"customfield_10200":null,"customfield_10002":null,"customfield_10003":null,"customfield_12500":null,"customfield_10400":null,"customfield_10116":null,"customfield_11600":["decker(decker)","eucabot(eucabot)"],"customfield_10117":null,"environment":null,"customfield_11800":null,"customfield_11802":null,"customfield_11805":null,"duedate":null,"customfield_11806":null,"progress":{"progress":0,"total":0},"votes":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/EUCA-2654/votes","votes":0,"hasVoted":false},"comment":{"comments":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/14231/comment/29154","id":"29154","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=eucabot","name":"eucabot","key":"eucabot","accountId":"557058:007ef05d-c772-4437-b383-d2b42d2a88a7","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/9e6d2b33ee28ce1387b2aa6cbe935cf3?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Deucabot%26avatarId%3D12000%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/9e6d2b33ee28ce1387b2aa6cbe935cf3?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Deucabot%26avatarId%3D12000%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/9e6d2b33ee28ce1387b2aa6cbe935cf3?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Deucabot%26avatarId%3D12000%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/9e6d2b33ee28ce1387b2aa6cbe935cf3?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Deucabot%26avatarId%3D12000%26noRedirect%3Dtrue"},"displayName":"Eucalyptus Bot","active":true,"timeZone":"Etc/GMT"},"body":"Originally posted by robb1e on 2009-07-30T13:17:28.886450+00:00\n\nSteps to reproduce:\n\n1. launch an image\n2. wait for instance to start processing (doesn't have to be running state)\n3. De-register the image\n4. Restart Cloud Controller\n5. Use API to describe image\n\nGet this response:\n\n\"Server: unknown\"\n\nAt this point, you can't use the euca-describe-image API call from admin or this user, but you can kill it.  Then restarting the Cloud Controller restores access to the API.\n\nWhat's happening, is when the ImageManager does the lookup in the DB, get throws an exception, but outside of the try/catch block, it uses the object which would have been initialised but is null and throws a NullPointerException, here on diskInfo.\n\nArrayList<String> ancestorIds = this.getAncestors(vmInfo.getOwnerId(), diskInfo.getImageLocation());\n\nThis then gets to ReplyQueue via Mule (how, I don't know), and throws a cast exception in parsePayload as VmInfo isn't of type EucalyptusMessage, VmAllocationInfo or String.  I'm not quite sure what the correct fix is here, but ImageManager should be using diskInfo inside the try block.  I don't know if that'll change the exception handling, but that should be more graceful to handle exceptions it doesn't know about.  Would control then pass down to SystemState handle method to loop through to the next instance.  \n\nCan you recomend a patch to apply here?  I think I'm going to try changing the exception handling in ReplyQueue and see how that goes.\n\nGet these exception:\n\n[30 07 2009 13:23:58] [edu.ucsb.eucalyptus.cloud.ws.ImageManager:ClusterMessageQueue-playpen@6C08FFAF]  INFO  Error locating information for emi-74DB0EE2\nedu.ucsb.eucalyptus.cloud.EucalyptusCloudException: Error locating information for emi-74DB0EE2\n        at edu.ucsb.eucalyptus.cloud.entities.EntityWrapper.getUnique(EntityWrapper.java:105)\n        at edu.ucsb.eucalyptus.cloud.entities.ImageInfo.named(ImageInfo.java:333)\n        at edu.ucsb.eucalyptus.cloud.ws.ImageManager.verify(ImageManager.java:126)\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n        at java.lang.reflect.Method.invoke(Method.java:597)\n        at org.mule.model.resolvers.AbstractEntryPointResolver.invokeMethod(AbstractEntryPointResolver.java:147)\n        at org.mule.model.resolvers.ReflectionEntryPointResolver.invoke(ReflectionEntryPointResolver.java:178)\n        at org.mule.model.resolvers.DefaultEntryPointResolverSet.invoke(DefaultEntryPointResolverSet.java:50)\n        at org.mule.component.DefaultLifecycleAdapter.intercept(DefaultLifecycleAdapter.java:202)\n        at org.mule.component.AbstractJavaComponent.invokeComponentInstance(AbstractJavaComponent.java:82)\n        at org.mule.component.AbstractJavaComponent.doOnCall(AbstractJavaComponent.java:73)\n        at org.mule.component.AbstractComponent.onCall(AbstractComponent.java:87)\n        at org.mule.model.seda.SedaService.doSend(SedaService.java:234)\n        at org.mule.service.AbstractService.sendEvent(AbstractService.java:510)\n        at org.mule.DefaultMuleSession.sendEvent(DefaultMuleSession.java:351)\n        at org.mule.routing.inbound.DefaultInboundRouterCollection.send(DefaultInboundRouterCollection.java:196)\n        at org.mule.routing.inbound.DefaultInboundRouterCollection.route(DefaultInboundRouterCollection.java:164)\n        at org.mule.transport.AbstractMessageReceiver$DefaultInternalMessageListener.onMessage(AbstractMessageReceiver.java:604)\n        at org.mule.transport.AbstractMessageReceiver.routeMessage(AbstractMessageReceiver.java:346)\n        at org.mule.transport.AbstractMessageReceiver.routeMessage(AbstractMessageReceiver.java:269)\n        at org.mule.transport.vm.VMMessageReceiver.onCall(VMMessageReceiver.java:106)\n        at org.mule.transport.vm.VMMessageDispatcher.doSend(VMMessageDispatcher.java:104)\n        at org.mule.transport.AbstractMessageDispatcher.send(AbstractMessageDispatcher.java:157)\n        at org.mule.transport.AbstractConnector.send(AbstractConnector.java:1889)\n        at org.mule.endpoint.DefaultOutboundEndpoint.send(DefaultOutboundEndpoint.java:76)\n        at org.mule.DefaultMuleSession.sendEvent(DefaultMuleSession.java:324)\n        at org.mule.module.client.MuleClient.send(MuleClient.java:653)\n        at org.mule.module.client.MuleClient.send(MuleClient.java:630)\n        at org.mule.module.client.MuleClient.send(MuleClient.java:583)\n        at edu.ucsb.eucalyptus.util.Messaging.send(Messaging.java:67)\n        at edu.ucsb.eucalyptus.cloud.ws.SystemState.restoreInstance(SystemState.java:322)\n        at edu.ucsb.eucalyptus.cloud.ws.SystemState.updateVmInstance(SystemState.java:293)\n        at edu.ucsb.eucalyptus.cloud.ws.SystemState.handle(SystemState.java:100)\n        at edu.ucsb.eucalyptus.cloud.cluster.VmUpdateCallback.process(VmUpdateCallback.java:65)\n        at edu.ucsb.eucalyptus.cloud.cluster.VmUpdateCallback.process(VmUpdateCallback.java:16)\n        at edu.ucsb.eucalyptus.cloud.cluster.QueuedEvent.trigger(QueuedEvent.java:31)\n        at edu.ucsb.eucalyptus.cloud.cluster.ClusterMessageQueue.run(ClusterMessageQueue.java:117)\n        at java.lang.Thread.run(Thread.java:619)\n[30 07 2009 13:23:58] [org.mule.service.DefaultServiceExceptionStrategy:ClusterMessageQueue-playpen@6C08FFAF]  ERROR\n********************************************************************************\nMessage               : Component that caused exception is: ImageResolve. Message payload is of type: VmInfo\nType                  : org.mule.api.service.ServiceException\nCode                  : MULE_ERROR--2\nPayload               : [\"placement\":\"playpen\", \"launchIndex\":\"0\", \"ownerId\":\"admin\", \"groupNames\":[\"default\"], \"instanceId\":\"i-426707DE\", \"class\":class edu.ucsb.eucalyptus.cloud.VmInfo, \"kernelId\":\"eki-F4DB10D7\", \"reservationId\":\"r-31FD0667\", \"volumes\":[], \"userData\":\"\", \"metaClass\":groovy.lang.MetaClassImpl@6f3a342a[class edu.ucsb.eucalyptus.cloud.VmInfo], \"instanceType\":VmTypeInfo{name='m1.small', memory=128, disk=1, cores=1}, \"serviceTag\":\"http://vm-container-0-0:8775/axis2/services/EucalyptusNC\", \"imageId\":\"emi-74DB0EE2\", \"productCodes\":[], \"launchTime\":Thu Jul 30 13:22:47 BST 2009, \"ramdiskId\":\"\", \"stateName\":\"Extant\", \"netParams\":NetworkConfigType{macAddress='d0:0d:42:67:07:DE', ipAddress='172.29.23.2', publicIp='0.0.0.0', vlan=370}, \"keyValue\":\"\"]\nJavaDoc               : http://mule.mulesource.org/docs/apidocs/org/mule/api/service/ServiceException.html\n********************************************************************************\nException stack is:\n1. null (java.lang.NullPointerException)\n  edu.ucsb.eucalyptus.cloud.ws.ImageManager:140 (null)\n2. Component that caused exception is: ImageResolve. Message payload is of type: VmInfo (org.mule.api.service.ServiceException)\n  org.mule.component.DefaultLifecycleAdapter:214 (http://mule.mulesource.org/docs/apidocs/org/mule/api/service/ServiceException.html)\n********************************************************************************\nRoot Exception stack trace:\njava.lang.NullPointerException\n        at edu.ucsb.eucalyptus.cloud.ws.ImageManager.verify(ImageManager.java:140)\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n        at java.lang.reflect.Method.invoke(Method.java:597)\n        at org.mule.model.resolvers.AbstractEntryPointResolver.invokeMethod(AbstractEntryPointResolver.java:147)\n        at org.mule.model.resolvers.ReflectionEntryPointResolver.invoke(ReflectionEntryPointResolver.java:178)\n        at org.mule.model.resolvers.DefaultEntryPointResolverSet.invoke(DefaultEntryPointResolverSet.java:50)\n        at org.mule.component.DefaultLifecycleAdapter.intercept(DefaultLifecycleAdapter.java:202)\n        at org.mule.component.AbstractJavaComponent.invokeComponentInstance(AbstractJavaComponent.java:82)\n        at org.mule.component.AbstractJavaComponent.doOnCall(AbstractJavaComponent.java:73)\n        at org.mule.component.AbstractComponent.onCall(AbstractComponent.java:87)\n        at org.mule.model.seda.SedaService.doSend(SedaService.java:234)\n        at org.mule.service.AbstractService.sendEvent(AbstractService.java:510)\n        at org.mule.DefaultMuleSession.sendEvent(DefaultMuleSession.java:351)\n        at org.mule.routing.inbound.DefaultInboundRouterCollection.send(DefaultInboundRouterCollection.java:196)\n        at org.mule.routing.inbound.DefaultInboundRouterCollection.route(DefaultInboundRouterCollection.java:164)\n        at org.mule.transport.AbstractMessageReceiver$DefaultInternalMessageListener.onMessage(AbstractMessageReceiver.java:604)\n        at org.mule.transport.AbstractMessageReceiver.routeMessage(AbstractMessageReceiver.java:346)\n        at org.mule.transport.AbstractMessageReceiver.routeMessage(AbstractMessageReceiver.java:269)\n        a.lang.ClassCastException: edu.ucsb.eucalyptus.cloud.VmInfo cannot be cast to java.lang.String\n        at edu.ucsb.eucalyptus.ic.ReplyQueue.parsePayload(ReplyQueue.java:113)\n        at edu.ucsb.eucalyptus.ic.ReplyQueue.handle(ReplyQueue.java:78)\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n        at java.lang.reflect.Method.invoke(Method.java:597)\n        at org.mule.model.resolvers.AbstractEntryPointResolver.invokeMethod(AbstractEntryPointResolver.java:147)\n        at org.mule.model.resolvers.ReflectionEntryPointResolver.invoke(ReflectionEntryPointResolver.java:178)\n        at org.mule.model.resolvers.DefaultEntryPointResolverSet.invoke(DefaultEntryPointResolverSet.java:50)\n        at org.mule.component.DefaultLifecycleAdapter.intercept(DefaultLifecycleAdapter.java:202)\n        at org.mule.component.AbstractJavaComponent.invokeComponentInstance(AbstractJavaComponent.java:82)\n        at org.mule.component.AbstractJavaComponent.doOnCall(AbstractJavaComponent.java:73)\n        at org.mule.component.AbstractComponent.onCall(AbstractComponent.java:87)\n        at org.mule.model.seda.SedaService.doSend(SedaService.java:234)\n        at org.mule.service.AbstractService.sendEvent(AbstractService.java:510)\n        at org.mule.DefaultMuleSession.sendEvent(DefaultMuleSession.java:351)\n        at org.mule.routing.inbound.DefaultInboundRouterCollection.send(DefaultInboundRouterCollection.java:196)\n        at org.mule.routing.inbound.DefaultInboundRouterCollection.route(DefaultInboundRouterCollection.java:164)\n        at org.mule.transport.AbstractMessageReceiver$DefaultInternalMessageListener.onMessage(AbstractMessageReceiver.java:604)\n        at org.mule.transport.AbstractMessageReceiver.routeMessage(AbstractMessageReceiver.java:346)\n        at org.mule.transport.AbstractMessageReceiver.routeMessage(AbstractMessageReceiver.java:269)\nat org.mule.transport.vm.VMMessageReceiver.onCall(VMMessageReceiver.java:106)\n        at org.mule.transport.vm.VMMessageDispatcher.doSend(VMMessageDispatcher.java:104)\n        at org.mule.transport.AbstractMessageDispatcher.send(AbstractMessageDispatcher.java:157)\n        at org.mule.transport.AbstractConnector.send(AbstractConnector.java:1889)\n        at org.mule.endpoint.DefaultOutboundEndpoint.send(DefaultOutboundEndpoint.java:76)\n        at org.mule.AbstractExceptionListener.routeException(AbstractExceptionListener.java:307)\n        at org.mule.service.DefaultServiceExceptionStrategy.routeException(DefaultServiceExceptionStrategy.java:60)\n        at org.mule.DefaultExceptionStrategy.handleMessagingException(DefaultExceptionStrategy.java:30)\n        at org.mule.AbstractExceptionListener.exceptionThrown(AbstractExceptionListener.java:144)\n        at org.mule.service.AbstractService.handleException(AbstractService.java:561)\n        at org.mule.model.seda.SedaService.doSend(SedaService.java:249)\n        at org.mule.service.AbstractService.sendEvent(AbstractService.java:510)\n        at org.mule.DefaultMuleSession.sendEvent(DefaultMuleSession.java:351)\n        at org.mule.routing.inbound.DefaultInboundRouterCollection.send(DefaultInboundRouterCollection.java:196)\n        at org.mule.routing.inbound.DefaultInboundRouterCollection.route(DefaultInboundRouterCollection.java:164)\n        at org.mule.transport.AbstractMessageReceiver$DefaultInternalMessageListener.onMessage(AbstractMessageReceiver.java:604)\n        at org.mule.transport.AbstractMessageReceiver.routeMessage(AbstractMessageReceiver.java:346)\n        at org.mule.transport.AbstractMessageReceiver.routeMessage(AbstractMessageReceiver.java:269)\n        at org.mule.transport.vm.VMMessageReceiver.onCall(VMMessageReceiver.java:106)\n        at org.mule.transport.vm.VMMessageDispatcher.doSend(VMMessageDispatcher.java:104)\n        at org.mule.transport.AbstractMessageDispatcher.send(AbstractMessageDispatcher.java:157)\n        at org.mule.transport.AbstractConnector.send(AbstractConnector.java:1889)\n        at org.mule.endpoint.DefaultOutboundEndpoint.send(DefaultOutboundEndpoint.java:76)\n        at org.mule.DefaultMuleSession.sendEvent(DefaultMuleSession.java:324)\n        at org.mule.module.client.MuleClient.send(MuleClient.java:653)\n        at org.mule.module.client.MuleClient.send(MuleClient.java:630)\n        at org.mule.module.client.MuleClient.send(MuleClient.java:583)\n        at edu.ucsb.eucalyptus.util.Messaging.send(Messaging.java:67)\n        at edu.ucsb.eucalyptus.cloud.ws.SystemState.restoreInstance(SystemState.java:322)\n        at edu.ucsb.eucalyptus.cloud.ws.SystemState.updateVmInstance(SystemState.java:293)\n        at edu.ucsb.eucalyptus.cloud.ws.SystemState.handle(SystemState.java:100)\n        at edu.ucsb.eucalyptus.cloud.cluster.VmUpdateCallback.process(VmUpdateCallback.java:65)\n        at edu.ucsb.eucalyptus.cloud.cluster.VmUpdateCallback.process(VmUpdateCallback.java:16)\n        at edu.ucsb.eucalyptus.cloud.cluster.QueuedEvent.trigger(QueuedEvent.java:31)\n        at edu.ucsb.eucalyptus.cloud.cluster.ClusterMessageQueue.run(ClusterMessageQueue.java:117)\n        at java.lang.Thread.run(Thread.java:619)t org.mule.transport.vm.VMMessageReceiver.onCall(VMMessageReceiver.java:106)\n        at org.mule.transport.vm.VMMessageDispatcher.doSend(VMMessageDispatcher.java:104)\n        at org.mule.transport.AbstractMessageDispatcher.send(AbstractMessageDispatcher.java:157)\n        at org.mule.transport.AbstractConnector.send(AbstractConnector.java:1889)\n        at org.mule.endpoint.DefaultOutboundEndpoint.send(DefaultOutboundEndpoint.java:76)\n        at org.mule.DefaultMuleSession.sendEvent(DefaultMuleSession.java:324)\n        at org.mule.module.client.MuleClient.send(MuleClient.java:653)\n        at org.mule.module.client.MuleClient.send(MuleClient.java:630)\n        at org.mule.module.client.MuleClient.send(MuleClient.java:583)\n        at edu.ucsb.eucalyptus.util.Messaging.send(Messaging.java:67)\n        at edu.ucsb.eucalyptus.cloud.ws.SystemState.restoreInstance(SystemState.java:322)\n        at edu.ucsb.eucalyptus.cloud.ws.SystemState.updateVmInstance(SystemState.java:293)\n        at edu.ucsb.eucalyptus.cloud.ws.SystemState.handle(SystemState.java:100)\n        at edu.ucsb.eucalyptus.cloud.cluster.VmUpdateCallback.process(VmUpdateCallback.java:65)\n        at edu.ucsb.eucalyptus.cloud.cluster.VmUpdateCallback.process(VmUpdateCallback.java:16)\n        at edu.ucsb.eucalyptus.cloud.cluster.QueuedEvent.trigger(QueuedEvent.java:31)\n        at edu.ucsb.eucalyptus.cloud.cluster.ClusterMessageQueue.run(ClusterMessageQueue.java:117)\n        at java.lang.Thread.run(Thread.java:619)\n********************************************************************************\n\n[30 07 2009 13:23:58] [org.mule.service.DefaultServiceExceptionStrategy:ClusterMessageQueue-playpen@6C08FFAF]  ERROR Message being processed is: org.mule.transport.DefaultMessageAdapter/org.mule.transport.DefaultMessageAdapter@373bc99b{id=db25e0a4-7d03-11de-837c-2f62592abd08, payload=edu.ucsb.eucalyptus.cloud.VmInfo, correlationId=null, correlationGroup=-1, correlationSeq=-1, encoding=UTF-8, exceptionPayload=org.mule.message.DefaultExceptionPayload@3630fb71}\n[30 07 2009 13:23:58] [edu.ucsb.eucalyptus.ic.ReplyQueue:ClusterMessageQueue-playpen@6C08FFAF]  ERROR Bailing out of error handling: don't have the correlationId for the caller!\n[30 07 2009 13:23:58] [edu.ucsb.eucalyptus.ic.ReplyQueue:ClusterMessageQueue-playpen@6C08FFAF]  ERROR java.lang.ClassCastException: edu.ucsb.eucalyptus.cloud.VmInfo cannot be cast to java.lang.String\njava.lang.ClassCastException: edu.ucsb.eucalyptus.cloud.VmInfo cannot be cast to java.lang.String\n        at edu.ucsb.eucalyptus.ic.ReplyQueue.parsePayload(ReplyQueue.java:113)\n        at edu.ucsb.eucalyptus.ic.ReplyQueue.handle(ReplyQueue.java:78)\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n        at java.lang.reflect.Method.invoke(Method.java:597)\n        at org.mule.model.resolvers.AbstractEntryPointResolver.invokeMethod(AbstractEntryPointResolver.java:147)\n        at org.mule.model.resolvers.ReflectionEntryPointResolver.invoke(ReflectionEntryPointResolver.java:178)\n        at org.mule.model.resolvers.DefaultEntryPointResolverSet.invoke(DefaultEntryPointResolverSet.java:50)\n        at org.mule.component.DefaultLifecycleAdapter.intercept(DefaultLifecycleAdapter.java:202)\n        at org.mule.component.AbstractJavaComponent.invokeComponentInstance(AbstractJavaComponent.java:82)\n        at org.mule.component.AbstractJavaComponent.doOnCall(AbstractJavaComponent.java:73)\n        at org.mule.component.AbstractComponent.onCall(AbstractComponent.java:87)\n        at org.mule.model.seda.SedaService.doSend(SedaService.java:234)\n        at org.mule.service.AbstractService.sendEvent(AbstractService.java:510)\n        at org.mule.DefaultMuleSession.sendEvent(DefaultMuleSession.java:351)\n        at org.mule.routing.inbound.DefaultInboundRouterCollection.send(DefaultInboundRouterCollection.java:196)\n        at org.mule.routing.inbound.DefaultInboundRouterCollection.route(DefaultInboundRouterCollection.java:164)\n        at org.mule.transport.AbstractMessageReceiver$DefaultInternalMessageListener.onMessage(AbstractMessageReceiver.java:604)\n        at org.mule.transport.AbstractMessageReceiver.routeMessage(AbstractMessageReceiver.java:346)\n        at org.mule.transport.AbstractMessageReceiver.routeMessage(AbstractMessageReceiver.java:269)\n        at org.mule.transport.vm.VMMessageReceiver.onCall(VMMessageReceiver.java:106)\n        at org.mule.transport.vm.VMMessageDispatcher.doSend(VMMessageDispatcher.java:104)\n        at org.mule.transport.AbstractMessageDispatcher.send(AbstractMessageDispatcher.java:157)\n        at org.mule.transport.AbstractConnector.send(AbstractConnector.java:1889)\n        at org.mule.endpoint.DefaultOutboundEndpoint.send(DefaultOutboundEndpoint.java:76)\n        at org.mule.AbstractExceptionListener.routeException(AbstractExceptionListener.java:307)\n        at org.mule.service.DefaultServiceExceptionStrategy.routeException(DefaultServiceExceptionStrategy.java:60)\n        at org.mule.DefaultExceptionStrategy.handleMessagingException(DefaultExceptionStrategy.java:30)\n        at org.mule.AbstractExceptionListener.exceptionThrown(AbstractExceptionListener.java:144)\n        at org.mule.service.AbstractService.handleException(AbstractService.java:561)\n        at org.mule.model.seda.SedaService.doSend(SedaService.java:249)\n        at org.mule.service.AbstractService.sendEvent(AbstractService.java:510)\n        at org.mule.DefaultMuleSession.sendEvent(DefaultMuleSession.java:351)\n        at org.mule.routing.inbound.DefaultInboundRouterCollection.send(DefaultInboundRouterCollection.java:196)\n        at org.mule.routing.inbound.DefaultInboundRouterCollection.route(DefaultInboundRouterCollection.java:164)\n        at org.mule.transport.AbstractMessageReceiver$DefaultInternalMessageListener.onMessage(AbstractMessageReceiver.java:604)\n        at org.mule.transport.AbstractMessageReceiver.routeMessage(AbstractMessageReceiver.java:346)\n        at org.mule.transport.AbstractMessageReceiver.routeMessage(AbstractMessageReceiver.java:269)\n        at org.mule.transport.vm.VMMessageReceiver.onCall(VMMessageReceiver.java:106)\n        at org.mule.transport.vm.VMMessageDispatcher.doSend(VMMessageDispatcher.java:104)\n        at org.mule.transport.AbstractMessageDispatcher.send(AbstractMessageDispatcher.java:157)\n        at org.mule.transport.AbstractConnector.send(AbstractConnector.java:1889)\n        at org.mule.endpoint.DefaultOutboundEndpoint.send(DefaultOutboundEndpoint.java:76)\n        at org.mule.DefaultMuleSession.sendEvent(DefaultMuleSession.java:324)\n        at org.mule.module.client.MuleClient.send(MuleClient.java:653)\n        at org.mule.module.client.MuleClient.send(MuleClient.java:630)\n        at org.mule.module.client.MuleClient.send(MuleClient.java:583)\n        at edu.ucsb.eucalyptus.util.Messaging.send(Messaging.java:67)\n        at edu.ucsb.eucalyptus.cloud.ws.SystemState.restoreInstance(SystemState.java:322)\n        at edu.ucsb.eucalyptus.cloud.ws.SystemState.updateVmInstance(SystemState.java:293)\n        at edu.ucsb.eucalyptus.cloud.ws.SystemState.handle(SystemState.java:100)\n        at edu.ucsb.eucalyptus.cloud.cluster.VmUpdateCallback.process(VmUpdateCallback.java:65)\n        at edu.ucsb.eucalyptus.cloud.cluster.VmUpdateCallback.process(VmUpdateCallback.java:16)\n        at edu.ucsb.eucalyptus.cloud.cluster.QueuedEvent.trigger(QueuedEvent.java:31)\n        at edu.ucsb.eucalyptus.cloud.cluster.ClusterMessageQueue.run(ClusterMessageQueue.java:117)\n        at java.lang.Thread.run(Thread.java:619)\n[30 07 2009 13:23:58] [org.mule.config.ExceptionHelper:ClusterMessageQueue-playpen@6C08FFAF]  WARN  Failed to load error mappings from: META-INF/services/org/mule/config/vm-exception-mappings.properties This may be because there are no error code mappings for protocol: vm","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=eucabot","name":"eucabot","key":"eucabot","accountId":"557058:007ef05d-c772-4437-b383-d2b42d2a88a7","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/9e6d2b33ee28ce1387b2aa6cbe935cf3?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Deucabot%26avatarId%3D12000%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/9e6d2b33ee28ce1387b2aa6cbe935cf3?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Deucabot%26avatarId%3D12000%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/9e6d2b33ee28ce1387b2aa6cbe935cf3?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Deucabot%26avatarId%3D12000%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/9e6d2b33ee28ce1387b2aa6cbe935cf3?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Deucabot%26avatarId%3D12000%26noRedirect%3Dtrue"},"displayName":"Eucalyptus Bot","active":true,"timeZone":"Etc/GMT"},"created":"2012-07-11T07:44:27.461-0500","updated":"2012-07-11T07:44:27.461-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/14231/comment/29155","id":"29155","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=eucabot","name":"eucabot","key":"eucabot","accountId":"557058:007ef05d-c772-4437-b383-d2b42d2a88a7","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/9e6d2b33ee28ce1387b2aa6cbe935cf3?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Deucabot%26avatarId%3D12000%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/9e6d2b33ee28ce1387b2aa6cbe935cf3?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Deucabot%26avatarId%3D12000%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/9e6d2b33ee28ce1387b2aa6cbe935cf3?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Deucabot%26avatarId%3D12000%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/9e6d2b33ee28ce1387b2aa6cbe935cf3?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Deucabot%26avatarId%3D12000%26noRedirect%3Dtrue"},"displayName":"Eucalyptus Bot","active":true,"timeZone":"Etc/GMT"},"body":"Originally posted by danleyden on 2009-09-01T12:52:30.893836+00:00\n\nAny updates / fixes available for this bug?","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=eucabot","name":"eucabot","key":"eucabot","accountId":"557058:007ef05d-c772-4437-b383-d2b42d2a88a7","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/9e6d2b33ee28ce1387b2aa6cbe935cf3?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Deucabot%26avatarId%3D12000%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/9e6d2b33ee28ce1387b2aa6cbe935cf3?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Deucabot%26avatarId%3D12000%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/9e6d2b33ee28ce1387b2aa6cbe935cf3?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Deucabot%26avatarId%3D12000%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/9e6d2b33ee28ce1387b2aa6cbe935cf3?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Deucabot%26avatarId%3D12000%26noRedirect%3Dtrue"},"displayName":"Eucalyptus Bot","active":true,"timeZone":"Etc/GMT"},"created":"2012-07-11T07:44:28.232-0500","updated":"2012-07-11T07:44:28.232-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/14231/comment/29156","id":"29156","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=eucabot","name":"eucabot","key":"eucabot","accountId":"557058:007ef05d-c772-4437-b383-d2b42d2a88a7","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/9e6d2b33ee28ce1387b2aa6cbe935cf3?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Deucabot%26avatarId%3D12000%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/9e6d2b33ee28ce1387b2aa6cbe935cf3?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Deucabot%26avatarId%3D12000%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/9e6d2b33ee28ce1387b2aa6cbe935cf3?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Deucabot%26avatarId%3D12000%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/9e6d2b33ee28ce1387b2aa6cbe935cf3?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Deucabot%26avatarId%3D12000%26noRedirect%3Dtrue"},"displayName":"Eucalyptus Bot","active":true,"timeZone":"Etc/GMT"},"body":"Originally posted by robb1e on 2009-09-01T15:30:53.567587+00:00\n\nI managed to fix this by applying this patch to ImageManager.java\n\n@@ -147,11 +147,17 @@\n             db.clean();\n         }\n \n-        ArrayList<String> ancestorIds = this.getAncestors(vmInfo.getOwnerId(), diskInfo.getImageLocation());\n-\n-        // :: create the response assets now since we might not have a ramdisk anyway :://\n-        VmImageInfo vmImgInfo = new VmImageInfo(vmInfo.getImageId(), vmInfo.getKernelId(), vmInfo.getRamdiskId(), diskUrl, null, null, productCodes);\n-        vmImgInfo.setAncestorIds(ancestorIds);\n+        VmImageInfo vmImgInfo;\n+        if (null != diskInfo && null != diskUrl){\n+\t        ArrayList<String> ancestorIds = this.getAncestors(vmInfo.getOwnerId(), diskInfo.getImageLocation());\n+\t\n+\t        // :: create the response assets now since we might not have a ramdisk anyway :://\n+\t        vmImgInfo = new VmImageInfo(vmInfo.getImageId(), vmInfo.getKernelId(), vmInfo.getRamdiskId(), diskUrl, null, null, productCodes);\n+\t        vmImgInfo.setAncestorIds(ancestorIds);\n+        } else {\n+        \tvmImgInfo = new VmImageInfo(vmInfo.getImageId(), vmInfo.getKernelId(), vmInfo.getRamdiskId(), \"\", null, null, productCodes);\n+        \tvmImgInfo.setAncestorIds(new ArrayList<String>());\n+        }\n         return vmImgInfo;\n     }\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=eucabot","name":"eucabot","key":"eucabot","accountId":"557058:007ef05d-c772-4437-b383-d2b42d2a88a7","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/9e6d2b33ee28ce1387b2aa6cbe935cf3?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Deucabot%26avatarId%3D12000%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/9e6d2b33ee28ce1387b2aa6cbe935cf3?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Deucabot%26avatarId%3D12000%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/9e6d2b33ee28ce1387b2aa6cbe935cf3?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Deucabot%26avatarId%3D12000%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/9e6d2b33ee28ce1387b2aa6cbe935cf3?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Deucabot%26avatarId%3D12000%26noRedirect%3Dtrue"},"displayName":"Eucalyptus Bot","active":true,"timeZone":"Etc/GMT"},"created":"2012-07-11T07:44:28.906-0500","updated":"2012-07-11T07:44:28.906-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/14231/comment/29157","id":"29157","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=eucabot","name":"eucabot","key":"eucabot","accountId":"557058:007ef05d-c772-4437-b383-d2b42d2a88a7","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/9e6d2b33ee28ce1387b2aa6cbe935cf3?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Deucabot%26avatarId%3D12000%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/9e6d2b33ee28ce1387b2aa6cbe935cf3?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Deucabot%26avatarId%3D12000%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/9e6d2b33ee28ce1387b2aa6cbe935cf3?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Deucabot%26avatarId%3D12000%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/9e6d2b33ee28ce1387b2aa6cbe935cf3?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Deucabot%26avatarId%3D12000%26noRedirect%3Dtrue"},"displayName":"Eucalyptus Bot","active":true,"timeZone":"Etc/GMT"},"body":"Originally posted by danleyden on 2009-09-01T16:50:28+00:00\n\nThanks Robb1e,\n\nyou da man!\n\n\n\n2009/9/1 robb1e <robert.clutton@gmail.com>:\n> I managed to fix this by applying this patch to ImageManager.java\n>\n> @@ -147,11 +147,17 @@\n>       db.clean();\n>     }\n>\n> -    ArrayList<String> ancestorIds = this.getAncestors(vmInfo.getOwnerId(), diskInfo.getImageLocation());\n> -\n> -    // :: create the response assets now since we might not have a ramdisk anyway :://\n> -    VmImageInfo vmImgInfo = new VmImageInfo(vmInfo.getImageId(), vmInfo.getKernelId(), vmInfo.getRamdiskId(), diskUrl, null, null, productCodes);\n> -    vmImgInfo.setAncestorIds(ancestorIds);\n> +    VmImageInfo vmImgInfo;\n> +    if (null != diskInfo && null != diskUrl){\n> +        ArrayList<String> ancestorIds = this.getAncestors(vmInfo.getOwnerId(), diskInfo.getImageLocation());\n> +\n> +        // :: create the response assets now since we might not have a ramdisk anyway :://\n> +        vmImgInfo = new VmImageInfo(vmInfo.getImageId(), vmInfo.getKernelId(), vmInfo.getRamdiskId(), diskUrl, null, null, productCodes);\n> +        vmImgInfo.setAncestorIds(ancestorIds);\n> +    } else {\n> +        vmImgInfo = new VmImageInfo(vmInfo.getImageId(), vmInfo.getKernelId(), vmInfo.getRamdiskId(), \"\", null, null, productCodes);\n> +        vmImgInfo.setAncestorIds(new ArrayList<String>());\n> +    }\n>     return vmImgInfo;\n>   }\n>\n> --\n> 'Server: unknown' on startup after deregistering a running image\n> https://bugs.launchpad.net/bugs/406878\n> You received this bug notification because you are subscribed to\n> Eucalyptus.\n>\n> Status in Eucalyptus: New\n>\n> Bug description:\n> Steps to reproduce:\n>\n> 1. launch an image\n> 2. wait for instance to start processing (doesn't have to be running state)\n> 3. De-register the image\n> 4. Restart Cloud Controller\n> 5. Use API to describe image\n>\n> Get this response:\n>\n> \"Server: unknown\"\n>\n> At this point, you can't use the euca-describe-image API call from admin or this user, but you can kill it. Then restarting the Cloud Controller restores access to the API.\n>\n> What's happening, is when the ImageManager does the lookup in the DB, get throws an exception, but outside of the try/catch block, it uses the object which would have been initialised but is null and throws a NullPointerException, here on diskInfo.\n>\n> ArrayList<String> ancestorIds = this.getAncestors(vmInfo.getOwnerId(), diskInfo.getImageLocation());\n>\n> This then gets to ReplyQueue via Mule (how, I don't know), and throws a cast exception in parsePayload as VmInfo isn't of type EucalyptusMessage, VmAllocationInfo or String. I'm not quite sure what the correct fix is here, but ImageManager should be using diskInfo inside the try block. I don't know if that'll change the exception handling, but that should be more graceful to handle exceptions it doesn't know about. Would control then pass down to SystemState handle method to loop through to the next instance.\n>\n> Can you recomend a patch to apply here? I think I'm going to try changing the exception handling in ReplyQueue and see how that goes.\n>\n> Get these exception:\n>\n> [30 07 2009 13:23:58] [edu.ucsb.eucalyptus.cloud.ws.ImageManager:ClusterMessageQueue-playpen@6C08FFAF] INFO Error locating information for emi-74DB0EE2\n> edu.ucsb.eucalyptus.cloud.EucalyptusCloudException: Error locating information for emi-74DB0EE2\n>    at edu.ucsb.eucalyptus.cloud.entities.EntityWrapper.getUnique(EntityWrapper.java:105)\n>    at edu.ucsb.eucalyptus.cloud.entities.ImageInfo.named(ImageInfo.java:333)\n>    at edu.ucsb.eucalyptus.cloud.ws.ImageManager.verify(ImageManager.java:126)\n>    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n>    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n>    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n>    at java.lang.reflect.Method.invoke(Method.java:597)\n>    at org.mule.model.resolvers.AbstractEntryPointResolver.invokeMethod(AbstractEntryPointResolver.java:147)\n>    at org.mule.model.resolvers.ReflectionEntryPointResolver.invoke(ReflectionEntryPointResolver.java:178)\n>    at org.mule.model.resolvers.DefaultEntryPointResolverSet.invoke(DefaultEntryPointResolverSet.java:50)\n>    at org.mule.component.DefaultLifecycleAdapter.intercept(DefaultLifecycleAdapter.java:202)\n>    at org.mule.component.AbstractJavaComponent.invokeComponentInstance(AbstractJavaComponent.java:82)\n>    at org.mule.component.AbstractJavaComponent.doOnCall(AbstractJavaComponent.java:73)\n>    at org.mule.component.AbstractComponent.onCall(AbstractComponent.java:87)\n>    at org.mule.model.seda.SedaService.doSend(SedaService.java:234)\n>    at org.mule.service.AbstractService.sendEvent(AbstractService.java:510)\n>    at org.mule.DefaultMuleSession.sendEvent(DefaultMuleSession.java:351)\n>    at org.mule.routing.inbound.DefaultInboundRouterCollection.send(DefaultInboundRouterCollection.java:196)\n>    at org.mule.routing.inbound.DefaultInboundRouterCollection.route(DefaultInboundRouterCollection.java:164)\n>    at org.mule.transport.AbstractMessageReceiver$DefaultInternalMessageListener.onMessage(AbstractMessageReceiver.java:604)\n>    at org.mule.transport.AbstractMessageReceiver.routeMessage(AbstractMessageReceiver.java:346)\n>    at org.mule.transport.AbstractMessageReceiver.routeMessage(AbstractMessageReceiver.java:269)\n>    at org.mule.transport.vm.VMMessageReceiver.onCall(VMMessageReceiver.java:106)\n>    at org.mule.transport.vm.VMMessageDispatcher.doSend(VMMessageDispatcher.java:104)\n>    at org.mule.transport.AbstractMessageDispatcher.send(AbstractMessageDispatcher.java:157)\n>    at org.mule.transport.AbstractConnector.send(AbstractConnector.java:1889)\n>    at org.mule.endpoint.DefaultOutboundEndpoint.send(DefaultOutboundEndpoint.java:76)\n>    at org.mule.DefaultMuleSession.sendEvent(DefaultMuleSession.java:324)\n>    at org.mule.module.client.MuleClient.send(MuleClient.java:653)\n>    at org.mule.module.client.MuleClient.send(MuleClient.java:630)\n>    at org.mule.module.client.MuleClient.send(MuleClient.java:583)\n>    at edu.ucsb.eucalyptus.util.Messaging.send(Messaging.java:67)\n>    at edu.ucsb.eucalyptus.cloud.ws.SystemState.restoreInstance(SystemState.java:322)\n>    at edu.ucsb.eucalyptus.cloud.ws.SystemState.updateVmInstance(SystemState.java:293)\n>    at edu.ucsb.eucalyptus.cloud.ws.SystemState.handle(SystemState.java:100)\n>    at edu.ucsb.eucalyptus.cloud.cluster.VmUpdateCallback.process(VmUpdateCallback.java:65)\n>    at edu.ucsb.eucalyptus.cloud.cluster.VmUpdateCallback.process(VmUpdateCallback.java:16)\n>    at edu.ucsb.eucalyptus.cloud.cluster.QueuedEvent.trigger(QueuedEvent.java:31)\n>    at edu.ucsb.eucalyptus.cloud.cluster.ClusterMessageQueue.run(ClusterMessageQueue.java:117)\n>    at java.lang.Thread.run(Thread.java:619)\n> [30 07 2009 13:23:58] [org.mule.service.DefaultServiceExceptionStrategy:ClusterMessageQueue-playpen@6C08FFAF] ERROR\n> ********************************************************************************\n> Message        : Component that caused exception is: ImageResolve. Message payload is of type: VmInfo\n> Type         : org.mule.api.service.ServiceException\n> Code         : MULE_ERROR--2\n> Payload        : [\"placement\":\"playpen\", \"launchIndex\":\"0\", \"ownerId\":\"admin\", \"groupNames\":[\"default\"], \"instanceId\":\"i-426707DE\", \"class\":class edu.ucsb.eucalyptus.cloud.VmInfo, \"kernelId\":\"eki-F4DB10D7\", \"reservationId\":\"r-31FD0667\", \"volumes\":[], \"userData\":\"\", \"metaClass\":groovy.lang.MetaClassImpl@6f3a342a[class edu.ucsb.eucalyptus.cloud.VmInfo], \"instanceType\":VmTypeInfo{name='m1.small', memory=128, disk=1, cores=1}, \"serviceTag\":\"http://vm-container-0-0:8775/axis2/services/EucalyptusNC\", \"imageId\":\"emi-74DB0EE2\", \"productCodes\":[], \"launchTime\":Thu Jul 30 13:22:47 BST 2009, \"ramdiskId\":\"\", \"stateName\":\"Extant\", \"netParams\":NetworkConfigType{macAddress='d0:0d:42:67:07:DE', ipAddress='172.29.23.2', publicIp='0.0.0.0', vlan=370}, \"keyValue\":\"\"]\n> JavaDoc        : http://mule.mulesource.org/docs/apidocs/org/mule/api/service/ServiceException.html\n> ********************************************************************************\n> Exception stack is:\n> 1. null (java.lang.NullPointerException)\n> edu.ucsb.eucalyptus.cloud.ws.ImageManager:140 (null)\n> 2. Component that caused exception is: ImageResolve. Message payload is of type: VmInfo (org.mule.api.service.ServiceException)\n> org.mule.component.DefaultLifecycleAdapter:214 (http://mule.mulesource.org/docs/apidocs/org/mule/api/service/ServiceException.html)\n> ********************************************************************************\n> Root Exception stack trace:\n> java.lang.NullPointerException\n>    at edu.ucsb.eucalyptus.cloud.ws.ImageManager.verify(ImageManager.java:140)\n>    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n>    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n>    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n>    at java.lang.reflect.Method.invoke(Method.java:597)\n>    at org.mule.model.resolvers.AbstractEntryPointResolver.invokeMethod(AbstractEntryPointResolver.java:147)\n>    at org.mule.model.resolvers.ReflectionEntryPointResolver.invoke(ReflectionEntryPointResolver.java:178)\n>    at org.mule.model.resolvers.DefaultEntryPointResolverSet.invoke(DefaultEntryPointResolverSet.java:50)\n>    at org.mule.component.DefaultLifecycleAdapter.intercept(DefaultLifecycleAdapter.java:202)\n>    at org.mule.component.AbstractJavaComponent.invokeComponentInstance(AbstractJavaComponent.java:82)\n>    at org.mule.component.AbstractJavaComponent.doOnCall(AbstractJavaComponent.java:73)\n>    at org.mule.component.AbstractComponent.onCall(AbstractComponent.java:87)\n>    at org.mule.model.seda.SedaService.doSend(SedaService.java:234)\n>    at org.mule.service.AbstractService.sendEvent(AbstractService.java:510)\n>    at org.mule.DefaultMuleSession.sendEvent(DefaultMuleSession.java:351)\n>    at org.mule.routing.inbound.DefaultInboundRouterCollection.send(DefaultInboundRouterCollection.java:196)\n>    at org.mule.routing.inbound.DefaultInboundRouterCollection.route(DefaultInboundRouterCollection.java:164)\n>    at org.mule.transport.AbstractMessageReceiver$DefaultInternalMessageListener.onMessage(AbstractMessageReceiver.java:604)\n>    at org.mule.transport.AbstractMessageReceiver.routeMessage(AbstractMessageReceiver.java:346)\n>    at org.mule.transport.AbstractMessageReceiver.routeMessage(AbstractMessageReceiver.java:269)\n>    a.lang.ClassCastException: edu.ucsb.eucalyptus.cloud.VmInfo cannot be cast to java.lang.String\n>    at edu.ucsb.eucalyptus.ic.ReplyQueue.parsePayload(ReplyQueue.java:113)\n>    at edu.ucsb.eucalyptus.ic.ReplyQueue.handle(ReplyQueue.java:78)\n>    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n>    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n>    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n>    at java.lang.reflect.Method.invoke(Method.java:597)\n>    at org.mule.model.resolvers.AbstractEntryPointResolver.invokeMethod(AbstractEntryPointResolver.java:147)\n>    at org.mule.model.resolvers.ReflectionEntryPointResolver.invoke(ReflectionEntryPointResolver.java:178)\n>    at org.mule.model.resolvers.DefaultEntryPointResolverSet.invoke(DefaultEntryPointResolverSet.java:50)\n>    at org.mule.component.DefaultLifecycleAdapter.intercept(DefaultLifecycleAdapter.java:202)\n>    at org.mule.component.AbstractJavaComponent.invokeComponentInstance(AbstractJavaComponent.java:82)\n>    at org.mule.component.AbstractJavaComponent.doOnCall(AbstractJavaComponent.java:73)\n>    at org.mule.component.AbstractComponent.onCall(AbstractComponent.java:87)\n>    at org.mule.model.seda.SedaService.doSend(SedaService.java:234)\n>    at org.mule.service.AbstractService.sendEvent(AbstractService.java:510)\n>    at org.mule.DefaultMuleSession.sendEvent(DefaultMuleSession.java:351)\n>    at org.mule.routing.inbound.DefaultInboundRouterCollection.send(DefaultInboundRouterCollection.java:196)\n>    at org.mule.routing.inbound.DefaultInboundRouterCollection.route(DefaultInboundRouterCollection.java:164)\n>    at org.mule.transport.AbstractMessageReceiver$DefaultInternalMessageListener.onMessage(AbstractMessageReceiver.java:604)\n>    at org.mule.transport.AbstractMessageReceiver.routeMessage(AbstractMessageReceiver.java:346)\n>    at org.mule.transport.AbstractMessageReceiver.routeMessage(AbstractMessageReceiver.java:269)\n> at org.mule.transport.vm.VMMessageReceiver.onCall(VMMessageReceiver.java:106)\n>    at org.mule.transport.vm.VMMessageDispatcher.doSend(VMMessageDispatcher.java:104)\n>    at org.mule.transport.AbstractMessageDispatcher.send(AbstractMessageDispatcher.java:157)\n>    at org.mule.transport.AbstractConnector.send(AbstractConnector.java:1889)\n>    at org.mule.endpoint.DefaultOutboundEndpoint.send(DefaultOutboundEndpoint.java:76)\n>    at org.mule.AbstractExceptionListener.routeException(AbstractExceptionListener.java:307)\n>    at org.mule.service.DefaultServiceExceptionStrategy.routeException(DefaultServiceExceptionStrategy.java:60)\n>    at org.mule.DefaultExceptionStrategy.handleMessagingException(DefaultExceptionStrategy.java:30)\n>    at org.mule.AbstractExceptionListener.exceptionThrown(AbstractExceptionListener.java:144)\n>    at org.mule.service.AbstractService.handleException(AbstractService.java:561)\n>    at org.mule.model.seda.SedaService.doSend(SedaService.java:249)\n>    at org.mule.service.AbstractService.sendEvent(AbstractService.java:510)\n>    at org.mule.DefaultMuleSession.sendEvent(DefaultMuleSession.java:351)\n>    at org.mule.routing.inbound.DefaultInboundRouterCollection.send(DefaultInboundRouterCollection.java:196)\n>    at org.mule.routing.inbound.DefaultInboundRouterCollection.route(DefaultInboundRouterCollection.java:164)\n>    at org.mule.transport.AbstractMessageReceiver$DefaultInternalMessageListener.onMessage(AbstractMessageReceiver.java:604)\n>    at org.mule.transport.AbstractMessageReceiver.routeMessage(AbstractMessageReceiver.java:346)\n>    at org.mule.transport.AbstractMessageReceiver.routeMessage(AbstractMessageReceiver.java:269)\n>    at org.mule.transport.vm.VMMessageReceiver.onCall(VMMessageReceiver.java:106)\n>    at org.mule.transport.vm.VMMessageDispatcher.doSend(VMMessageDispatcher.java:104)\n>    at org.mule.transport.AbstractMessageDispatcher.send(AbstractMessageDispatcher.java:157)\n>    at org.mule.transport.AbstractConnector.send(AbstractConnector.java:1889)\n>    at org.mule.endpoint.DefaultOutboundEndpoint.send(DefaultOutboundEndpoint.java:76)\n>    at org.mule.DefaultMuleSession.sendEvent(DefaultMuleSession.java:324)\n>    at org.mule.module.client.MuleClient.send(MuleClient.java:653)\n>    at org.mule.module.client.MuleClient.send(MuleClient.java:630)\n>    at org.mule.module.client.MuleClient.send(MuleClient.java:583)\n>    at edu.ucsb.eucalyptus.util.Messaging.send(Messaging.java:67)\n>    at edu.ucsb.eucalyptus.cloud.ws.SystemState.restoreInstance(SystemState.java:322)\n>    at edu.ucsb.eucalyptus.cloud.ws.SystemState.updateVmInstance(SystemState.java:293)\n>    at edu.ucsb.eucalyptus.cloud.ws.SystemState.handle(SystemState.java:100)\n>    at edu.ucsb.eucalyptus.cloud.cluster.VmUpdateCallback.process(VmUpdateCallback.java:65)\n>    at edu.ucsb.eucalyptus.cloud.cluster.VmUpdateCallback.process(VmUpdateCallback.java:16)\n>    at edu.ucsb.eucalyptus.cloud.cluster.QueuedEvent.trigger(QueuedEvent.java:31)\n>    at edu.ucsb.eucalyptus.cloud.cluster.ClusterMessageQueue.run(ClusterMessageQueue.java:117)\n>    at java.lang.Thread.run(Thread.java:619)t org.mule.transport.vm.VMMessageReceiver.onCall(VMMessageReceiver.java:106)\n>    at org.mule.transport.vm.VMMessageDispatcher.doSend(VMMessageDispatcher.java:104)\n>    at org.mule.transport.AbstractMessageDispatcher.send(AbstractMessageDispatcher.java:157)\n>    at org.mule.transport.AbstractConnector.send(AbstractConnector.java:1889)\n>    at org.mule.endpoint.DefaultOutboundEndpoint.send(DefaultOutboundEndpoint.java:76)\n>    at org.mule.DefaultMuleSession.sendEvent(DefaultMuleSession.java:324)\n>    at org.mule.module.client.MuleClient.send(MuleClient.java:653)\n>    at org.mule.module.client.MuleClient.send(MuleClient.java:630)\n>    at org.mule.module.client.MuleClient.send(MuleClient.java:583)\n>    at edu.ucsb.eucalyptus.util.Messaging.send(Messaging.java:67)\n>    at edu.ucsb.eucalyptus.cloud.ws.SystemState.restoreInstance(SystemState.java:322)\n>    at edu.ucsb.eucalyptus.cloud.ws.SystemState.updateVmInstance(SystemState.java:293)\n>    at edu.ucsb.eucalyptus.cloud.ws.SystemState.handle(SystemState.java:100)\n>    at edu.ucsb.eucalyptus.cloud.cluster.VmUpdateCallback.process(VmUpdateCallback.java:65)\n>    at edu.ucsb.eucalyptus.cloud.cluster.VmUpdateCallback.process(VmUpdateCallback.java:16)\n>    at edu.ucsb.eucalyptus.cloud.cluster.QueuedEvent.trigger(QueuedEvent.java:31)\n>    at edu.ucsb.eucalyptus.cloud.cluster.ClusterMessageQueue.run(ClusterMessageQueue.java:117)\n>    at java.lang.Thread.run(Thread.java:619)\n> ********************************************************************************\n>\n> [30 07 2009 13:23:58] [org.mule.service.DefaultServiceExceptionStrategy:ClusterMessageQueue-playpen@6C08FFAF] ERROR Message being processed is: org.mule.transport.DefaultMessageAdapter/org.mule.transport.DefaultMessageAdapter@373bc99b{id=db25e0a4-7d03-11de-837c-2f62592abd08, payload=edu.ucsb.eucalyptus.cloud.VmInfo, correlationId=null, correlationGroup=-1, correlationSeq=-1, encoding=UTF-8, exceptionPayload=org.mule.message.DefaultExceptionPayload@3630fb71}\n> [30 07 2009 13:23:58] [edu.ucsb.eucalyptus.ic.ReplyQueue:ClusterMessageQueue-playpen@6C08FFAF] ERROR Bailing out of error handling: don't have the correlationId for the caller!\n> [30 07 2009 13:23:58] [edu.ucsb.eucalyptus.ic.ReplyQueue:ClusterMessageQueue-playpen@6C08FFAF] ERROR java.lang.ClassCastException: edu.ucsb.eucalyptus.cloud.VmInfo cannot be cast to java.lang.String\n> java.lang.ClassCastException: edu.ucsb.eucalyptus.cloud.VmInfo cannot be cast to java.lang.String\n>    at edu.ucsb.eucalyptus.ic.ReplyQueue.parsePayload(ReplyQueue.java:113)\n>    at edu.ucsb.eucalyptus.ic.ReplyQueue.handle(ReplyQueue.java:78)\n>    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n>    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n>    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n>    at java.lang.reflect.Method.invoke(Method.java:597)\n>    at org.mule.model.resolvers.AbstractEntryPointResolver.invokeMethod(AbstractEntryPointResolver.java:147)\n>    at org.mule.model.resolvers.ReflectionEntryPointResolver.invoke(ReflectionEntryPointResolver.java:178)\n>    at org.mule.model.resolvers.DefaultEntryPointResolverSet.invoke(DefaultEntryPointResolverSet.java:50)\n>    at org.mule.component.DefaultLifecycleAdapter.intercept(DefaultLifecycleAdapter.java:202)\n>    at org.mule.component.AbstractJavaComponent.invokeComponentInstance(AbstractJavaComponent.java:82)\n>    at org.mule.component.AbstractJavaComponent.doOnCall(AbstractJavaComponent.java:73)\n>    at org.mule.component.AbstractComponent.onCall(AbstractComponent.java:87)\n>    at org.mule.model.seda.SedaService.doSend(SedaService.java:234)\n>    at org.mule.service.AbstractService.sendEvent(AbstractService.java:510)\n>    at org.mule.DefaultMuleSession.sendEvent(DefaultMuleSession.java:351)\n>    at org.mule.routing.inbound.DefaultInboundRouterCollection.send(DefaultInboundRouterCollection.java:196)\n>    at org.mule.routing.inbound.DefaultInboundRouterCollection.route(DefaultInboundRouterCollection.java:164)\n>    at org.mule.transport.AbstractMessageReceiver$DefaultInternalMessageListener.onMessage(AbstractMessageReceiver.java:604)\n>    at org.mule.transport.AbstractMessageReceiver.routeMessage(AbstractMessageReceiver.java:346)\n>    at org.mule.transport.AbstractMessageReceiver.routeMessage(AbstractMessageReceiver.java:269)\n>    at org.mule.transport.vm.VMMessageReceiver.onCall(VMMessageReceiver.java:106)\n>    at org.mule.transport.vm.VMMessageDispatcher.doSend(VMMessageDispatcher.java:104)\n>    at org.mule.transport.AbstractMessageDispatcher.send(AbstractMessageDispatcher.java:157)\n>    at org.mule.transport.AbstractConnector.send(AbstractConnector.java:1889)\n>    at org.mule.endpoint.DefaultOutboundEndpoint.send(DefaultOutboundEndpoint.java:76)\n>    at org.mule.AbstractExceptionListener.routeException(AbstractExceptionListener.java:307)\n>    at org.mule.service.DefaultServiceExceptionStrategy.routeException(DefaultServiceExceptionStrategy.java:60)\n>    at org.mule.DefaultExceptionStrategy.handleMessagingException(DefaultExceptionStrategy.java:30)\n>    at org.mule.AbstractExceptionListener.exceptionThrown(AbstractExceptionListener.java:144)\n>    at org.mule.service.AbstractService.handleException(AbstractService.java:561)\n>    at org.mule.model.seda.SedaService.doSend(SedaService.java:249)\n>    at org.mule.service.AbstractService.sendEvent(AbstractService.java:510)\n>    at org.mule.DefaultMuleSession.sendEvent(DefaultMuleSession.java:351)\n>    at org.mule.routing.inbound.DefaultInboundRouterCollection.send(DefaultInboundRouterCollection.java:196)\n>    at org.mule.routing.inbound.DefaultInboundRouterCollection.route(DefaultInboundRouterCollection.java:164)\n>    at org.mule.transport.AbstractMessageReceiver$DefaultInternalMessageListener.onMessage(AbstractMessageReceiver.java:604)\n>    at org.mule.transport.AbstractMessageReceiver.routeMessage(AbstractMessageReceiver.java:346)\n>    at org.mule.transport.AbstractMessageReceiver.routeMessage(AbstractMessageReceiver.java:269)\n>    at org.mule.transport.vm.VMMessageReceiver.onCall(VMMessageReceiver.java:106)\n>    at org.mule.transport.vm.VMMessageDispatcher.doSend(VMMessageDispatcher.java:104)\n>    at org.mule.transport.AbstractMessageDispatcher.send(AbstractMessageDispatcher.java:157)\n>    at org.mule.transport.AbstractConnector.send(AbstractConnector.java:1889)\n>    at org.mule.endpoint.DefaultOutboundEndpoint.send(DefaultOutboundEndpoint.java:76)\n>    at org.mule.DefaultMuleSession.sendEvent(DefaultMuleSession.java:324)\n>    at org.mule.module.client.MuleClient.send(MuleClient.java:653)\n>    at org.mule.module.client.MuleClient.send(MuleClient.java:630)\n>    at org.mule.module.client.MuleClient.send(MuleClient.java:583)\n>    at edu.ucsb.eucalyptus.util.Messaging.send(Messaging.java:67)\n>    at edu.ucsb.eucalyptus.cloud.ws.SystemState.restoreInstance(SystemState.java:322)\n>    at edu.ucsb.eucalyptus.cloud.ws.SystemState.updateVmInstance(SystemState.java:293)\n>    at edu.ucsb.eucalyptus.cloud.ws.SystemState.handle(SystemState.java:100)\n>    at edu.ucsb.eucalyptus.cloud.cluster.VmUpdateCallback.process(VmUpdateCallback.java:65)\n>    at edu.ucsb.eucalyptus.cloud.cluster.VmUpdateCallback.process(VmUpdateCallback.java:16)\n>    at edu.ucsb.eucalyptus.cloud.cluster.QueuedEvent.trigger(QueuedEvent.java:31)\n>    at edu.ucsb.eucalyptus.cloud.cluster.ClusterMessageQueue.run(ClusterMessageQueue.java:117)\n>    at java.lang.Thread.run(Thread.java:619)\n> [30 07 2009 13:23:58] [org.mule.config.ExceptionHelper:ClusterMessageQueue-playpen@6C08FFAF] WARN Failed to load error mappings from: META-INF/services/org/mule/config/vm-exception-mappings.properties This may be because there are no error code mappings for protocol: vm\n>","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=eucabot","name":"eucabot","key":"eucabot","accountId":"557058:007ef05d-c772-4437-b383-d2b42d2a88a7","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/9e6d2b33ee28ce1387b2aa6cbe935cf3?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Deucabot%26avatarId%3D12000%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/9e6d2b33ee28ce1387b2aa6cbe935cf3?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Deucabot%26avatarId%3D12000%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/9e6d2b33ee28ce1387b2aa6cbe935cf3?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Deucabot%26avatarId%3D12000%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/9e6d2b33ee28ce1387b2aa6cbe935cf3?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Deucabot%26avatarId%3D12000%26noRedirect%3Dtrue"},"displayName":"Eucalyptus Bot","active":true,"timeZone":"Etc/GMT"},"created":"2012-07-11T07:44:29.735-0500","updated":"2012-07-11T07:44:29.735-0500"}],"maxResults":4,"total":4,"startAt":0},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_11808":null}}
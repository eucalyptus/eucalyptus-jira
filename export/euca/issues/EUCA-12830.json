{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"49284","self":"https://eucalyptus.atlassian.net/rest/api/2/issue/49284","key":"EUCA-12830","fields":{"issuetype":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://eucalyptus.atlassian.net/secure/viewavatar?size=xsmall&avatarId=14803&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":14803},"timespent":null,"customfield_13100":null,"project":{"self":"https://eucalyptus.atlassian.net/rest/api/2/project/10000","id":"10000","key":"EUCA","name":"Eucalyptus","avatarUrls":{"48x48":"https://eucalyptus.atlassian.net/secure/projectavatar?pid=10000&avatarId=10011","24x24":"https://eucalyptus.atlassian.net/secure/projectavatar?size=small&pid=10000&avatarId=10011","16x16":"https://eucalyptus.atlassian.net/secure/projectavatar?size=xsmall&pid=10000&avatarId=10011","32x32":"https://eucalyptus.atlassian.net/secure/projectavatar?size=medium&pid=10000&avatarId=10011"}},"customfield_11000":null,"customfield_11001":null,"fixVersions":[],"aggregatetimespent":null,"resolution":null,"customfield_10310":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/10209","value":"CentOS 6","id":"10209"}],"customfield_11401":null,"customfield_10311":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/11500","value":"Edge","id":"11500"}],"customfield_11400":null,"customfield_10104":[],"customfield_10500":{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/10403","value":"Not Applicable","id":"10403"},"customfield_10302":null,"customfield_10303":null,"customfield_10105":null,"customfield_10700":null,"customfield_10304":null,"customfield_10701":null,"customfield_10306":null,"customfield_10702":null,"customfield_10703":null,"customfield_10704":null,"customfield_10308":null,"resolutiondate":null,"customfield_10705":null,"customfield_10309":null,"workratio":-1,"watches":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/EUCA-12830/watchers","watchCount":2,"isWatching":false},"lastViewed":null,"created":"2016-10-13T13:11:35.902-0500","customfield_12000":null,"priority":{"self":"https://eucalyptus.atlassian.net/rest/api/2/priority/4","iconUrl":"https://eucalyptus.atlassian.net/images/icons/priorities/minor.svg","name":"Minor","id":"4"},"customfield_12400":null,"customfield_12201":null,"customfield_10300":null,"customfield_10102":null,"customfield_12600":"{}","customfield_10301":null,"labels":[],"customfield_11700":null,"aggregatetimeoriginalestimate":null,"timeestimate":null,"customfield_11901":null,"versions":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/version/18200","id":"18200","description":"Eucalyptus 4.3.0.1","name":"4.3.0.1","archived":false,"released":true,"releaseDate":"2016-09-21"}],"issuelinks":[{"id":"43861","self":"https://eucalyptus.atlassian.net/rest/api/2/issueLink/43861","type":{"id":"10103","name":"Relates","inward":"relates to","outward":"relates to","self":"https://eucalyptus.atlassian.net/rest/api/2/issueLinkType/10103"},"outwardIssue":{"id":"21397","key":"EUCA-6213","self":"https://eucalyptus.atlassian.net/rest/api/2/issue/21397","fields":{"summary":"Registered CLC's should check for matched bind addr","status":{"self":"https://eucalyptus.atlassian.net/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://eucalyptus.atlassian.net/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://eucalyptus.atlassian.net/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://eucalyptus.atlassian.net/rest/api/2/priority/3","iconUrl":"https://eucalyptus.atlassian.net/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issuetype/2","id":"2","description":"A new feature of the product, which has yet to be developed.","iconUrl":"https://eucalyptus.atlassian.net/secure/viewavatar?size=xsmall&avatarId=14811&avatarType=issuetype","name":"New Feature","subtask":false,"avatarId":14811}}}}],"assignee":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=mbacchi","name":"mbacchi","key":"mbacchi","accountId":"557058:d650aabc-f00c-4262-93a9-7799945b8eed","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/24b916c1ff78f38b51f4bb1dc66ed58c?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dmbacchi%26avatarId%3D16201%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/24b916c1ff78f38b51f4bb1dc66ed58c?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dmbacchi%26avatarId%3D16201%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/24b916c1ff78f38b51f4bb1dc66ed58c?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dmbacchi%26avatarId%3D16201%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/24b916c1ff78f38b51f4bb1dc66ed58c?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dmbacchi%26avatarId%3D16201%26noRedirect%3Dtrue"},"displayName":"Matt Bacchi","active":true,"timeZone":"US/Central"},"updated":"2016-10-18T13:03:59.223-0500","status":{"self":"https://eucalyptus.atlassian.net/rest/api/2/status/10000","description":"This issue has not yet been validated, and is not currently being investigated.","iconUrl":"https://eucalyptus.atlassian.net/images/icons/statuses/generic.png","name":"Unconfirmed","id":"10000","statusCategory":{"self":"https://eucalyptus.atlassian.net/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"components":[],"timeoriginalestimate":null,"customfield_13000":null,"description":"Only seen in CentOS 6 with recent code in the security-4.3 branch (and I assume maint-4.3 since they're the same at the moment), not seen in master, nor on CentOS 7 on any branch.\r\n\r\nOn a 1-node cloud deployed by Calyptos, after deployment I see two \"eucalyptus\" services, one on the expected public IP address, one on the storage SAN network which is \"disabled\" and shouldn't exist.\r\n\r\nWorkaround: Restarting eucalyptus-cloud makes the bad service go away.\r\n\r\nThe Quick Launch job http://jenkins.qa1.eucalyptus-systems.com/job/Quick%20Launch%20Maint-4.3/79/ was in this state until eucalyptus-cloud was restarted. Probably easily reproducible. Maybe only with a 1-node cloud but [~mbacchi] thinks it shouldn't matter.\r\n\r\n{noformat}\r\nSERVICE  eucalyptus            eucalyptus        10.107.101.135                   enabled\r\nSERVICE  eucalyptus            eucalyptus        10.111.1.135                     disabled\r\n\r\n# ip addr\r\n1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN\r\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\r\n    inet 127.0.0.1/8 scope host lo\r\n    inet6 ::1/128 scope host\r\n       valid_lft forever preferred_lft forever\r\n2: em1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc mq state UP qlen 1000\r\n    link/ether e8:9a:8f:74:12:ca brd ff:ff:ff:ff:ff:ff\r\n    inet6 fe80::ea9a:8fff:fe74:12ca/64 scope link\r\n       valid_lft forever preferred_lft forever\r\n3: em2: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc mq state UP qlen 1000\r\n    link/ether e8:9a:8f:74:12:cb brd ff:ff:ff:ff:ff:ff\r\n    inet 10.113.1.135/16 brd 10.113.255.255 scope global em2\r\n    inet6 fe80::ea9a:8fff:fe74:12cb/64 scope link\r\n       valid_lft forever preferred_lft forever\r\n17: br0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UNKNOWN\r\n    link/ether e8:9a:8f:74:12:ca brd ff:ff:ff:ff:ff:ff\r\n    inet 10.111.1.135/16 brd 10.111.255.255 scope global br0\r\n    inet 10.111.31.113/32 scope global br0\r\n    inet6 fe80::ea9a:8fff:fe74:12ca/64 scope link\r\n       valid_lft forever preferred_lft forever\r\n18: em1.107@em1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP\r\n    link/ether e8:9a:8f:74:12:ca brd ff:ff:ff:ff:ff:ff\r\n    inet 10.107.101.135/16 brd 10.107.255.255 scope global em1.107\r\n    inet6 fe80::ea9a:8fff:fe74:12ca/64 scope link\r\n       valid_lft forever preferred_lft forever\r\n19: em1.116@em1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP\r\n    link/ether e8:9a:8f:74:12:ca brd ff:ff:ff:ff:ff:ff\r\n    inet6 fe80::ea9a:8fff:fe74:12ca/64 scope link\r\n       valid_lft forever preferred_lft forever\r\n20: vn_i-5046f17a: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast state UNKNOWN qlen 500\r\n    link/ether fe:0d:50:46:f1:7a brd ff:ff:ff:ff:ff:ff\r\n    inet6 fe80::fc0d:50ff:fe46:f17a/64 scope link\r\n       valid_lft forever preferred_lft forever\r\n{noformat}\r\n\r\nFrom emails/IRC since I raised the issue:\r\n\r\n[~sjones] \"You can specify --bind-addr in eucalyptus.conf CLOUD_OPTS to avoid any issues when there are multiple network interfaces. Being able to set the bind address is not new.\"\r\n\r\n[~lincoln.thomas] \"So, if this setting is not a new thing, did something change in the cookbook to account for there being two \"eucalyptus\" services running in the security/maint-4.3 branches but still only one in master and in 4.3.0 and earlier? Or was there some dev code change made in the maint branch since 4.3.0 that might account for this? (thus not a QA thing) There is no --bind-addr in eucalyptus.conf CLOUD_OPTS, in my security-4.3 nor my master clouds. Not a big deal, just weird.... I haven't seen any functional problems other than the one on the 10.111 net being \"disabled\".\"\r\n\r\n[~shaon] \"I don't recall any recent changes that might trigger this. We don't use bind-addr in QA by default. But, I believe there are options in the cookbook, that can be used from override section of Quick Launch.\"\r\n\r\n[~tony] \"I've never seen 2 eucalyptus processes like that. This is definitely new. It seems like a bug to me that there would be a eucalyptus service on two interfaces. FYI, the 107 is the storage network for SAN.\"\r\n\r\n[~mbacchi] \"There's this in the cookbook which tries to figure out the network interface to bind to, but it would depend on how the job is configured and what is passed in as attributes: https://github.com/eucalyptus/eucalyptus-cookbook/blob/master/libraries/bind-addr.rb. Use of that function is determined by this in the attributes, and in the job you pasted (i.e. in EQS) it doesn't set this to true apparently: https://github.com/eucalyptus/eucalyptus-cookbook/blob/master/attributes/default.rb#L49-L52. So I don't know to be honest how the interface is determined to be bound to when starting eucalyptus-cloud service.\"\r\n\r\n[~mclark] \"in the CB there's another attribute bind-network which should replace the other attrs I think it attempts to discover the correct interface/addr. All this should go away, and get replaced with the next iteration of Calyptos too.\"\r\n\r\n[~tony] \"how does it figure the interface to bind to if bind-network is empty?  It doesn't appear in this calyptos job so best I can assume it guesses...or the eucalyptus process just attempts to bind to whatever is the default gw: http://jenkins.qa1.eucalyptus-systems.com/job/Calyptos-CI/750/consoleFull\"\r\n\r\n[~mclark] \"I don't think the CB does, or at least shouldnt do anything if these are not set. I don't know for certain though. It should leave this up to Euca's own interface discovery/setting mechanism. I don't remember off hand what that is, ie is it the first interface to get a packet from the correct mcast group, etc?\"\r\n","customfield_13200":null,"customfield_11300":null,"customfield_11500":null,"timetracking":{},"customfield_10005":null,"customfield_10401":null,"customfield_10600":null,"customfield_12900":null,"aggregatetimeestimate":null,"attachment":[],"summary":"Two \"eucalyptus\" services are created, one \"disabled\"","creator":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=lincoln.thomas","name":"lincoln.thomas","key":"lincoln.thomas","accountId":"557058:f9364c00-87ee-4948-b657-bb8f8f2030ea","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/c21bba9797b880c34a5d772e6db4664f?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dlincoln.thomas%26avatarId%3D17800%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/c21bba9797b880c34a5d772e6db4664f?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dlincoln.thomas%26avatarId%3D17800%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/c21bba9797b880c34a5d772e6db4664f?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dlincoln.thomas%26avatarId%3D17800%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/c21bba9797b880c34a5d772e6db4664f?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dlincoln.thomas%26avatarId%3D17800%26noRedirect%3Dtrue"},"displayName":"Lincoln Thomas","active":true,"timeZone":"America/Los_Angeles"},"subtasks":[],"reporter":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=lincoln.thomas","name":"lincoln.thomas","key":"lincoln.thomas","accountId":"557058:f9364c00-87ee-4948-b657-bb8f8f2030ea","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/c21bba9797b880c34a5d772e6db4664f?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dlincoln.thomas%26avatarId%3D17800%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/c21bba9797b880c34a5d772e6db4664f?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dlincoln.thomas%26avatarId%3D17800%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/c21bba9797b880c34a5d772e6db4664f?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dlincoln.thomas%26avatarId%3D17800%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/c21bba9797b880c34a5d772e6db4664f?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dlincoln.thomas%26avatarId%3D17800%26noRedirect%3Dtrue"},"displayName":"Lincoln Thomas","active":true,"timeZone":"America/Los_Angeles"},"customfield_10000":null,"customfield_12100":"0|i03ydb:","aggregateprogress":{"progress":0,"total":0},"customfield_10001":null,"customfield_10200":null,"customfield_10002":null,"customfield_10003":null,"customfield_12500":null,"customfield_10400":null,"customfield_11600":["lincoln.thomas(lincoln.thomas)","mbacchi(mbacchi)"],"customfield_10116":null,"environment":null,"customfield_10117":null,"customfield_11800":null,"customfield_11802":null,"duedate":null,"customfield_11805":null,"customfield_11806":null,"progress":{"progress":0,"total":0},"comment":{"comments":[],"maxResults":0,"total":0,"startAt":0},"votes":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/EUCA-12830/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_11808":null}}
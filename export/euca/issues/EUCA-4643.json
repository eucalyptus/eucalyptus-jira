{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"18237","self":"https://eucalyptus.atlassian.net/rest/api/2/issue/18237","key":"EUCA-4643","fields":{"issuetype":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://eucalyptus.atlassian.net/secure/viewavatar?size=xsmall&avatarId=14803&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":14803},"timespent":null,"customfield_13100":null,"project":{"self":"https://eucalyptus.atlassian.net/rest/api/2/project/10000","id":"10000","key":"EUCA","name":"Eucalyptus","avatarUrls":{"48x48":"https://eucalyptus.atlassian.net/secure/projectavatar?pid=10000&avatarId=10011","24x24":"https://eucalyptus.atlassian.net/secure/projectavatar?size=small&pid=10000&avatarId=10011","16x16":"https://eucalyptus.atlassian.net/secure/projectavatar?size=xsmall&pid=10000&avatarId=10011","32x32":"https://eucalyptus.atlassian.net/secure/projectavatar?size=medium&pid=10000&avatarId=10011"}},"customfield_11000":null,"customfield_11001":null,"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://eucalyptus.atlassian.net/rest/api/2/resolution/3","id":"3","description":"The problem is a duplicate of an existing issue.","name":"Duplicate"},"customfield_10310":null,"customfield_11401":null,"customfield_10311":null,"customfield_11400":null,"customfield_10302":null,"customfield_10104":[],"customfield_10500":{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/10403","value":"Not Applicable","id":"10403"},"customfield_10303":null,"customfield_10105":{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/10101","value":"No","id":"10101"},"customfield_10304":null,"customfield_10700":null,"customfield_10701":null,"customfield_10306":null,"customfield_10702":null,"customfield_10703":null,"resolutiondate":"2013-01-23T13:11:27.836-0600","customfield_10704":null,"customfield_10308":null,"customfield_10309":null,"customfield_10705":null,"workratio":-1,"watches":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/EUCA-4643/watchers","watchCount":2,"isWatching":false},"lastViewed":null,"created":"2012-12-17T19:32:41.529-0600","customfield_12000":null,"priority":{"self":"https://eucalyptus.atlassian.net/rest/api/2/priority/3","iconUrl":"https://eucalyptus.atlassian.net/images/icons/priorities/major.svg","name":"Major","id":"3"},"customfield_12400":null,"customfield_12201":null,"customfield_10102":null,"customfield_10300":null,"customfield_12600":"{}","customfield_10301":null,"labels":[],"customfield_11700":null,"aggregatetimeoriginalestimate":null,"timeestimate":null,"customfield_11901":null,"versions":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/version/10112","id":"10112","description":"Eucalyptus 3.2.0","name":"3.2.0","archived":false,"released":true,"releaseDate":"2012-12-19"}],"issuelinks":[{"id":"15423","self":"https://eucalyptus.atlassian.net/rest/api/2/issueLink/15423","type":{"id":"10102","name":"Duplicate","inward":"is duplicated by","outward":"duplicates","self":"https://eucalyptus.atlassian.net/rest/api/2/issueLinkType/10102"},"outwardIssue":{"id":"17530","key":"EUCA-4253","self":"https://eucalyptus.atlassian.net/rest/api/2/issue/17530","fields":{"summary":"iptables-preload is not honored when CC are in HA mode and failover happens","status":{"self":"https://eucalyptus.atlassian.net/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://eucalyptus.atlassian.net/images/icons/statuses/generic.png","name":"Closed","id":"6","statusCategory":{"self":"https://eucalyptus.atlassian.net/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://eucalyptus.atlassian.net/rest/api/2/priority/3","iconUrl":"https://eucalyptus.atlassian.net/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://eucalyptus.atlassian.net/secure/viewavatar?size=xsmall&avatarId=14803&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":14803}}}}],"assignee":null,"updated":"2015-05-08T17:14:40.130-0500","status":{"self":"https://eucalyptus.atlassian.net/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://eucalyptus.atlassian.net/images/icons/statuses/generic.png","name":"Closed","id":"6","statusCategory":{"self":"https://eucalyptus.atlassian.net/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[],"timeoriginalestimate":null,"customfield_13000":null,"description":"  Step1 ,in inactive CC, I use command iptables-save> /var/run/eucalyptus/net/iptables-preload to set my defined iptables\r\n1)Detailed iptables like below:\r\n[root@euca-mgmt-1 net]# cat iptables-preload\r\n# Generated by iptables-save v1.4.7 on Fri Dec 14 16:14:09 2012\r\n*nat\r\n:PREROUTING ACCEPT [0:0]\r\n:POSTROUTING ACCEPT [0:0]\r\n:OUTPUT ACCEPT [0:0]\r\nCOMMIT\r\n# Completed on Fri Dec 14 16:14:09 2012\r\n# Generated by iptables-save v1.4.7 on Fri Dec 14 16:14:09 2012\r\n*filter\r\n:INPUT ACCEPT [0:0]\r\n:FORWARD ACCEPT [0:0]\r\n:OUTPUT ACCEPT [1:92]\r\n-A INPUT -i lo -j ACCEPT\r\n2 )see the iptables setting result in this inactive CC, it take effect\r\n[root@euca-mgmt-1 net]# iptables -L -n -v\r\nChain INPUT (policy ACCEPT 631 packets, 119K bytes)\r\n pkts bytes target     prot opt in     out     source               destination         \r\n   \t15  2340 ACCEPT     all  --  lo     *       0.0.0.0/0            0.0.0.0/0           ---------my defined iptable entry take effect\r\n\r\nChain FORWARD (policy ACCEPT 0 packets, 0 bytes)\r\n pkts bytes target     prot opt in     out     source               destination         \r\n\r\nChain OUTPUT (policy ACCEPT 594 packets, 116K bytes)\r\n \tpkts bytes target     prot opt in     out     source               destination\r\nstep2 use same operation in active CC and see the result , there are no iptables entry take effect about my defined one.\r\n\t[root@euca-mgmt-2 net]# iptables -v -L -n\r\nChain INPUT (policy ACCEPT 5658 packets, 1837K bytes)----------------------- my iptable rule in chain INPUT not take effect\r\n pkts bytes target     prot opt in     out     source               destination         \r\n\r\nChain FORWARD (policy DROP 0 packets, 0 bytes)\r\n pkts bytes target     prot opt in     out     source               destination         \r\n  168 11104 EUCA_COUNTERS_OUT  all  --  *      *       0.0.0.0/0            0.0.0.0/0           \r\n  --------------------------omit more iptables not relevant to this ticket----------------------\r\n\r\nStep3, do failover operation ,let inactive CC become an active one,and see the iptables info,\r\n             I found that the active CC can not load the iptables rules that store at iptables-preload \r\n            And meanwhile the inactive one now can get the rules save at iptables-preload\r\n\r\nSummary:\r\n Only inactive CC can load iptables store at iptables-preload. After become a active CC, it will lose all entries save in iptables-preload\r\n","customfield_13200":null,"customfield_11300":null,"customfield_11500":null,"timetracking":{},"customfield_10005":null,"customfield_10401":null,"customfield_10600":null,"customfield_12900":null,"attachment":[],"aggregatetimeestimate":null,"summary":"Active CC can not load iptables that saved in /var/run/eucalyptus/net/iptables-preload","creator":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=vxu","name":"vxu","key":"vxu","accountId":"557058:73cdca34-6060-40b0-9d66-54a29597c31f","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/05d0480d0a67796c51acda35f7683f75?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FavatarId%3D10122%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/05d0480d0a67796c51acda35f7683f75?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26avatarId%3D10122%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/05d0480d0a67796c51acda35f7683f75?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26avatarId%3D10122%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/05d0480d0a67796c51acda35f7683f75?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26avatarId%3D10122%26noRedirect%3Dtrue"},"displayName":"vivi.xu","active":false,"timeZone":"US/Central"},"subtasks":[],"reporter":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=vxu","name":"vxu","key":"vxu","accountId":"557058:73cdca34-6060-40b0-9d66-54a29597c31f","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/05d0480d0a67796c51acda35f7683f75?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FavatarId%3D10122%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/05d0480d0a67796c51acda35f7683f75?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26avatarId%3D10122%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/05d0480d0a67796c51acda35f7683f75?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26avatarId%3D10122%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/05d0480d0a67796c51acda35f7683f75?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26avatarId%3D10122%26noRedirect%3Dtrue"},"displayName":"vivi.xu","active":false,"timeZone":"US/Central"},"customfield_10000":"10000_*:*_1_*:*_3173926320_*|*_5_*:*_1_*:*_0","aggregateprogress":{"progress":0,"total":0},"customfield_12100":"0|i01sd3:","customfield_10001":"2013-01-23T13:11:28.609-0600","customfield_10200":null,"customfield_10002":null,"customfield_10003":null,"customfield_10400":null,"customfield_12500":null,"customfield_10116":null,"customfield_11600":["eucabotpub(eucabotpub)","vxu(vxu)"],"customfield_10117":null,"environment":"euca3.2.0 HA enviroment for rhel6u3","customfield_11800":null,"customfield_11802":null,"customfield_11805":null,"duedate":null,"progress":{"progress":0,"total":0},"customfield_11806":null,"comment":{"comments":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/18237/comment/38954","id":"38954","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=eucabotpub","name":"eucabotpub","key":"eucabotpub","accountId":"557058:9cdf1bc6-150b-4f78-8521-b596b3332dff","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/cdf0bb3a5ec3f98dae87fd9afffe817a?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Deucabotpub%26avatarId%3D12300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/cdf0bb3a5ec3f98dae87fd9afffe817a?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Deucabotpub%26avatarId%3D12300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/cdf0bb3a5ec3f98dae87fd9afffe817a?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Deucabotpub%26avatarId%3D12300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/cdf0bb3a5ec3f98dae87fd9afffe817a?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Deucabotpub%26avatarId%3D12300%26noRedirect%3Dtrue"},"displayName":"Eucalyptus Bot (Public)","active":true,"timeZone":"US/Central"},"body":"Status updated by gholms\n\nThis is a duplicate of EUCA-4253.","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=eucabotpub","name":"eucabotpub","key":"eucabotpub","accountId":"557058:9cdf1bc6-150b-4f78-8521-b596b3332dff","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/cdf0bb3a5ec3f98dae87fd9afffe817a?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Deucabotpub%26avatarId%3D12300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/cdf0bb3a5ec3f98dae87fd9afffe817a?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Deucabotpub%26avatarId%3D12300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/cdf0bb3a5ec3f98dae87fd9afffe817a?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Deucabotpub%26avatarId%3D12300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/cdf0bb3a5ec3f98dae87fd9afffe817a?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Deucabotpub%26avatarId%3D12300%26noRedirect%3Dtrue"},"displayName":"Eucalyptus Bot (Public)","active":true,"timeZone":"US/Central"},"created":"2013-01-23T13:11:28.609-0600","updated":"2013-01-23T13:11:28.609-0600"}],"maxResults":1,"total":1,"startAt":0},"votes":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/EUCA-4643/votes","votes":0,"hasVoted":false},"customfield_11808":null,"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]}}}
{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"34152","self":"https://eucalyptus.atlassian.net/rest/api/2/issue/34152","key":"EUCA-10327","fields":{"issuetype":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://eucalyptus.atlassian.net/secure/viewavatar?size=xsmall&avatarId=14803&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":14803},"timespent":null,"customfield_13100":null,"project":{"self":"https://eucalyptus.atlassian.net/rest/api/2/project/10000","id":"10000","key":"EUCA","name":"Eucalyptus","avatarUrls":{"48x48":"https://eucalyptus.atlassian.net/secure/projectavatar?pid=10000&avatarId=10011","24x24":"https://eucalyptus.atlassian.net/secure/projectavatar?size=small&pid=10000&avatarId=10011","16x16":"https://eucalyptus.atlassian.net/secure/projectavatar?size=xsmall&pid=10000&avatarId=10011","32x32":"https://eucalyptus.atlassian.net/secure/projectavatar?size=medium&pid=10000&avatarId=10011"}},"customfield_11000":null,"customfield_11001":null,"fixVersions":[],"aggregatetimespent":null,"customfield_10310":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/10209","value":"CentOS 6","id":"10209"}],"resolution":null,"customfield_10311":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/11500","value":"Edge","id":"11500"}],"customfield_11401":null,"customfield_11400":null,"customfield_10302":null,"customfield_10500":{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/10402","value":"Internal","id":"10402"},"customfield_10104":[],"customfield_10105":{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/10101","value":"No","id":"10101"},"customfield_10303":null,"customfield_10700":null,"customfield_10304":null,"customfield_10701":null,"customfield_10306":{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/10201","value":"Medium","id":"10201"},"customfield_10702":null,"customfield_10703":null,"customfield_10704":null,"customfield_10308":null,"resolutiondate":null,"customfield_10309":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/10204","value":"KVM","id":"10204"}],"customfield_10705":null,"workratio":-1,"lastViewed":null,"watches":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/EUCA-10327/watchers","watchCount":1,"isWatching":false},"created":"2015-01-13T15:13:59.001-0600","customfield_12000":null,"customfield_12400":null,"priority":{"self":"https://eucalyptus.atlassian.net/rest/api/2/priority/3","iconUrl":"https://eucalyptus.atlassian.net/images/icons/priorities/major.svg","name":"Major","id":"3"},"customfield_12201":null,"customfield_12600":"{}","customfield_10102":null,"customfield_10300":null,"labels":["AWSCompat-PM"],"customfield_10301":null,"customfield_11700":null,"aggregatetimeoriginalestimate":null,"timeestimate":null,"versions":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/version/14301","id":"14301","description":"Eucalyptus 4.1.0","name":"4.1.0","archived":false,"released":true,"releaseDate":"2015-01-29"}],"customfield_11901":null,"issuelinks":[{"id":"28558","self":"https://eucalyptus.atlassian.net/rest/api/2/issueLink/28558","type":{"id":"10600","name":"Bonfire Testing","inward":"discovered while testing","outward":"testing discovered","self":"https://eucalyptus.atlassian.net/rest/api/2/issueLinkType/10600"},"inwardIssue":{"id":"33986","key":"EUCA-10275","self":"https://eucalyptus.atlassian.net/rest/api/2/issue/33986","fields":{"summary":"Snapshots Shared With Another Account Aren't Viewable","status":{"self":"https://eucalyptus.atlassian.net/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://eucalyptus.atlassian.net/images/icons/statuses/generic.png","name":"Closed","id":"6","statusCategory":{"self":"https://eucalyptus.atlassian.net/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://eucalyptus.atlassian.net/rest/api/2/priority/3","iconUrl":"https://eucalyptus.atlassian.net/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://eucalyptus.atlassian.net/secure/viewavatar?size=xsmall&avatarId=14803&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":14803}}}}],"assignee":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=vasya","name":"vasya","key":"vasya","accountId":"557058:1c63481a-0634-4ae7-9004-cb0f143e141f","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/fa832ffa4e20c9aa05ac272214d43196?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dvasya%26avatarId%3D10408%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/fa832ffa4e20c9aa05ac272214d43196?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dvasya%26avatarId%3D10408%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/fa832ffa4e20c9aa05ac272214d43196?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dvasya%26avatarId%3D10408%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/fa832ffa4e20c9aa05ac272214d43196?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dvasya%26avatarId%3D10408%26noRedirect%3Dtrue"},"displayName":"Vasiliy Kochergin","active":false,"timeZone":"America/Los_Angeles"},"updated":"2016-03-24T16:42:25.750-0500","status":{"self":"https://eucalyptus.atlassian.net/rest/api/2/status/10001","description":"This issue has been validated/reproduced, but has not been prioritized yet.","iconUrl":"https://eucalyptus.atlassian.net/images/icons/statuses/generic.png","name":"Confirmed","id":"10001","statusCategory":{"self":"https://eucalyptus.atlassian.net/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"components":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/component/12700","id":"12700","name":"OSG","description":"Object Storage Gateway"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/component/10014","id":"10014","name":"Storage Controller"}],"timeoriginalestimate":null,"description":"*Assessment*\r\n\r\nWhile verifying EUCA-10275, it was noticed that creating a volume from a snapshot that was performed from a volume created in another AZ failed.  This happened on the [Group #1|https://eucalyptus.atlassian.net/wiki/display/QA/Euca+4.1+Quality+Dashboard#Euca4.1QualityDashboard-Group#1] cloud.  It seems to only happen when original volume was created on an SC-EMC cluster, then snapshot performed.  New volume was then created from the snapshot on SC-Ceph cluster.  If the workflow happened the other way around (i.e. volume created on Ceph, snapshot, then volume from snapshot created on EMC), then everything worked fine.\r\n\r\n*Steps*\r\n\r\n# Uploaded IAM access policy for account that will create snapshots can share them:\r\n{code}\r\n# euare-grouplistpolicies -g Testers --region admin-hspencer@group1 -v\r\neuca23-snapshot-policy\r\n{\r\n  \"Statement\": [\r\n    {\r\n      \"Sid\": \"Stmt1419701314091\",\r\n      \"Action\": [\r\n        \"ec2:CreateVolume\",\r\n        \"ec2:DeleteVolume\",\r\n        \"ec2:DescribeVolumeAttribute\",\r\n        \"ec2:DescribeVolumes\",\r\n        \"ec2:ModifyVolumeAttribute\",\r\n        \"ec2:CreateSnapshot\",\r\n        \"ec2:DeleteSnapshot\",\r\n        \"ec2:DescribeSnapshotAttribute\",\r\n        \"ec2:DescribeSnapshots\",\r\n        \"ec2:ModifySnapshotAttribute\",\r\n        \"ec2:ResetSnapshotAttribute\"\r\n      ],\r\n      \"Effect\": \"Allow\",\r\n      \"Resource\": \"*\"\r\n    }\r\n  ]\r\n}\r\n\r\n# euare-grouplistusers -g Testers --region admin-hspencer@group1\r\narn:aws:iam::203845665981:group/Testers\r\n   users\r\n   arn:aws:iam::203845665981:user/tessai\r\n{code}\r\n# Uploaded IAM access policy for account that will create volumes from the shared snapshots:\r\n{code}\r\n# euare-grouplistpolicies -g Developers --region admin-ssuehle@group1 -v\r\neuca23-sharee\r\n{\r\n  \"Statement\": [\r\n    {\r\n      \"Sid\": \"Stmt1419702055946\",\r\n      \"Action\": [\r\n        \"ec2:CreateSnapshot\",\r\n        \"ec2:CreateVolume\",\r\n        \"ec2:DeleteSnapshot\",\r\n        \"ec2:DeleteVolume\",\r\n        \"ec2:DescribeSnapshots\",\r\n        \"ec2:DescribeVolumes\"\r\n      ],\r\n      \"Effect\": \"Allow\",\r\n      \"Resource\": \"*\"\r\n    }\r\n  ]\r\n}\r\n\r\n# euare-grouplistusers -g Developers --region admin-ssuehle@group1\r\narn:aws:iam::792312799970:group/Developers\r\n   users\r\n   arn:aws:iam::792312799970:user/ssuehle-user01\r\n{code}\r\n# Create volumes and snapshots from the volumes using the 203845665981 account on SC-EMC cluster (AZ two):\r\n{code}\r\n# euca-create-volume -s 15 -z two --region tessai-group1@group1\r\nVOLUME\tvol-690eb568\t15\t\ttwo\tcreating\t2015-01-13T20:12:51.675Z\r\n\r\n# euca-describe-volumes vol-690eb568 --region tessai-group1@group1\r\nVOLUME\tvol-690eb568\t15\t\ttwo\tavailable\t2015-01-13T20:12:51.675Z\tstandard\r\n\r\n# euca-create-snapshot vol-690eb568 --region tessai-group1@group1\r\nSNAPSHOT\tsnap-552222fa\tvol-690eb568\tpending\t2015-01-13T20:15:28.230Z\t203845665981\t15\r\n\r\n# euca-describe-snapshots snap-552222fa --region tessai-group1@group1\r\nSNAPSHOT\tsnap-552222fa\tvol-690eb568\tcompleted\t2015-01-13T20:15:28.230Z\t100%\t203845665981\t15\r\n{code}\r\n# Modify snapshots to share with 792312799970 account:\r\n{code}\r\n# euca-modify-snapshot-attribute --create-volume-permission --add 792312799970 snap-552222fa --region tessai-group1@group1\r\n{code}\r\n# Create volume using 792312799970 account on SC-Ceph (AZ one):\r\n{code}\r\n# euca-describe-snapshots snap-552222fa --region ssuehle-user01@group1\r\nSNAPSHOT\tsnap-552222fa\tvol-690eb568\tcompleted\t2015-01-13T20:15:28.230Z\t100%\t203845665981\t15\r\n\r\n# euca-create-volume --snapshot snap-552222fa -z one --region ssuehle-user01@group1\r\nVOLUME\tvol-062e0854\t15\tsnap-552222fa\tone\tcreating\t2015-01-13T20:36:45.297Z\r\n{code}\r\n# Observe snapshot failure:\r\n{code}\r\n# euca-describe-volumes vol-062e0854 --region ssuehle-user01@group1\r\nVOLUME\tvol-062e0854\t15\tsnap-552222fa\tone\tfailed\t2015-01-13T20:36:45.297Z\tstandard\r\n{code}\r\n\r\n\r\n\r\n\r\n","customfield_13000":null,"customfield_13200":null,"customfield_11300":null,"customfield_11500":null,"timetracking":{},"customfield_10401":null,"customfield_10005":null,"customfield_10600":null,"customfield_12900":null,"aggregatetimeestimate":null,"attachment":[],"summary":"Cross Volume/Shared Snapshot Use Case Failure From EMC to Ceph SC backends","creator":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=hspencer","name":"hspencer","key":"hspencer","accountId":"557058:4a3a93bc-21f8-4658-9f5b-9cb484c910a7","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue"},"displayName":"Harold Spencer Jr.","active":true,"timeZone":"America/Los_Angeles"},"subtasks":[],"reporter":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=hspencer","name":"hspencer","key":"hspencer","accountId":"557058:4a3a93bc-21f8-4658-9f5b-9cb484c910a7","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue"},"displayName":"Harold Spencer Jr.","active":true,"timeZone":"America/Los_Angeles"},"customfield_10000":null,"customfield_12100":"0|i031jj:","aggregateprogress":{"progress":0,"total":0},"customfield_10001":null,"customfield_10002":null,"customfield_10200":null,"customfield_10003":null,"customfield_12500":null,"customfield_10400":null,"customfield_11600":["hspencer(hspencer)","vasya(vasya)"],"customfield_10116":null,"customfield_10117":null,"environment":"* [Group #1 cloud|https://eucalyptus.atlassian.net/wiki/display/QA/Euca+4.1+Quality+Dashboard#Euca4.1QualityDashboard-TypeofDeployments]","customfield_11800":null,"customfield_11802":null,"customfield_11805":null,"duedate":null,"customfield_11806":null,"progress":{"progress":0,"total":0},"votes":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/EUCA-10327/votes","votes":0,"hasVoted":false},"comment":{"comments":[],"maxResults":0,"total":0,"startAt":0},"customfield_11808":null,"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]}}}
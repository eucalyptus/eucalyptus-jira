{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"46305","self":"https://eucalyptus.atlassian.net/rest/api/2/issue/46305","key":"EUCA-12599","fields":{"issuetype":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://eucalyptus.atlassian.net/secure/viewavatar?size=xsmall&avatarId=14803&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":14803},"timespent":null,"customfield_13100":null,"project":{"self":"https://eucalyptus.atlassian.net/rest/api/2/project/10000","id":"10000","key":"EUCA","name":"Eucalyptus","avatarUrls":{"48x48":"https://eucalyptus.atlassian.net/secure/projectavatar?pid=10000&avatarId=10011","24x24":"https://eucalyptus.atlassian.net/secure/projectavatar?size=small&pid=10000&avatarId=10011","16x16":"https://eucalyptus.atlassian.net/secure/projectavatar?size=xsmall&pid=10000&avatarId=10011","32x32":"https://eucalyptus.atlassian.net/secure/projectavatar?size=medium&pid=10000&avatarId=10011"}},"customfield_11000":null,"fixVersions":[],"customfield_11001":null,"aggregatetimespent":null,"resolution":{"self":"https://eucalyptus.atlassian.net/rest/api/2/resolution/6","id":"6","description":"The product is working as designed.","name":"Not a Bug"},"customfield_10310":null,"customfield_10311":null,"customfield_11401":null,"customfield_11400":null,"customfield_10302":null,"customfield_10104":[],"customfield_10500":{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/10403","value":"Not Applicable","id":"10403"},"customfield_10303":null,"customfield_10105":null,"customfield_10700":null,"customfield_10304":null,"customfield_10701":null,"customfield_10702":null,"customfield_10306":null,"customfield_10703":null,"customfield_10704":null,"customfield_10308":null,"resolutiondate":"2016-07-26T07:51:19.505-0500","customfield_10309":null,"customfield_10705":null,"workratio":-1,"lastViewed":null,"watches":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/EUCA-12599/watchers","watchCount":4,"isWatching":false},"created":"2016-07-21T15:08:48.945-0500","customfield_12000":null,"customfield_12400":null,"priority":{"self":"https://eucalyptus.atlassian.net/rest/api/2/priority/3","iconUrl":"https://eucalyptus.atlassian.net/images/icons/priorities/major.svg","name":"Major","id":"3"},"customfield_12201":null,"customfield_10102":null,"customfield_10300":null,"customfield_12600":"{}","customfield_10301":null,"labels":[],"customfield_11700":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"versions":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/version/16800","id":"16800","description":"Eucalyptus 4.3.0","name":"4.3.0","archived":false,"released":true,"releaseDate":"2016-08-09"}],"customfield_11901":null,"issuelinks":[],"assignee":null,"updated":"2016-07-26T07:51:19.518-0500","status":{"self":"https://eucalyptus.atlassian.net/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://eucalyptus.atlassian.net/images/icons/statuses/generic.png","name":"Closed","id":"6","statusCategory":{"self":"https://eucalyptus.atlassian.net/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[],"timeoriginalestimate":null,"description":"This is only occurring in faststart (I'm porting faststart to 4.3 now), not in other EQS cookbook builds.\r\n\r\n\r\nThis error occurs (in cloud-debug.log):\r\n\r\n{code:java}\r\nThu Jul 21 12:19:46 2016 ERROR [BindingCache:main] Unable to delete file: /var/run/eucalyptus/classcache\r\n{code}\r\n\r\nYou then see clcadmin-initialize-cloud hung, with a child process trying to do chown -R:\r\n\r\n\r\n{code:java}\r\n[root@c-23 ~]# ps -ef | grep euca\r\nroot      3812  5542  0 13:07 pts/1    00:00:00 grep --color=auto euca\r\nroot      6396     1  0 12:19 ?        00:00:00 eucalyptus-cloud\r\nroot      6685  6543  0 12:19 ?        00:00:00 eucalyptus-cloud --initialize\r\neucalyp+  6688  6685  0 12:19 ?        00:00:05 eucalyptus-cloud --initialize\r\neucalyp+  6992  6688  0 12:19 ?        00:00:00 chown -R eucalyptus ///var/run/eucalyptus//classcache\r\neucalyp+  7431  6396  1 12:20 ?        00:00:33 eucalyptus-cloud\r\n{code}\r\n\r\nFinally, the SystemCredentialsInit step fails with the following repeated errors (in cloud-debug.log):\r\n\r\n{code:java}\r\nBootstrap stage completed: UnprivilegedConfiguration\r\n================================================================================\r\nThu Jul 21 12:20:32 2016  INFO [Bootstrap:main] ================================================================================\r\nBootstrap stage: SystemCredentialsInit.load()\r\n================================================================================\r\nThu Jul 21 12:20:32 2016  INFO [Bootstrap:main] :1469128832691:Bootstrap:bootstrap:BOOTSTRAPPER_LOAD:SystemCredentialsInit:com.eucalyptus.component.auth.SystemCredentials.RemoteComponentCredentialBootstrapper\r\nThu Jul 21 12:20:32 2016 ERROR [SystemCredentials:main] Failed to lookup key for Storage with alias=storage in file ///var/lib/eucalyptus/keys/euca.p12\r\nThu Jul 21 12:20:32 2016 FATAL [SystemCredentials:main] Waiting for system credentials before proceeding with startup...\r\nThu Jul 21 12:20:34 2016 ERROR [SystemCredentials:main] Failed to lookup key for Storage with alias=storage in file ///var/lib/eucalyptus/keys/euca.p12\r\nThu Jul 21 12:20:34 2016 FATAL [SystemCredentials:main] Waiting for system credentials before proceeding with startup...\r\nThu Jul 21 12:20:36 2016 ERROR [SystemCredentials:main] Failed to lookup key for Storage with alias=storage in file ///var/lib/eucalyptus/keys/euca.p12\r\nThu Jul 21 12:20:36 2016 FATAL [SystemCredentials:main] Waiting for system credentials before proceeding with startup...\r\nThu Jul 21 12:20:38 2016 ERROR [SystemCredentials:main] Failed to lookup key for Storage with alias=storage in file ///var/lib/eucalyptus/keys/euca.p12\r\nThu Jul 21 12:20:38 2016 FATAL [SystemCredentials:main] Waiting for system credentials before proceeding with startup...\r\nThu Jul 21 12:20:40 2016 ERROR [SystemCredentials:main] Failed to lookup key for Storage with alias=storage in file ///var/lib/eucalyptus/keys/euca.p12\r\nThu Jul 21 12:20:40 2016 FATAL [SystemCredentials:main] Waiting for system credentials before proceeding with startup...\r\nThu Jul 21 12:20:42 2016 ERROR [SystemCredentials:main] Failed to lookup key for Storage with alias=storage in file ///var/lib/eucalyptus/keys/euca.p12\r\n{code}\r\n","customfield_13000":null,"customfield_13200":null,"customfield_11300":null,"customfield_11500":null,"timetracking":{},"customfield_10005":null,"customfield_10401":null,"customfield_10600":null,"customfield_12900":null,"attachment":[],"aggregatetimeestimate":null,"summary":"[BindingCache:main] Unable to delete file: /var/run/eucalyptus/classcache","creator":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=mbacchi","name":"mbacchi","key":"mbacchi","accountId":"557058:d650aabc-f00c-4262-93a9-7799945b8eed","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/24b916c1ff78f38b51f4bb1dc66ed58c?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dmbacchi%26avatarId%3D16201%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/24b916c1ff78f38b51f4bb1dc66ed58c?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dmbacchi%26avatarId%3D16201%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/24b916c1ff78f38b51f4bb1dc66ed58c?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dmbacchi%26avatarId%3D16201%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/24b916c1ff78f38b51f4bb1dc66ed58c?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dmbacchi%26avatarId%3D16201%26noRedirect%3Dtrue"},"displayName":"Matt Bacchi","active":true,"timeZone":"US/Central"},"subtasks":[],"reporter":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=mbacchi","name":"mbacchi","key":"mbacchi","accountId":"557058:d650aabc-f00c-4262-93a9-7799945b8eed","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/24b916c1ff78f38b51f4bb1dc66ed58c?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dmbacchi%26avatarId%3D16201%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/24b916c1ff78f38b51f4bb1dc66ed58c?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dmbacchi%26avatarId%3D16201%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/24b916c1ff78f38b51f4bb1dc66ed58c?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dmbacchi%26avatarId%3D16201%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/24b916c1ff78f38b51f4bb1dc66ed58c?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dmbacchi%26avatarId%3D16201%26noRedirect%3Dtrue"},"displayName":"Matt Bacchi","active":true,"timeZone":"US/Central"},"customfield_12100":"0|i03vfr:","aggregateprogress":{"progress":0,"total":0},"customfield_10000":"6_*:*_1_*:*_0_*|*_10000_*:*_1_*:*_405750574","customfield_10001":"2016-07-21T15:57:16.855-0500","customfield_10200":null,"customfield_10002":null,"customfield_10003":null,"customfield_12500":null,"customfield_10400":null,"customfield_11600":["gholms(gholms)","mbacchi(mbacchi)","sjones(sjones)"],"customfield_10116":null,"environment":null,"customfield_10117":null,"customfield_11800":null,"customfield_11802":null,"customfield_11805":null,"duedate":null,"progress":{"progress":0,"total":0},"customfield_11806":null,"comment":{"comments":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/46305/comment/107229","id":"107229","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=mbacchi","name":"mbacchi","key":"mbacchi","accountId":"557058:d650aabc-f00c-4262-93a9-7799945b8eed","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/24b916c1ff78f38b51f4bb1dc66ed58c?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dmbacchi%26avatarId%3D16201%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/24b916c1ff78f38b51f4bb1dc66ed58c?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dmbacchi%26avatarId%3D16201%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/24b916c1ff78f38b51f4bb1dc66ed58c?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dmbacchi%26avatarId%3D16201%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/24b916c1ff78f38b51f4bb1dc66ed58c?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dmbacchi%26avatarId%3D16201%26noRedirect%3Dtrue"},"displayName":"Matt Bacchi","active":true,"timeZone":"US/Central"},"body":"more debugging:\r\n\r\n\r\n{code:java}\r\n[root@c-23 ~]# ls -l /proc/6992/fd\r\ntotal 0\r\nlr-x------. 1 eucalyptus eucalyptus 64 Jul 21 12:19 0 -> pipe:[9901549]\r\nl-wx------. 1 eucalyptus eucalyptus 64 Jul 21 12:19 1 -> pipe:[9901550]\r\nl-wx------. 1 eucalyptus eucalyptus 64 Jul 21 12:19 2 -> pipe:[9901551]\r\nlr-x------. 1 eucalyptus eucalyptus 64 Jul 21 12:19 4 -> /run/eucalyptus/classcache/com/eucalyptus/compute\r\nlr-x------. 1 eucalyptus eucalyptus 64 Jul 21 12:34 5 -> /run/eucalyptus/classcache/com\r\nlr-x------. 1 eucalyptus eucalyptus 64 Jul 21 12:19 6 -> /run/eucalyptus/classcache/com/eucalyptus\r\nlr-x------. 1 eucalyptus eucalyptus 64 Jul 21 12:19 7 -> /run/eucalyptus/classcache/com/eucalyptus/compute/common\r\nlr-x------. 1 eucalyptus eucalyptus 64 Jul 21 12:19 8 -> /run/eucalyptus/classcache/com/eucalyptus/compute/common/backend\r\n\r\n[root@c-23 ~]# cat /proc/6992/stack \r\n[<ffffffff811e7570>] pipe_wait+0x70/0xc0\r\n[<ffffffff811e7856>] pipe_write+0x236/0x5b0\r\n[<ffffffff811de3fd>] do_sync_write+0x8d/0xd0\r\n[<ffffffff811dec1d>] vfs_write+0xbd/0x1e0\r\n[<ffffffff811df6bf>] SyS_write+0x7f/0xe0\r\n[<ffffffff81646889>] system_call_fastpath+0x16/0x1b\r\n[<ffffffffffffffff>] 0xffffffffffffffff\r\n\r\n[root@c-23 ~]# strace -s 99 -ffp 6992\r\nProcess 6992 attached\r\nwrite(2, \"changing ownership of \\342\\200\\230///var/run/eucalyptus//classcache/com/eucalyptus/compute/common/backend/Di\"..., 132\r\n^CProcess 6992 detached\r\n <detached ...>\r\n{code}\r\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=mbacchi","name":"mbacchi","key":"mbacchi","accountId":"557058:d650aabc-f00c-4262-93a9-7799945b8eed","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/24b916c1ff78f38b51f4bb1dc66ed58c?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dmbacchi%26avatarId%3D16201%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/24b916c1ff78f38b51f4bb1dc66ed58c?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dmbacchi%26avatarId%3D16201%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/24b916c1ff78f38b51f4bb1dc66ed58c?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dmbacchi%26avatarId%3D16201%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/24b916c1ff78f38b51f4bb1dc66ed58c?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dmbacchi%26avatarId%3D16201%26noRedirect%3Dtrue"},"displayName":"Matt Bacchi","active":true,"timeZone":"US/Central"},"created":"2016-07-21T15:14:54.423-0500","updated":"2016-07-21T15:14:54.423-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/46305/comment/107237","id":"107237","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=gholms","name":"gholms","key":"gholms","accountId":"557058:6e5fdc25-c797-4d3d-8fd4-55c3c4ed99b0","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/3e16def22dd4a96dbe507df70f15f37f?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dgholms%26avatarId%3D18100%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/3e16def22dd4a96dbe507df70f15f37f?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dgholms%26avatarId%3D18100%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/3e16def22dd4a96dbe507df70f15f37f?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dgholms%26avatarId%3D18100%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/3e16def22dd4a96dbe507df70f15f37f?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dgholms%26avatarId%3D18100%26noRedirect%3Dtrue"},"displayName":"Garrett Holmstrom","active":true,"timeZone":"America/Los_Angeles"},"body":"What are the permissions on /var/lib/eucalyptus/classcache and its contents?","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=gholms","name":"gholms","key":"gholms","accountId":"557058:6e5fdc25-c797-4d3d-8fd4-55c3c4ed99b0","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/3e16def22dd4a96dbe507df70f15f37f?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dgholms%26avatarId%3D18100%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/3e16def22dd4a96dbe507df70f15f37f?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dgholms%26avatarId%3D18100%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/3e16def22dd4a96dbe507df70f15f37f?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dgholms%26avatarId%3D18100%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/3e16def22dd4a96dbe507df70f15f37f?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dgholms%26avatarId%3D18100%26noRedirect%3Dtrue"},"displayName":"Garrett Holmstrom","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-07-21T15:57:16.855-0500","updated":"2016-07-21T15:57:16.855-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/46305/comment/107238","id":"107238","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=mbacchi","name":"mbacchi","key":"mbacchi","accountId":"557058:d650aabc-f00c-4262-93a9-7799945b8eed","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/24b916c1ff78f38b51f4bb1dc66ed58c?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dmbacchi%26avatarId%3D16201%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/24b916c1ff78f38b51f4bb1dc66ed58c?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dmbacchi%26avatarId%3D16201%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/24b916c1ff78f38b51f4bb1dc66ed58c?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dmbacchi%26avatarId%3D16201%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/24b916c1ff78f38b51f4bb1dc66ed58c?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dmbacchi%26avatarId%3D16201%26noRedirect%3Dtrue"},"displayName":"Matt Bacchi","active":true,"timeZone":"US/Central"},"body":"No such dir:\r\n\r\n\r\n{code:java}\r\n[root@c-23 ~]# ls -l /var/lib/eucalyptus/\r\ntotal 0\r\ndrwx------. 2 eucalyptus eucalyptus 6 Jul 21 12:19 backups\r\ndrwx------. 2 eucalyptus eucalyptus 6 Jul 20 15:50 db\r\ndrwx------. 2 eucalyptus eucalyptus 6 Jul 20 15:50 keys\r\ndrwxr-xr-x. 2 eucalyptus eucalyptus 6 Jul 21 12:20 queue\r\ndrwxr-xr-x. 2 eucalyptus eucalyptus 6 Jul 20 15:51 upgrade\r\ndrwx------. 2 eucalyptus eucalyptus 6 Jul 20 15:50 webapps\r\n{code}\r\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=mbacchi","name":"mbacchi","key":"mbacchi","accountId":"557058:d650aabc-f00c-4262-93a9-7799945b8eed","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/24b916c1ff78f38b51f4bb1dc66ed58c?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dmbacchi%26avatarId%3D16201%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/24b916c1ff78f38b51f4bb1dc66ed58c?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dmbacchi%26avatarId%3D16201%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/24b916c1ff78f38b51f4bb1dc66ed58c?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dmbacchi%26avatarId%3D16201%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/24b916c1ff78f38b51f4bb1dc66ed58c?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dmbacchi%26avatarId%3D16201%26noRedirect%3Dtrue"},"displayName":"Matt Bacchi","active":true,"timeZone":"US/Central"},"created":"2016-07-21T16:03:14.525-0500","updated":"2016-07-21T16:03:14.525-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/46305/comment/107239","id":"107239","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=gholms","name":"gholms","key":"gholms","accountId":"557058:6e5fdc25-c797-4d3d-8fd4-55c3c4ed99b0","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/3e16def22dd4a96dbe507df70f15f37f?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dgholms%26avatarId%3D18100%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/3e16def22dd4a96dbe507df70f15f37f?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dgholms%26avatarId%3D18100%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/3e16def22dd4a96dbe507df70f15f37f?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dgholms%26avatarId%3D18100%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/3e16def22dd4a96dbe507df70f15f37f?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dgholms%26avatarId%3D18100%26noRedirect%3Dtrue"},"displayName":"Garrett Holmstrom","active":true,"timeZone":"America/Los_Angeles"},"body":"Sorry, I mis-typed.  /run/eucalyptus/classcache.","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=gholms","name":"gholms","key":"gholms","accountId":"557058:6e5fdc25-c797-4d3d-8fd4-55c3c4ed99b0","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/3e16def22dd4a96dbe507df70f15f37f?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dgholms%26avatarId%3D18100%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/3e16def22dd4a96dbe507df70f15f37f?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dgholms%26avatarId%3D18100%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/3e16def22dd4a96dbe507df70f15f37f?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dgholms%26avatarId%3D18100%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/3e16def22dd4a96dbe507df70f15f37f?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dgholms%26avatarId%3D18100%26noRedirect%3Dtrue"},"displayName":"Garrett Holmstrom","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-07-21T16:05:33.995-0500","updated":"2016-07-21T16:05:33.995-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/46305/comment/107240","id":"107240","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=mbacchi","name":"mbacchi","key":"mbacchi","accountId":"557058:d650aabc-f00c-4262-93a9-7799945b8eed","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/24b916c1ff78f38b51f4bb1dc66ed58c?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dmbacchi%26avatarId%3D16201%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/24b916c1ff78f38b51f4bb1dc66ed58c?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dmbacchi%26avatarId%3D16201%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/24b916c1ff78f38b51f4bb1dc66ed58c?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dmbacchi%26avatarId%3D16201%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/24b916c1ff78f38b51f4bb1dc66ed58c?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dmbacchi%26avatarId%3D16201%26noRedirect%3Dtrue"},"displayName":"Matt Bacchi","active":true,"timeZone":"US/Central"},"body":"There are a ton of files in that dir, but here's the top level:\r\n\r\n{code:java}\r\n[root@c-23 ~]# ls -l /run/eucalyptus/classcache/\r\ntotal 1296\r\n-rw-r--r--. 1 eucalyptus eucalyptus      20 Jul 21 12:19 broker-types.xml\r\n-rw-r--r--. 1 eucalyptus eucalyptus    7671 Jul 21 12:20 classcache.properties\r\ndrwxr-xr-x. 3 eucalyptus eucalyptus      60 Jul 21 12:19 com\r\ndrwxr-xr-x. 3 eucalyptus eucalyptus      60 Jul 21 12:19 edu\r\n-rw-r--r--. 1 eucalyptus eucalyptus 1312743 Jul 21 12:19 msgs-binding.xml\r\n\r\n[root@c-23 ~]# find /run/eucalyptus/classcache/ | wc -l \r\n23902\r\n{code}\r\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=mbacchi","name":"mbacchi","key":"mbacchi","accountId":"557058:d650aabc-f00c-4262-93a9-7799945b8eed","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/24b916c1ff78f38b51f4bb1dc66ed58c?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dmbacchi%26avatarId%3D16201%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/24b916c1ff78f38b51f4bb1dc66ed58c?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dmbacchi%26avatarId%3D16201%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/24b916c1ff78f38b51f4bb1dc66ed58c?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dmbacchi%26avatarId%3D16201%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/24b916c1ff78f38b51f4bb1dc66ed58c?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dmbacchi%26avatarId%3D16201%26noRedirect%3Dtrue"},"displayName":"Matt Bacchi","active":true,"timeZone":"US/Central"},"created":"2016-07-21T16:08:54.262-0500","updated":"2016-07-21T16:08:54.262-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/46305/comment/107277","id":"107277","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=mbacchi","name":"mbacchi","key":"mbacchi","accountId":"557058:d650aabc-f00c-4262-93a9-7799945b8eed","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/24b916c1ff78f38b51f4bb1dc66ed58c?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dmbacchi%26avatarId%3D16201%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/24b916c1ff78f38b51f4bb1dc66ed58c?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dmbacchi%26avatarId%3D16201%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/24b916c1ff78f38b51f4bb1dc66ed58c?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dmbacchi%26avatarId%3D16201%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/24b916c1ff78f38b51f4bb1dc66ed58c?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dmbacchi%26avatarId%3D16201%26noRedirect%3Dtrue"},"displayName":"Matt Bacchi","active":true,"timeZone":"US/Central"},"body":"A bit more troubleshooting, it appears that when clcadmin-initialize-cloud is run by hand, it only starts 2 eucalyptus-cloud processes, versus 4 in the above run via the faststart installer:\r\n\r\nIn one terminal:\r\n{code:java}\r\n[root@c-36 ~]# which clcadmin-initialize-cloud \r\n/usr/sbin/clcadmin-initialize-cloud\r\n[root@c-36 ~]# /usr/sbin/clcadmin-initialize-cloud^C\r\n[root@c-36 ~]# ps -ef | grep euca\r\nroot     11312  4688  0 07:16 pts/1    00:00:00 grep --color=auto euca\r\n[root@c-36 ~]# ps -ef | grep euca\r\nroot     11314  4688  0 07:16 pts/1    00:00:00 grep --color=auto euca\r\n[root@c-36 ~]# clcadmin-initialize-cloud\r\n2016-07-22 07:17:26 INFO ulimit: resource=7 soft=1024 hard=4096\r\n2016-07-22 07:17:26 INFO ulimit: resource=7 soft=65535 hard=65535\r\n2016-07-22 07:17:26 INFO ulimit: resource=6 soft=31154 hard=31154\r\n2016-07-22 07:17:26 INFO ulimit: resource=6 soft=-1 hard=-1\r\n2016-07-22 07:17:26 11477 INFO User did not set heap size. Setting it automatically to 4GB base on total memory of 8190132224 bytes\r\n2016-07-22 07:17:27 INFO Returning Bootstrapper instance.\r\n2016-07-22 07:18:49 INFO Executing Pre-Shutdown Hooks...\r\n2016-07-22 07:18:49 INFO Executing Shutdown Hooks...\r\n2016-07-22 07:18:49 INFO Executing Shutdown Hook: com.eucalyptus.component.BasicService$1@5ea3e7dc\r\n2016-07-22 07:18:50 INFO Executing Post-Shutdown Hooks...\r\n2016-07-22 07:18:50 INFO Executing Post-Shutdown Hook: com.eucalyptus.system.Threads$ThreadPool$1@208c5ec6\r\n2016-07-22 07:18:50 INFO SHUTDOWN:Eucalyptus.SYSTEM Stopping thread pool...\r\n2016-07-22 07:18:50 INFO Executing Post-Shutdown Hook: PostgresqlBootstrapper$2@686a107e\r\n2016-07-22 07:18:50 INFO Executing Post-Shutdown Hook: com.eucalyptus.system.Threads$ThreadPool$1@364e2308\r\n2016-07-22 07:18:50 INFO SHUTDOWN:Eucalyptus.bootstrap:Futures Stopping thread pool...\r\n2016-07-22 07:18:50 11474 INFO Service shut down cleanly.\r\n{code}\r\n\r\nIn a second terminal:\r\n\r\n{code:java}\r\n[root@c-36 ~]# while true; do\r\n> date\r\n> ps -ef | grep euca\r\n> sleep 2\r\n> echo \"--------------\"\r\n> done\r\nFri Jul 22 07:17:20 PDT 2016\r\nroot     11324  4653  0 07:17 pts/0    00:00:00 grep --color=auto euca\r\n--------------\r\nFri Jul 22 07:17:22 PDT 2016\r\nroot     11328  4653  0 07:17 pts/0    00:00:00 grep --color=auto euca\r\n--------------\r\nFri Jul 22 07:17:24 PDT 2016\r\nroot     11332  4653  0 07:17 pts/0    00:00:00 grep --color=auto euca\r\n--------------\r\nFri Jul 22 07:17:26 PDT 2016\r\nroot     11474 11334  0 07:17 pts/1    00:00:00 eucalyptus-cloud --initialize\r\nroot     11477 11474  0 07:17 pts/1    00:00:00 eucalyptus-cloud --initialize\r\nroot     11501  4653  0 07:17 pts/0    00:00:00 grep --color=auto euca\r\n--------------\r\nFri Jul 22 07:17:28 PDT 2016\r\nroot     11474 11334  0 07:17 pts/1    00:00:00 eucalyptus-cloud --initialize\r\nroot     11477 11474 99 07:17 pts/1    00:00:03 eucalyptus-cloud --initialize\r\nroot     11517  4653  0 07:17 pts/0    00:00:00 grep --color=auto euca\r\n--------------\r\nFri Jul 22 07:17:30 PDT 2016\r\nroot     11474 11334  0 07:17 pts/1    00:00:00 eucalyptus-cloud --initialize\r\nroot     11477 11474 82 07:17 pts/1    00:00:03 eucalyptus-cloud --initialize\r\nroot     11521  4653  0 07:17 pts/0    00:00:00 grep --color=auto euca\r\n--------------\r\nFri Jul 22 07:17:32 PDT 2016\r\nroot     11474 11334  0 07:17 pts/1    00:00:00 eucalyptus-cloud --initialize\r\nroot     11477 11474 47 07:17 pts/1    00:00:03 eucalyptus-cloud --initialize\r\nroot     11525  4653  0 07:17 pts/0    00:00:00 grep --color=auto euca\r\n--------------\r\nFri Jul 22 07:17:34 PDT 2016\r\nroot     11474 11334  0 07:17 pts/1    00:00:00 eucalyptus-cloud --initialize\r\nroot     11477 11474 36 07:17 pts/1    00:00:03 eucalyptus-cloud --initialize\r\nroot     11529  4653  0 07:17 pts/0    00:00:00 grep --color=auto euca\r\n--------------\r\nFri Jul 22 07:17:36 PDT 2016\r\nroot     11474 11334  0 07:17 pts/1    00:00:00 eucalyptus-cloud --initialize\r\nroot     11477 11474 30 07:17 pts/1    00:00:03 eucalyptus-cloud --initialize\r\nroot     11533  4653  0 07:17 pts/0    00:00:00 grep --color=auto euca\r\n--------------\r\nFri Jul 22 07:17:38 PDT 2016\r\nroot     11474 11334  0 07:17 pts/1    00:00:00 eucalyptus-cloud --initialize\r\neucalyp+ 11477 11474 49 07:17 pts/1    00:00:06 eucalyptus-cloud --initialize\r\nroot     11575  4653  0 07:17 pts/0    00:00:00 grep --color=auto euca\r\n...\r\n--------------\r\nFri Jul 22 07:18:13 PDT 2016\r\nroot     11474 11334  0 07:17 pts/1    00:00:00 eucalyptus-cloud --initialize\r\neucalyp+ 11477 11474 95 07:17 pts/1    00:00:44 eucalyptus-cloud --initialize\r\neucalyp+ 11674     1  1 07:18 pts/1    00:00:00 /usr/bin/postgres -D /var/lib/eucalyptus/db/data -h127.0.0.1 -p8777\r\neucalyp+ 11676 11674  0 07:18 ?        00:00:00 postgres: logger process   \r\neucalyp+ 11678 11674  0 07:18 ?        00:00:00 postgres: checkpointer process   \r\neucalyp+ 11679 11674  0 07:18 ?        00:00:00 postgres: writer process   \r\neucalyp+ 11680 11674  0 07:18 ?        00:00:00 postgres: wal writer process   \r\neucalyp+ 11681 11674  0 07:18 ?        00:00:00 postgres: autovacuum launcher process   \r\neucalyp+ 11682 11674  0 07:18 ?        00:00:00 postgres: stats collector process   \r\neucalyp+ 11727 11674  4 07:18 ?        00:00:00 postgres: eucalyptus eucalyptus_shared 127.0.0.1(38376) idle\r\neucalyp+ 11733 11674  6 07:18 ?        00:00:00 postgres: eucalyptus eucalyptus_shared 127.0.0.1(38378) idle\r\neucalyp+ 11739 11674  6 07:18 ?        00:00:00 postgres: eucalyptus eucalyptus_shared 127.0.0.1(38380) idle\r\neucalyp+ 11741 11674  5 07:18 ?        00:00:00 postgres: eucalyptus eucalyptus_shared 127.0.0.1(38382) idle\r\neucalyp+ 11743 11674 16 07:18 ?        00:00:00 postgres: eucalyptus eucalyptus_shared 127.0.0.1(38384) ALTER TABLE\r\nroot     11747  4653  0 07:18 pts/0    00:00:00 grep --color=auto euca\r\n...\r\n--------------\r\nFri Jul 22 07:18:49 PDT 2016\r\nroot     11474 11334  0 07:17 pts/1    00:00:00 eucalyptus-cloud --initialize\r\neucalyp+ 11477 11474 73 07:17 pts/1    00:01:00 eucalyptus-cloud --initialize\r\neucalyp+ 11846 11477  0 07:18 pts/1    00:00:00 /usr/bin/pg_ctl stop -mf -D///var/lib/eucalyptus/db/data\r\nroot     11851  4653  0 07:18 pts/0    00:00:00 grep --color=auto euca\r\n--------------\r\nFri Jul 22 07:18:51 PDT 2016\r\nroot     11858  4653  0 07:18 pts/0    00:00:00 grep --color=auto euca\r\n{code}\r\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=mbacchi","name":"mbacchi","key":"mbacchi","accountId":"557058:d650aabc-f00c-4262-93a9-7799945b8eed","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/24b916c1ff78f38b51f4bb1dc66ed58c?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dmbacchi%26avatarId%3D16201%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/24b916c1ff78f38b51f4bb1dc66ed58c?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dmbacchi%26avatarId%3D16201%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/24b916c1ff78f38b51f4bb1dc66ed58c?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dmbacchi%26avatarId%3D16201%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/24b916c1ff78f38b51f4bb1dc66ed58c?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dmbacchi%26avatarId%3D16201%26noRedirect%3Dtrue"},"displayName":"Matt Bacchi","active":true,"timeZone":"US/Central"},"created":"2016-07-22T09:24:44.856-0500","updated":"2016-07-22T09:24:44.856-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/46305/comment/107278","id":"107278","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=mbacchi","name":"mbacchi","key":"mbacchi","accountId":"557058:d650aabc-f00c-4262-93a9-7799945b8eed","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/24b916c1ff78f38b51f4bb1dc66ed58c?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dmbacchi%26avatarId%3D16201%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/24b916c1ff78f38b51f4bb1dc66ed58c?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dmbacchi%26avatarId%3D16201%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/24b916c1ff78f38b51f4bb1dc66ed58c?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dmbacchi%26avatarId%3D16201%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/24b916c1ff78f38b51f4bb1dc66ed58c?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dmbacchi%26avatarId%3D16201%26noRedirect%3Dtrue"},"displayName":"Matt Bacchi","active":true,"timeZone":"US/Central"},"body":"This is in fact due to the faststart run_list containing all recipes in one big list (run_list is set in ciab-template.json.)  This is evident in the log file, but I missed it earlier and didn't realize it was starting the eucalyptus-cloud service from the storage-controller.rb recipe before running clcadmin-initialize-cloud.  You can see the service restart before the initialize action in this log file:\r\n\r\n{code:java}\r\n[2016-07-22T06:45:00-07:00] INFO: Processing service[eucalyptus-cloud] action restart (eucalyptus::storage-controller line 139)\r\n[2016-07-22T06:45:00-07:00] INFO: service[eucalyptus-cloud] restarted\r\n...\r\n...\r\n[2016-07-22T06:45:07-07:00] INFO: Processing execute[Initialize Eucalyptus DB] action run (eucalyptus::cloud-controller line 32)\r\n{code}\r\n\r\nThis problem isn't experienced when using calyptos because it doesn't shove all recipes in a single run_list, rather it performs multiple runs of chef-client with smaller run_lists, and that's why we didn't witness this problem at the time I was preparing the chef cookbooks for 4.3.  This problem bubbled to the surface now due to the faststart ciab run_list, which combines all recipes in one list, and therefore chef has to attempt to compile these commands and process them in an order that it thinks is proper.  Unfortunately it is not working as designed.\r\n\r\nBecause this is a single node installation, the easy way to fix this is to add a chef guard so that it won't start the eucalyptus-cloud service unless a file that clcadmin-initialize-cloud creates exists, such as this line in storage-controller.rb:\r\n\r\n{code:java}\r\ndiff --git a/recipes/storage-controller.rb b/recipes/storage-controller.rb\r\nindex e4f8346..7e4d618 100644\r\n--- a/recipes/storage-controller.rb\r\n+++ b/recipes/storage-controller.rb\r\n@@ -139,4 +139,5 @@ end\r\n service \"eucalyptus-cloud\" do\r\n   action [ :enable, :start ]\r\n   supports :status => true, :start => true, :stop => true, :restart => true\r\n+  only_if lazy { ::File.exist? \"#{node[\"eucalyptus\"][\"home-directory\"]}/var/lib/eucalyptus/db/data/server.crt\" }\r\n end\r\n{code}\r\n\r\nBut that will not work on a cloud with components on separate machines, and these recipes are used both for multi node eucalyptus installations as well as single node faststart installs.  This will have to be investigated how best to preempt the service start when clcadmin-initialize-cloud hasn't been run.\r\n\r\nWorking on it ...\r\n\r\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=mbacchi","name":"mbacchi","key":"mbacchi","accountId":"557058:d650aabc-f00c-4262-93a9-7799945b8eed","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/24b916c1ff78f38b51f4bb1dc66ed58c?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dmbacchi%26avatarId%3D16201%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/24b916c1ff78f38b51f4bb1dc66ed58c?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dmbacchi%26avatarId%3D16201%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/24b916c1ff78f38b51f4bb1dc66ed58c?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dmbacchi%26avatarId%3D16201%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/24b916c1ff78f38b51f4bb1dc66ed58c?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dmbacchi%26avatarId%3D16201%26noRedirect%3Dtrue"},"displayName":"Matt Bacchi","active":true,"timeZone":"US/Central"},"created":"2016-07-22T10:27:57.973-0500","updated":"2016-07-22T10:27:57.973-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/46305/comment/107280","id":"107280","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=sjones","name":"sjones","key":"sjones","accountId":"557058:f5dce1b0-db45-4dd6-a0e8-3cea5effb5ce","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue"},"displayName":"Steve Jones","active":true,"timeZone":"America/Los_Angeles"},"body":"[~mbacchi], not sure if relevant to this use case but it may be fine to start eucalyptus-cloud non-clc hosts as they wait for credentials to become available during startup.","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=sjones","name":"sjones","key":"sjones","accountId":"557058:f5dce1b0-db45-4dd6-a0e8-3cea5effb5ce","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue"},"displayName":"Steve Jones","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-07-22T11:13:46.544-0500","updated":"2016-07-22T11:13:46.544-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/46305/comment/107417","id":"107417","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=mbacchi","name":"mbacchi","key":"mbacchi","accountId":"557058:d650aabc-f00c-4262-93a9-7799945b8eed","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/24b916c1ff78f38b51f4bb1dc66ed58c?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dmbacchi%26avatarId%3D16201%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/24b916c1ff78f38b51f4bb1dc66ed58c?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dmbacchi%26avatarId%3D16201%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/24b916c1ff78f38b51f4bb1dc66ed58c?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dmbacchi%26avatarId%3D16201%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/24b916c1ff78f38b51f4bb1dc66ed58c?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dmbacchi%26avatarId%3D16201%26noRedirect%3Dtrue"},"displayName":"Matt Bacchi","active":true,"timeZone":"US/Central"},"body":"This is due to Chef ordering a 'eucalyptus-cloud' restart event before the 'clcadmin-initialize-cloud' event.  So therefore we get two processes.\r\n\r\nThe current fix within faststart is to run two different runlists, first has the initialization, and the second has the remaining provisioning events.","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=mbacchi","name":"mbacchi","key":"mbacchi","accountId":"557058:d650aabc-f00c-4262-93a9-7799945b8eed","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/24b916c1ff78f38b51f4bb1dc66ed58c?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dmbacchi%26avatarId%3D16201%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/24b916c1ff78f38b51f4bb1dc66ed58c?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dmbacchi%26avatarId%3D16201%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/24b916c1ff78f38b51f4bb1dc66ed58c?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dmbacchi%26avatarId%3D16201%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/24b916c1ff78f38b51f4bb1dc66ed58c?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dmbacchi%26avatarId%3D16201%26noRedirect%3Dtrue"},"displayName":"Matt Bacchi","active":true,"timeZone":"US/Central"},"created":"2016-07-26T07:51:19.516-0500","updated":"2016-07-26T07:51:19.516-0500"}],"maxResults":9,"total":9,"startAt":0},"votes":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/EUCA-12599/votes","votes":0,"hasVoted":false},"customfield_11808":null,"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]}}}
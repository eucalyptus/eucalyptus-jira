{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"30863","self":"https://eucalyptus.atlassian.net/rest/api/2/issue/30863","key":"EUCA-9574","fields":{"issuetype":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://eucalyptus.atlassian.net/secure/viewavatar?size=xsmall&avatarId=14803&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":14803},"timespent":null,"customfield_13100":null,"project":{"self":"https://eucalyptus.atlassian.net/rest/api/2/project/10000","id":"10000","key":"EUCA","name":"Eucalyptus","avatarUrls":{"48x48":"https://eucalyptus.atlassian.net/secure/projectavatar?pid=10000&avatarId=10011","24x24":"https://eucalyptus.atlassian.net/secure/projectavatar?size=small&pid=10000&avatarId=10011","16x16":"https://eucalyptus.atlassian.net/secure/projectavatar?size=xsmall&pid=10000&avatarId=10011","32x32":"https://eucalyptus.atlassian.net/secure/projectavatar?size=medium&pid=10000&avatarId=10011"}},"customfield_11000":null,"fixVersions":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/version/14205","id":"14205","description":"Eucalyptus 4.0.1","name":"4.0.1","archived":false,"released":true,"releaseDate":"2014-08-13"}],"customfield_11001":null,"aggregatetimespent":null,"customfield_10310":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/10209","value":"CentOS 6","id":"10209"}],"resolution":{"self":"https://eucalyptus.atlassian.net/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_11401":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=tony","name":"tony","key":"tony","accountId":"557058:353956db-b78c-4f3b-9096-f8f58e6709c8","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/14ec1b18e630cc0743492fc327a12df7?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dtony%26avatarId%3D16600%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/14ec1b18e630cc0743492fc327a12df7?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dtony%26avatarId%3D16600%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/14ec1b18e630cc0743492fc327a12df7?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dtony%26avatarId%3D16600%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/14ec1b18e630cc0743492fc327a12df7?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dtony%26avatarId%3D16600%26noRedirect%3Dtrue"},"displayName":"Tony Beckham","active":true,"timeZone":"America/Tijuana"},"customfield_10311":null,"customfield_11400":null,"customfield_10302":null,"customfield_10104":[],"customfield_10500":{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/10403","value":"Not Applicable","id":"10403"},"customfield_10105":{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/10101","value":"No","id":"10101"},"customfield_10303":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=sjones","name":"sjones","key":"sjones","accountId":"557058:f5dce1b0-db45-4dd6-a0e8-3cea5effb5ce","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue"},"displayName":"Steve Jones","active":true,"timeZone":"America/Los_Angeles"},"customfield_10304":null,"customfield_10700":null,"customfield_10701":null,"customfield_10702":null,"customfield_10306":{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/10200","value":"High","id":"10200"},"customfield_10703":null,"customfield_10704":null,"resolutiondate":"2014-07-14T18:33:25.956-0500","customfield_10308":null,"customfield_10309":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/10204","value":"KVM","id":"10204"}],"customfield_10705":null,"workratio":-1,"lastViewed":null,"watches":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/EUCA-9574/watchers","watchCount":3,"isWatching":false},"created":"2014-06-20T18:24:12.275-0500","customfield_12000":null,"priority":{"self":"https://eucalyptus.atlassian.net/rest/api/2/priority/1","iconUrl":"https://eucalyptus.atlassian.net/images/icons/priorities/blocker.svg","name":"Blocker","id":"1"},"customfield_12400":null,"customfield_12201":null,"customfield_10102":null,"customfield_10300":null,"customfield_12600":"{}","customfield_10301":null,"labels":[],"customfield_11700":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_11901":null,"versions":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/version/13700","id":"13700","description":"Eucalyptus 3.4.2","name":"3.4.2","archived":false,"released":true,"releaseDate":"2014-02-24"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/version/12806","id":"12806","description":"Eucalyptus 4.0.0","name":"4.0.0","archived":false,"released":true,"releaseDate":"2014-05-30"}],"issuelinks":[{"id":"25342","self":"https://eucalyptus.atlassian.net/rest/api/2/issueLink/25342","type":{"id":"10101","name":"Cloners","inward":"is cloned by","outward":"clones","self":"https://eucalyptus.atlassian.net/rest/api/2/issueLinkType/10101"},"outwardIssue":{"id":"29453","key":"EUCA-9296","self":"https://eucalyptus.atlassian.net/rest/api/2/issue/29453","fields":{"summary":"volumes leftover in SC database as \"available\" after multiple instances fail to run","status":{"self":"https://eucalyptus.atlassian.net/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://eucalyptus.atlassian.net/images/icons/statuses/generic.png","name":"Closed","id":"6","statusCategory":{"self":"https://eucalyptus.atlassian.net/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://eucalyptus.atlassian.net/rest/api/2/priority/1","iconUrl":"https://eucalyptus.atlassian.net/images/icons/priorities/blocker.svg","name":"Blocker","id":"1"},"issuetype":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://eucalyptus.atlassian.net/secure/viewavatar?size=xsmall&avatarId=14803&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":14803}}}}],"assignee":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=tony","name":"tony","key":"tony","accountId":"557058:353956db-b78c-4f3b-9096-f8f58e6709c8","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/14ec1b18e630cc0743492fc327a12df7?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dtony%26avatarId%3D16600%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/14ec1b18e630cc0743492fc327a12df7?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dtony%26avatarId%3D16600%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/14ec1b18e630cc0743492fc327a12df7?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dtony%26avatarId%3D16600%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/14ec1b18e630cc0743492fc327a12df7?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dtony%26avatarId%3D16600%26noRedirect%3Dtrue"},"displayName":"Tony Beckham","active":true,"timeZone":"America/Tijuana"},"updated":"2014-12-08T17:00:26.883-0600","status":{"self":"https://eucalyptus.atlassian.net/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://eucalyptus.atlassian.net/images/icons/statuses/generic.png","name":"Closed","id":"6","statusCategory":{"self":"https://eucalyptus.atlassian.net/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/component/10014","id":"10014","name":"Storage Controller"}],"timeoriginalestimate":null,"description":"Hi All,\r\n\r\nI am sharing simple steps in order to reproduce the problem in 4.0.0 with the storage backend set to any SAN device. I reproduce it on netapp. I think it is not related to the SAN backend. \r\n\r\nFirst of all the problem that we are trying to reproduce is\r\n\r\n'SC database leaves volumes in state 'Available' which are not known to the CLC'\r\n\r\na) Setup a 4.0.0 cloud with following topology\r\n\r\nCLC+UFS - 1 machine\r\nCC/SC - 1 machine\r\nNC - 1\r\nNetwork Mode - EDGE\r\nBlock device storage backend - Netapp\r\nObject storage backend - Walrus\r\n\r\nb) Configure the cloud with an HVM backed EBS image of size 3GB. I used ubuntu precise as my preferred choice of guest operating system\r\n\r\nc) Lower down the property for {{storage.maxtotalvolumesizeingb}} to 15 where default is 100.\r\n\r\nd) Run multiple new instances of this HVM backed EBS image at 1 request such that all of them combined would create volumes on the cloud that exceeds the limit set to the property.\r\n\r\nI ran 6 instances as that would cause a total of 18GB of volumes to be created on the cloud (image size is 3GB) hence causing a exceed of max total of all volumes set in the cloud.\r\n\r\n{code}\r\neuca-run-instances -k sshlogin -t m1.small -n 6 emi-5350d811\r\n{code}\r\n\r\ne) You will notice almost immediately all instances failed to get running, {{euca-describe-instances verbose}} does not show them up. Following is seen immediately after the {{euca-run-instances}} was issued:\r\n\r\n{code}\r\n[root@odc-d-06-02 ~]# euca-run-instances -k sshlogin -t m1.small -n 6 emi-5350d811\r\nRESERVATION\tr-5bc3deb3\t507133477975\tdefault\r\nINSTANCE\ti-5d096e1d\temi-5350d811\t\teuca-10-104-3-37.eucalyptus.internal\tpending\tsshlogin\t0\t\tm1.small\t2014-05-01T02:41:17.385Z\tcloud4\t\t\t\tmonitoring-disabled\t10.104.3.37\t10.104.3.37\t\t\tebs\t\t\t\t\thvm\t\t\tsg-3fd8d792\t\t\t\r\nINSTANCE\ti-174f3ea8\temi-5350d811\t\teuca-10-104-3-43.eucalyptus.internal\tpending\tsshlogin\t1\t\tm1.small\t2014-05-01T02:41:17.425Z\tcloud4\t\t\t\tmonitoring-disabled\t10.104.3.43\t10.104.3.43\t\t\tebs\t\t\t\t\thvm\t\t\tsg-3fd8d792\t\t\t\r\nINSTANCE\ti-5efd6aec\temi-5350d811\t\teuca-10-104-3-35.eucalyptus.internal\tpending\tsshlogin\t2\t\tm1.small\t2014-05-01T02:41:17.463Z\tcloud4\t\t\t\tmonitoring-disabled\t10.104.3.35\t10.104.3.35\t\t\tebs\t\t\t\t\thvm\t\t\tsg-3fd8d792\t\t\t\r\nINSTANCE\ti-69ea59e3\temi-5350d811\t\teuca-10-104-3-34.eucalyptus.internal\tpending\tsshlogin\t3\t\tm1.small\t2014-05-01T02:41:17.502Z\tcloud4\t\t\t\tmonitoring-disabled\t10.104.3.34\t10.104.3.34\t\t\tebs\t\t\t\t\thvm\t\t\tsg-3fd8d792\t\t\t\r\nINSTANCE\ti-15eca329\temi-5350d811\t\teuca-10-104-3-33.eucalyptus.internal\tpending\tsshlogin\t4\t\tm1.small\t2014-05-01T02:41:17.542Z\tcloud4\t\t\t\tmonitoring-disabled\t10.104.3.33\t10.104.3.33\t\t\tebs\t\t\t\t\thvm\t\t\tsg-3fd8d792\t\t\t\r\nINSTANCE\ti-b0c095cf\temi-5350d811\t\teuca-10-104-3-39.eucalyptus.internal\tpending\tsshlogin\t5\t\tm1.small\t2014-05-01T02:41:17.582Z\tcloud4\t\t\t\tmonitoring-disabled\t10.104.3.39\t10.104.3.39\t\t\tebs\t\t\t\t\thvm\t\t\tsg-3fd8d792\t\t\t\r\n{code}\r\n\r\nIn few seconds output of {{euca-describe-instances verbose}} becomes empty.\r\n\r\nThen following is seen in cloud-output.log of CLC\r\n\r\n{code}\r\n2014-04-30 19:41:18 ERROR 000004099 Volumes                  | Failed to create volume: com.eucalyptus.blockstorage.Volume@74a7df5a\r\n2014-04-30 19:41:18 ERROR 000004099 ClusterAllocator         | com.eucalyptus.entities.TransactionCallbackException: java.lang.RuntimeException: com.eucalyptus.ws.EucalyptusRemoteFault: Action:ProblemAction Code:CreateStorageVolumeType Id:RelatesTo Error: Total Volume Size Limit Exceeded volume: vol-5c54f597Total Volume Size Limit Exceeded volume: vol-5c54f597\r\n2014-04-30 19:41:19 ERROR 000004099 ClusterAllocator         | java.util.NoSuchElementException: example: [VmInstance networkConfig=null vmId=null bootRecord=null usageStats=null launchRecord=null runtimeState=null transientVolumeState=null placement=null expiration=null privateNetwork=null networkGroups=[] networkGroupIds=[] networkIndex=null tags=null ownerUserId=null ownerUserName=null ownerAccountNumber=null uniqueName=null ownerFullNameCached=null state=null lastState=null stateChangeStack=null displayName=i-5d096e1d id=null version=null creationTimestamp=null lastUpdateTimestamp=null naturalId=null]\r\n2014-04-30 19:41:19 ERROR 000004099 ClusterAllocator         | java.util.NoSuchElementException: example: [VmInstance networkConfig=null vmId=null bootRecord=null usageStats=null launchRecord=null runtimeState=null transientVolumeState=null placement=null expiration=null privateNetwork=null networkGroups=[] networkGroupIds=[] networkIndex=null tags=null ownerUserId=null ownerUserName=null ownerAccountNumber=null uniqueName=null ownerFullNameCached=null state=null lastState=null stateChangeStack=null displayName=i-174f3ea8 id=null version=null creationTimestamp=null lastUpdateTimestamp=null naturalId=null]\r\n2014-04-30 19:41:19 ERROR 000004099 ClusterAllocator         | java.util.NoSuchElementException: example: [VmInstance networkConfig=null vmId=null bootRecord=null usageStats=null launchRecord=null runtimeState=null transientVolumeState=null placement=null expiration=null privateNetwork=null networkGroups=[] networkGroupIds=[] networkIndex=null tags=null ownerUserId=null ownerUserName=null ownerAccountNumber=null uniqueName=null ownerFullNameCached=null state=null lastState=null stateChangeStack=null displayName=i-5efd6aec id=null version=null creationTimestamp=null lastUpdateTimestamp=null naturalId=null]\r\n2014-04-30 19:41:19 ERROR 000004099 ClusterAllocator         | java.util.NoSuchElementException: example: [VmInstance networkConfig=null vmId=null bootRecord=null usageStats=null launchRecord=null runtimeState=null transientVolumeState=null placement=null expiration=null privateNetwork=null networkGroups=[] networkGroupIds=[] networkIndex=null tags=null ownerUserId=null ownerUserName=null ownerAccountNumber=null uniqueName=null ownerFullNameCached=null state=null lastState=null stateChangeStack=null displayName=i-69ea59e3 id=null version=null creationTimestamp=null lastUpdateTimestamp=null naturalId=null]\r\n2014-04-30 19:41:19 ERROR 000004099 ClusterAllocator         | java.util.NoSuchElementException: example: [VmInstance networkConfig=null vmId=null bootRecord=null usageStats=null launchRecord=null runtimeState=null transientVolumeState=null placement=null expiration=null privateNetwork=null networkGroups=[] networkGroupIds=[] networkIndex=null tags=null ownerUserId=null ownerUserName=null ownerAccountNumber=null uniqueName=null ownerFullNameCached=null state=null lastState=null stateChangeStack=null displayName=i-15eca329 id=null version=null creationTimestamp=null lastUpdateTimestamp=null naturalId=null]\r\n2014-04-30 19:41:19 ERROR 000004099 ClusterAllocator         | java.util.NoSuchElementException: example: [VmInstance networkConfig=null vmId=null bootRecord=null usageStats=null launchRecord=null runtimeState=null transientVolumeState=null placement=null expiration=null privateNetwork=null networkGroups=[] networkGroupIds=[] networkIndex=null tags=null ownerUserId=null ownerUserName=null ownerAccountNumber=null uniqueName=null ownerFullNameCached=null state=null lastState=null stateChangeStack=null displayName=i-b0c095cf id=null version=null creationTimestamp=null lastUpdateTimestamp=null naturalId=null]\r\n{code}\r\n\r\nThen check the databases\r\n\r\nCLC\r\n\r\n{code}\r\neucalyptus_cloud=# select * from metadata_volumes;\r\n id | creation_timestamp | last_update_timestamp | metadata_perm_uuid | version | metadata_display_name | metadata_last_state | metadata_state | metadata_state_change_sta\r\nck | metadata_account_id | metadata_unique_name | metadata_user_id | metadata_user_name | metadata_volume_localdevice | metadata_volume_parentsnapshot | metadata_volume_p\r\nartition | metadata_volume_remotedevice | metadata_volume_sc_name | metadata_volume_size \r\n----+--------------------+-----------------------+--------------------+---------+-----------------------+---------------------+----------------+--------------------------\r\n---+---------------------+----------------------+------------------+--------------------+-----------------------------+--------------------------------+------------------\r\n---------+------------------------------+-------------------------+----------------------\r\n(0 rows)\r\n{code}\r\n\r\nSC\r\n{code}\r\neucalyptus_storage=# select * from volumes;\r\n                id                |   creation_timestamp    |  last_update_timestamp  |          metadata_perm_uuid          | version |       create_time       |      de\r\nletion_time      | sc_name | size |  snapshot_id  |  status   | volume_user_name | volume_name  | zone \r\n----------------------------------+-------------------------+-------------------------+--------------------------------------+---------+-------------------------+--------\r\n-----------------+---------+------+---------------+-----------+------------------+--------------+------\r\n 8ae8815445b39db10145b5a216d90022 | 2014-04-30 19:34:29.977 | 2014-04-30 19:37:54.489 | ff0c9f73-386e-4e4a-8bcb-9ea99c8f6870 |       3 | 2014-04-30 19:34:29.977 | 2014-04\r\n-30 19:37:54.488 | cloud4  |    3 | snap-d8de081b | deleted   | eucalyptus       | vol-1154668e | \r\n 8ae8815445b39db10145b54c57310012 | 2014-04-30 18:00:50.353 | 2014-04-30 19:38:54.308 | 8ca6d2f3-b8d0-429e-bf99-971e037d1d11 |       3 | 2014-04-30 18:00:50.353 | 2014-04\r\n-30 19:38:54.308 | cloud4  |    1 |               | deleted   | eucalyptus       | vol-0d0f8478 | \r\n 8ae8815445b39db10145b561bb820014 | 2014-04-30 18:24:12.29  | 2014-04-30 19:38:54.734 | 2a3c0cab-fcc4-448a-ae68-fe38bdf2bebd |       3 | 2014-04-30 18:24:12.289 | 2014-04\r\n-30 19:38:54.733 | cloud4  |    3 |               | deleted   | eucalyptus       | vol-5030f3eb | \r\n 8ae8815445b39db10145b5a84fc20026 | 2014-04-30 19:41:17.762 | 2014-04-30 19:42:00.02  | 7ceda4c0-0a7a-4e5d-a7cb-7309dda646fe |       1 | 2014-04-30 19:41:17.762 |        \r\n                 | cloud4  |    3 | snap-d8de081b | available | eucalyptus       | vol-c3eca2d7 | \r\n 8ae8815445b39db10145b5a850fa002a | 2014-04-30 19:41:18.074 | 2014-04-30 19:42:10.199 | b675de92-2572-436d-95c6-e3bc3fa627a0 |       1 | 2014-04-30 19:41:18.074 |        \r\n                 | cloud4  |    3 | snap-d8de081b | available | eucalyptus       | vol-5dfe29a1 | \r\n 8ae8815445b39db10145b5a8505a0028 | 2014-04-30 19:41:17.914 | 2014-04-30 19:42:29.822 | 9681c3ce-9124-4d0b-8457-1747d7645576 |       1 | 2014-04-30 19:41:17.914 |        \r\n                 | cloud4  |    3 | snap-d8de081b | available | eucalyptus       | vol-8df2f180 | \r\n 8ae8815445b39db10145b5a85183002c | 2014-04-30 19:41:18.211 | 2014-04-30 19:42:30.705 | a8890225-ab5f-48a3-ba14-d3a961efd8e5 |       1 | 2014-04-30 19:41:18.211 |        \r\n                 | cloud4  |    3 | snap-d8de081b | available | eucalyptus       | vol-198c17d0 | \r\n 8ae8815445b39db10145b5a85200002e | 2014-04-30 19:41:18.336 | 2014-04-30 19:42:34.636 | a4cd68cc-e10b-4dbe-9c25-81838850c063 |       1 | 2014-04-30 19:41:18.336 |        \r\n                 | cloud4  |    3 | snap-d8de081b | available | eucalyptus       | vol-6fb1a2a5 | \r\n(8 rows)\r\n{code}\r\n\r\nIf we look at the CLC there are no volumes on the cloud because all instances failed to get created. On the SC however we have recorded volumes that are marked as available causing the accounting to provide incorrect result, see below:\r\n\r\n{code}\r\neucalyptus_storage=# select sum(size) from volumes where status<>'deleted';\r\n sum \r\n-----\r\n  15\r\n(1 row)\r\n{code}\r\n\r\nNow according to the CLC I can create volumes but according to the SC I cannot create volumes, here:\r\n\r\n{code}\r\n[root@odc-d-06-02 ~]# euca-create-volume -s 1 -z cloud4\r\neuca-create-volume: error (CreateStorageVolumeType): Total Volume Size Limit Exceeded volume: vol-5d6e38e8\r\n[root@odc-d-06-02 ~]# euca-describe-volumes verbose\r\n{code}\r\n\r\nThis is the problem that needs to be fixed. I hope the above simple steps to reproduce the problem will help in finding the root cause of the issue. Please let me know if you have any additional questions.\r\n\r\nCheers!\r\nDeependra","customfield_13000":null,"customfield_13200":null,"customfield_11300":null,"customfield_11500":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=sjones","name":"sjones","key":"sjones","accountId":"557058:f5dce1b0-db45-4dd6-a0e8-3cea5effb5ce","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue"},"displayName":"Steve Jones","active":true,"timeZone":"America/Los_Angeles"},"timetracking":{},"customfield_10005":null,"customfield_10401":null,"customfield_10600":null,"customfield_12900":null,"aggregatetimeestimate":null,"attachment":[],"summary":"CLONE - for 4.0.1 - volumes leftover in SC database as \"available\" after multiple instances fail to run","creator":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=sjones","name":"sjones","key":"sjones","accountId":"557058:f5dce1b0-db45-4dd6-a0e8-3cea5effb5ce","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue"},"displayName":"Steve Jones","active":true,"timeZone":"America/Los_Angeles"},"subtasks":[],"reporter":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=sjones","name":"sjones","key":"sjones","accountId":"557058:f5dce1b0-db45-4dd6-a0e8-3cea5effb5ce","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue"},"displayName":"Steve Jones","active":true,"timeZone":"America/Los_Angeles"},"customfield_10000":"3_*:*_1_*:*_64256_*|*_10001_*:*_1_*:*_624585573_*|*_10000_*:*_1_*:*_1027748_*|*_10006_*:*_1_*:*_0_*|*_10003_*:*_1_*:*_1448476161","aggregateprogress":{"progress":0,"total":0},"customfield_12100":"0|i02sin:","customfield_10001":"2014-07-14T18:33:25.986-0500","customfield_10200":null,"customfield_10002":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/10000","value":"Customer Affecting","id":"10000"}],"customfield_10003":null,"customfield_10400":null,"customfield_12500":null,"customfield_10116":null,"customfield_11600":["sjones(sjones)","tony(tony)"],"customfield_10117":null,"environment":null,"customfield_11800":null,"customfield_11802":null,"customfield_11805":null,"duedate":null,"customfield_11806":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/30863/comment/73027","id":"73027","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=sjones","name":"sjones","key":"sjones","accountId":"557058:f5dce1b0-db45-4dd6-a0e8-3cea5effb5ce","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue"},"displayName":"Steve Jones","active":true,"timeZone":"America/Los_Angeles"},"body":"Fixed pushed to 4.0 testing:\r\n\r\nhttps://github.com/eucalyptus/eucalyptus/commit/8bbd94dfafab8f5f93c7aa6e0d4dd4d921c71b0b\r\n\r\nhttps://github.com/eucalyptus/eucalyptus/commit/c72ec7aacb4a299c971c711a26b3e4d3311587da\r\n\r\nhttps://github.com/eucalyptus/eucalyptus/commit/df927b2ef986b09a93147d2028033a1a1c22ad83","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=sjones","name":"sjones","key":"sjones","accountId":"557058:f5dce1b0-db45-4dd6-a0e8-3cea5effb5ce","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue"},"displayName":"Steve Jones","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-06-28T00:12:09.825-0500","updated":"2014-06-28T00:12:09.825-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/30863/comment/73749","id":"73749","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=tony","name":"tony","key":"tony","accountId":"557058:353956db-b78c-4f3b-9096-f8f58e6709c8","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/14ec1b18e630cc0743492fc327a12df7?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dtony%26avatarId%3D16600%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/14ec1b18e630cc0743492fc327a12df7?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dtony%26avatarId%3D16600%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/14ec1b18e630cc0743492fc327a12df7?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dtony%26avatarId%3D16600%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/14ec1b18e630cc0743492fc327a12df7?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dtony%26avatarId%3D16600%26noRedirect%3Dtrue"},"displayName":"Tony Beckham","active":true,"timeZone":"America/Tijuana"},"body":"Fix Verified.\r\n\r\nInstalled Packages\r\nName        : eucalyptus\r\nArch        : x86_64\r\nVersion     : 4.0.1\r\nRelease     : 0.0.22219.22.20140713git7ec100e.el6\r\n\r\nIn the given scenario where there is not enough capacity for the desired reservation, the CLC and SC have matching views of volumes present in the system after the operation completes.","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=tony","name":"tony","key":"tony","accountId":"557058:353956db-b78c-4f3b-9096-f8f58e6709c8","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/14ec1b18e630cc0743492fc327a12df7?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dtony%26avatarId%3D16600%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/14ec1b18e630cc0743492fc327a12df7?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dtony%26avatarId%3D16600%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/14ec1b18e630cc0743492fc327a12df7?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dtony%26avatarId%3D16600%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/14ec1b18e630cc0743492fc327a12df7?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dtony%26avatarId%3D16600%26noRedirect%3Dtrue"},"displayName":"Tony Beckham","active":true,"timeZone":"America/Tijuana"},"created":"2014-07-14T18:33:25.986-0500","updated":"2014-07-14T18:33:25.986-0500"}],"maxResults":2,"total":2,"startAt":0},"votes":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/EUCA-9574/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_11808":null}}
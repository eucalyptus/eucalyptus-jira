{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"45805","self":"https://eucalyptus.atlassian.net/rest/api/2/issue/45805","key":"EUCA-12547","fields":{"issuetype":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://eucalyptus.atlassian.net/secure/viewavatar?size=xsmall&avatarId=14803&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":14803},"timespent":null,"customfield_13100":null,"project":{"self":"https://eucalyptus.atlassian.net/rest/api/2/project/10000","id":"10000","key":"EUCA","name":"Eucalyptus","avatarUrls":{"48x48":"https://eucalyptus.atlassian.net/secure/projectavatar?pid=10000&avatarId=10011","24x24":"https://eucalyptus.atlassian.net/secure/projectavatar?size=small&pid=10000&avatarId=10011","16x16":"https://eucalyptus.atlassian.net/secure/projectavatar?size=xsmall&pid=10000&avatarId=10011","32x32":"https://eucalyptus.atlassian.net/secure/projectavatar?size=medium&pid=10000&avatarId=10011"}},"customfield_11000":null,"fixVersions":[],"customfield_11001":null,"aggregatetimespent":null,"resolution":{"self":"https://eucalyptus.atlassian.net/rest/api/2/resolution/6","id":"6","description":"The product is working as designed.","name":"Not a Bug"},"customfield_10310":null,"customfield_10311":null,"customfield_11401":null,"customfield_11400":null,"customfield_10302":null,"customfield_10104":[],"customfield_10500":{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/10403","value":"Not Applicable","id":"10403"},"customfield_10105":null,"customfield_10303":null,"customfield_10700":null,"customfield_10304":null,"customfield_10701":null,"customfield_10306":null,"customfield_10702":null,"customfield_10703":null,"customfield_10308":null,"resolutiondate":"2016-07-08T16:04:25.364-0500","customfield_10704":null,"customfield_10309":null,"customfield_10705":null,"workratio":-1,"watches":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/EUCA-12547/watchers","watchCount":1,"isWatching":false},"lastViewed":null,"created":"2016-07-08T15:33:14.857-0500","customfield_12000":null,"customfield_12400":null,"priority":{"self":"https://eucalyptus.atlassian.net/rest/api/2/priority/3","iconUrl":"https://eucalyptus.atlassian.net/images/icons/priorities/major.svg","name":"Major","id":"3"},"customfield_12201":null,"customfield_10102":null,"customfield_10300":null,"customfield_12600":"{}","labels":[],"customfield_10301":null,"customfield_11700":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_11901":null,"versions":[],"issuelinks":[{"id":"40401","self":"https://eucalyptus.atlassian.net/rest/api/2/issueLink/40401","type":{"id":"10103","name":"Relates","inward":"relates to","outward":"relates to","self":"https://eucalyptus.atlassian.net/rest/api/2/issueLinkType/10103"},"outwardIssue":{"id":"40625","key":"EUCA-11951","self":"https://eucalyptus.atlassian.net/rest/api/2/issue/40625","fields":{"summary":"ENI: src/dst attribute support","status":{"self":"https://eucalyptus.atlassian.net/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://eucalyptus.atlassian.net/images/icons/statuses/generic.png","name":"Closed","id":"6","statusCategory":{"self":"https://eucalyptus.atlassian.net/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://eucalyptus.atlassian.net/rest/api/2/priority/3","iconUrl":"https://eucalyptus.atlassian.net/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issuetype/7","id":"7","description":"A user story. Created by JIRA Software - do not edit or delete.","iconUrl":"https://eucalyptus.atlassian.net/secure/viewavatar?size=xsmall&avatarId=14815&avatarType=issuetype","name":"Story","subtask":false,"avatarId":14815}}}}],"assignee":null,"updated":"2016-07-08T16:04:25.375-0500","status":{"self":"https://eucalyptus.atlassian.net/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://eucalyptus.atlassian.net/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://eucalyptus.atlassian.net/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[],"timeoriginalestimate":null,"description":"I have two instances i-1 (10.116.154.231) and i-2 (10.116.154.214) in a subnet.\r\ni-1 is running tcpdump -nni eth0 icmp\r\nIf i-2's EMI source-dest-check is set to false i am getting\r\n{code}\r\n[root@euca-172-31-17-30 cloud-user]# hping3 --rand-source 10.116.154.231 --icmp\r\nHPING 10.116.154.231 (eth0 10.116.154.231): icmp mode set, 28 headers + 0 data bytes\r\nICMP Network Unreachable from ip=172.31.17.17 name=UNKNOWN   \r\nICMP Network Unreachable from ip=172.31.17.17 name=UNKNOWN \r\n{code}\r\nIf i-2's EMI source-dest-check is set to true i am getting\r\n{code}\r\n[root@euca-172-31-17-30 cloud-user]# hping3 --rand-source 10.116.154.231 --icmp\r\nHPING 10.116.154.231 (eth0 10.116.154.231): icmp mode set, 28 headers + 0 data bytes\r\n\r\n\r\n^C\r\n--- 10.116.154.231 hping statistic ---\r\n10 packets transmitted, 0 packets received, 100% packet loss\r\n{code}\r\nBut i-1 does not log any requests\r\nIf I run \r\n{code}\r\n[root@euca-172-31-17-30 cloud-user]# hping3  10.116.154.231 --icmp\r\nHPING 10.116.154.231 (eth0 10.116.154.231): icmp mode set, 28 headers + 0 data bytes\r\nlen=28 ip=10.116.154.231 ttl=61 id=60874 icmp_seq=0 rtt=1.1 ms\r\nlen=28 ip=10.116.154.231 ttl=61 id=60875 icmp_seq=1 rtt=1.1 ms\r\nlen=28 ip=10.116.154.231 ttl=61 id=60876 icmp_seq=2 rtt=0.8 ms\r\n{code}\r\nI-1 logs requests from i-2\r\n{code}\r\n[cloud-user@euca-172-31-17-28 ~]$ sudo tcpdump -nni eth0 icmp\r\ntcpdump: verbose output suppressed, use -v or -vv for full protocol decode\r\nlistening on eth0, link-type EN10MB (Ethernet), capture size 65535 bytes\r\n20:30:12.049299 IP 10.116.154.214 > 172.31.17.28: ICMP echo request, id 3116, seq 1024, length 8\r\n20:30:12.049323 IP 172.31.17.28 > 10.116.154.214: ICMP echo reply, id 3116, seq 1024, length 8\r\n20:30:13.049386 IP 10.116.154.214 > 172.31.17.28: ICMP echo request, id 3116, seq 1280, length 8\r\n20:30:13.049414 IP 172.31.17.28 > 10.116.154.214: ICMP echo reply, id 3116, seq 1280, length 8\r\n{code}\r\n\r\nSystem works as designed if I use i-1's private IPs\r\n\r\nWith i-2's source-dest-check set to false i-1 logs\r\n{code}\r\n[cloud-user@euca-172-31-17-28 ~]$ sudo tcpdump -nni eth0 icmp\r\ntcpdump: verbose output suppressed, use -v or -vv for full protocol decode\r\nlistening on eth0, link-type EN10MB (Ethernet), capture size 65535 bytes\r\n20:44:13.226729 IP 209.26.178.229 > 172.31.17.28: ICMP echo request, id 22060, seq 3072, length 8\r\n20:44:13.226771 IP 172.31.17.28 > 209.26.178.229: ICMP echo reply, id 22060, seq 3072, length 8\r\n20:44:14.226915 IP 43.230.29.247 > 172.31.17.28: ICMP echo request, id 22060, seq 3328, length 8\r\n20:44:14.226960 IP 172.31.17.28 > 43.230.29.247: ICMP echo reply, id 22060, seq 3328, length 8\r\n20:44:36.795641 IP 10.116.154.214 > 172.31.17.28: ICMP echo request, id 11351, seq 1, length 64\r\n20:44:36.795683 IP 172.31.17.28 > 10.116.154.214: ICMP echo reply, id 11351, seq 1, length 64\r\n20:45:04.899351 IP 62.109.71.86 > 172.31.17.28: ICMP echo request, id 22572, seq 0, length 8\r\n20:45:04.899389 IP 172.31.17.28 > 62.109.71.86: ICMP echo reply, id 22572, seq 0, length 8\r\n20:45:05.899512 IP 68.77.154.83 > 172.31.17.28: ICMP echo request, id 22572, seq 256, length 8\r\n20:45:05.899547 IP 172.31.17.28 > 68.77.154.83: ICMP echo reply, id 22572, seq 256, length 8\r\n20:45:06.899546 IP 193.175.157.239 > 172.31.17.28: ICMP echo request, id 22572, seq 512, length 8\r\n20:45:06.899577 IP 172.31.17.28 > 193.175.157.239: ICMP echo reply, id 22572, seq 512, length 8\r\n20:45:07.899598 IP 58.101.122.167 > 172.31.17.28: ICMP echo request, id 22572, seq 768, length 8\r\n{code}\r\n","customfield_13000":null,"customfield_13200":null,"customfield_11300":null,"customfield_11500":null,"timetracking":{},"customfield_10005":null,"customfield_10401":null,"customfield_10600":null,"customfield_12900":null,"aggregatetimeestimate":null,"attachment":[],"summary":"Source ENI check does not seems to be working","creator":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=vasya","name":"vasya","key":"vasya","accountId":"557058:1c63481a-0634-4ae7-9004-cb0f143e141f","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/fa832ffa4e20c9aa05ac272214d43196?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dvasya%26avatarId%3D10408%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/fa832ffa4e20c9aa05ac272214d43196?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dvasya%26avatarId%3D10408%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/fa832ffa4e20c9aa05ac272214d43196?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dvasya%26avatarId%3D10408%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/fa832ffa4e20c9aa05ac272214d43196?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dvasya%26avatarId%3D10408%26noRedirect%3Dtrue"},"displayName":"Vasiliy Kochergin","active":false,"timeZone":"America/Los_Angeles"},"subtasks":[],"reporter":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=vasya","name":"vasya","key":"vasya","accountId":"557058:1c63481a-0634-4ae7-9004-cb0f143e141f","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/fa832ffa4e20c9aa05ac272214d43196?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dvasya%26avatarId%3D10408%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/fa832ffa4e20c9aa05ac272214d43196?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dvasya%26avatarId%3D10408%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/fa832ffa4e20c9aa05ac272214d43196?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dvasya%26avatarId%3D10408%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/fa832ffa4e20c9aa05ac272214d43196?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dvasya%26avatarId%3D10408%26noRedirect%3Dtrue"},"displayName":"Vasiliy Kochergin","active":false,"timeZone":"America/Los_Angeles"},"customfield_12100":"0|i03utr:","aggregateprogress":{"progress":0,"total":0},"customfield_10000":"5_*:*_1_*:*_0_*|*_10000_*:*_1_*:*_1870520","customfield_10001":"2016-07-08T16:04:25.373-0500","customfield_10002":null,"customfield_10200":null,"customfield_10003":null,"customfield_12500":null,"customfield_10400":null,"customfield_10116":null,"customfield_11600":["tsugawa(tsugawa)","vasya(vasya)"],"environment":null,"customfield_10117":null,"customfield_11800":null,"customfield_11802":null,"duedate":null,"customfield_11805":null,"progress":{"progress":0,"total":0},"customfield_11806":null,"votes":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/EUCA-12547/votes","votes":0,"hasVoted":false},"comment":{"comments":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/45805/comment/106530","id":"106530","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=tsugawa","name":"tsugawa","key":"tsugawa","accountId":"557058:619bab88-9b87-4778-995a-1e8a85d8b899","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/c16b1da4b6426cad544b6eddd78d76b1?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FavatarId%3D10122%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/c16b1da4b6426cad544b6eddd78d76b1?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26avatarId%3D10122%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/c16b1da4b6426cad544b6eddd78d76b1?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26avatarId%3D10122%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/c16b1da4b6426cad544b6eddd78d76b1?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26avatarId%3D10122%26noRedirect%3Dtrue"},"displayName":"M Tsugawa","active":true,"timeZone":"America/New_York"},"body":"From the description, the behavior is expected.\r\n\r\n\"Network Unreachable\" in is returned by the VPC router (172.31.17.17) since the packet generated by hping have a public IP as source address. NAT rules will not match, and VPC router will be unable to route to the destination (instance's public IP), since internal routing is based on private IPs. NAT only takes place if the source IP lies within VPC's CIDR.\r\n\r\nSetting source-dest-check flag to true will block packets before entering routing phase, so there is no icmp response back from VPC router.\r\n\r\nWithout source IP spoofing, packets will go through regardless of src/dst check flag.\r\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=tsugawa","name":"tsugawa","key":"tsugawa","accountId":"557058:619bab88-9b87-4778-995a-1e8a85d8b899","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/c16b1da4b6426cad544b6eddd78d76b1?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FavatarId%3D10122%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/c16b1da4b6426cad544b6eddd78d76b1?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26avatarId%3D10122%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/c16b1da4b6426cad544b6eddd78d76b1?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26avatarId%3D10122%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/c16b1da4b6426cad544b6eddd78d76b1?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26avatarId%3D10122%26noRedirect%3Dtrue"},"displayName":"M Tsugawa","active":true,"timeZone":"America/New_York"},"created":"2016-07-08T16:04:25.373-0500","updated":"2016-07-08T16:04:25.373-0500"}],"maxResults":1,"total":1,"startAt":0},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_11808":null}}
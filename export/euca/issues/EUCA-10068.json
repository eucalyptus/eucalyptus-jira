{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"32925","self":"https://eucalyptus.atlassian.net/rest/api/2/issue/32925","key":"EUCA-10068","fields":{"issuetype":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://eucalyptus.atlassian.net/secure/viewavatar?size=xsmall&avatarId=14803&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":14803},"timespent":null,"customfield_13100":null,"project":{"self":"https://eucalyptus.atlassian.net/rest/api/2/project/10000","id":"10000","key":"EUCA","name":"Eucalyptus","avatarUrls":{"48x48":"https://eucalyptus.atlassian.net/secure/projectavatar?pid=10000&avatarId=10011","24x24":"https://eucalyptus.atlassian.net/secure/projectavatar?size=small&pid=10000&avatarId=10011","16x16":"https://eucalyptus.atlassian.net/secure/projectavatar?size=xsmall&pid=10000&avatarId=10011","32x32":"https://eucalyptus.atlassian.net/secure/projectavatar?size=medium&pid=10000&avatarId=10011"}},"customfield_11000":null,"fixVersions":[],"customfield_11001":null,"aggregatetimespent":null,"customfield_10310":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/10209","value":"CentOS 6","id":"10209"}],"resolution":{"self":"https://eucalyptus.atlassian.net/rest/api/2/resolution/2","id":"2","description":"The problem described is an issue which will never be fixed.","name":"Won't Fix"},"customfield_11401":null,"customfield_10311":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/10308","value":"Managed-NOVLAN","id":"10308"}],"customfield_11400":null,"customfield_10104":[],"customfield_10302":null,"customfield_10500":{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/10402","value":"Internal","id":"10402"},"customfield_10303":null,"customfield_10105":{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/10101","value":"No","id":"10101"},"customfield_10304":null,"customfield_10700":null,"customfield_10701":null,"customfield_10702":null,"customfield_10306":{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/10200","value":"High","id":"10200"},"customfield_10703":null,"customfield_10308":null,"customfield_10704":null,"resolutiondate":"2015-05-29T12:23:29.576-0500","customfield_10309":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/10204","value":"KVM","id":"10204"}],"customfield_10705":null,"workratio":-1,"watches":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/EUCA-10068/watchers","watchCount":4,"isWatching":false},"lastViewed":null,"created":"2014-10-13T22:03:07.209-0500","customfield_12000":null,"customfield_12400":null,"priority":{"self":"https://eucalyptus.atlassian.net/rest/api/2/priority/3","iconUrl":"https://eucalyptus.atlassian.net/images/icons/priorities/major.svg","name":"Major","id":"3"},"customfield_12201":null,"customfield_10102":null,"customfield_10300":null,"customfield_12600":"{}","labels":["AWSCompat-PM"],"customfield_10301":null,"customfield_11700":null,"aggregatetimeoriginalestimate":null,"timeestimate":null,"versions":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/version/14205","id":"14205","description":"Eucalyptus 4.0.1","name":"4.0.1","archived":false,"released":true,"releaseDate":"2014-08-13"}],"customfield_11901":null,"issuelinks":[{"id":"27600","self":"https://eucalyptus.atlassian.net/rest/api/2/issueLink/27600","type":{"id":"10103","name":"Relates","inward":"relates to","outward":"relates to","self":"https://eucalyptus.atlassian.net/rest/api/2/issueLinkType/10103"},"inwardIssue":{"id":"33102","key":"EUCA-10091","self":"https://eucalyptus.atlassian.net/rest/api/2/issue/33102","fields":{"summary":"Eucalyptus Load Balancer Doesn't Add ELB Unique Cookie When Application-Controlled Session Stickiness ","status":{"self":"https://eucalyptus.atlassian.net/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://eucalyptus.atlassian.net/images/icons/statuses/generic.png","name":"Closed","id":"6","statusCategory":{"self":"https://eucalyptus.atlassian.net/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://eucalyptus.atlassian.net/rest/api/2/priority/2","iconUrl":"https://eucalyptus.atlassian.net/images/icons/priorities/critical.svg","name":"Critical","id":"2"},"issuetype":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://eucalyptus.atlassian.net/secure/viewavatar?size=xsmall&avatarId=14803&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":14803}}}},{"id":"27414","self":"https://eucalyptus.atlassian.net/rest/api/2/issueLink/27414","type":{"id":"10103","name":"Relates","inward":"relates to","outward":"relates to","self":"https://eucalyptus.atlassian.net/rest/api/2/issueLinkType/10103"},"inwardIssue":{"id":"32838","key":"GUI-1359","self":"https://eucalyptus.atlassian.net/rest/api/2/issue/32838","fields":{"summary":"Support ELB+Autoscaling deployments of the Management Console on Eucalyptus","status":{"self":"https://eucalyptus.atlassian.net/rest/api/2/status/10001","description":"This issue has been validated/reproduced, but has not been prioritized yet.","iconUrl":"https://eucalyptus.atlassian.net/images/icons/statuses/generic.png","name":"Confirmed","id":"10001","statusCategory":{"self":"https://eucalyptus.atlassian.net/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"priority":{"self":"https://eucalyptus.atlassian.net/rest/api/2/priority/3","iconUrl":"https://eucalyptus.atlassian.net/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issuetype/4","id":"4","description":"An improvement or enhancement to an existing feature or task.","iconUrl":"https://eucalyptus.atlassian.net/secure/viewavatar?size=xsmall&avatarId=14810&avatarType=issuetype","name":"Improvement","subtask":false,"avatarId":14810}}}}],"assignee":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=spark","name":"spark","key":"spark","accountId":"557058:2ed923b8-7172-41f0-a425-8796bd9a62f9","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/fec440044f6e652174838d59d9233f29?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dspark%26avatarId%3D10900%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/fec440044f6e652174838d59d9233f29?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dspark%26avatarId%3D10900%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/fec440044f6e652174838d59d9233f29?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dspark%26avatarId%3D10900%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/fec440044f6e652174838d59d9233f29?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dspark%26avatarId%3D10900%26noRedirect%3Dtrue"},"displayName":"Sang-Min Park","active":false,"timeZone":"America/Los_Angeles"},"updated":"2016-06-06T16:32:56.477-0500","status":{"self":"https://eucalyptus.atlassian.net/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://eucalyptus.atlassian.net/images/icons/statuses/generic.png","name":"Closed","id":"6","statusCategory":{"self":"https://eucalyptus.atlassian.net/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/component/10201","id":"10201","name":"AWS Compatibility"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/component/11500","id":"11500","name":"ELB","description":"Load Balancing"}],"timeoriginalestimate":null,"customfield_13000":null,"description":"*Assessment*\r\n\r\nOn AWS, an ELB can support both duration-based session stickiness and application-specific session stickiness policies being applied on the same load balancer port.  Eucalyptus ELB will show that the policies have been applied, however when testing using curl there are not multiple 'Set-Cookie' headers as seen with AWS ELB.\r\n\r\n*Details - Comparison of ELBs*\r\n\r\n_AWS_\r\n\r\n* Load balancer with policies\r\n{code}\r\n$ aws elb describe-load-balancers --profile harold-work\r\nLOADBALANCERDESCRIPTIONS\thasp-euca-2147073422.us-east-1.elb.amazonaws.com\tZ3DZXE0Q79N41H\t2014-10-09T14:23:56.810Z\thasp-euca-2147073422.us-east-1.elb.amazonaws.com\thasp-euca\tinternet-facing\r\nAVAILABILITYZONES\tus-east-1a\r\nHEALTHCHECK\t10\t30\tTCP:8888\t5\t2\r\nINSTANCES\ti-968cc878\r\nLISTENER\t8888\tHTTP\t443\tHTTPS\tarn:aws:iam::048212016277:server-certificate/Harold-Jr-Server-Cert\r\nPOLICYNAMES\tHaspDurationStickyPolicy\r\nPOLICYNAMES\tELBSecurityPolicy-2014-01\r\nAPPCOOKIESTICKINESSPOLICIES\teucaconsole_session\tEucaManagementConsolePolicy\r\nLBCOOKIESTICKINESSPOLICIES\t30\tHaspDurationStickyPolicy\r\nOTHERPOLICIES\tELBSecurityPolicy-2014-01\r\nSOURCESECURITYGROUP\tamazon-elb-sg\tamazon-elb\r\n{code}\r\n* Result of 'curl' output\r\n{code}\r\n$ curl -I -k https://hasp-euca-2147073422.us-east-1.elb.amazonaws.com\r\nHTTP/1.1 200 OK\r\nCACHE-CONTROL: NO-CACHE\r\nCache-control: no-cache=\"set-cookie\"\r\nContent-length: 16467\r\nContent-Type: text/html; charset=UTF-8\r\nDate: Mon, 13 Oct 2014 21:25:58 GMT\r\nPRAGMA: NO-CACHE\r\nServer: gunicorn/18.0\r\nSet-Cookie: eucaconsole_session=63629ce5691875d29a7d2269475e269a991277305RQhVBIcPu6OSfPNs5PkZvrOYcU4XX26lK6p7OEg3RIwuil9Z2BlQ1ICYLXN2rcmWDQnELONIHtXoC++bZojQDJxnJPrLzJHtVAoJcLozH8CYAq1Ivw8xkmwYlV9XBzuIjTLLbx6tWlv8Hc5hE3c34Qjpt/uUNHZjNAJRY31Cwr3e5yYyPyv5ZU3TMd8BWPpomu4YOqSd6j101TT4EykXo7YpLV4Rds17wgkEAiOhc0IASyXl6vvfdOWt0lXA8hfuQa58WO+YA8BagCeZpIaQgDlF3KYIvoOqgqJ813hUgMStQyHEV0=; expires=Tue, 14-Oct-2014 09:25:58 GMT; Path=/; secure\r\nSet-Cookie: AWSELB=1D6D6BCF12E56BD42FE753CA9ACA34B394EB2AA24A0580D9516B00B074CE588DFC4DAC76D7B8FCC06AA2B930B68B9ECC42F61F939A4833187834681446616FB45DFB3CF20C;PATH=/;MAX-AGE=30\r\nX-FRAME-OPTIONS: SAMEORIGIN\r\nConnection: keep-alive\r\n{code}\r\n\r\n_Eucalyptus_\r\n\r\n* Load balancer with policies\r\n{code}\r\n# eulb-describe-lbs --region account2-user11@ --show-long\r\nLOAD_BALANCER\tMultiPolicy\tMultiPolicy-325271821652.eulb.future.euca-hasp.cs.prc.eucalyptus-systems.com\t\t\t{interval=30,target=TCP:8888,timeout=5,healthy-threshold=3,unhealthy-threshold=2}\tHonest\t\t\ti-454aea95\t{protocol=HTTP,lb-port=80,instance-protocol=HTTP,instance-port=8888,{EucaManagementConsolePolicy}}\t\t{policy-name=EucaManagementConsolePolicy,cookie-name=eucaconsole_session}\t{policy-name=LBCookiePolicy,expiration-period=30}\t\t{owner-alias=094999295155,group-name=euca-internal-325271821652-MultiPolicy}\t\t2014-10-13T20:47:22.601Z\r\n{code}\r\n* Result of 'curl' output\r\n{code}\r\n# curl -I http://MultiPolicy-325271821652.eulb.future.euca-hasp.cs.prc.eucalyptus-systems.com\r\nHTTP/1.1 200 OK\r\nServer: gunicorn/18.0\r\nDate: Mon, 13 Oct 2014 23:19:44 GMT\r\nConnection: keep-alive\r\nContent-Type: text/html; charset=UTF-8\r\nContent-Length: 16634\r\nX-FRAME-OPTIONS: SAMEORIGIN\r\nPRAGMA: NO-CACHE\r\nCACHE-CONTROL: NO-CACHE\r\nSet-Cookie: eucaconsole_session=79fed0e3911a239342b34517f6d5e519d8e19f9aYsNUUDhecOE5oUQdoVKyF4DINo7cksgLdoNQHWPmjQ5NnADQWYuepF5UGn5VJ+Vis9GOxklUYOIJNApoENJqd150M+WKsZF1ouXUqKU2rQX394bQ8MNrgz0U1poph58jefMxbe9vRBDIMjrO7YhPBr1wGNQ48r3PTso1R78lo9pkV0o0tkWhmzaa7/nrlZPrIi4zZ7aHKix6U+NBozSZO4YfHo1TLQ5HcojGntWjLN50BtA9OopQwnAbU9TgW9MHyHLPlO6hWY2KvKDyod+F3sSmzCYrtvwd/ZjmdsDz/CHFWt5aKYY=; expires=Tue, 14-Oct-2014 11:19:44 GMT; Path=/\r\n{code}\r\n\r\nComparing the AWS ELB curl output to the Eucalyptus ELB output, AWS returns two 'Set-Cookie' headers, while Eucalyptus returns only one.  Per [AWS  ELB documentation|http://docs.aws.amazon.com/ElasticLoadBalancing/latest/DeveloperGuide/TerminologyandKeyConcepts.html#session-stickiness], we should be able to return two:\r\n{quote}\r\nAn application instance must always receive and send two cookies: A cookie that defines the stickiness duration and a special Elastic Load Balancing cookie named AWSELB, that has the mapping to the application instance.\r\n{quote}\r\n\r\n* Looking at the haproxy configuration file on the Eucalyptus ELB, we only contain configuration for the application-specific session stickiness, but not the duration-based session stickiness.\r\n{code}\r\n# cat /var/lib/load-balancer-servo/euca_haproxy.conf\r\nglobal\r\n  maxconn 100000\r\n  ulimit-n 655360\r\n  pidfile /var/run/haproxy.pid\r\n  #drop privileges after port binding\r\n  user servo\r\n  group servo\r\n\r\ndefaults\r\n  timeout connect 5s\r\n  timeout client 50s\r\n  timeout server 50s\r\n  timeout queue 1m\r\n  timeout check 5s\r\n  retries 3\r\n  option dontlognull\r\n  option redispatch\r\n\r\nfrontend http-80\r\n  # lb-MultiPolicy\r\n  mode http\r\n  option forwardfor except 127.0.0.1\r\n  timeout http-keep-alive 5ms\r\n  timeout http-keep-alive 50ms\r\n  reqadd X-Forwarded-Proto:\\ http\r\n  reqadd X-Forwarded-Port:\\ 80\r\n  bind 0.0.0.0:80\r\n  log /var/lib/load-balancer-servo/haproxy.sock local2 info\r\n  log-format httplog\\ %f\\ %b\\ %s\\ %ST\\ %ts\\ %Tq\\ %Tw\\ %Tc\\ %Tr\\ %Tt\r\n  default_backend backend-http-80\r\n\r\nbackend backend-http-80\r\n  server http-80 10.104.7.11:8888 cookie MTAuMTA0LjcuMTE=\r\n  mode http\r\n  balance roundrobin\r\n  appsession eucaconsole_session len 4096 timeout 1440m\r\n{code}\r\n\r\n*Pertinent Data*\r\n\r\nThis was discovered while attempting to set up the Eucalyptus Management Console behind an ELB.  The goal is to confirm the correct setup for the following:\r\n\r\n* HTTPS/SSL ELB offloading for Eucalyptus Management Console\r\n* ELB + AutoScaled deployment of Eucalyptus Management Console\r\n\r\n*Steps*\r\n\r\n# Set up a Eucalyptus 4.0.1 Cloud with Load Balancer and Eucalyptus DNS enabled\r\n# Add the [CentOS 6.5 image|http://eucalyptus-images.s3.amazonaws.com/public/centos.raw.xz] from emis.eucalyptus.com\r\n# Launch a Load Balancer image with LB port value '80' and instance port value '8888'.  For example:\r\n{code}\r\n# eulb-create-lb MultiPolicy --listener \"lb-port=80, protocol=http, instance-port=8888, instance-protocol=http\" --availability-zone Honest\r\n{code}\r\n# Add both duration-based session stickiness and application-specific session stickiness policies to the LB.  For example:\r\n{code}\r\n# eulb-create-lb-cookie-stickiness-policy MultiPolicy --expiration-period 30 --policy-name LBCookiePolicy\r\n# eulb-set-lb-policies-of-listener MultiPolicy --lb-port 80 --policy-names LBCookiePolicy\r\n# eulb-create-app-cookie-stickiness-policy --policy-name EucaManagementConsolePolicy --cookie-name eucaconsole_session MultiPolicy\r\n# eulb-set-lb-policies-of-listener MultiPolicy --lb-port 80 --policy-names EucaManagementConsolePolicy\r\n{code}\r\n# Launch an instance from the CentOS 6.5 EMI, and [install the Eucalyptus Management Console |https://www.eucalyptus.com/docs/eucalyptus/4.0.1/index.html#shared/console_install_centos_rhel6.html] on the instance.\r\n# Register the instance with the Load Balancer.  Make sure that the Load Balancer can communicate with the instance on port 8888.\r\n# Use 'curl', and query the URL of the Load Balancer. For example:\r\n{code}\r\n# curl -I http://MultiPolicy-325271821652.eulb.future.euca-hasp.cs.prc.eucalyptus-systems.com\r\n{code}\r\n# Notice the lack of the 'Set-Cookie' header value that contains AWSELB","customfield_13200":null,"customfield_11300":null,"customfield_11500":null,"timetracking":{},"customfield_10401":null,"customfield_10005":null,"customfield_10600":null,"customfield_12900":null,"attachment":[],"aggregatetimeestimate":null,"summary":"ELB Doesn't Support Duration-Based and Application-Specific Session Stickiness Policies on the same LB port","creator":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=hspencer","name":"hspencer","key":"hspencer","accountId":"557058:4a3a93bc-21f8-4658-9f5b-9cb484c910a7","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue"},"displayName":"Harold Spencer Jr.","active":true,"timeZone":"America/Los_Angeles"},"subtasks":[],"reporter":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=hspencer","name":"hspencer","key":"hspencer","accountId":"557058:4a3a93bc-21f8-4658-9f5b-9cb484c910a7","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue"},"displayName":"Harold Spencer Jr.","active":true,"timeZone":"America/Los_Angeles"},"aggregateprogress":{"progress":0,"total":0},"customfield_10000":"5_*:*_1_*:*_0_*|*_10000_*:*_1_*:*_238131750_*|*_10001_*:*_1_*:*_19426290667","customfield_12100":"0|i02xzz:","customfield_10001":"2014-11-21T15:50:38.534-0600","customfield_10002":null,"customfield_10200":null,"customfield_10003":null,"customfield_12500":null,"customfield_10400":null,"customfield_10116":null,"customfield_11600":["hspencer(hspencer)","spark(spark)"],"customfield_10117":null,"environment":null,"customfield_11800":null,"customfield_11802":null,"customfield_11805":null,"duedate":null,"progress":{"progress":0,"total":0},"customfield_11806":null,"comment":{"comments":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/32925/comment/77810","id":"77810","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=hspencer","name":"hspencer","key":"hspencer","accountId":"557058:4a3a93bc-21f8-4658-9f5b-9cb484c910a7","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue"},"displayName":"Harold Spencer Jr.","active":true,"timeZone":"America/Los_Angeles"},"body":"Looks like in [haproxy_conf.py in the load-balancer-servo repo|https://github.com/eucalyptus/load-balancer-servo/blob/master/servo/haproxy/haproxy_conf.py#L188-L189], we prevent this by the following logic:\r\n{code}\r\n            if cookie_expire and cookie_name:\r\n                servo.log.error('both duration-based and app-controlled cookie stickiness are enabled. something is wrong!')\r\n{code} ","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=hspencer","name":"hspencer","key":"hspencer","accountId":"557058:4a3a93bc-21f8-4658-9f5b-9cb484c910a7","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue"},"displayName":"Harold Spencer Jr.","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-10-16T12:15:20.241-0500","updated":"2014-10-16T12:15:20.241-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/32925/comment/79426","id":"79426","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=spark","name":"spark","key":"spark","accountId":"557058:2ed923b8-7172-41f0-a425-8796bd9a62f9","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/fec440044f6e652174838d59d9233f29?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dspark%26avatarId%3D10900%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/fec440044f6e652174838d59d9233f29?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dspark%26avatarId%3D10900%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/fec440044f6e652174838d59d9233f29?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dspark%26avatarId%3D10900%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/fec440044f6e652174838d59d9233f29?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dspark%26avatarId%3D10900%26noRedirect%3Dtrue"},"displayName":"Sang-Min Park","active":false,"timeZone":"America/Los_Angeles"},"body":"HAproxy does not implement the two different policy types on the same port. Currently, ELB front-end do not allow users to set multiple policies on the same port. In the steps above, eulb-set-lb-policies-of-listener had to be called with multiple policies in order to set them. If it did, Euca's ELB would returned error like this:\r\n\r\n[root@thinkpad ~]# eulb-set-lb-policies-of-listener -l 80 -p app_pol,lbpol mylb\r\neulb-set-lb-policies-of-listener: error (InvalidConfigurationRequest): Requested configuration change is invalid: Only one cookie stickiness policy can be set\r\n\r\nIn addition, I don't think there's a real use-case for setting two different stickiness policies on the application. I'll lower the priority of this ticket. \r\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=spark","name":"spark","key":"spark","accountId":"557058:2ed923b8-7172-41f0-a425-8796bd9a62f9","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/fec440044f6e652174838d59d9233f29?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dspark%26avatarId%3D10900%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/fec440044f6e652174838d59d9233f29?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dspark%26avatarId%3D10900%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/fec440044f6e652174838d59d9233f29?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dspark%26avatarId%3D10900%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/fec440044f6e652174838d59d9233f29?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dspark%26avatarId%3D10900%26noRedirect%3Dtrue"},"displayName":"Sang-Min Park","active":false,"timeZone":"America/Los_Angeles"},"created":"2014-11-21T15:50:38.534-0600","updated":"2014-11-21T15:50:38.534-0600"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/32925/comment/87077","id":"87077","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=spark","name":"spark","key":"spark","accountId":"557058:2ed923b8-7172-41f0-a425-8796bd9a62f9","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/fec440044f6e652174838d59d9233f29?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dspark%26avatarId%3D10900%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/fec440044f6e652174838d59d9233f29?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dspark%26avatarId%3D10900%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/fec440044f6e652174838d59d9233f29?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dspark%26avatarId%3D10900%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/fec440044f6e652174838d59d9233f29?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dspark%26avatarId%3D10900%26noRedirect%3Dtrue"},"displayName":"Sang-Min Park","active":false,"timeZone":"America/Los_Angeles"},"body":"I will mark this as \"Won't fix\" because the underlying Haproxy doesn't support this capability. If there's any escalation necessary please re-open.","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=spark","name":"spark","key":"spark","accountId":"557058:2ed923b8-7172-41f0-a425-8796bd9a62f9","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/fec440044f6e652174838d59d9233f29?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dspark%26avatarId%3D10900%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/fec440044f6e652174838d59d9233f29?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dspark%26avatarId%3D10900%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/fec440044f6e652174838d59d9233f29?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dspark%26avatarId%3D10900%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/fec440044f6e652174838d59d9233f29?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dspark%26avatarId%3D10900%26noRedirect%3Dtrue"},"displayName":"Sang-Min Park","active":false,"timeZone":"America/Los_Angeles"},"created":"2015-05-29T12:23:29.614-0500","updated":"2015-05-29T12:23:29.614-0500"}],"maxResults":3,"total":3,"startAt":0},"votes":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/EUCA-10068/votes","votes":0,"hasVoted":false},"customfield_11808":null,"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]}}}
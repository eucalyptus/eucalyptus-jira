{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"27023","self":"https://eucalyptus.atlassian.net/rest/api/2/issue/27023","key":"EUCA-8638","fields":{"issuetype":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://eucalyptus.atlassian.net/secure/viewavatar?size=xsmall&avatarId=14803&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":14803},"timespent":null,"customfield_13100":null,"project":{"self":"https://eucalyptus.atlassian.net/rest/api/2/project/10000","id":"10000","key":"EUCA","name":"Eucalyptus","avatarUrls":{"48x48":"https://eucalyptus.atlassian.net/secure/projectavatar?pid=10000&avatarId=10011","24x24":"https://eucalyptus.atlassian.net/secure/projectavatar?size=small&pid=10000&avatarId=10011","16x16":"https://eucalyptus.atlassian.net/secure/projectavatar?size=xsmall&pid=10000&avatarId=10011","32x32":"https://eucalyptus.atlassian.net/secure/projectavatar?size=medium&pid=10000&avatarId=10011"}},"customfield_11000":null,"fixVersions":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/version/12806","id":"12806","description":"Eucalyptus 4.0.0","name":"4.0.0","archived":false,"released":true,"releaseDate":"2014-05-30"}],"customfield_11001":null,"aggregatetimespent":null,"customfield_10310":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/10209","value":"CentOS 6","id":"10209"}],"resolution":{"self":"https://eucalyptus.atlassian.net/rest/api/2/resolution/3","id":"3","description":"The problem is a duplicate of an existing issue.","name":"Duplicate"},"customfield_10311":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/10307","value":"Managed","id":"10307"}],"customfield_11401":null,"customfield_11400":null,"customfield_10500":{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/10402","value":"Internal","id":"10402"},"customfield_10104":[],"customfield_10302":null,"customfield_10303":null,"customfield_10105":{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/10101","value":"No","id":"10101"},"customfield_10304":null,"customfield_10700":null,"customfield_10701":null,"customfield_10702":null,"customfield_10306":{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/10200","value":"High","id":"10200"},"customfield_10703":null,"customfield_10704":null,"customfield_10308":null,"resolutiondate":"2014-03-06T15:25:10.152-0600","customfield_10705":null,"customfield_10309":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/10204","value":"KVM","id":"10204"}],"workratio":-1,"watches":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/EUCA-8638/watchers","watchCount":4,"isWatching":false},"lastViewed":null,"created":"2014-01-30T07:47:14.177-0600","customfield_12000":null,"customfield_12400":null,"priority":{"self":"https://eucalyptus.atlassian.net/rest/api/2/priority/3","iconUrl":"https://eucalyptus.atlassian.net/images/icons/priorities/major.svg","name":"Major","id":"3"},"customfield_12201":null,"customfield_12600":"{}","customfield_10102":null,"customfield_10300":null,"customfield_10301":null,"labels":["AWSCompat-PM"],"customfield_11700":null,"aggregatetimeoriginalestimate":null,"timeestimate":null,"versions":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/version/12801","id":"12801","description":"Eucalyptus 3.4.1","name":"3.4.1","archived":false,"released":true,"releaseDate":"2013-12-16"}],"customfield_11901":null,"issuelinks":[{"id":"22942","self":"https://eucalyptus.atlassian.net/rest/api/2/issueLink/22942","type":{"id":"10102","name":"Duplicate","inward":"is duplicated by","outward":"duplicates","self":"https://eucalyptus.atlassian.net/rest/api/2/issueLinkType/10102"},"outwardIssue":{"id":"21182","key":"TOOLS-330","self":"https://eucalyptus.atlassian.net/rest/api/2/issue/21182","fields":{"summary":"euca-register-snapshot now requires --root-device-name.  Did not used to.","status":{"self":"https://eucalyptus.atlassian.net/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://eucalyptus.atlassian.net/images/icons/statuses/generic.png","name":"Closed","id":"6","statusCategory":{"self":"https://eucalyptus.atlassian.net/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://eucalyptus.atlassian.net/rest/api/2/priority/3","iconUrl":"https://eucalyptus.atlassian.net/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://eucalyptus.atlassian.net/secure/viewavatar?size=xsmall&avatarId=14803&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":14803}}}},{"id":"22855","self":"https://eucalyptus.atlassian.net/rest/api/2/issueLink/22855","type":{"id":"10103","name":"Relates","inward":"relates to","outward":"relates to","self":"https://eucalyptus.atlassian.net/rest/api/2/issueLinkType/10103"},"outwardIssue":{"id":"27020","key":"EUCA-8636","self":"https://eucalyptus.atlassian.net/rest/api/2/issue/27020","fields":{"summary":"Extra block device mapping in meta-data service doesn't match AWS","status":{"self":"https://eucalyptus.atlassian.net/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://eucalyptus.atlassian.net/images/icons/statuses/generic.png","name":"Closed","id":"6","statusCategory":{"self":"https://eucalyptus.atlassian.net/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://eucalyptus.atlassian.net/rest/api/2/priority/3","iconUrl":"https://eucalyptus.atlassian.net/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://eucalyptus.atlassian.net/secure/viewavatar?size=xsmall&avatarId=14803&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":14803}}}},{"id":"22856","self":"https://eucalyptus.atlassian.net/rest/api/2/issueLink/22856","type":{"id":"10103","name":"Relates","inward":"relates to","outward":"relates to","self":"https://eucalyptus.atlassian.net/rest/api/2/issueLinkType/10103"},"outwardIssue":{"id":"27021","key":"EUCA-8637","self":"https://eucalyptus.atlassian.net/rest/api/2/issue/27021","fields":{"summary":"EBS-backed instance shows full device path for ephemeral0 which doesn't match AWS behavior","status":{"self":"https://eucalyptus.atlassian.net/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://eucalyptus.atlassian.net/images/icons/statuses/generic.png","name":"Closed","id":"6","statusCategory":{"self":"https://eucalyptus.atlassian.net/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://eucalyptus.atlassian.net/rest/api/2/priority/3","iconUrl":"https://eucalyptus.atlassian.net/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://eucalyptus.atlassian.net/secure/viewavatar?size=xsmall&avatarId=14803&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":14803}}}},{"id":"22857","self":"https://eucalyptus.atlassian.net/rest/api/2/issueLink/22857","type":{"id":"10400","name":"Subtask","inward":"has a subtask of","outward":"is a subtask of","self":"https://eucalyptus.atlassian.net/rest/api/2/issueLinkType/10400"},"outwardIssue":{"id":"17513","key":"EUCA-4244","self":"https://eucalyptus.atlassian.net/rest/api/2/issue/17513","fields":{"summary":"Should support images with multiple device mappings","status":{"self":"https://eucalyptus.atlassian.net/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://eucalyptus.atlassian.net/images/icons/statuses/generic.png","name":"Closed","id":"6","statusCategory":{"self":"https://eucalyptus.atlassian.net/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://eucalyptus.atlassian.net/rest/api/2/priority/3","iconUrl":"https://eucalyptus.atlassian.net/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://eucalyptus.atlassian.net/secure/viewavatar?size=xsmall&avatarId=14803&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":14803}}}}],"assignee":null,"updated":"2014-07-03T09:16:47.654-0500","status":{"self":"https://eucalyptus.atlassian.net/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://eucalyptus.atlassian.net/images/icons/statuses/generic.png","name":"Closed","id":"6","statusCategory":{"self":"https://eucalyptus.atlassian.net/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/component/10201","id":"10201","name":"AWS Compatibility"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/component/10002","id":"10002","name":"Cloud Controller"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/component/11504","id":"11504","name":"EC2"}],"timeoriginalestimate":null,"description":"*Assessment*\r\n\r\nWhen registering an EBS-backed EMI from a snapshot, per AWS documentation for [ec2-register|http://docs.aws.amazon.com/AWSEC2/latest/CommandLineReference/ApiReference-cmd-RegisterImage.html], if --root-device-name isn't provided, by default /dev/sda1 will be used.  In our case, its /dev/sda.  \r\n{code}\r\nWhen you register an Amazon EBS-backed AMI from a snapshot, at a minimum you must specify a snapshot or a block device mapping for the root device. This example command specifies a snapshot for the root device. By default, the root device is /dev/sda1\r\n{code}\r\nSince we don't follow this, it breaks AWS compatibility. \r\n\r\n*Signs*\r\n\r\n* Comparison of behavior between AWS and Eucalyptus:\r\n** AWS\r\n{code}\r\n$ ec2-register -n EBS-Test-Ubuntu-Precise-x86_64 -s snap-3e1af229 -O XXXXXXXXX -W XXXXXXXXXXXXXXXX\r\nIMAGE\tami-cd8fb0a4\r\n{code}\r\n** Eucalyptus\r\n{code}\r\n# euca-register --name ebs-ubuntu-precise-x86_64 --snapshot snap-E0D142C6 --region eucalyptus-admin@\r\neuca-register: error (400 Bad Request): ec2_amazonaws_com_doc_2013_02_01 failed to marshall type edu.ucsb.eucalyptus.msgs.RegisterImageType with ns:http://ec2.amazonaws.com/doc/2013-02-01/ caused by: null value for element \"{http://ec2.amazonaws.com/doc/2013-02-01/}deviceName\" from object of type edu.ucsb.eucalyptus.msgs.BlockDeviceMappingItemType\r\n{code}\r\n\r\n*Steps*\r\n\r\n* Setup Eucalyptus 3.4.1 Cloud\r\n* Download and source admin user creds for eucalyptus account\r\n* Create keypair (for example):\r\n{code}\r\n$ euca-create-keypair account1-user01 > account1-user01.priv\r\n$ chmod 0600 account1-user01.priv\r\n{code}\r\n* Authorize port 22 in default security group:\r\n{code}\r\n$ euca-authorize -P tcp -p 22 -s 0.0.0.0/0 default\r\n{code}\r\n* Download precise-server-cloudimg\r\n{code}\r\n$ wget http://cloud-images.ubuntu.com/precise/current/precise-server-cloudimg-amd64.tar.gz\r\n{code}\r\n* Create instance store-backed EMI using eustore:\r\n{code}\r\n$ eustore-install-image -t precise-server-cloudimg-amd64.tar.gz -b ubuntu-latest-precise-x86_64 --hypervisor universal -s \"Ubuntu Cloud Image - Precise Pangolin - 12.04 LTS\"\r\n{code}\r\n* Run instance using that EMI (for example):\r\n{code}\r\n$ euca-run-instances -t m1.medium -k account1-user01 emi-5C8C3909\r\n{code}\r\n* Create a volume based upon the size of how big you want the root filesystem to be for the EBS-backed EMI (for example):\r\n{code}\r\n$ euca-create-volume -s 6 -z LayinDaSmackDown\r\n{code}\r\n* Attach volume to running instance (for example):\r\n{code}\r\n$ euca-attach-volume -d /dev/vdd -i i-839E3FB0 vol-B5863B3B\r\n{code}\r\n* SSH into the instance and download Ubuntu Precise Cloud image (qcow2 format) - for example:\r\n{code}\r\n$ ssh -i account1-user01.priv ubuntu@euca-10-104-7-10.eucalyptus.euca-hasp.eucalyptus-systems.com\r\n# cd /mnt  (change directory to mounted ephemeral device)\r\n# sudo -s\r\n# wget http://cloud-images.ubuntu.com/precise/current/precise-server-cloudimg-amd64-disk1.img\r\n{code}\r\n* Install qemu-utils:\r\n{code}\r\n# apt-get install -y qemu-utils\r\n{code}\r\n* Convert image from qcow2 to raw:\r\n{code}\r\n# qemu-img convert -O raw precise-server-cloudimg-amd64-disk1.img precise-server-cloudimg-amd64-disk1-raw.img\r\n{code}\r\n* dd raw image to block device where volume is attached (use dmesg to figure out where volume is attached):\r\n{code}\r\n# dmesg | tail\r\n[ 7026.943212] virtio-pci 0000:00:05.0: using default PCI settings\r\n[ 7026.943249] pci 0000:00:07.0: no hotplug settings from platform\r\n[ 7026.943251] pci 0000:00:07.0: using default PCI settings\r\n[ 7026.945964] virtio-pci 0000:00:07.0: enabling device (0000 -> 0003)\r\n[ 7026.955143] virtio-pci 0000:00:07.0: PCI INT A -> Link[LNKC] -> GSI 10 (level, high) -> IRQ 10\r\n[ 7026.955180] virtio-pci 0000:00:07.0: setting latency timer to 64\r\n[ 7026.955429] virtio-pci 0000:00:07.0: irq 45 for MSI/MSI-X\r\n[ 7026.955456] virtio-pci 0000:00:07.0: irq 46 for MSI/MSI-X\r\n[ 7026.986990]  vdb: unknown partition table\r\n[10447.093426] virtio-pci 0000:00:07.0: PCI INT A disabled\r\n\r\n# dd if=/mnt/precise-server-cloudimg-amd64-disk1-raw.img of=/dev/vdb bs=1M\r\n{code}\r\n* Log out of instance, and detach volume:\r\n{code}\r\n$ euca-detach-volume vol-B5863B3B\r\n{code}\r\n* Create snapshot of volume (for example):\r\n{code}\r\n$ euca-create-snapshot vol-B5863B3B\r\n{code}\r\n* Attempt to register EBS-backed EMI without defining --root-device-name:\r\n{code}\r\n$ euca-register --name ebs-ubuntu-precise-x86_64 --snapshot snap-E0D142C6\r\neuca-register: error (400 Bad Request): ec2_amazonaws_com_doc_2013_02_01 failed to marshall type edu.ucsb.eucalyptus.msgs.RegisterImageType with ns:http://ec2.amazonaws.com/doc/2013-02-01/ caused by: null value for element \"{http://ec2.amazonaws.com/doc/2013-02-01/}deviceName\" from object of type edu.ucsb.eucalyptus.msgs.BlockDeviceMappingItemType\r\n{code}","customfield_13000":null,"customfield_13200":null,"customfield_11300":null,"customfield_11500":null,"timetracking":{},"customfield_10005":null,"customfield_10401":null,"customfield_10600":null,"customfield_12900":null,"attachment":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/attachment/18752","id":"18752","filename":"sosreport-CLC-Walrus-UserConsole.2-20140128184330-8ec9.tar.xz","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=hspencer","name":"hspencer","key":"hspencer","accountId":"557058:4a3a93bc-21f8-4658-9f5b-9cb484c910a7","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue"},"displayName":"Harold Spencer Jr.","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-01-30T07:47:14.210-0600","size":14897720,"mimeType":"application/x-xz","content":"https://eucalyptus.atlassian.net/secure/attachment/18752/sosreport-CLC-Walrus-UserConsole.2-20140128184330-8ec9.tar.xz"}],"aggregatetimeestimate":null,"summary":"Default Root Device Isn't Populated When Registering EBS-backed EMI If Not Defined","creator":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=hspencer","name":"hspencer","key":"hspencer","accountId":"557058:4a3a93bc-21f8-4658-9f5b-9cb484c910a7","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue"},"displayName":"Harold Spencer Jr.","active":true,"timeZone":"America/Los_Angeles"},"subtasks":[],"reporter":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=hspencer","name":"hspencer","key":"hspencer","accountId":"557058:4a3a93bc-21f8-4658-9f5b-9cb484c910a7","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue"},"displayName":"Harold Spencer Jr.","active":true,"timeZone":"America/Los_Angeles"},"aggregateprogress":{"progress":0,"total":0},"customfield_10000":"10001_*:*_1_*:*_3021221523_*|*_10000_*:*_1_*:*_30254517_*|*_5_*:*_1_*:*_0","customfield_12100":"0|i014o7:","customfield_10001":"2014-03-06T15:25:10.213-0600","customfield_10200":null,"customfield_10002":null,"customfield_10003":null,"customfield_12500":null,"customfield_10400":null,"customfield_10116":null,"customfield_11600":["hspencer(hspencer)","kedwards(kedwards)"],"customfield_10117":null,"environment":"*non-HA, multi-cluster*\r\n{code}\r\nSERVICE\teuare          \teucalyptus     \t10.104.10.6    \tENABLED   \t68  \thttp://10.104.10.6:8773/services/Euare  \tarn:euca:eucalyptus::euare:10.104.10.6/\r\nSERVICE\ttokens         \teucalyptus     \t10.104.10.6    \tENABLED   \t68  \thttp://10.104.10.6:8773/services/Tokens \tarn:euca:eucalyptus::tokens:10.104.10.6/\r\nSERVICE\twalrus         \twalrus         \tStirItUp       \tENABLED   \t68  \thttp://10.104.10.6:8773/services/Walrus \tarn:euca:bootstrap:walrus:walrus:StirItUp/\r\nSERVICE\tnotifications  \teucalyptus     \t10.104.10.6    \tENABLED   \t68  \thttp://10.104.10.6:8773/services/Notifications\tarn:euca:eucalyptus::notifications:10.104.10.6/\r\nSERVICE\tjetty          \teucalyptus     \t10.104.10.6    \tENABLED   \t68  \thttp://10.104.10.6:8773/services/Jetty  \tarn:euca:eucalyptus::jetty:10.104.10.6/\r\nSERVICE\tdns            \teucalyptus     \t10.104.10.6    \tENABLED   \t68  \thttp://10.104.10.6:8773/services/Dns    \tarn:euca:eucalyptus::dns:10.104.10.6/\r\nSERVICE\tcluster        \tExodus         \tNaturalMystic  \tENABLED   \t68  \thttp://10.104.10.22:8774/axis2/services/EucalyptusCC\tarn:euca:eucalyptus:Exodus:cluster:NaturalMystic/\r\nSERVICE\tcluster        \tLegend         \tIsThisLove     \tENABLED   \t68  \thttp://10.104.1.185:8774/axis2/services/EucalyptusCC\tarn:euca:eucalyptus:Legend:cluster:IsThisLove/\r\nSERVICE\tautoscaling    \tautoscaling    \t10.104.10.6    \tENABLED   \t68  \thttp://10.104.10.6:8773/services/AutoScaling\tarn:euca:eucalyptus:autoscaling:autoscaling:10.104.10.6/\r\nSERVICE\tstorage        \tExodus         \tTheHeathen     \tENABLED   \t68  \thttp://10.104.10.22:8773/services/Storage\tarn:euca:eucalyptus:Exodus:storage:TheHeathen/\r\nSERVICE\tstorage        \tLegend         \tNoWomanNoCry   \tENABLED   \t68  \thttp://10.104.1.185:8773/services/Storage\tarn:euca:eucalyptus:Legend:storage:NoWomanNoCry/\r\nSERVICE\teucalyptus     \teucalyptus     \t10.104.10.6    \tENABLED   \t68  \thttp://10.104.10.6:8773/services/Eucalyptus\tarn:euca:eucalyptus:::10.104.10.6/\r\nSERVICE\tcloudwatch     \tcloudwatch     \t10.104.10.6    \tENABLED   \t68  \thttp://10.104.10.6:8773/services/CloudWatch\tarn:euca:eucalyptus:cloudwatch:cloudwatch:10.104.10.6/\r\nSERVICE\tloadbalancing  \tloadbalancing  \t10.104.10.6    \tENABLED   \t68  \thttp://10.104.10.6:8773/services/LoadBalancing\tarn:euca:eucalyptus:loadbalancing:loadbalancing:10.104.10.6/\r\nSERVICE\tbootstrap      \tbootstrap      \t10.104.10.6    \tENABLED   \t68  \thttp://10.104.10.6:8773/services/Empyrean\tarn:euca:bootstrap:::10.104.10.6/\r\nSERVICE\treporting      \tbootstrap      \t10.104.10.6    \tENABLED   \t68  \thttp://10.104.10.6:8773/services/Reporting\tarn:euca:bootstrap::reporting:10.104.10.6/\r\n{code}","customfield_11800":null,"customfield_11802":null,"duedate":null,"customfield_11805":null,"progress":{"progress":0,"total":0},"customfield_11806":null,"votes":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/EUCA-8638/votes","votes":0,"hasVoted":false},"comment":{"comments":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/27023/comment/62152","id":"62152","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=hspencer","name":"hspencer","key":"hspencer","accountId":"557058:4a3a93bc-21f8-4658-9f5b-9cb484c910a7","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue"},"displayName":"Harold Spencer Jr.","active":true,"timeZone":"America/Los_Angeles"},"body":"Added this as a subtask of EUCA-4244 since if you don't pass --root-device-name, it causes issues regarding EUCA-4244.  The follow examples below from [ec2-register|http://docs.aws.amazon.com/AWSEC2/latest/CommandLineReference/ApiReference-cmd-RegisterImage.html] show the comparison on how we fail compared to AWS:\r\n* Example 3 - This example command registers an AMI with a block device mapping for three Amazon EBS volumes. The first volume is the root device volume based on an Amazon EBS snapshot. The second volume is a volume based on another snapshot. The third volume is an empty GiB volume.\r\n** AWS\r\n{code}\r\n$ ec2-register -n EBS-Test-Ubuntu-Precise-x86_64-v2 -O XXXXXXXXXX -W XXXXXXXXXXX -b \"/dev/sda1=snap-3e1af229\" -b \"/dev/sdb=snap-2056be37\" -b \"/dev/sdc=:100\"\r\nIMAGE\tami-318eb158\r\n{code}\r\n** Eucalyptus\r\n{code}\r\n# euca-register --name ebs-ubuntu-precise-x86_64 -b \"/dev/sda=snap-E0D142C6\" -b \"/dev/sdb=snap-D36A3F4D\" -b \"/dev/sdc=:3\" --region eucalyptus-admin@ --debug\r\n2014-01-28 19:00:18,166 DEBUG   RegisterImage parsed arguments: {'VirtualizationType': None, 'BlockDeviceMapping': [{'DeviceName': '/dev/sda', 'Ebs': {'SnapshotId': 'snap-E0D142C6'}}, {'DeviceName': '/dev/sdb', 'Ebs': {'SnapshotId': 'snap-D36A3F4D'}}, {'DeviceName': '/dev/sdc', 'Ebs': {'VolumeSize': 3}}], 'Description': None, 'shell_configfile': '', 'url': None, 'key_id': None, 'Platform': None, 'userregion': 'eucalyptus-admin@', 'snapshot': None, 'Architecture': None, 'show_empty_fields': False, 'ImageLocation': None, 'KernelId': None, 'RamdiskId': None, 'secret_key': None, 'deprecated_key_id': None, 'RootDeviceName': None, 'Name': 'ebs-ubuntu-precise-x86_64'}\r\n2014-01-28 19:00:18,166 DEBUG   Config current user set to 'eucalyptus-admin'\r\n2014-01-28 19:00:18,166 DEBUG   Config searching regions for option 'ec2-url'\r\n2014-01-28 19:00:18,166 DEBUG   Config   section 'BobMarley'\r\n2014-01-28 19:00:18,166 INFO    Config option 'ec2-url' = 'http://10.104.10.6:8773/services/Eucalyptus'\r\n2014-01-28 19:00:18,166 DEBUG   Config searching regions for option 'verify-ssl'\r\n2014-01-28 19:00:18,166 DEBUG   Config   section 'BobMarley'\r\n2014-01-28 19:00:18,166 DEBUG   Config   section '*'\r\n2014-01-28 19:00:18,167 INFO    Config option 'verify-ssl' not found\r\n2014-01-28 19:00:18,167 DEBUG   Config searching users for option 'key-id'\r\n2014-01-28 19:00:18,167 DEBUG   Config   section 'eucalyptus-admin'\r\n2014-01-28 19:00:18,167 INFO    Config option 'key-id' = 'AKIZKYODDZPMV9XQWN8R'\r\n2014-01-28 19:00:18,167 DEBUG   Config searching users for option 'secret-key'\r\n2014-01-28 19:00:18,167 DEBUG   Config   section 'eucalyptus-admin'\r\n2014-01-28 19:00:18,167 INFO    Config option 'secret-key' = <redacted>\r\neuca-register: error: either a manifest location or a root device snapshot mapping must be specified\r\nTraceback (most recent call last):\r\n  File \"/usr/bin/euca-register\", line 6, in <module>\r\n    euca2ools.commands.euca.registerimage.RegisterImage.run()\r\n  File \"/usr/lib/python2.6/site-packages/requestbuilder/command.py\", line 289, in run\r\n    cmd.handle_cli_exception(err)\r\n  File \"/usr/lib/python2.6/site-packages/requestbuilder/request.py\", line 200, in handle_cli_exception\r\n    BaseCommand.handle_cli_exception(self, err)\r\n  File \"/usr/lib/python2.6/site-packages/requestbuilder/command.py\", line 286, in run\r\n    result = cmd.main()\r\n  File \"/usr/lib/python2.6/site-packages/requestbuilder/request.py\", line 180, in main\r\n    self.preprocess()\r\n  File \"/usr/lib/python2.6/site-packages/euca2ools/commands/euca/registerimage.py\", line 101, in preprocess\r\n    raise ArgumentError('either a manifest location or a root '\r\nrequestbuilder.exceptions.ArgumentError: either a manifest location or a root device snapshot mapping must be specified\r\n# euca-register --name ebs-ubuntu-precise-x86_64 -b \"/dev/sda1=snap-E0D142C6\" -b \"/dev/sdb=snap-D36A3F4D\" -b \"/dev/sdc=:3\" --region eucalyptus-admin@ --debug\r\n2014-01-28 19:02:19,858 DEBUG   RegisterImage parsed arguments: {'VirtualizationType': None, 'BlockDeviceMapping': [{'DeviceName': '/dev/sda1', 'Ebs': {'SnapshotId': 'snap-E0D142C6'}}, {'DeviceName': '/dev/sdb', 'Ebs': {'SnapshotId': 'snap-D36A3F4D'}}, {'DeviceName': '/dev/sdc', 'Ebs': {'VolumeSize': 3}}], 'Description': None, 'shell_configfile': '', 'url': None, 'key_id': None, 'Platform': None, 'userregion': 'eucalyptus-admin@', 'snapshot': None, 'Architecture': None, 'show_empty_fields': False, 'ImageLocation': None, 'KernelId': None, 'RamdiskId': None, 'secret_key': None, 'deprecated_key_id': None, 'RootDeviceName': None, 'Name': 'ebs-ubuntu-precise-x86_64'}\r\n2014-01-28 19:02:19,859 DEBUG   Config current user set to 'eucalyptus-admin'\r\n2014-01-28 19:02:19,859 DEBUG   Config searching regions for option 'ec2-url'\r\n2014-01-28 19:02:19,859 DEBUG   Config   section 'BobMarley'\r\n2014-01-28 19:02:19,859 INFO    Config option 'ec2-url' = 'http://10.104.10.6:8773/services/Eucalyptus'\r\n2014-01-28 19:02:19,859 DEBUG   Config searching regions for option 'verify-ssl'\r\n2014-01-28 19:02:19,859 DEBUG   Config   section 'BobMarley'\r\n2014-01-28 19:02:19,859 DEBUG   Config   section '*'\r\n2014-01-28 19:02:19,859 INFO    Config option 'verify-ssl' not found\r\n2014-01-28 19:02:19,859 DEBUG   Config searching users for option 'key-id'\r\n2014-01-28 19:02:19,860 DEBUG   Config   section 'eucalyptus-admin'\r\n2014-01-28 19:02:19,860 INFO    Config option 'key-id' = 'AKIZKYODDZPMV9XQWN8R'\r\n2014-01-28 19:02:19,860 DEBUG   Config searching users for option 'secret-key'\r\n2014-01-28 19:02:19,860 DEBUG   Config   section 'eucalyptus-admin'\r\n2014-01-28 19:02:19,860 INFO    Config option 'secret-key' = <redacted>\r\neuca-register: error: either a manifest location or a root device snapshot mapping must be specified\r\nTraceback (most recent call last):\r\n  File \"/usr/bin/euca-register\", line 6, in <module>\r\n    euca2ools.commands.euca.registerimage.RegisterImage.run()\r\n  File \"/usr/lib/python2.6/site-packages/requestbuilder/command.py\", line 289, in run\r\n    cmd.handle_cli_exception(err)\r\n  File \"/usr/lib/python2.6/site-packages/requestbuilder/request.py\", line 200, in handle_cli_exception\r\n    BaseCommand.handle_cli_exception(self, err)\r\n  File \"/usr/lib/python2.6/site-packages/requestbuilder/command.py\", line 286, in run\r\n    result = cmd.main()\r\n  File \"/usr/lib/python2.6/site-packages/requestbuilder/request.py\", line 180, in main\r\n    self.preprocess()\r\n  File \"/usr/lib/python2.6/site-packages/euca2ools/commands/euca/registerimage.py\", line 101, in preprocess\r\n    raise ArgumentError('either a manifest location or a root '\r\nrequestbuilder.exceptions.ArgumentError: either a manifest location or a root device snapshot mapping must be specified\r\n{code}\r\n* Example 4: This example command registers an AMI with two volumes The first volume is the root volume based on an Amazon EBS snapshot. The DeleteOnTermination flag of the root volume is set to false. The second volume is an instance store volume, ephemeral0.\r\n** AWS\r\n{code}\r\n$ ec2-register -n EBS-Test-Ubuntu-Precise-x86_64-v3 -O XXXXXXXX -W XXXXXXXXX -b \"/dev/sda1=snap-3e1af229:80:false\" -b \"/dev/sdc=ephemeral0\"\r\nIMAGE\tami-558bb43c\r\n{code}\r\n** Eucalyptus\r\n{code}\r\n# euca-register --name ebs-ubuntu-precise-x86_64 -b \"/dev/sda1=snap-E0D142C6:8:false\" -b \"/dev/sdc=ephemeral0\" --region eucalyptus-admin@ --debug\r\n2014-01-28 19:06:41,751 DEBUG   RegisterImage parsed arguments: {'VirtualizationType': None, 'BlockDeviceMapping': [{'DeviceName': '/dev/sda1', 'Ebs': {'DeleteOnTermination': 'false', 'SnapshotId': 'snap-E0D142C6', 'VolumeSize': 8}}, {'DeviceName': '/dev/sdc', 'VirtualName': 'ephemeral0'}], 'Description': None, 'shell_configfile': '', 'url': None, 'key_id': None, 'Platform': None, 'userregion': 'eucalyptus-admin@', 'snapshot': None, 'Architecture': None, 'show_empty_fields': False, 'ImageLocation': None, 'KernelId': None, 'RamdiskId': None, 'secret_key': None, 'deprecated_key_id': None, 'RootDeviceName': None, 'Name': 'ebs-ubuntu-precise-x86_64'}\r\n2014-01-28 19:06:41,752 DEBUG   Config current user set to 'eucalyptus-admin'\r\n2014-01-28 19:06:41,752 DEBUG   Config searching regions for option 'ec2-url'\r\n2014-01-28 19:06:41,752 DEBUG   Config   section 'BobMarley'\r\n2014-01-28 19:06:41,752 INFO    Config option 'ec2-url' = 'http://10.104.10.6:8773/services/Eucalyptus'\r\n2014-01-28 19:06:41,752 DEBUG   Config searching regions for option 'verify-ssl'\r\n2014-01-28 19:06:41,752 DEBUG   Config   section 'BobMarley'\r\n2014-01-28 19:06:41,752 DEBUG   Config   section '*'\r\n2014-01-28 19:06:41,752 INFO    Config option 'verify-ssl' not found\r\n2014-01-28 19:06:41,752 DEBUG   Config searching users for option 'key-id'\r\n2014-01-28 19:06:41,753 DEBUG   Config   section 'eucalyptus-admin'\r\n2014-01-28 19:06:41,753 INFO    Config option 'key-id' = 'AKIZKYODDZPMV9XQWN8R'\r\n2014-01-28 19:06:41,753 DEBUG   Config searching users for option 'secret-key'\r\n2014-01-28 19:06:41,753 DEBUG   Config   section 'eucalyptus-admin'\r\n2014-01-28 19:06:41,753 INFO    Config option 'secret-key' = <redacted>\r\neuca-register: error: either a manifest location or a root device snapshot mapping must be specified\r\nTraceback (most recent call last):\r\n  File \"/usr/bin/euca-register\", line 6, in <module>\r\n    euca2ools.commands.euca.registerimage.RegisterImage.run()\r\n  File \"/usr/lib/python2.6/site-packages/requestbuilder/command.py\", line 289, in run\r\n    cmd.handle_cli_exception(err)\r\n  File \"/usr/lib/python2.6/site-packages/requestbuilder/request.py\", line 200, in handle_cli_exception\r\n    BaseCommand.handle_cli_exception(self, err)\r\n  File \"/usr/lib/python2.6/site-packages/requestbuilder/command.py\", line 286, in run\r\n    result = cmd.main()\r\n  File \"/usr/lib/python2.6/site-packages/requestbuilder/request.py\", line 180, in main\r\n    self.preprocess()\r\n  File \"/usr/lib/python2.6/site-packages/euca2ools/commands/euca/registerimage.py\", line 101, in preprocess\r\n    raise ArgumentError('either a manifest location or a root '\r\nrequestbuilder.exceptions.ArgumentError: either a manifest location or a root device snapshot mapping must be specified\r\n{code}\r\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=hspencer","name":"hspencer","key":"hspencer","accountId":"557058:4a3a93bc-21f8-4658-9f5b-9cb484c910a7","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue"},"displayName":"Harold Spencer Jr.","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-01-30T08:07:46.653-0600","updated":"2014-01-30T08:07:46.653-0600"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/27023/comment/64021","id":"64021","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=kedwards","name":"kedwards","key":"kedwards","accountId":"557058:f9c2f8da-1fc6-4aa7-8fb0-750e7e422b6b","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/d1746a6d05a30ca027012a7da4545962?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dkedwards%26avatarId%3D10200%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/d1746a6d05a30ca027012a7da4545962?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dkedwards%26avatarId%3D10200%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/d1746a6d05a30ca027012a7da4545962?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dkedwards%26avatarId%3D10200%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/d1746a6d05a30ca027012a7da4545962?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dkedwards%26avatarId%3D10200%26noRedirect%3Dtrue"},"displayName":"Ken Edwards","active":true,"timeZone":"America/Los_Angeles"},"body":"dup of tools-330","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=kedwards","name":"kedwards","key":"kedwards","accountId":"557058:f9c2f8da-1fc6-4aa7-8fb0-750e7e422b6b","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/d1746a6d05a30ca027012a7da4545962?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dkedwards%26avatarId%3D10200%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/d1746a6d05a30ca027012a7da4545962?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dkedwards%26avatarId%3D10200%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/d1746a6d05a30ca027012a7da4545962?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dkedwards%26avatarId%3D10200%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/d1746a6d05a30ca027012a7da4545962?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dkedwards%26avatarId%3D10200%26noRedirect%3Dtrue"},"displayName":"Ken Edwards","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-03-06T15:25:10.213-0600","updated":"2014-03-06T15:25:10.213-0600"}],"maxResults":2,"total":2,"startAt":0},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_11808":null}}
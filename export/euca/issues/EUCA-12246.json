{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"42428","self":"https://eucalyptus.atlassian.net/rest/api/2/issue/42428","key":"EUCA-12246","fields":{"issuetype":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://eucalyptus.atlassian.net/secure/viewavatar?size=xsmall&avatarId=14803&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":14803},"timespent":null,"customfield_13100":null,"project":{"self":"https://eucalyptus.atlassian.net/rest/api/2/project/10000","id":"10000","key":"EUCA","name":"Eucalyptus","avatarUrls":{"48x48":"https://eucalyptus.atlassian.net/secure/projectavatar?pid=10000&avatarId=10011","24x24":"https://eucalyptus.atlassian.net/secure/projectavatar?size=small&pid=10000&avatarId=10011","16x16":"https://eucalyptus.atlassian.net/secure/projectavatar?size=xsmall&pid=10000&avatarId=10011","32x32":"https://eucalyptus.atlassian.net/secure/projectavatar?size=medium&pid=10000&avatarId=10011"}},"customfield_11000":null,"customfield_11001":null,"fixVersions":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/version/16800","id":"16800","description":"Eucalyptus 4.3.0","name":"4.3.0","archived":false,"released":true,"releaseDate":"2016-08-09"}],"aggregatetimespent":null,"resolution":{"self":"https://eucalyptus.atlassian.net/rest/api/2/resolution/5","id":"5","description":"All attempts at reproducing this issue failed, or not enough information was available to reproduce the issue. Reading the code produces no clues as to why this behavior would occur. If more information appears later, please reopen the issue.","name":"Cannot Reproduce"},"customfield_10310":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/10209","value":"CentOS 6","id":"10209"}],"customfield_10311":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/12401","value":"VPC-MIDO","id":"12401"}],"customfield_11401":null,"customfield_11400":null,"customfield_10500":{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/10403","value":"Not Applicable","id":"10403"},"customfield_10104":[],"customfield_10302":null,"customfield_10303":null,"customfield_10105":null,"customfield_10700":null,"customfield_10304":null,"customfield_10701":null,"customfield_10702":null,"customfield_10306":null,"customfield_10703":null,"customfield_10704":null,"resolutiondate":"2016-07-08T19:27:30.608-0500","customfield_10308":null,"customfield_10309":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/10204","value":"KVM","id":"10204"}],"customfield_10705":null,"workratio":-1,"lastViewed":null,"watches":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/EUCA-12246/watchers","watchCount":3,"isWatching":false},"created":"2016-04-22T11:02:14.520-0500","customfield_12000":null,"customfield_12400":null,"priority":{"self":"https://eucalyptus.atlassian.net/rest/api/2/priority/3","iconUrl":"https://eucalyptus.atlassian.net/images/icons/priorities/major.svg","name":"Major","id":"3"},"customfield_12201":null,"customfield_10300":null,"customfield_10102":null,"customfield_12600":"{}","customfield_10301":null,"labels":[],"customfield_11700":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"versions":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/version/17200","id":"17200","description":"Eucalyptus 4.2.2","name":"4.2.2","archived":false,"released":true,"releaseDate":"2016-04-28"}],"customfield_11901":null,"issuelinks":[{"id":"36930","self":"https://eucalyptus.atlassian.net/rest/api/2/issueLink/36930","type":{"id":"10600","name":"Bonfire Testing","inward":"discovered while testing","outward":"testing discovered","self":"https://eucalyptus.atlassian.net/rest/api/2/issueLinkType/10600"},"inwardIssue":{"id":"35084","key":"EUCA-11840","self":"https://eucalyptus.atlassian.net/rest/api/2/issue/35084","fields":{"summary":"ELB not working if webservices port has been changed to something different from 8773","status":{"self":"https://eucalyptus.atlassian.net/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://eucalyptus.atlassian.net/images/icons/statuses/generic.png","name":"Closed","id":"6","statusCategory":{"self":"https://eucalyptus.atlassian.net/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://eucalyptus.atlassian.net/rest/api/2/priority/2","iconUrl":"https://eucalyptus.atlassian.net/images/icons/priorities/critical.svg","name":"Critical","id":"2"},"issuetype":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://eucalyptus.atlassian.net/secure/viewavatar?size=xsmall&avatarId=14803&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":14803}}}}],"assignee":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=tony","name":"tony","key":"tony","accountId":"557058:353956db-b78c-4f3b-9096-f8f58e6709c8","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/14ec1b18e630cc0743492fc327a12df7?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dtony%26avatarId%3D16600%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/14ec1b18e630cc0743492fc327a12df7?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dtony%26avatarId%3D16600%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/14ec1b18e630cc0743492fc327a12df7?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dtony%26avatarId%3D16600%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/14ec1b18e630cc0743492fc327a12df7?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dtony%26avatarId%3D16600%26noRedirect%3Dtrue"},"displayName":"Tony Beckham","active":true,"timeZone":"America/Tijuana"},"updated":"2016-10-28T00:21:53.596-0500","status":{"self":"https://eucalyptus.atlassian.net/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://eucalyptus.atlassian.net/images/icons/statuses/generic.png","name":"Closed","id":"6","statusCategory":{"self":"https://eucalyptus.atlassian.net/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/component/11500","id":"11500","name":"ELB","description":"Load Balancing"}],"timeoriginalestimate":null,"customfield_13000":null,"description":"*Assessment*\r\n\r\nAfter setting up an ELB that spans multiple AZs, if one of the ELB instances gets terminated, all web requests are on hold for around a minute.  After the hold, all requests are successful. \r\n\r\n*Signs*\r\n\r\n* Output from curl test when request is holding:\r\n{code}\r\nHTTP/1.1 200 OK\r\nServer: nginx/1.4.6 (Ubuntu)\r\nDate: Wed, 20 Apr 2016 16:02:35 GMT\r\nContent-Type: text/html\r\nContent-Length: 612\r\nLast-Modified: Tue, 04 Mar 2014 11:46:45 GMT\r\nETag: \"5315bd25-264\"\r\nAccept-Ranges: bytes\r\n\r\nHTTP/1.1 200 OK\r\nServer: nginx/1.4.6 (Ubuntu)\r\nDate: Wed, 20 Apr 2016 16:02:35 GMT\r\nContent-Type: text/html\r\nContent-Length: 612\r\nLast-Modified: Tue, 04 Mar 2014 11:46:45 GMT\r\nETag: \"5315bd25-264\"\r\nAccept-Ranges: bytes\r\n\r\nHTTP/1.1 200 OK\r\nServer: nginx/1.4.6 (Ubuntu)\r\nDate: Wed, 20 Apr 2016 16:02:35 GMT\r\nContent-Type: text/html\r\nContent-Length: 612\r\nLast-Modified: Tue, 04 Mar 2014 11:46:45 GMT\r\nETag: \"5315bd25-264\"\r\nAccept-Ranges: bytes\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nHTTP/1.1 200 OK\r\nServer: nginx/1.4.6 (Ubuntu)\r\nDate: Wed, 20 Apr 2016 16:03:51 GMT\r\nContent-Type: text/html\r\nContent-Length: 612\r\nLast-Modified: Tue, 04 Mar 2014 11:46:45 GMT\r\nETag: \"5315bd25-264\"\r\nAccept-Ranges: bytes\r\n\r\nHTTP/1.1 200 OK\r\nServer: nginx/1.4.6 (Ubuntu)\r\nDate: Wed, 20 Apr 2016 16:03:51 GMT\r\nContent-Type: text/html\r\nContent-Length: 612\r\nLast-Modified: Tue, 04 Mar 2014 11:46:45 GMT\r\nETag: \"5315bd25-264\"\r\nAccept-Ranges: bytes\r\n{code}\r\n* Screen shot attached showing ELB metrics from Cloudwatch in Grafana UI.  From the screen shot, you can see the minute delay regarding connection counts per AZ.\r\n\r\n*Setup*\r\n\r\n# Set up Eucalyptus multi-cluster cloud with Eucalyptus DNS enabled - [hspencer-309|http://jenkins.qa1.eucalyptus-systems.com/job/Quick%20Launch%20Maint-4.2/309/]\r\n# Created eucalyptus account euca2ools configuration file\r\n{code}\r\n[root@c-31 ~]# eval `clcadmin-assume-system-credentials`\r\n[root@c-31 ~]# euctl system\r\nsystem.dns.dnsdomain = d-36.autoqa.qa1.eucalyptus-systems.com\r\nsystem.dns.nameserver = nshost.localhost\r\nsystem.dns.nameserveraddress = 10.111.1.125\r\nsystem.dns.registrationid = 67b7e6c7-7ee8-4be4-9b28-fd4a9caa5e89\r\nsystem.exec.io_chunk_size = 102400\r\nsystem.exec.max_restricted_concurrent_ops = 2\r\nsystem.exec.restricted_concurrent_ops = dd,gunzip,tar\r\n[root@c-31 ~]# euare-useraddkey -u admin -wd d-36.autoqa.qa1.eucalyptus-systems.com > .euca/euca-admin.ini\r\n{code}\r\n# Create signed cert for UFS, and configure HTTPS endpoints (DOC-1699)\r\n{code}\r\n[root@c-31 ~]# euctl bootstrap.webservices.ssl.server_alias=rick-ross\r\n[root@c-31 ~]# euctl bootstrap.webservices.ssl.server_password=rickross\r\n[root@c-31 ~]# euctl bootstrap.webservices.port=443 \r\n[root@c-31 ~]# euctl bootstrap.webservices.default_ec2_uri_scheme=https\r\n[root@c-31 ~]# euctl bootstrap.webservices.default_euare_uri_scheme=https\r\n[root@c-31 ~]# euctl bootstrap.webservices.default_s3_uri_scheme=https\r\n{code}\r\n# Enable DNS spoofing \r\n{code}\r\n[root@c-31 ~]# euctl dns.spoof_regions.enabled=true\r\n[root@c-31 ~]# euctl dns.spoof_regions.spoof_aws_default_regions=true\r\n[root@c-31 ~]# euctl dns.spoof_regions.spoof_aws_regions=true\r\n{code}\r\n# Create non-admin account\r\n{code}\r\n[root@c-31 ~]# eval `euare-releaserole`\r\n[root@c-31 ~]# euare-accountcreate -a development-operations -w > .euca/devops-admin.ini --region euca-admin@\r\n[root@c-31 ~]# euca-describe-availability-zones --region devops-admin@\r\nAVAILABILITYZONE\tblack-dollar\tavailable\r\nAVAILABILITYZONE\thood-billionaire\tavailable\r\n{code}\r\n# Launch [Ubuntu Cloud (Trusty)|http://cloud-images.ubuntu.com/trusty/current/trusty-server-cloudimg-amd64-disk1.img] instances with cloud-init script to install nginx\r\n{code}\r\n[root@c-31 ~]# cat nginx-cloudinit.config\r\n#cloud-config\r\napt_update: true\r\napt_upgrade: true\r\ndisable_root: true\r\npackages:\r\n - less\r\nruncmd:\r\n - [ sh, -xc, \"META_HOSTNAME=`curl -s http://169.254.169.254/latest/meta-data/local-hostname`; META_IP=`curl -s http://169.254.169.254/latest/meta-data/local-ipv4`; echo ${META_IP}   ${META_HOSTNAME} >> /etc/hosts\" ]\r\n - [ sh, -xc, \"META_HOSTNAME=`curl -s http://169.254.169.254/latest/meta-data/local-hostname`; hostname ${META_HOSTNAME}; sysctl -w kernel.hostname=${META_HOSTNAME}\" ]\r\n - [ apt-get, install, -y, --force-yes, dnsutils ]\r\n - [ apt-get, install, -y, --force-yes, bind9utils ]\r\n - [ apt-get, install, -y, --force-yes, mlocate ]\r\n - [ apt-get, install, -y, --force-yes, nginx ]\r\n\r\n[root@c-31 ~]# euca-run-instances -k devops-admin -t m1.medium emi-bb7eff48 --monitor -n 3 --user-data-file nginx-cloudinit.config --region devops-admin@\r\n\r\n[root@c-31 ~]# euca-describe-instances --filter tag-value=\"Nginx*\" --region devops-admin@\r\nRESERVATION\tr-a1b12734\t000884302249\tdefault\r\nINSTANCE\ti-9f4fe675\temi-bb7eff48\teuca-10-116-164-124.eucalyptus.d-36.autoqa.qa1.eucalyptus-systems.com\teuca-172-31-4-216.eucalyptus.internal\trunning\tdevops-admin\t\t\tm1.medium\t2016-04-17T18:47:36.368Z\tblack-dollar\t\t\t\tmonitoring-enabled\t10.116.164.124\t172.31.4.216\tvpc-9652735e\tsubnet-05ae1229\tinstance-store\t\t\t\t\thvm\t\t\tsg-fd182601\t\t\tarn:aws:iam::000884302249:instance-profile/grafana-cloudwatch-profile\tx86_64\r\nNETWORKINTERFACE\teni-7356e59a\tsubnet-05ae1229\tvpc-9652735e\t000884302249\tin-use\t172.31.4.216\teuca-172-31-4-216.eucalyptus.internal\ttrue\r\nATTACHMENT\teni-attach-d6955978\t0\tattached\t2016-04-17T18:47:36.378Z\ttrue\r\nASSOCIATION\t10.116.164.124\t\t172.31.4.216\r\nGROUP\tsg-fd182601\tdefault\r\nPRIVATEIPADDRESS\t172.31.4.216\teuca-172-31-4-216.eucalyptus.internal\tprimary\r\nTAG\tinstance\ti-9f4fe675\tApplication\tNginx Web Server\r\nRESERVATION\tr-c1c90578\t000884302249\tdefault\r\nINSTANCE\ti-b82a82b0\temi-bb7eff48\teuca-10-116-164-54.eucalyptus.d-36.autoqa.qa1.eucalyptus-systems.com\teuca-172-31-28-225.eucalyptus.internal\trunning\tdevops-admin\t\t\tm1.medium\t2016-04-15T18:51:19.309Z\thood-billionaire\t\t\t\tmonitoring-enabled\t10.116.164.54\t172.31.28.225\tvpc-9652735e\tsubnet-f3ce9346\tinstance-store\t\t\t\t\thvm\t\t\tsg-fd182601\t\t\t\tx86_64\r\nNETWORKINTERFACE\teni-01afe09a\tsubnet-f3ce9346\tvpc-9652735e\t000884302249\tin-use\t172.31.28.225\teuca-172-31-28-225.eucalyptus.internal\ttrue\r\nATTACHMENT\teni-attach-9601c1e7\t0\tattached\t2016-04-15T18:51:19.319Z\ttrue\r\nASSOCIATION\t10.116.164.54\t\t172.31.28.225\r\nGROUP\tsg-fd182601\tdefault\r\nPRIVATEIPADDRESS\t172.31.28.225\teuca-172-31-28-225.eucalyptus.internal\tprimary\r\nTAG\tinstance\ti-b82a82b0\tApplication\tNginx Web Server\r\nINSTANCE\ti-78b07c0f\temi-bb7eff48\teuca-10-116-164-16.eucalyptus.d-36.autoqa.qa1.eucalyptus-systems.com\teuca-172-31-26-171.eucalyptus.internal\trunning\tdevops-admin\t\t\tm1.medium\t2016-04-15T18:51:19.359Z\thood-billionaire\t\t\t\tmonitoring-enabled\t10.116.164.16\t172.31.26.171\tvpc-9652735e\tsubnet-f3ce9346\tinstance-store\t\t\t\t\thvm\t\t\tsg-fd182601\t\t\t\tx86_64\r\nNETWORKINTERFACE\teni-18e2b128\tsubnet-f3ce9346\tvpc-9652735e\t000884302249\tin-use\t172.31.26.171\teuca-172-31-26-171.eucalyptus.internal\ttrue\r\nATTACHMENT\teni-attach-04b64edb\t0\tattached\t2016-04-15T18:51:19.370Z\ttrue\r\nASSOCIATION\t10.116.164.16\t\t172.31.26.171\r\nGROUP\tsg-fd182601\tdefault\r\nPRIVATEIPADDRESS\t172.31.26.171\teuca-172-31-26-171.eucalyptus.internal\tprimary\r\nTAG\tinstance\ti-78b07c0f\tApplication\tNginx Web Server\r\n{code}\r\n# Authorize port 80 to be accessible\r\n{code}\r\n[root@c-31 ~]# euca-authorize -P tcp -p http default --region devops-admin@\r\n{code}\r\n# Confirm web page on all instances can be reached\r\n{code}\r\n[root@c-31 ~]# for x in `euca-describe-instances --filter tag-value=\"Nginx*\" --region devops-admin@ | grep INSTANCE | awk '{print $4}'`; do curl -I ${x}; done\r\nHTTP/1.1 200 OK\r\nServer: nginx/1.4.6 (Ubuntu)\r\nDate: Tue, 19 Apr 2016 16:18:29 GMT\r\nContent-Type: text/html\r\nContent-Length: 612\r\nLast-Modified: Tue, 04 Mar 2014 11:46:45 GMT\r\nConnection: keep-alive\r\nETag: \"5315bd25-264\"\r\nAccept-Ranges: bytes\r\n\r\nHTTP/1.1 200 OK\r\nServer: nginx/1.4.6 (Ubuntu)\r\nDate: Tue, 19 Apr 2016 16:18:29 GMT\r\nContent-Type: text/html\r\nContent-Length: 612\r\nLast-Modified: Tue, 04 Mar 2014 11:46:45 GMT\r\nConnection: keep-alive\r\nETag: \"5315bd25-264\"\r\nAccept-Ranges: bytes\r\n\r\nHTTP/1.1 200 OK\r\nServer: nginx/1.4.6 (Ubuntu)\r\nDate: Tue, 19 Apr 2016 16:18:29 GMT\r\nContent-Type: text/html\r\nContent-Length: 612\r\nLast-Modified: Tue, 04 Mar 2014 11:46:45 GMT\r\nConnection: keep-alive\r\nETag: \"5315bd25-264\"\r\nAccept-Ranges: bytes\r\n{code}\r\n# Create ELB\r\n{code}\r\n[root@c-31 ~]# eulb-create-lb -s subnet-f3ce9346,subnet-05ae1229 -l \"lb-port=80, protocol=HTTP, instance-port=80, instance-protocol=HTTP\" --tag Purpose=\"ELB for Nginx Web Servers\" NginxELB --region devops-admin@\r\nDNS_NAME\tNginxELB-000884302249.lb.d-36.autoqa.qa1.eucalyptus-systems.com\r\n{code}\r\n# Register instances to ELB\r\n{code}\r\n[root@c-31 ~]# eulb-register-instances-with-lb --instances i-9f4fe675,i-b82a82b0,i-78b07c0f NginxELB --region devops-admin@\r\nINSTANCE\ti-9f4fe675\r\nINSTANCE\ti-b82a82b0\r\nINSTANCE\ti-78b07c0f\r\n[root@c-31 ~]# eulb-describe-instance-health --show-long NginxELB --region devops-admin@\r\nINSTANCE\ti-9f4fe675\tOutOfService\tInstance registration is still in progress.\tELB\r\nINSTANCE\ti-b82a82b0\tOutOfService\tInstance registration is still in progress.\tELB\r\nINSTANCE\ti-78b07c0f\tOutOfService\tInstance registration is still in progress.\tELB\r\n{code}\r\n# Configure Cross Zone Load Balancing\r\n{code}\r\n[root@c-31 ~]# eulb-modify-lb-attributes NginxELB CrossZoneLoadBalancing.Enabled=true --region devops-admin@\r\n[root@c-31 ~]# eulb-describe-lb-attributes NginxELB --region devops-admin@\r\nAccessLog.Enabled\tfalse\r\nConnectionDraining.Enabled\tfalse\r\nConnectionSettings.IdleTimeout\t60\r\nCrossZoneLoadBalancing.Enabled\ttrue\r\n{code}\r\n# Configure ELB health check\r\n{code}\r\n[root@c-31 ~]# eulb-configure-healthcheck --healthy-threshold 3 --unhealthy-threshold 3 --timeout 3 --interval 30 --target HTTP:80/ NginxELB --region devops-admin@\r\nHEALTH_CHECK\tHTTP:80/\t30\t3\t3\t3\r\n[root@c-31 ~]# eulb-describe-lbs --show-long NginxELB --region devops-admin@\r\nLOAD_BALANCER\tNginxELB\tNginxELB-000884302249.lb.d-36.autoqa.qa1.eucalyptus-systems.com\t\t\t{interval=30,target=HTTP:80/,timeout=3,healthy-threshold=3,unhealthy-threshold=3}\thood-billionaire,black-dollar\tsubnet-f3ce9346,subnet-05ae1229\tvpc-9652735e\ti-9f4fe675,i-78b07c0f,i-b82a82b0\t{protocol=HTTP,lb-port=80,instance-protocol=HTTP,instance-port=80}\t\t\t\t\t{owner-alias=000884302249,group-name=default}\t{sg-fd182601}\t2016-04-19T13:20:35.827Z\tinternet-facing\r\n[root@c-31 ~]# eulb-describe-instance-health NginxELB --region devops-admin@\r\nINSTANCE\ti-9f4fe675\tInService\r\nINSTANCE\ti-78b07c0f\tInService\r\nINSTANCE\ti-b82a82b0\tInService\r\n{code}\r\n# Confirm ELB is working correctly\r\n{code}\r\n[root@c-31 ~]# curl -I NginxELB-000884302249.lb.d-36.autoqa.qa1.eucalyptus-systems.com\r\nHTTP/1.1 200 OK\r\nServer: nginx/1.4.6 (Ubuntu)\r\nDate: Tue, 19 Apr 2016 13:56:52 GMT\r\nContent-Type: text/html\r\nContent-Length: 612\r\nLast-Modified: Tue, 04 Mar 2014 11:46:45 GMT\r\nETag: \"5315bd25-264\"\r\nAccept-Ranges: bytes\r\n{code}\r\n# Open up another terminal, and run while loop that queries ELB:\r\n{code}\r\n$ while true; do curl -I NginxELB-000884302249.lb.d-36.autoqa.qa1.eucalyptus-systems.com; done\r\n{code}\r\n# Terminate one of the ELB instances, then observe output from while loop.  Notice how the curl requests become delayed until a new instance replaces the terminated ELB instance.","customfield_13200":null,"customfield_11300":null,"customfield_11500":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=tony","name":"tony","key":"tony","accountId":"557058:353956db-b78c-4f3b-9096-f8f58e6709c8","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/14ec1b18e630cc0743492fc327a12df7?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dtony%26avatarId%3D16600%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/14ec1b18e630cc0743492fc327a12df7?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dtony%26avatarId%3D16600%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/14ec1b18e630cc0743492fc327a12df7?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dtony%26avatarId%3D16600%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/14ec1b18e630cc0743492fc327a12df7?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dtony%26avatarId%3D16600%26noRedirect%3Dtrue"},"displayName":"Tony Beckham","active":true,"timeZone":"America/Tijuana"},"timetracking":{},"customfield_10005":null,"customfield_10401":null,"customfield_10600":null,"customfield_12900":null,"aggregatetimeestimate":null,"attachment":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/attachment/29411","id":"29411","filename":"Screen Shot 2016-04-20 at 12.07.34 PM.png","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=hspencer","name":"hspencer","key":"hspencer","accountId":"557058:4a3a93bc-21f8-4658-9f5b-9cb484c910a7","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue"},"displayName":"Harold Spencer Jr.","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-04-22T12:02:09.390-0500","size":95848,"mimeType":"image/png","content":"https://eucalyptus.atlassian.net/secure/attachment/29411/Screen+Shot+2016-04-20+at+12.07.34+PM.png","thumbnail":"https://eucalyptus.atlassian.net/secure/thumbnail/29411/Screen+Shot+2016-04-20+at+12.07.34+PM.png"}],"summary":"Multi-AZ ELB hangs around a minute if one of the ELB instances is terminated","creator":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=hspencer","name":"hspencer","key":"hspencer","accountId":"557058:4a3a93bc-21f8-4658-9f5b-9cb484c910a7","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue"},"displayName":"Harold Spencer Jr.","active":true,"timeZone":"America/Los_Angeles"},"subtasks":[],"reporter":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=hspencer","name":"hspencer","key":"hspencer","accountId":"557058:4a3a93bc-21f8-4658-9f5b-9cb484c910a7","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue"},"displayName":"Harold Spencer Jr.","active":true,"timeZone":"America/Los_Angeles"},"customfield_12100":"0|i03pzb:","aggregateprogress":{"progress":0,"total":0},"customfield_10000":"3_*:*_1_*:*_2002985991_*|*_5_*:*_1_*:*_0_*|*_10000_*:*_1_*:*_536823212_*|*_10001_*:*_2_*:*_4143306899","customfield_10001":"2016-04-25T18:33:13.134-0500","customfield_10002":null,"customfield_10200":null,"customfield_10003":null,"customfield_10400":null,"customfield_12500":null,"customfield_10116":null,"customfield_11600":["dmitrii(dmitrii)","hspencer(hspencer)","spark(spark)","tony(tony)"],"customfield_10117":null,"environment":"[hspencer-309|http://jenkins.qa1.eucalyptus-systems.com/job/Quick%20Launch%20Maint-4.2/309/]","customfield_11800":null,"customfield_11802":null,"duedate":null,"customfield_11805":null,"progress":{"progress":0,"total":0},"customfield_11806":null,"votes":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/EUCA-12246/votes","votes":0,"hasVoted":false},"comment":{"comments":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/42428/comment/101959","id":"101959","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=spark","name":"spark","key":"spark","accountId":"557058:2ed923b8-7172-41f0-a425-8796bd9a62f9","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/fec440044f6e652174838d59d9233f29?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dspark%26avatarId%3D10900%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/fec440044f6e652174838d59d9233f29?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dspark%26avatarId%3D10900%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/fec440044f6e652174838d59d9233f29?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dspark%26avatarId%3D10900%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/fec440044f6e652174838d59d9233f29?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dspark%26avatarId%3D10900%26noRedirect%3Dtrue"},"displayName":"Sang-Min Park","active":false,"timeZone":"America/Los_Angeles"},"body":"In this case the expected behaviour is that the running instance in the different AZ continue to serve the traffics and the ELB clients (web application) rely on round-robin DNS to pick up the IP address of the running instance. \r\nTo confirm this behaviour, we need to set a shorter time-out in the curl in the loop. If the other IP works, then it's the expected behaviour. ","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=spark","name":"spark","key":"spark","accountId":"557058:2ed923b8-7172-41f0-a425-8796bd9a62f9","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/fec440044f6e652174838d59d9233f29?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dspark%26avatarId%3D10900%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/fec440044f6e652174838d59d9233f29?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dspark%26avatarId%3D10900%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/fec440044f6e652174838d59d9233f29?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dspark%26avatarId%3D10900%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/fec440044f6e652174838d59d9233f29?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dspark%26avatarId%3D10900%26noRedirect%3Dtrue"},"displayName":"Sang-Min Park","active":false,"timeZone":"America/Los_Angeles"},"created":"2016-04-25T18:33:13.134-0500","updated":"2016-04-25T18:33:13.134-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/42428/comment/102161","id":"102161","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=dmitrii","name":"dmitrii","key":"dmitrii","accountId":"557058:1e0ea807-434b-4b54-967f-1dec4a9ede55","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue"},"displayName":"Dmitrii Calzago","active":false,"timeZone":"America/Los_Angeles"},"body":"May be good to confirm that the behavior is as expected.","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=dmitrii","name":"dmitrii","key":"dmitrii","accountId":"557058:1e0ea807-434b-4b54-967f-1dec4a9ede55","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue"},"displayName":"Dmitrii Calzago","active":false,"timeZone":"America/Los_Angeles"},"created":"2016-04-28T16:09:17.727-0500","updated":"2016-04-28T16:09:17.727-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/42428/comment/106555","id":"106555","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=tony","name":"tony","key":"tony","accountId":"557058:353956db-b78c-4f3b-9096-f8f58e6709c8","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/14ec1b18e630cc0743492fc327a12df7?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dtony%26avatarId%3D16600%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/14ec1b18e630cc0743492fc327a12df7?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dtony%26avatarId%3D16600%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/14ec1b18e630cc0743492fc327a12df7?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dtony%26avatarId%3D16600%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/14ec1b18e630cc0743492fc327a12df7?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dtony%26avatarId%3D16600%26noRedirect%3Dtrue"},"displayName":"Tony Beckham","active":true,"timeZone":"America/Tijuana"},"body":"I was able to see that if the command {code}while true; do curl -I app-elb-000389137617.lb.e-31.autoqa.qa1.eucalyptus-systems.com/instance-name; done{code} would stop getting served if an ELB vm was terminated. However, if I start the same command in another terminal (or kill that one and run again) the ELB serves up requests. I do not think this is a bug of eucalyptus as requests continually get processed even as an elb VM is shutting down->terminated and replaced.","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=tony","name":"tony","key":"tony","accountId":"557058:353956db-b78c-4f3b-9096-f8f58e6709c8","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/14ec1b18e630cc0743492fc327a12df7?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dtony%26avatarId%3D16600%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/14ec1b18e630cc0743492fc327a12df7?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dtony%26avatarId%3D16600%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/14ec1b18e630cc0743492fc327a12df7?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dtony%26avatarId%3D16600%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/14ec1b18e630cc0743492fc327a12df7?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dtony%26avatarId%3D16600%26noRedirect%3Dtrue"},"displayName":"Tony Beckham","active":true,"timeZone":"America/Tijuana"},"created":"2016-07-08T19:27:30.618-0500","updated":"2016-07-08T19:27:30.618-0500"}],"maxResults":3,"total":3,"startAt":0},"customfield_11808":null,"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]}}}
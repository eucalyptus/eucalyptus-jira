{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"62403","self":"https://eucalyptus.atlassian.net/rest/api/2/issue/62403","key":"EUCA-13452","fields":{"issuetype":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://eucalyptus.atlassian.net/secure/viewavatar?size=xsmall&avatarId=14803&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":14803},"timespent":null,"customfield_13100":null,"project":{"self":"https://eucalyptus.atlassian.net/rest/api/2/project/10000","id":"10000","key":"EUCA","name":"Eucalyptus","avatarUrls":{"48x48":"https://eucalyptus.atlassian.net/secure/projectavatar?pid=10000&avatarId=10011","24x24":"https://eucalyptus.atlassian.net/secure/projectavatar?size=small&pid=10000&avatarId=10011","16x16":"https://eucalyptus.atlassian.net/secure/projectavatar?size=xsmall&pid=10000&avatarId=10011","32x32":"https://eucalyptus.atlassian.net/secure/projectavatar?size=medium&pid=10000&avatarId=10011"}},"customfield_11000":null,"customfield_11001":null,"fixVersions":[],"aggregatetimespent":null,"resolution":null,"customfield_10310":null,"customfield_10311":null,"customfield_11401":null,"customfield_11400":null,"customfield_10500":{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/10403","value":"Not Applicable","id":"10403"},"customfield_10302":null,"customfield_10104":[],"customfield_10105":null,"customfield_10303":null,"customfield_10700":null,"customfield_10304":null,"customfield_10701":null,"customfield_10306":null,"customfield_10702":null,"customfield_10703":null,"resolutiondate":null,"customfield_10704":null,"customfield_10308":null,"customfield_10309":null,"customfield_10705":null,"workratio":-1,"watches":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/EUCA-13452/watchers","watchCount":2,"isWatching":false},"lastViewed":null,"created":"2017-10-24T18:57:07.863-0500","customfield_12000":null,"priority":{"self":"https://eucalyptus.atlassian.net/rest/api/2/priority/3","iconUrl":"https://eucalyptus.atlassian.net/images/icons/priorities/major.svg","name":"Major","id":"3"},"customfield_12400":null,"customfield_12201":null,"customfield_10300":null,"customfield_10102":null,"customfield_12600":"{}","customfield_10301":null,"labels":[],"customfield_11700":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"versions":[],"customfield_11901":null,"issuelinks":[{"id":"54002","self":"https://eucalyptus.atlassian.net/rest/api/2/issueLink/54002","type":{"id":"10103","name":"Relates","inward":"relates to","outward":"relates to","self":"https://eucalyptus.atlassian.net/rest/api/2/issueLinkType/10103"},"inwardIssue":{"id":"37921","key":"EUCA-11320","self":"https://eucalyptus.atlassian.net/rest/api/2/issue/37921","fields":{"summary":"Large file uploads fails","status":{"self":"https://eucalyptus.atlassian.net/rest/api/2/status/10001","description":"This issue has been validated/reproduced, but has not been prioritized yet.","iconUrl":"https://eucalyptus.atlassian.net/images/icons/statuses/generic.png","name":"Confirmed","id":"10001","statusCategory":{"self":"https://eucalyptus.atlassian.net/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"priority":{"self":"https://eucalyptus.atlassian.net/rest/api/2/priority/3","iconUrl":"https://eucalyptus.atlassian.net/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://eucalyptus.atlassian.net/secure/viewavatar?size=xsmall&avatarId=14803&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":14803}}}}],"assignee":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=kedwards","name":"kedwards","key":"kedwards","accountId":"557058:f9c2f8da-1fc6-4aa7-8fb0-750e7e422b6b","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/d1746a6d05a30ca027012a7da4545962?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dkedwards%26avatarId%3D10200%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/d1746a6d05a30ca027012a7da4545962?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dkedwards%26avatarId%3D10200%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/d1746a6d05a30ca027012a7da4545962?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dkedwards%26avatarId%3D10200%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/d1746a6d05a30ca027012a7da4545962?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dkedwards%26avatarId%3D10200%26noRedirect%3Dtrue"},"displayName":"Ken Edwards","active":true,"timeZone":"America/Los_Angeles"},"updated":"2017-11-27T11:53:45.951-0600","status":{"self":"https://eucalyptus.atlassian.net/rest/api/2/status/10001","description":"This issue has been validated/reproduced, but has not been prioritized yet.","iconUrl":"https://eucalyptus.atlassian.net/images/icons/statuses/generic.png","name":"Confirmed","id":"10001","statusCategory":{"self":"https://eucalyptus.atlassian.net/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"components":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/component/12700","id":"12700","name":"OSG","description":"Object Storage Gateway"}],"timeoriginalestimate":null,"customfield_13000":null,"description":"Concurrent S3 puts can fail with the following error in the ufs cloud-debug.log:\r\n\r\n{code}\r\nTue Oct 24 16:29:51 2017 ERROR [ObjectFactoryImpl:eucalyptus-bootstrap-servicecontext-common-worker-671] Data PUT failure to backend for bucketuuid / objectuuid : 385bc5f5-c36e-48cd-b80a-1a9ab6d80c8d/42340a91-7496-4e34-9ed0-69736b6c417d\r\njava.util.concurrent.ExecutionException: com.amazonaws.AmazonClientException: Unable to execute HTTP request: Read timed out\r\n\tat java.util.concurrent.FutureTask.report(FutureTask.java:122)\r\n\tat java.util.concurrent.FutureTask.get(FutureTask.java:206)\r\n\tat com.eucalyptus.objectstorage.ObjectFactoryImpl.waitForCompletion(ObjectFactoryImpl.java:362)\r\n\tat com.eucalyptus.objectstorage.ObjectFactoryImpl.createObject(ObjectFactoryImpl.java:318)\r\n\tat com.eucalyptus.objectstorage.ObjectStorageGateway.doPutOperation(ObjectStorageGateway.java:473)\r\n\tat com.eucalyptus.objectstorage.ObjectStorageGateway.putObject(ObjectStorageGateway.java:428)\r\n\tat sun.reflect.GeneratedMethodAccessor470.invoke(Unknown Source)\r\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n\tat java.lang.reflect.Method.invoke(Method.java:498)\r\n\tat org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:333)\r\n\tat org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:207)\r\n\tat com.sun.proxy.$Proxy158.putObject(Unknown Source)\r\n\tat sun.reflect.GeneratedMethodAccessor473.invoke(Unknown Source)\r\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n\tat java.lang.reflect.Method.invoke(Method.java:498)\r\n\tat org.springframework.expression.spel.support.ReflectiveMethodExecutor.execute(ReflectiveMethodExecutor.java:113)\r\n\tat org.springframework.expression.spel.ast.MethodReference.getValueInternal(MethodReference.java:102)\r\n\tat org.springframework.expression.spel.ast.MethodReference.access$000(MethodReference.java:49)\r\n\tat org.springframework.expression.spel.ast.MethodReference$MethodValueRef.getValue(MethodReference.java:347)\r\n\tat org.springframework.expression.spel.ast.CompoundExpression.getValueInternal(CompoundExpression.java:88)\r\n\tat org.springframework.expression.spel.ast.SpelNodeImpl.getTypedValue(SpelNodeImpl.java:131)\r\n\tat org.springframework.expression.spel.standard.SpelExpression.getValue(SpelExpression.java:330)\r\n\tat org.springframework.integration.util.AbstractExpressionEvaluator.evaluateExpression(AbstractExpressionEvaluator.java:169)\r\n\tat org.springframework.integration.util.MessagingMethodInvokerHelper.processInternal(MessagingMethodInvokerHelper.java:317)\r\n\tat org.springframework.integration.util.MessagingMethodInvokerHelper.process(MessagingMethodInvokerHelper.java:155)\r\n\tat org.springframework.integration.handler.MethodInvokingMessageProcessor.processMessage(MethodInvokingMessageProcessor.java:93)\r\n\tat org.springframework.integration.handler.ServiceActivatingHandler.handleRequestMessage(ServiceActivatingHandler.java:89)\r\n\tat org.springframework.integration.handler.AbstractReplyProducingMessageHandler.handleMessageInternal(AbstractReplyProducingMessageHandler.java:109)\r\n\tat org.springframework.integration.handler.AbstractMessageHandler.handleMessage(AbstractMessageHandler.java:127)\r\n\tat org.springframework.integration.dispatcher.AbstractDispatcher.tryOptimizedDispatch(AbstractDispatcher.java:116)\r\n\tat org.springframework.integration.dispatcher.UnicastingDispatcher.doDispatch(UnicastingDispatcher.java:148)\r\n\tat org.springframework.integration.dispatcher.UnicastingDispatcher.dispatch(UnicastingDispatcher.java:121)\r\n\tat org.springframework.integration.channel.AbstractSubscribableChannel.doSend(AbstractSubscribableChannel.java:77)\r\n\tat org.springframework.integration.channel.AbstractMessageChannel.send(AbstractMessageChannel.java:423)\r\n\tat org.springframework.integration.channel.AbstractMessageChannel.send(AbstractMessageChannel.java:373)\r\n\tat org.springframework.messaging.core.GenericMessagingTemplate.doSend(GenericMessagingTemplate.java:115)\r\n\tat org.springframework.messaging.core.GenericMessagingTemplate.doSend(GenericMessagingTemplate.java:45)\r\n\tat org.springframework.messaging.core.AbstractMessageSendingTemplate.send(AbstractMessageSendingTemplate.java:105)\r\n\tat org.springframework.integration.router.AbstractMessageRouter.handleMessageInternal(AbstractMessageRouter.java:194)\r\n\tat org.springframework.integration.handler.AbstractMessageHandler.handleMessage(AbstractMessageHandler.java:127)\r\n\tat org.springframework.integration.dispatcher.AbstractDispatcher.tryOptimizedDispatch(AbstractDispatcher.java:116)\r\n\tat org.springframework.integration.dispatcher.UnicastingDispatcher.doDispatch(UnicastingDispatcher.java:148)\r\n\tat org.springframework.integration.dispatcher.UnicastingDispatcher.dispatch(UnicastingDispatcher.java:121)\r\n\tat org.springframework.integration.channel.AbstractSubscribableChannel.doSend(AbstractSubscribableChannel.java:77)\r\n\tat org.springframework.integration.channel.AbstractMessageChannel.send(AbstractMessageChannel.java:423)\r\n\tat org.springframework.integration.channel.AbstractMessageChannel.send(AbstractMessageChannel.java:373)\r\n\tat org.springframework.messaging.core.GenericMessagingTemplate.doSend(GenericMessagingTemplate.java:115)\r\n\tat org.springframework.messaging.core.GenericMessagingTemplate.doSend(GenericMessagingTemplate.java:45)\r\n\tat org.springframework.messaging.core.AbstractMessageSendingTemplate.send(AbstractMessageSendingTemplate.java:105)\r\n\tat org.springframework.integration.handler.AbstractMessageProducingHandler.sendOutput(AbstractMessageProducingHandler.java:292)\r\n\tat org.springframework.integration.handler.AbstractMessageProducingHandler.produceOutput(AbstractMessageProducingHandler.java:212)\r\n\tat org.springframework.integration.handler.MessageHandlerChain$ReplyForwardingMessageChannel.send(MessageHandlerChain.java:239)\r\n\tat org.springframework.messaging.core.GenericMessagingTemplate.doSend(GenericMessagingTemplate.java:115)\r\n\tat org.springframework.messaging.core.GenericMessagingTemplate.doSend(GenericMessagingTemplate.java:45)\r\n\tat org.springframework.messaging.core.AbstractMessageSendingTemplate.send(AbstractMessageSendingTemplate.java:105)\r\n\tat org.springframework.integration.handler.AbstractMessageProducingHandler.sendOutput(AbstractMessageProducingHandler.java:292)\r\n\tat org.springframework.integration.handler.AbstractMessageProducingHandler.produceOutput(AbstractMessageProducingHandler.java:212)\r\n\tat org.springframework.integration.handler.AbstractMessageProducingHandler.sendOutputs(AbstractMessageProducingHandler.java:129)\r\n\tat org.springframework.integration.handler.AbstractReplyProducingMessageHandler.handleMessageInternal(AbstractReplyProducingMessageHandler.java:115)\r\n\tat org.springframework.integration.handler.AbstractMessageHandler.handleMessage(AbstractMessageHandler.java:127)\r\n\tat org.springframework.integration.handler.MessageHandlerChain.handleMessageInternal(MessageHandlerChain.java:110)\r\n\tat org.springframework.integration.handler.AbstractMessageHandler.handleMessage(AbstractMessageHandler.java:127)\r\n\tat org.springframework.integration.dispatcher.AbstractDispatcher.tryOptimizedDispatch(AbstractDispatcher.java:116)\r\n\tat org.springframework.integration.dispatcher.UnicastingDispatcher.doDispatch(UnicastingDispatcher.java:148)\r\n\tat org.springframework.integration.dispatcher.UnicastingDispatcher.dispatch(UnicastingDispatcher.java:121)\r\n\tat org.springframework.integration.channel.AbstractSubscribableChannel.doSend(AbstractSubscribableChannel.java:77)\r\n\tat org.springframework.integration.channel.AbstractMessageChannel.send(AbstractMessageChannel.java:423)\r\n\tat org.springframework.integration.channel.AbstractMessageChannel.send(AbstractMessageChannel.java:373)\r\n\tat org.springframework.messaging.core.GenericMessagingTemplate.doSend(GenericMessagingTemplate.java:115)\r\n\tat org.springframework.messaging.core.GenericMessagingTemplate.doSend(GenericMessagingTemplate.java:45)\r\n\tat org.springframework.messaging.core.AbstractMessageSendingTemplate.send(AbstractMessageSendingTemplate.java:105)\r\n\tat com.eucalyptus.context.ServiceContext.lambda$dispatch$0(ServiceContext.java:187)\r\n\tat com.eucalyptus.context.ServiceContext.lambda$runWithContext$2(ServiceContext.java:292)\r\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\r\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\r\n\tat java.lang.Thread.run(Thread.java:748)\r\nCaused by: com.amazonaws.AmazonClientException: Unable to execute HTTP request: Read timed out\r\n\tat com.amazonaws.http.AmazonHttpClient.executeHelper(AmazonHttpClient.java:450)\r\n\tat com.amazonaws.http.AmazonHttpClient.execute(AmazonHttpClient.java:229)\r\n\tat com.amazonaws.services.s3.AmazonS3Client.invoke(AmazonS3Client.java:3384)\r\n\tat com.amazonaws.services.s3.AmazonS3Client.putObject(AmazonS3Client.java:1363)\r\n\tat com.eucalyptus.objectstorage.providers.s3.S3ProviderClient.putObject(S3ProviderClient.java:634)\r\n\tat com.eucalyptus.objectstorage.ObjectFactoryImpl$3.call(ObjectFactoryImpl.java:294)\r\n\tat com.eucalyptus.objectstorage.ObjectFactoryImpl$3.call(ObjectFactoryImpl.java:289)\r\n\tat java.util.concurrent.FutureTask.run(FutureTask.java:266)\r\n\t... 3 more\r\nCaused by: java.net.SocketTimeoutException: Read timed out\r\n\tat java.net.SocketInputStream.socketRead0(Native Method)\r\n\tat java.net.SocketInputStream.socketRead(SocketInputStream.java:116)\r\n\tat java.net.SocketInputStream.read(SocketInputStream.java:171)\r\n\tat java.net.SocketInputStream.read(SocketInputStream.java:141)\r\n\tat org.apache.http.impl.io.AbstractSessionInputBuffer.fillBuffer(AbstractSessionInputBuffer.java:166)\r\n\tat org.apache.http.impl.io.SocketInputBuffer.fillBuffer(SocketInputBuffer.java:90)\r\n\tat org.apache.http.impl.io.AbstractSessionInputBuffer.readLine(AbstractSessionInputBuffer.java:281)\r\n\tat org.apache.http.impl.conn.DefaultHttpResponseParser.parseHead(DefaultHttpResponseParser.java:92)\r\n\tat org.apache.http.impl.conn.DefaultHttpResponseParser.parseHead(DefaultHttpResponseParser.java:61)\r\n\tat org.apache.http.impl.io.AbstractMessageParser.parse(AbstractMessageParser.java:254)\r\n\tat org.apache.http.impl.AbstractHttpClientConnection.receiveResponseHeader(AbstractHttpClientConnection.java:289)\r\n\tat org.apache.http.impl.conn.DefaultClientConnection.receiveResponseHeader(DefaultClientConnection.java:252)\r\n\tat org.apache.http.impl.conn.ManagedClientConnectionImpl.receiveResponseHeader(ManagedClientConnectionImpl.java:191)\r\n\tat org.apache.http.protocol.HttpRequestExecutor.doReceiveResponse(HttpRequestExecutor.java:300)\r\n\tat com.amazonaws.http.protocol.SdkHttpRequestExecutor.doReceiveResponse(SdkHttpRequestExecutor.java:66)\r\n\tat org.apache.http.protocol.HttpRequestExecutor.execute(HttpRequestExecutor.java:127)\r\n\tat org.apache.http.impl.client.DefaultRequestDirector.tryExecute(DefaultRequestDirector.java:715)\r\n\tat org.apache.http.impl.client.DefaultRequestDirector.execute(DefaultRequestDirector.java:520)\r\n\tat org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:906)\r\n\tat org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:805)\r\n\tat com.amazonaws.http.AmazonHttpClient.executeHelper(AmazonHttpClient.java:380)\r\n\t... 10 more\r\nTue Oct 24 16:29:51 2017  WARN [ObjectStorageGateway:eucalyptus-bootstrap-servicecontext-common-worker-671] CorrelationId: bc2c0217-e3c6-475f-83f1-df829caa023d Responding to client with: \r\ncom.eucalyptus.objectstorage.exceptions.s3.InternalErrorException: We encountered an internal error. Please try again.\r\n\tat com.eucalyptus.objectstorage.ObjectStorageGateway.doPutOperation(ObjectStorageGateway.java:476)\r\n\tat com.eucalyptus.objectstorage.ObjectStorageGateway.putObject(ObjectStorageGateway.java:428)\r\n\tat sun.reflect.GeneratedMethodAccessor470.invoke(Unknown Source)\r\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n\tat java.lang.reflect.Method.invoke(Method.java:498)\r\n\tat org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:333)\r\n\tat org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:207)\r\n\tat com.sun.proxy.$Proxy158.putObject(Unknown Source)\r\n\tat sun.reflect.GeneratedMethodAccessor473.invoke(Unknown Source)\r\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n\tat java.lang.reflect.Method.invoke(Method.java:498)\r\n\tat org.springframework.expression.spel.support.ReflectiveMethodExecutor.execute(ReflectiveMethodExecutor.java:113)\r\n\tat org.springframework.expression.spel.ast.MethodReference.getValueInternal(MethodReference.java:102)\r\n\tat org.springframework.expression.spel.ast.MethodReference.access$000(MethodReference.java:49)\r\n\tat org.springframework.expression.spel.ast.MethodReference$MethodValueRef.getValue(MethodReference.java:347)\r\n\tat org.springframework.expression.spel.ast.CompoundExpression.getValueInternal(CompoundExpression.java:88)\r\n\tat org.springframework.expression.spel.ast.SpelNodeImpl.getTypedValue(SpelNodeImpl.java:131)\r\n\tat org.springframework.expression.spel.standard.SpelExpression.getValue(SpelExpression.java:330)\r\n\tat org.springframework.integration.util.AbstractExpressionEvaluator.evaluateExpression(AbstractExpressionEvaluator.java:169)\r\n\tat org.springframework.integration.util.MessagingMethodInvokerHelper.processInternal(MessagingMethodInvokerHelper.java:317)\r\n\tat org.springframework.integration.util.MessagingMethodInvokerHelper.process(MessagingMethodInvokerHelper.java:155)\r\n\tat org.springframework.integration.handler.MethodInvokingMessageProcessor.processMessage(MethodInvokingMessageProcessor.java:93)\r\n\tat org.springframework.integration.handler.ServiceActivatingHandler.handleRequestMessage(ServiceActivatingHandler.java:89)\r\n\tat org.springframework.integration.handler.AbstractReplyProducingMessageHandler.handleMessageInternal(AbstractReplyProducingMessageHandler.java:109)\r\n\tat org.springframework.integration.handler.AbstractMessageHandler.handleMessage(AbstractMessageHandler.java:127)\r\n\tat org.springframework.integration.dispatcher.AbstractDispatcher.tryOptimizedDispatch(AbstractDispatcher.java:116)\r\n\tat org.springframework.integration.dispatcher.UnicastingDispatcher.doDispatch(UnicastingDispatcher.java:148)\r\n\tat org.springframework.integration.dispatcher.UnicastingDispatcher.dispatch(UnicastingDispatcher.java:121)\r\n\tat org.springframework.integration.channel.AbstractSubscribableChannel.doSend(AbstractSubscribableChannel.java:77)\r\n\tat org.springframework.integration.channel.AbstractMessageChannel.send(AbstractMessageChannel.java:423)\r\n\tat org.springframework.integration.channel.AbstractMessageChannel.send(AbstractMessageChannel.java:373)\r\n\tat org.springframework.messaging.core.GenericMessagingTemplate.doSend(GenericMessagingTemplate.java:115)\r\n\tat org.springframework.messaging.core.GenericMessagingTemplate.doSend(GenericMessagingTemplate.java:45)\r\n\tat org.springframework.messaging.core.AbstractMessageSendingTemplate.send(AbstractMessageSendingTemplate.java:105)\r\n\tat org.springframework.integration.router.AbstractMessageRouter.handleMessageInternal(AbstractMessageRouter.java:194)\r\n\tat org.springframework.integration.handler.AbstractMessageHandler.handleMessage(AbstractMessageHandler.java:127)\r\n\tat org.springframework.integration.dispatcher.AbstractDispatcher.tryOptimizedDispatch(AbstractDispatcher.java:116)\r\n\tat org.springframework.integration.dispatcher.UnicastingDispatcher.doDispatch(UnicastingDispatcher.java:148)\r\n\tat org.springframework.integration.dispatcher.UnicastingDispatcher.dispatch(UnicastingDispatcher.java:121)\r\n\tat org.springframework.integration.channel.AbstractSubscribableChannel.doSend(AbstractSubscribableChannel.java:77)\r\n\tat org.springframework.integration.channel.AbstractMessageChannel.send(AbstractMessageChannel.java:423)\r\n\tat org.springframework.integration.channel.AbstractMessageChannel.send(AbstractMessageChannel.java:373)\r\n\tat org.springframework.messaging.core.GenericMessagingTemplate.doSend(GenericMessagingTemplate.java:115)\r\n\tat org.springframework.messaging.core.GenericMessagingTemplate.doSend(GenericMessagingTemplate.java:45)\r\n\tat org.springframework.messaging.core.AbstractMessageSendingTemplate.send(AbstractMessageSendingTemplate.java:105)\r\n\tat org.springframework.integration.handler.AbstractMessageProducingHandler.sendOutput(AbstractMessageProducingHandler.java:292)\r\n\tat org.springframework.integration.handler.AbstractMessageProducingHandler.produceOutput(AbstractMessageProducingHandler.java:212)\r\n\tat org.springframework.integration.handler.MessageHandlerChain$ReplyForwardingMessageChannel.send(MessageHandlerChain.java:239)\r\n\tat org.springframework.messaging.core.GenericMessagingTemplate.doSend(GenericMessagingTemplate.java:115)\r\n\tat org.springframework.messaging.core.GenericMessagingTemplate.doSend(GenericMessagingTemplate.java:45)\r\n\tat org.springframework.messaging.core.AbstractMessageSendingTemplate.send(AbstractMessageSendingTemplate.java:105)\r\n\tat org.springframework.integration.handler.AbstractMessageProducingHandler.sendOutput(AbstractMessageProducingHandler.java:292)\r\n\tat org.springframework.integration.handler.AbstractMessageProducingHandler.produceOutput(AbstractMessageProducingHandler.java:212)\r\n\tat org.springframework.integration.handler.AbstractMessageProducingHandler.sendOutputs(AbstractMessageProducingHandler.java:129)\r\n\tat org.springframework.integration.handler.AbstractReplyProducingMessageHandler.handleMessageInternal(AbstractReplyProducingMessageHandler.java:115)\r\n\tat org.springframework.integration.handler.AbstractMessageHandler.handleMessage(AbstractMessageHandler.java:127)\r\n\tat org.springframework.integration.handler.MessageHandlerChain.handleMessageInternal(MessageHandlerChain.java:110)\r\n\tat org.springframework.integration.handler.AbstractMessageHandler.handleMessage(AbstractMessageHandler.java:127)\r\n\tat org.springframework.integration.dispatcher.AbstractDispatcher.tryOptimizedDispatch(AbstractDispatcher.java:116)\r\n\tat org.springframework.integration.dispatcher.UnicastingDispatcher.doDispatch(UnicastingDispatcher.java:148)\r\n\tat org.springframework.integration.dispatcher.UnicastingDispatcher.dispatch(UnicastingDispatcher.java:121)\r\n\tat org.springframework.integration.channel.AbstractSubscribableChannel.doSend(AbstractSubscribableChannel.java:77)\r\n\tat org.springframework.integration.channel.AbstractMessageChannel.send(AbstractMessageChannel.java:423)\r\n\tat org.springframework.integration.channel.AbstractMessageChannel.send(AbstractMessageChannel.java:373)\r\n\tat org.springframework.messaging.core.GenericMessagingTemplate.doSend(GenericMessagingTemplate.java:115)\r\n\tat org.springframework.messaging.core.GenericMessagingTemplate.doSend(GenericMessagingTemplate.java:45)\r\n\tat org.springframework.messaging.core.AbstractMessageSendingTemplate.send(AbstractMessageSendingTemplate.java:105)\r\n\tat com.eucalyptus.context.ServiceContext.lambda$dispatch$0(ServiceContext.java:187)\r\n\tat com.eucalyptus.context.ServiceContext.lambda$runWithContext$2(ServiceContext.java:292)\r\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\r\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\r\n\tat java.lang.Thread.run(Thread.java:748)\r\nCaused by: com.eucalyptus.objectstorage.exceptions.s3.InternalErrorException: We encountered an internal error. Please try again.\r\n\tat com.eucalyptus.objectstorage.ObjectFactoryImpl.createObject(ObjectFactoryImpl.java:335)\r\n\tat com.eucalyptus.objectstorage.ObjectStorageGateway.doPutOperation(ObjectStorageGateway.java:473)\r\n\t... 71 more\r\nTue Oct 24 16:29:51 2017  WARN [Contexts:eucalyptus-bootstrap-servicecontext-common-worker-671] Received a reply for absent client:  No channel to write response message: Found correlation id bc2c0217-e3c6-475f-83f1-df829caa023d but no corresponding context. for ExceptionResponseType\r\n{code}\r\n\r\nTo reproduce configure the aws cli as follows:\r\n\r\n{code}\r\n# cat .aws/config \r\n[default]\r\nregion = eucalyptus\r\ns3 =\r\n    signature_version = s3\r\n    multipart_threshold = 100MB\r\n{code}\r\n\r\nand ensure credentials are available for use by the aws cli, e.g.:\r\n\r\n{code}\r\n# eval $(euca-generate-environment-config)\r\n{code}\r\n\r\ncreate a ~50MB file and attempt to put at concurrency 50:\r\n\r\n{code}\r\n# head -c 50000000 /dev/urandom > random50.dat\r\n# aws --endpoint $S3_URL s3 mb s3://test\r\nmake_bucket: test\r\n# for N in {1..50}; do aws --endpoint $S3_URL s3 cp --quiet random50.dat s3://test/random50_$N.dat & done\r\n{code}\r\n\r\nThese steps to reproduce expect a single ufs host.","customfield_13200":null,"customfield_11300":null,"customfield_11500":null,"timetracking":{},"customfield_10005":null,"customfield_10401":null,"customfield_10600":null,"security":null,"customfield_12900":null,"attachment":[],"aggregatetimeestimate":null,"summary":"S3 put object fails with concurrency > 10","creator":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=sjones","name":"sjones","key":"sjones","accountId":"557058:f5dce1b0-db45-4dd6-a0e8-3cea5effb5ce","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue"},"displayName":"Steve Jones","active":true,"timeZone":"America/Los_Angeles"},"subtasks":[],"reporter":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=sjones","name":"sjones","key":"sjones","accountId":"557058:f5dce1b0-db45-4dd6-a0e8-3cea5effb5ce","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue"},"displayName":"Steve Jones","active":true,"timeZone":"America/Los_Angeles"},"aggregateprogress":{"progress":0,"total":0},"customfield_10000":null,"customfield_12100":"0|i04567:","customfield_10001":"2017-10-25T10:46:42.987-0500","customfield_10200":null,"customfield_10002":null,"customfield_10003":null,"customfield_10400":null,"customfield_12500":null,"customfield_10116":null,"customfield_11600":["kedwards(kedwards)","sjones(sjones)"],"customfield_10117":null,"environment":null,"customfield_11800":null,"customfield_11802":null,"duedate":null,"customfield_11805":null,"progress":{"progress":0,"total":0},"customfield_11806":null,"votes":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/EUCA-13452/votes","votes":0,"hasVoted":false},"comment":{"comments":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/62403/comment/128037","id":"128037","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=sjones","name":"sjones","key":"sjones","accountId":"557058:f5dce1b0-db45-4dd6-a0e8-3cea5effb5ce","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue"},"displayName":"Steve Jones","active":true,"timeZone":"America/Los_Angeles"},"body":"This issue occurs due to the configuration of the thread pool used for puts. You can check the pool by running the following command against a ufs host:\r\n\r\n{code}\r\n# euctl -U https://10.111.5.62:8773/services/Properties euca='com.eucalyptus.objectstorage.ObjectFactoryImpl.PUT_OBJECT_SERVICE'\r\njava.util.concurrent.ThreadPoolExecutor@1f8df27c[Running, pool size = 20, active threads = 20, queued tasks = 5, completed tasks = 702]\r\n{code}\r\n\r\nA work around for the issue is to increase the core size of the thread pool:\r\n\r\n{code}\r\n# euctl -U https://10.111.5.62:8773/services/Properties euca='com.eucalyptus.objectstorage.ObjectFactoryImpl.PUT_OBJECT_SERVICE.corePoolSize=100'\r\n100\r\n{code}\r\n\r\nthe core pool size can be checked using:\r\n\r\n{code}\r\n# euctl -U https://10.111.5.62:8773/services/Properties euca='com.eucalyptus.objectstorage.ObjectFactoryImpl.PUT_OBJECT_SERVICE.corePoolSize'\r\n100\r\n{code}\r\n\r\nwhen there are 10 active threads the next 200 put requests are queued up, which can cause timeouts for osg clients and lead to workers being stuck in the pool until their reads also timeout.\r\n\r\nThe core pool size would need to be modified each time a ufs service is restarted.","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=sjones","name":"sjones","key":"sjones","accountId":"557058:f5dce1b0-db45-4dd6-a0e8-3cea5effb5ce","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue"},"displayName":"Steve Jones","active":true,"timeZone":"America/Los_Angeles"},"created":"2017-10-24T19:07:08.287-0500","updated":"2017-10-24T19:07:08.287-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/62403/comment/128038","id":"128038","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=kedwards","name":"kedwards","key":"kedwards","accountId":"557058:f9c2f8da-1fc6-4aa7-8fb0-750e7e422b6b","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/d1746a6d05a30ca027012a7da4545962?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dkedwards%26avatarId%3D10200%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/d1746a6d05a30ca027012a7da4545962?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dkedwards%26avatarId%3D10200%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/d1746a6d05a30ca027012a7da4545962?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dkedwards%26avatarId%3D10200%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/d1746a6d05a30ca027012a7da4545962?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dkedwards%26avatarId%3D10200%26noRedirect%3Dtrue"},"displayName":"Ken Edwards","active":true,"timeZone":"America/Los_Angeles"},"body":"work around has been provided.","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=kedwards","name":"kedwards","key":"kedwards","accountId":"557058:f9c2f8da-1fc6-4aa7-8fb0-750e7e422b6b","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/d1746a6d05a30ca027012a7da4545962?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dkedwards%26avatarId%3D10200%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/d1746a6d05a30ca027012a7da4545962?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dkedwards%26avatarId%3D10200%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/d1746a6d05a30ca027012a7da4545962?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dkedwards%26avatarId%3D10200%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/d1746a6d05a30ca027012a7da4545962?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dkedwards%26avatarId%3D10200%26noRedirect%3Dtrue"},"displayName":"Ken Edwards","active":true,"timeZone":"America/Los_Angeles"},"created":"2017-10-25T10:46:42.987-0500","updated":"2017-10-25T10:46:42.987-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/62403/comment/128039","id":"128039","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=sjones","name":"sjones","key":"sjones","accountId":"557058:f5dce1b0-db45-4dd6-a0e8-3cea5effb5ce","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue"},"displayName":"Steve Jones","active":true,"timeZone":"America/Los_Angeles"},"body":"This issue can also be reproduced using multipart upload for an object with the following aws cli configuration:\r\n\r\n{code}\r\n# aws configure set region eucalyptus\r\n# aws configure set s3.max_concurrent_requests 11\r\n# aws configure set s3.multipart_threshold 64MB\r\n# aws configure set s3.multipart_chunksize 32MB\r\n# aws configure set s3.signature_version s3\r\n# cat .aws/config\r\n[default]\r\nregion = eucalyptus\r\ns3 =\r\n    max_concurrent_requests = 11\r\n    multipart_threshold = 64MB\r\n    multipart_chunksize = 32MB\r\n    signature_version = s3\r\n# \r\n{code}\r\n\r\nwith this particular configuration for concurrency and multipart sizes you can see issues with uploading a ~500MB object:\r\n\r\n{code}\r\n# head -c 500000000 /dev/urandom > random500.dat\r\n# aws --endpoint $S3_URL s3 mb s3://test\r\nmake_bucket: test\r\n# aws --endpoint $S3_URL s3 cp random500.dat s3://test/\r\n...\r\n{code}\r\n\r\nThe following shows issues after a few uploads of the object, checking the thread-pool executor after each:\r\n\r\n{code}\r\n#\r\n# euctl -U http://10.111.5.64:8773/services/Properties euca='com.eucalyptus.objectstorage.ObjectFactoryImpl.PUT_OBJECT_SERVICE'\r\njava.util.concurrent.ThreadPoolExecutor@2d9b9ee8[Running, pool size = 10, active threads = 0, queued tasks = 0, completed tasks = 853]\r\n# \r\n# \r\n# aws --endpoint $S3_URL s3 cp random500.dat s3://test/ \r\nupload: ./random500.dat to s3://test/random500.dat                  \r\n# \r\n# \r\n# euctl -U http://10.111.5.64:8773/services/Properties euca='com.eucalyptus.objectstorage.ObjectFactoryImpl.PUT_OBJECT_SERVICE'\r\njava.util.concurrent.ThreadPoolExecutor@2d9b9ee8[Running, pool size = 10, active threads = 1, queued tasks = 0, completed tasks = 869]\r\n# \r\n# \r\n# aws --endpoint $S3_URL s3 cp random500.dat s3://test/ \r\nupload: ./random500.dat to s3://test/random500.dat                  \r\n# \r\n# \r\n# euctl -U http://10.111.5.64:8773/services/Properties euca='com.eucalyptus.objectstorage.ObjectFactoryImpl.PUT_OBJECT_SERVICE'\r\njava.util.concurrent.ThreadPoolExecutor@2d9b9ee8[Running, pool size = 10, active threads = 3, queued tasks = 0, completed tasks = 885]\r\n# \r\n# \r\n# aws --endpoint $S3_URL s3 cp random500.dat s3://test/ \r\nupload: ./random500.dat to s3://test/random500.dat                  \r\n# \r\n# \r\n# euctl -U http://10.111.5.64:8773/services/Properties euca='com.eucalyptus.objectstorage.ObjectFactoryImpl.PUT_OBJECT_SERVICE'\r\njava.util.concurrent.ThreadPoolExecutor@2d9b9ee8[Running, pool size = 10, active threads = 7, queued tasks = 0, completed tasks = 901]\r\n# \r\n# \r\n# aws --endpoint $S3_URL s3 cp random500.dat s3://test/ \r\nupload failed: ./random500.dat to s3://test/random500.dat ('Connection aborted.', error(104, 'Connection reset by peer'))\r\n# \r\n# \r\n# euctl -U http://10.111.5.64:8773/services/Properties euca='com.eucalyptus.objectstorage.ObjectFactoryImpl.PUT_OBJECT_SERVICE'\r\njava.util.concurrent.ThreadPoolExecutor@2d9b9ee8[Running, pool size = 10, active threads = 10, queued tasks = 42, completed tasks = 907]\r\n# \r\n# \r\n{code}\r\n\r\nonce a few parts have timed out all the active threads are consumed and there is a backlog of queued tasks. Once in this state all uploads will fail until there are threads available:\r\n\r\n{code}\r\n#\r\n# date; euctl -U http://10.111.5.64:8773/services/Properties euca='com.eucalyptus.objectstorage.ObjectFactoryImpl.PUT_OBJECT_SERVICE'\r\nWed Oct 25 10:00:10 PDT 2017\r\njava.util.concurrent.ThreadPoolExecutor@2d9b9ee8[Running, pool size = 10, active threads = 10, queued tasks = 42, completed tasks = 907]\r\n# \r\n# \r\n# date; euctl -U http://10.111.5.64:8773/services/Properties euca='com.eucalyptus.objectstorage.ObjectFactoryImpl.PUT_OBJECT_SERVICE'\r\nWed Oct 25 10:01:12 PDT 2017\r\njava.util.concurrent.ThreadPoolExecutor@2d9b9ee8[Running, pool size = 10, active threads = 10, queued tasks = 32, completed tasks = 917]\r\n# \r\n# \r\n# date; euctl -U http://10.111.5.64:8773/services/Properties euca='com.eucalyptus.objectstorage.ObjectFactoryImpl.PUT_OBJECT_SERVICE'\r\nWed Oct 25 10:02:53 PDT 2017\r\njava.util.concurrent.ThreadPoolExecutor@2d9b9ee8[Running, pool size = 10, active threads = 10, queued tasks = 22, completed tasks = 927]\r\n# \r\n# \r\n# euctl -U http://10.111.5.64:8773/services/Properties euca='com.eucalyptus.objectstorage.ObjectFactoryImpl.PUT_OBJECT_SERVICE'\r\njava.util.concurrent.ThreadPoolExecutor@2d9b9ee8[Running, pool size = 10, active threads = 10, queued tasks = 12, completed tasks = 937]\r\n# \r\n# \r\n# date; euctl -U http://10.111.5.64:8773/services/Properties euca='com.eucalyptus.objectstorage.ObjectFactoryImpl.PUT_OBJECT_SERVICE'\r\nWed Oct 25 10:06:08 PDT 2017\r\njava.util.concurrent.ThreadPoolExecutor@2d9b9ee8[Running, pool size = 10, active threads = 10, queued tasks = 2, completed tasks = 947]\r\n# \r\n# \r\n# date; euctl -U http://10.111.5.64:8773/services/Properties euca='com.eucalyptus.objectstorage.ObjectFactoryImpl.PUT_OBJECT_SERVICE'\r\nWed Oct 25 10:07:29 PDT 2017\r\njava.util.concurrent.ThreadPoolExecutor@2d9b9ee8[Running, pool size = 10, active threads = 2, queued tasks = 0, completed tasks = 957]\r\n# \r\n# \r\n# date; euctl -U http://10.111.5.64:8773/services/Properties euca='com.eucalyptus.objectstorage.ObjectFactoryImpl.PUT_OBJECT_SERVICE'\r\nWed Oct 25 10:08:16 PDT 2017\r\njava.util.concurrent.ThreadPoolExecutor@2d9b9ee8[Running, pool size = 10, active threads = 0, queued tasks = 0, completed tasks = 959]\r\n#\r\n#\r\n{code}\r\n\r\nthe timestamps in the above show that it can take a number of minutes with no activity to clear the backlog. The required time to return to a good idle state (active threads = 0, queued tasks = 0) will increase as a multiple of the \"objectstorage.queue_timeout\", e.g. setting this value to 3 would mean the backlog would take 3 times longer to clear.\r\n\r\nThe work around noted above of increasing the core pool size will clear the backlog (queued tasks) faster and could immediately make some threads available for handling uploads.\r\n\r\nNote that the default value for concurrency with the aws cli is 10, so a single upload would come close to consuming all core threads.","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=sjones","name":"sjones","key":"sjones","accountId":"557058:f5dce1b0-db45-4dd6-a0e8-3cea5effb5ce","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue"},"displayName":"Steve Jones","active":true,"timeZone":"America/Los_Angeles"},"created":"2017-10-25T13:29:54.082-0500","updated":"2017-10-25T13:29:54.082-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/62403/comment/128040","id":"128040","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=sjones","name":"sjones","key":"sjones","accountId":"557058:f5dce1b0-db45-4dd6-a0e8-3cea5effb5ce","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue"},"displayName":"Steve Jones","active":true,"timeZone":"America/Los_Angeles"},"body":"A candidate fix for this issue is here:\r\n\r\nhttps://github.com/sjones4/eucalyptus/commit/3c45bc98831c47da7e30f3c45c5adcea4ccf07de\r\n\r\nwith this change a timed out client will consume a few seconds of thread pool time rather than minutes and the thread pool core size is increased from 10 to 100.","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=sjones","name":"sjones","key":"sjones","accountId":"557058:f5dce1b0-db45-4dd6-a0e8-3cea5effb5ce","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue"},"displayName":"Steve Jones","active":true,"timeZone":"America/Los_Angeles"},"created":"2017-10-25T13:45:55.500-0500","updated":"2017-10-25T13:45:55.500-0500"}],"maxResults":4,"total":4,"startAt":0},"customfield_11808":null,"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]}}}
{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"30226","self":"https://eucalyptus.atlassian.net/rest/api/2/issue/30226","key":"EUCA-9458","fields":{"issuetype":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://eucalyptus.atlassian.net/secure/viewavatar?size=xsmall&avatarId=14803&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":14803},"timespent":null,"customfield_13100":null,"project":{"self":"https://eucalyptus.atlassian.net/rest/api/2/project/10000","id":"10000","key":"EUCA","name":"Eucalyptus","avatarUrls":{"48x48":"https://eucalyptus.atlassian.net/secure/projectavatar?pid=10000&avatarId=10011","24x24":"https://eucalyptus.atlassian.net/secure/projectavatar?size=small&pid=10000&avatarId=10011","16x16":"https://eucalyptus.atlassian.net/secure/projectavatar?size=xsmall&pid=10000&avatarId=10011","32x32":"https://eucalyptus.atlassian.net/secure/projectavatar?size=medium&pid=10000&avatarId=10011"}},"customfield_11000":null,"customfield_11001":null,"fixVersions":[],"aggregatetimespent":null,"resolution":null,"customfield_10310":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/10207","value":"Ubuntu Precise","id":"10207"}],"customfield_11401":null,"customfield_10311":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/10308","value":"Managed-NOVLAN","id":"10308"}],"customfield_11400":null,"customfield_10302":null,"customfield_10500":{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/10403","value":"Not Applicable","id":"10403"},"customfield_10104":[],"customfield_10303":null,"customfield_10105":null,"customfield_10700":null,"customfield_10304":null,"customfield_10701":null,"customfield_10702":null,"customfield_10306":null,"customfield_10703":null,"customfield_10308":null,"customfield_10704":null,"resolutiondate":null,"customfield_10309":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/10204","value":"KVM","id":"10204"}],"customfield_10705":null,"workratio":-1,"watches":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/EUCA-9458/watchers","watchCount":3,"isWatching":false},"lastViewed":null,"created":"2014-05-23T13:28:32.167-0500","customfield_12000":null,"customfield_12400":null,"priority":{"self":"https://eucalyptus.atlassian.net/rest/api/2/priority/3","iconUrl":"https://eucalyptus.atlassian.net/images/icons/priorities/major.svg","name":"Major","id":"3"},"customfield_12201":null,"customfield_10102":null,"customfield_10300":null,"customfield_12600":"{}","labels":[],"customfield_10301":null,"customfield_11700":null,"aggregatetimeoriginalestimate":null,"timeestimate":null,"versions":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/version/13700","id":"13700","description":"Eucalyptus 3.4.2","name":"3.4.2","archived":false,"released":true,"releaseDate":"2014-02-24"}],"customfield_11901":null,"issuelinks":[{"id":"25019","self":"https://eucalyptus.atlassian.net/rest/api/2/issueLink/25019","type":{"id":"10103","name":"Relates","inward":"relates to","outward":"relates to","self":"https://eucalyptus.atlassian.net/rest/api/2/issueLinkType/10103"},"outwardIssue":{"id":"13512","key":"EUCA-2325","self":"https://eucalyptus.atlassian.net/rest/api/2/issue/13512","fields":{"summary":"Attach volume on Ubuntu 12.04 64-bit makes cluster nonfunctional","status":{"self":"https://eucalyptus.atlassian.net/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://eucalyptus.atlassian.net/images/icons/statuses/generic.png","name":"Closed","id":"6","statusCategory":{"self":"https://eucalyptus.atlassian.net/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://eucalyptus.atlassian.net/rest/api/2/priority/2","iconUrl":"https://eucalyptus.atlassian.net/images/icons/priorities/critical.svg","name":"Critical","id":"2"},"issuetype":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://eucalyptus.atlassian.net/secure/viewavatar?size=xsmall&avatarId=14803&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":14803}}}},{"id":"25018","self":"https://eucalyptus.atlassian.net/rest/api/2/issueLink/25018","type":{"id":"10103","name":"Relates","inward":"relates to","outward":"relates to","self":"https://eucalyptus.atlassian.net/rest/api/2/issueLinkType/10103"},"outwardIssue":{"id":"18331","key":"EUCA-4604","self":"https://eucalyptus.atlassian.net/rest/api/2/issue/18331","fields":{"summary":"libvirt+NC hangs/restarts during virDomainAttachDevice () when using multipath","status":{"self":"https://eucalyptus.atlassian.net/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://eucalyptus.atlassian.net/images/icons/statuses/generic.png","name":"Closed","id":"6","statusCategory":{"self":"https://eucalyptus.atlassian.net/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://eucalyptus.atlassian.net/rest/api/2/priority/2","iconUrl":"https://eucalyptus.atlassian.net/images/icons/priorities/critical.svg","name":"Critical","id":"2"},"issuetype":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://eucalyptus.atlassian.net/secure/viewavatar?size=xsmall&avatarId=14803&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":14803}}}},{"id":"25020","self":"https://eucalyptus.atlassian.net/rest/api/2/issueLink/25020","type":{"id":"10103","name":"Relates","inward":"relates to","outward":"relates to","self":"https://eucalyptus.atlassian.net/rest/api/2/issueLinkType/10103"},"outwardIssue":{"id":"17511","key":"EUCA-4242","self":"https://eucalyptus.atlassian.net/rest/api/2/issue/17511","fields":{"summary":"NC: node controller locks up with one thread in libvirt","status":{"self":"https://eucalyptus.atlassian.net/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://eucalyptus.atlassian.net/images/icons/statuses/generic.png","name":"Closed","id":"6","statusCategory":{"self":"https://eucalyptus.atlassian.net/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://eucalyptus.atlassian.net/rest/api/2/priority/3","iconUrl":"https://eucalyptus.atlassian.net/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://eucalyptus.atlassian.net/secure/viewavatar?size=xsmall&avatarId=14803&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":14803}}}}],"assignee":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=dmitrii","name":"dmitrii","key":"dmitrii","accountId":"557058:1e0ea807-434b-4b54-967f-1dec4a9ede55","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue"},"displayName":"Dmitrii Calzago","active":false,"timeZone":"America/Los_Angeles"},"updated":"2014-05-29T16:28:54.102-0500","status":{"self":"https://eucalyptus.atlassian.net/rest/api/2/status/10000","description":"This issue has not yet been validated, and is not currently being investigated.","iconUrl":"https://eucalyptus.atlassian.net/images/icons/statuses/generic.png","name":"Unconfirmed","id":"10000","statusCategory":{"self":"https://eucalyptus.atlassian.net/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"components":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/component/10010","id":"10010","name":"Node Controller"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/component/10014","id":"10014","name":"Storage Controller"}],"timeoriginalestimate":null,"description":"Hi guys!\r\n\r\nI create a new instance, I can ping to it and login using ssh... I'm also able to create or delete volumes but when I try to attach a volume to an instance many errors shows up and ping or ssh stop working.\r\n\r\nh4.Configuration\r\nAll cloud components run on the same server\r\nMANAGED-NOVLAN\r\nStorage is in overlay\r\n\r\nh4.Error messages\r\n- euca-attach-volume command does not show errors\r\n- cc.log\r\n{quote}\r\n2014-05-23 11:24:49  INFO | [i-E4EE4419][vol-F65B3CCE] attaching volume\r\n2014-05-23 11:25:49 ERROR | operation on 10.0.0.150 could not be invoked (check NC host, port, and credentials): Response timed out\r\n2014-05-23 11:25:49 ERROR | doAttachVolume() failed\r\n2014-05-23 11:26:09 ERROR | select() timed out for read: timeout=20\r\n2014-05-23 11:26:09 ERROR | BUG: child process 11723 handling 'ncDescribeResource' was terminated with 1 (core=0)\r\n2014-05-23 11:26:09 ERROR | bad return from ncDescribeResource(10.0.0.150) (1)\r\n2014-05-23 11:26:09 ERROR | error message from ncDescribeResource: UNSET\r\n{quote}\r\n\r\n- cloud-output.log (attached file)\r\n\r\n- kern.log \r\n{quote}\r\nMay 23 11:24:50 node1 kernel: [67262.371920] scsi5 : iSCSI Initiator over TCP/IP\r\nMay 23 11:24:51 node1 kernel: [67263.383132] scsi 5:0:0:0: RAID              IET      Controller       0001 PQ: 0 ANSI: 5\r\nMay 23 11:24:51 node1 kernel: [67263.383343] scsi 5:0:0:0: Attached scsi generic sg3 type 12\r\nMay 23 11:24:51 node1 kernel: [67263.383761] scsi 5:0:0:1: Direct-Access     IET      VIRTUAL-DISK     0001 PQ: 0 ANSI: 5\r\nMay 23 11:24:51 node1 kernel: [67263.383919] sd 5:0:0:1: Attached scsi generic sg4 type 0\r\nMay 23 11:24:51 node1 kernel: [67263.384247] sd 5:0:0:1: [sdb] 4194304 512-byte logical blocks: (2.14 GB/2.00 GiB)\r\nMay 23 11:24:51 node1 kernel: [67263.384993] sd 5:0:0:1: [sdb] Write Protect is off\r\nMay 23 11:24:51 node1 kernel: [67263.384997] sd 5:0:0:1: [sdb] Mode Sense: 49 00 00 08\r\nMay 23 11:24:51 node1 kernel: [67263.385163] sd 5:0:0:1: [sdb] Write cache: enabled, read cache: enabled, doesn't support DPO or FUA\r\nMay 23 11:24:51 node1 kernel: [67263.387420]  sdb: unknown partition table\r\nMay 23 11:24:51 node1 kernel: [67263.388438] sd 5:0:0:1: [sdb] Attached SCSI disk\r\nMay 23 11:24:53 node1 kernel: [67264.998360] type=1400 audit(1400865893.437:49): apparmor=\"STATUS\" operation=\"profile_replace\" parent=11642 profile=\"unconfined\" name=\"libvirt-49fa5c57-6f5a-20b9-fa4e-3c406c7f2de0\" pid=11643 comm=\"apparmor_parser\"\r\n{quote}\r\n\r\nthanks in advance \r\n","customfield_13000":null,"customfield_13200":null,"customfield_11300":null,"customfield_11500":null,"timetracking":{},"customfield_10401":null,"customfield_10005":null,"customfield_10600":null,"customfield_12900":null,"attachment":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/attachment/20044","id":"20044","filename":"cloud-output.log","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=turoart","name":"turoart","key":"turoart","accountId":"557058:722e2c3f-9771-4b55-9442-a8ea66d571a7","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/6ea0607516806bb9505ab59fedc6b7c6?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FavatarId%3D10122%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/6ea0607516806bb9505ab59fedc6b7c6?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26avatarId%3D10122%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/6ea0607516806bb9505ab59fedc6b7c6?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26avatarId%3D10122%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/6ea0607516806bb9505ab59fedc6b7c6?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26avatarId%3D10122%26noRedirect%3Dtrue"},"displayName":"Arturo Vargas","active":true,"timeZone":"America/Costa_Rica"},"created":"2014-05-23T13:28:32.188-0500","size":48201,"mimeType":"text/x-log","content":"https://eucalyptus.atlassian.net/secure/attachment/20044/cloud-output.log"}],"aggregatetimeestimate":null,"summary":"Node controller stop working after attach volume to instance","creator":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=turoart","name":"turoart","key":"turoart","accountId":"557058:722e2c3f-9771-4b55-9442-a8ea66d571a7","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/6ea0607516806bb9505ab59fedc6b7c6?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FavatarId%3D10122%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/6ea0607516806bb9505ab59fedc6b7c6?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26avatarId%3D10122%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/6ea0607516806bb9505ab59fedc6b7c6?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26avatarId%3D10122%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/6ea0607516806bb9505ab59fedc6b7c6?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26avatarId%3D10122%26noRedirect%3Dtrue"},"displayName":"Arturo Vargas","active":true,"timeZone":"America/Costa_Rica"},"subtasks":[],"reporter":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=turoart","name":"turoart","key":"turoart","accountId":"557058:722e2c3f-9771-4b55-9442-a8ea66d571a7","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/6ea0607516806bb9505ab59fedc6b7c6?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FavatarId%3D10122%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/6ea0607516806bb9505ab59fedc6b7c6?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26avatarId%3D10122%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/6ea0607516806bb9505ab59fedc6b7c6?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26avatarId%3D10122%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/6ea0607516806bb9505ab59fedc6b7c6?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26avatarId%3D10122%26noRedirect%3Dtrue"},"displayName":"Arturo Vargas","active":true,"timeZone":"America/Costa_Rica"},"customfield_10000":null,"customfield_12100":"0|i02q5j:","aggregateprogress":{"progress":0,"total":0},"customfield_10001":"2014-05-27T13:49:54.739-0500","customfield_10002":null,"customfield_10200":null,"customfield_10003":null,"customfield_10400":null,"customfield_12500":null,"customfield_10116":null,"customfield_11600":["turoart(turoart)","dmitrii(dmitrii)"],"customfield_10117":null,"environment":"Ubuntu 12.04","customfield_11800":null,"customfield_11802":null,"customfield_11805":null,"duedate":null,"progress":{"progress":0,"total":0},"customfield_11806":null,"comment":{"comments":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/30226/comment/71411","id":"71411","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=dmitrii","name":"dmitrii","key":"dmitrii","accountId":"557058:1e0ea807-434b-4b54-967f-1dec4a9ede55","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue"},"displayName":"Dmitrii Calzago","active":false,"timeZone":"America/Los_Angeles"},"body":"Hi, [~turoart]!\r\n\r\nI assume you posted the kern.log snippet from the NC? What is happening in the *nc.log* and *httpd-nc_error_log* around the same time? I am also thinking, if the NC host became unreachable, that is quite a serious failure and there must be something in */var/log/dmesg* or */var/log/messages* on the NC about that, no?\r\n\r\nBased on the kern.log it looks like the iSCSI target was attached successfully and the block device became available on the host OS. So, perhaps the problems occurred when libvirt tried passing that device to the guest? Another couple logs to check for abnormalities would be */var/log/libvirt/libvirtd.log* and */var/log/libvirt/qemu/i-XXXXXX.log* for the instance.","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=dmitrii","name":"dmitrii","key":"dmitrii","accountId":"557058:1e0ea807-434b-4b54-967f-1dec4a9ede55","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue"},"displayName":"Dmitrii Calzago","active":false,"timeZone":"America/Los_Angeles"},"created":"2014-05-27T13:49:54.739-0500","updated":"2014-05-27T13:49:54.739-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/30226/comment/71468","id":"71468","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=turoart","name":"turoart","key":"turoart","accountId":"557058:722e2c3f-9771-4b55-9442-a8ea66d571a7","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/6ea0607516806bb9505ab59fedc6b7c6?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FavatarId%3D10122%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/6ea0607516806bb9505ab59fedc6b7c6?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26avatarId%3D10122%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/6ea0607516806bb9505ab59fedc6b7c6?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26avatarId%3D10122%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/6ea0607516806bb9505ab59fedc6b7c6?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26avatarId%3D10122%26noRedirect%3Dtrue"},"displayName":"Arturo Vargas","active":true,"timeZone":"America/Costa_Rica"},"body":"Thanks [~dmitrii]\r\n\r\nThe kern.log snippet is from the NC. nc.log does not show errors.\r\nhttpd-nc_error_log shows this but happens before attaching the volume, even before I create the instance... \r\n{quote}\r\n[error] server reached MaxClients setting, consider raising the MaxClients setting\r\n{quote}\r\n\r\nI check libvirtd.log and /var/log/libvirt/qemu/i-XXXXXX.log but none show new messages when I attach the volume.\r\n\r\nNC host is reachable but it is the service that stops working. After trying attach the volume I am no longer able to create instances, if I restart the service *sudo service eucalyptus-nc restart* I get the error:\r\n{quote}\r\n* Restarting Eucalyptus services                                       (98)Address already in use: make_sock: could not bind to address 0.0.0.0:8775\r\nno listening sockets available, shutting down\r\nUnable to open logs\r\n\r\nFailed to start the NC!\r\n{quote} \r\n\r\ndmesg does not show errors...\r\nsyslog show something similar to kern.log but with one or two additional lines\r\n{quote}\r\nMay 27 17:56:45 node1 kernel: [ 3255.014195] scsi5 : iSCSI Initiator over TCP/IP\r\nMay 27 17:56:46 node1 kernel: [ 3256.031110] scsi 5:0:0:0: RAID              IET      Controller       0001 PQ: 0 ANSI: 5\r\nMay 27 17:56:46 node1 kernel: [ 3256.031386] scsi 5:0:0:0: Attached scsi generic sg3 type 12\r\nMay 27 17:56:46 node1 kernel: [ 3256.032010] scsi 5:0:0:1: Direct-Access     IET      VIRTUAL-DISK     0001 PQ: 0 ANSI: 5\r\nMay 27 17:56:46 node1 kernel: [ 3256.032263] sd 5:0:0:1: Attached scsi generic sg4 type 0\r\nMay 27 17:56:46 node1 kernel: [ 3256.032451] sd 5:0:0:1: [sdb] 4194304 512-byte logical blocks: (2.14 GB/2.00 GiB)\r\nMay 27 17:56:46 node1 kernel: [ 3256.032845] sd 5:0:0:1: [sdb] Write Protect is off\r\nMay 27 17:56:46 node1 kernel: [ 3256.032855] sd 5:0:0:1: [sdb] Mode Sense: 49 00 00 08\r\nMay 27 17:56:46 node1 kernel: [ 3256.033111] sd 5:0:0:1: [sdb] Write cache: enabled, read cache: enabled, doesn't support DPO or FUA\r\nMay 27 17:56:46 node1 kernel: [ 3256.035409]  sdb: unknown partition table\r\nMay 27 17:56:46 node1 kernel: [ 3256.036402] sd 5:0:0:1: [sdb] Attached SCSI disk\r\nMay 27 17:56:46 node1 iscsid: connection1:0 is operational now\r\nMay 27 17:56:48 node1 kernel: [ 3257.634737] type=1400 audit(1401235008.096:50): apparmor=\"STATUS\" operation=\"profile_replace\" parent=13914 profile=\"unconfined\" name=\"libvirt-1752de47-42d3-867a-bf3e-86b9dca7778b\" pid=13915 comm=\"apparmor_parser\"\r\nMay 27 17:57:45 node1 tgtd: tgt_target_destroy(1936) target 12 still has it nexus\r\nMay 27 17:57:48  tgtd: last message repeated 3 times\r\nMay 27 17:57:48 node1 udevd[13889]: inotify_add_watch(6, /dev/dm-33, 10) failed: No such file or directory\r\n{quote}\r\n\r\nThat is all I got, I don't find any other error message \r\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=turoart","name":"turoart","key":"turoart","accountId":"557058:722e2c3f-9771-4b55-9442-a8ea66d571a7","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/6ea0607516806bb9505ab59fedc6b7c6?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FavatarId%3D10122%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/6ea0607516806bb9505ab59fedc6b7c6?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26avatarId%3D10122%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/6ea0607516806bb9505ab59fedc6b7c6?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26avatarId%3D10122%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/6ea0607516806bb9505ab59fedc6b7c6?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26avatarId%3D10122%26noRedirect%3Dtrue"},"displayName":"Arturo Vargas","active":true,"timeZone":"America/Costa_Rica"},"created":"2014-05-27T19:11:07.133-0500","updated":"2014-05-27T19:11:07.133-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/30226/comment/71474","id":"71474","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=dmitrii","name":"dmitrii","key":"dmitrii","accountId":"557058:1e0ea807-434b-4b54-967f-1dec4a9ede55","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue"},"displayName":"Dmitrii Calzago","active":false,"timeZone":"America/Los_Angeles"},"body":"Interesting. Those extra few lines in *syslog* may be a clue. It sounds like NC may be locking up in a deadlock. When the service stops working, could you see if you have a couple httpd processes as follows:\r\n\r\n{code}\r\n# ps aux | grep httpd-nc\r\nroot      3488  0.0  0.0 103252   828 pts/0    S+   17:17   0:00 grep httpd-nc\r\nroot     11577  0.0  0.0  55276  1516 ?        Ss   May12   0:16 /usr/sbin/httpd -f /opt/eucalyptus/etc/eucalyptus/httpd-nc.conf\r\n500      11579  0.3  2.8 949044 232368 ?       Sl   May12  86:56 /usr/sbin/httpd -f /opt/eucalyptus/etc/eucalyptus/httpd-nc.conf\r\n{code}\r\n\r\nand could you obtain and share the thread dump from the one owned by the non-root user (e.g., 500 in this case)?\r\n\r\n{code}\r\n# pstack 11579\r\nThread 3 (Thread 0x7f55896c9700 (LWP 11580)):\r\n#0  0x00007f55abf5ecdd in nanosleep () from /lib64/libc.so.6\r\n#1  0x00007f55abf93e54 in usleep () from /lib64/libc.so.6\r\n#2  0x00007f55a792ba45 in sensor_bottom_half () from /opt/eucalyptus/packages/axis2c-1.6.0/services/EucalyptusNC/libEucalyptusNC.so\r\n#3  0x00007f55a792bfc9 in sensor_thread () from /opt/eucalyptus/packages/axis2c-1.6.0/services/EucalyptusNC/libEucalyptusNC.so\r\n#4  0x00007f55ac24d9d1 in start_thread () from /lib64/libpthread.so.0\r\n#5  0x00007f55abf9ab6d in clone () from /lib64/libc.so.6\r\nThread 2 (Thread 0x7f55a210a700 (LWP 11598)):\r\n#0  0x00007f55abf5ecdd in nanosleep () from /lib64/libc.so.6\r\n#1  0x00007f55abf5eb50 in sleep () from /lib64/libc.so.6\r\n#2  0x00007f55a78ddaa9 in monitoring_thread () from /opt/eucalyptus/packages/axis2c-1.6.0/services/EucalyptusNC/libEucalyptusNC.so\r\n#3  0x00007f55ac24d9d1 in start_thread () from /lib64/libpthread.so.0\r\n#4  0x00007f55abf9ab6d in clone () from /lib64/libc.so.6\r\nThread 1 (Thread 0x7f55ad9617e0 (LWP 11579)):\r\n#0  0x00007f55abf9ce9f in accept4 () from /lib64/libc.so.6\r\n#1  0x00007f55ac47ee8a in apr_socket_accept () from /usr/lib64/libapr-1.so.0\r\n#2  0x00007f55ad9b7be1 in unixd_accept ()\r\n#3  0x00007f55ad9b6913 in ?? ()\r\n#4  0x00007f55ad9b6c8a in ?? ()\r\n#5  0x00007f55ad9b790c in ap_mpm_run ()\r\n#6  0x00007f55ad98e900 in main ()\r\n{code} \r\n\r\n(you may need to install the {{gdb}} package to get the {{pstack}} tool)\r\n\r\nThanks for your help!","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=dmitrii","name":"dmitrii","key":"dmitrii","accountId":"557058:1e0ea807-434b-4b54-967f-1dec4a9ede55","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue"},"displayName":"Dmitrii Calzago","active":false,"timeZone":"America/Los_Angeles"},"created":"2014-05-27T19:22:42.908-0500","updated":"2014-05-27T19:22:42.908-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/30226/comment/71536","id":"71536","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=turoart","name":"turoart","key":"turoart","accountId":"557058:722e2c3f-9771-4b55-9442-a8ea66d571a7","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/6ea0607516806bb9505ab59fedc6b7c6?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FavatarId%3D10122%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/6ea0607516806bb9505ab59fedc6b7c6?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26avatarId%3D10122%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/6ea0607516806bb9505ab59fedc6b7c6?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26avatarId%3D10122%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/6ea0607516806bb9505ab59fedc6b7c6?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26avatarId%3D10122%26noRedirect%3Dtrue"},"displayName":"Arturo Vargas","active":true,"timeZone":"America/Costa_Rica"},"body":"Hi, thanks you for all the suggestions \r\n{quote}\r\n# ps aux | grep httpd-nc\r\nroot      3285  0.0  0.0  51032  1524 ?        Ss   10:22   0:00 /usr/sbin/apache2 -f //etc/eucalyptus/httpd-nc.conf\r\n1001      3289  0.6  0.6 887432 215088 ?       Sl   10:22   0:10 /usr/sbin/apache2 -f //etc/eucalyptus/httpd-nc.conf\r\n{quote}\r\n\r\nI think I'm missing something with pstack  \r\n{quote}\r\n3289: /usr/sbin/apache2 -f //etc/eucalyptus/httpd-nc.conf\r\n(No symbols found)\r\n0x7fda84075d2d: ???? (0, 51, 7fda84b41580, 7fda85a2c0a8, 7fda85a2cd58, 7fda85a2d498) + ffffffffff08e3b8\r\n0x00000000: ???? (7fda740008c0, 7fda84b99930, 0, 7fda73fff700, 7fda84970028, 7fda84ab93a0) + ffffffffffeb8ca0\r\n0x7fda84ab9370: ???? (7fda84ab7028, 7fda84970038, 0, 0, 7fda85a22010, 0) + 146fc0\r\n0x00000000: ???? (7fda84abd028, 7fda84964038, 7fda84ab9320, 0, 7fda85a22010, 0) + 7bfc0\r\n0x7fda84970028: ???? (0, 7fda84b33038, 7fda84a92140, 0, 7fda85a22010, 0) + 1fc0\r\n0x7fda84964028: ???? (7fda84b39028, 7fda84b27038, 7fda84b37ac0, 0, 7fda85a22010, 0) + 3fc0\r\n0x7fda84abb028: ???? (0, 0, 7fda84b3b0d0, 0, 7fda85a22010, 0) + ffff80257b4c4f98\r\n{quote}\r\n\r\nis there another way to get the thread dump?\r\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=turoart","name":"turoart","key":"turoart","accountId":"557058:722e2c3f-9771-4b55-9442-a8ea66d571a7","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/6ea0607516806bb9505ab59fedc6b7c6?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FavatarId%3D10122%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/6ea0607516806bb9505ab59fedc6b7c6?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26avatarId%3D10122%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/6ea0607516806bb9505ab59fedc6b7c6?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26avatarId%3D10122%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/6ea0607516806bb9505ab59fedc6b7c6?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26avatarId%3D10122%26noRedirect%3Dtrue"},"displayName":"Arturo Vargas","active":true,"timeZone":"America/Costa_Rica"},"created":"2014-05-28T12:44:45.880-0500","updated":"2014-05-28T12:44:45.880-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/30226/comment/71538","id":"71538","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=turoart","name":"turoart","key":"turoart","accountId":"557058:722e2c3f-9771-4b55-9442-a8ea66d571a7","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/6ea0607516806bb9505ab59fedc6b7c6?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FavatarId%3D10122%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/6ea0607516806bb9505ab59fedc6b7c6?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26avatarId%3D10122%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/6ea0607516806bb9505ab59fedc6b7c6?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26avatarId%3D10122%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/6ea0607516806bb9505ab59fedc6b7c6?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26avatarId%3D10122%26noRedirect%3Dtrue"},"displayName":"Arturo Vargas","active":true,"timeZone":"America/Costa_Rica"},"body":"I got this using gdb\r\n\r\n{code}\r\nThread 5 (Thread 0x7fda73fff700 (LWP 3291)):\r\n#0  0x00007fda83d8fa43 in poll () from /lib/x86_64-linux-gnu/libc.so.6\r\n#1  0x00007fda7f19b3ac in ?? () from /usr/lib/libvirt.so.0\r\n#2  0x00007fda7f19c011 in ?? () from /usr/lib/libvirt.so.0\r\n#3  0x00007fda7f19d250 in ?? () from /usr/lib/libvirt.so.0\r\n#4  0x00007fda7f19d947 in ?? () from /usr/lib/libvirt.so.0\r\n#5  0x00007fda7f181920 in ?? () from /usr/lib/libvirt.so.0\r\n#6  0x00007fda7f181a74 in ?? () from /usr/lib/libvirt.so.0\r\n#7  0x00007fda7f1836e7 in ?? () from /usr/lib/libvirt.so.0\r\n#8  0x00007fda7f162a30 in virDomainAttachDevice () from /usr/lib/libvirt.so.0\r\n#9  0x00007fda7fece6a4 in doAttachVolume (nc=0x7fda8018ee80, pMeta=<optimized out>, instanceId=0x7fda7806bad8 \"i-F2CA3F1C\", \r\n    volumeId=0x7fda7806bbb0 \"vol-9A4643AA\", \r\n    attachmentToken=0x7fda7806bde8 \"sc://vol-9A4643AA,XEXalDv2hfgTI+B20m+oaJO5kXJgZnfDHtFmBMVe/G7A0yY0DRYb4caBt+MJ4va+MjRxonmkuFqgy+IJixtRU+hw96vUWGzuh2QuofpRh0/PzWt3OZJIgYwV5TGD0hIzbdnirr+YtdgKcM5feSuPaECsO7krYh/VDDHManfSMIpTryHsriHQlG\"..., localDev=<optimized out>)\r\n    at handlers_default.c:1240\r\n#10 0x00007fda7feb86b2 in ncAttachVolumeMarshal (ncAttachVolume=<optimized out>, env=0x7fda849620e8) at server-marshal.c:790\r\n#11 0x00007fda7feb2615 in axis2_svc_skel_EucalyptusNC_invoke (svc_skeleton=<optimized out>, env=0x7fda849620e8, content_node=0x7fda84953ef0, \r\n    msg_ctx=<optimized out>) at axis2_svc_skel_EucalyptusNC.c:632\r\n#12 0x00007fda82fea265 in ?? () from /usr/lib/axis2/lib/libaxis2_engine.so.0\r\n#13 0x00007fda82fe9f91 in ?? () from /usr/lib/axis2/lib/libaxis2_engine.so.0\r\n#14 0x00007fda82fe060e in axis2_engine_receive () from /usr/lib/axis2/lib/libaxis2_engine.so.0\r\n#15 0x00007fda832357db in axis2_http_transport_utils_process_http_post_request () from /usr/lib/apache2/modules/libmod_axis2.so\r\n#16 0x00007fda832318f9 in axis2_apache2_worker_process_request () from /usr/lib/apache2/modules/libmod_axis2.so\r\n#17 0x00007fda8322f7d4 in ?? () from /usr/lib/apache2/modules/libmod_axis2.so\r\n#18 0x00007fda84b83bb8 in ap_run_handler ()\r\n#19 0x00007fda84b8402e in ap_invoke_handler ()\r\n#20 0x00007fda84b93990 in ap_process_request ()\r\n#21 0x00007fda84b907b8 in ?? ()\r\n#22 0x00007fda84b8a658 in ap_run_process_connection ()\r\n#23 0x00007fda84b99b5c in ?? ()\r\n#24 0x00007fda842b2417 in ?? () from /usr/lib/libapr-1.so.0\r\n#25 0x00007fda8406ee9a in start_thread () from /lib/x86_64-linux-gnu/libpthread.so.0\r\n#26 0x00007fda83d9b3fd in clone () from /lib/x86_64-linux-gnu/libc.so.6\r\n#27 0x0000000000000000 in ?? ()\r\n\r\nThread 4 (Thread 0x7fda737fe700 (LWP 3292)):\r\n#0  0x00007fda84072d84 in pthread_cond_wait@@GLIBC_2.3.2 () from /lib/x86_64-linux-gnu/libpthread.so.0\r\n#1  0x00007fda842a07c0 in apr_thread_cond_wait () from /usr/lib/libapr-1.so.0\r\n#2  0x00007fda84b9ae04 in ap_queue_info_wait_for_idler ()\r\n---Type <return> to continue, or q <return> to quit---\r\n#3  0x00007fda84b997e9 in ?? ()\r\n#4  0x00007fda842b2417 in ?? () from /usr/lib/libapr-1.so.0\r\n#5  0x00007fda8406ee9a in start_thread () from /lib/x86_64-linux-gnu/libpthread.so.0\r\n#6  0x00007fda83d9b3fd in clone () from /lib/x86_64-linux-gnu/libc.so.6\r\n#7  0x0000000000000000 in ?? ()\r\n\r\nThread 3 (Thread 0x7fda72de7700 (LWP 5128)):\r\n#0  0x00007fda84072d84 in pthread_cond_wait@@GLIBC_2.3.2 () from /lib/x86_64-linux-gnu/libpthread.so.0\r\n#1  0x00007fda7ff0a35b in sem_prolaag (pSem=0x7fda7401fa40, doLog=<optimized out>) at ipc.c:378\r\n#2  0x00007fda7ff1390d in sensor_bottom_half () at sensor.c:487\r\n#3  0x00007fda7ff13c83 in sensor_thread (arg=<optimized out>) at sensor.c:511\r\n#4  0x00007fda8406ee9a in start_thread () from /lib/x86_64-linux-gnu/libpthread.so.0\r\n#5  0x00007fda83d9b3fd in clone () from /lib/x86_64-linux-gnu/libc.so.6\r\n#6  0x0000000000000000 in ?? ()\r\n\r\nThread 2 (Thread 0x7fda725e6700 (LWP 5240)):\r\n#0  0x00007fda84072d84 in pthread_cond_wait@@GLIBC_2.3.2 () from /lib/x86_64-linux-gnu/libpthread.so.0\r\n#1  0x00007fda7ff0a35b in sem_prolaag (pSem=0x7fda7401fa40, doLog=<optimized out>) at ipc.c:378\r\n#2  0x00007fda7febe083 in lock_hypervisor_conn () at handlers.c:764\r\n#3  0x00007fda7fec5aa2 in refresh_instance_info (instance=0x7fda74041660, nc=<optimized out>) at handlers.c:961\r\n#4  monitoring_thread (arg=<optimized out>) at handlers.c:1367\r\n#5  0x00007fda8406ee9a in start_thread () from /lib/x86_64-linux-gnu/libpthread.so.0\r\n#6  0x00007fda83d9b3fd in clone () from /lib/x86_64-linux-gnu/libc.so.6\r\n#7  0x0000000000000000 in ?? ()\r\n\r\nThread 1 (Thread 0x7fda84b2d740 (LWP 3289)):\r\n#0  0x00007fda84075d2d in read () from /lib/x86_64-linux-gnu/libpthread.so.0\r\n#1  0x00007fda84b9b264 in ap_mpm_pod_check ()\r\n#2  0x00007fda84b6de65 in ?? ()\r\n#3  0x00007fda84b99d2e in ?? ()\r\n#4  0x00007fda84b9a605 in ap_mpm_run ()\r\n#5  0x00007fda84b6eb58 in main ()\r\n{code}","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=turoart","name":"turoart","key":"turoart","accountId":"557058:722e2c3f-9771-4b55-9442-a8ea66d571a7","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/6ea0607516806bb9505ab59fedc6b7c6?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FavatarId%3D10122%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/6ea0607516806bb9505ab59fedc6b7c6?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26avatarId%3D10122%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/6ea0607516806bb9505ab59fedc6b7c6?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26avatarId%3D10122%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/6ea0607516806bb9505ab59fedc6b7c6?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26avatarId%3D10122%26noRedirect%3Dtrue"},"displayName":"Arturo Vargas","active":true,"timeZone":"America/Costa_Rica"},"created":"2014-05-28T13:04:06.271-0500","updated":"2014-05-28T13:04:06.271-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/30226/comment/71539","id":"71539","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=dmitrii","name":"dmitrii","key":"dmitrii","accountId":"557058:1e0ea807-434b-4b54-967f-1dec4a9ede55","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue"},"displayName":"Dmitrii Calzago","active":false,"timeZone":"America/Los_Angeles"},"body":"Darn it, I forgot that package binaries do not have debug symbols compiled into them. (My example was with a development version of NC compiled from source.)\r\n\r\nIt looks like you do have the NC running, though, which reinforces my theory that it deadlocks somewhere upon volume attachment. Are there any other processes that are related to Eucalyptus? E.g., if you were to run {{pstree}} with the PID of that non-root NC apache process, are there child processes? (I am wondering if the deadlock is in NC's code or if NC is waiting for an external helper process to complete.)","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=dmitrii","name":"dmitrii","key":"dmitrii","accountId":"557058:1e0ea807-434b-4b54-967f-1dec4a9ede55","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue"},"displayName":"Dmitrii Calzago","active":false,"timeZone":"America/Los_Angeles"},"created":"2014-05-28T13:06:06.630-0500","updated":"2014-05-28T13:06:06.630-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/30226/comment/71542","id":"71542","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=dmitrii","name":"dmitrii","key":"dmitrii","accountId":"557058:1e0ea807-434b-4b54-967f-1dec4a9ede55","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue"},"displayName":"Dmitrii Calzago","active":false,"timeZone":"America/Los_Angeles"},"body":"Ah, that's helpful, [~turoart]! So, indeed, the whole NC is deadlocked waiting for {{virDomainAttachDevice()}} call to succeed. It's a bug in libvirt (or deeper in KVM perhaps) and we've seen it before. Let me dig around to see how we've dealt with it in the past. In general, if you are able to upgrade (or downgrade) the libvirt library, that may magically solve the problem. Perhaps, though, there is some other way to avoid it.","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=dmitrii","name":"dmitrii","key":"dmitrii","accountId":"557058:1e0ea807-434b-4b54-967f-1dec4a9ede55","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue"},"displayName":"Dmitrii Calzago","active":false,"timeZone":"America/Los_Angeles"},"created":"2014-05-28T13:10:09.940-0500","updated":"2014-05-28T13:10:09.940-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/30226/comment/71543","id":"71543","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=dmitrii","name":"dmitrii","key":"dmitrii","accountId":"557058:1e0ea807-434b-4b54-967f-1dec4a9ede55","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue"},"displayName":"Dmitrii Calzago","active":false,"timeZone":"America/Los_Angeles"},"body":"I've linked three tickets that are related (and perhaps duplicate).\r\n\r\n* In one of them, this kind of problem was present in libvirt release 0.9.8, but went away in 0.9.13\r\n* There are a couple signs that multi-pathing may be problematic\r\n\r\nSo, my questions would be:\r\n\r\n* What libvirt version do you have installed? (Can you upgrade to 0.9.13?)\r\n* Are you using multi-pathing and, if so, can you try without it?\r\n* What host operating system are you on?","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=dmitrii","name":"dmitrii","key":"dmitrii","accountId":"557058:1e0ea807-434b-4b54-967f-1dec4a9ede55","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue"},"displayName":"Dmitrii Calzago","active":false,"timeZone":"America/Los_Angeles"},"created":"2014-05-28T13:19:51.548-0500","updated":"2014-05-28T13:19:51.548-0500"}],"maxResults":8,"total":8,"startAt":0},"votes":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/EUCA-9458/votes","votes":1,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_11808":null}}
{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"49601","self":"https://eucalyptus.atlassian.net/rest/api/2/issue/49601","key":"EUCA-12866","fields":{"issuetype":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issuetype/4","id":"4","description":"An improvement or enhancement to an existing feature or task.","iconUrl":"https://eucalyptus.atlassian.net/secure/viewavatar?size=xsmall&avatarId=14810&avatarType=issuetype","name":"Improvement","subtask":false,"avatarId":14810},"timespent":null,"customfield_13100":null,"project":{"self":"https://eucalyptus.atlassian.net/rest/api/2/project/10000","id":"10000","key":"EUCA","name":"Eucalyptus","avatarUrls":{"48x48":"https://eucalyptus.atlassian.net/secure/projectavatar?pid=10000&avatarId=10011","24x24":"https://eucalyptus.atlassian.net/secure/projectavatar?size=small&pid=10000&avatarId=10011","16x16":"https://eucalyptus.atlassian.net/secure/projectavatar?size=xsmall&pid=10000&avatarId=10011","32x32":"https://eucalyptus.atlassian.net/secure/projectavatar?size=medium&pid=10000&avatarId=10011"}},"customfield_11000":null,"fixVersions":[],"customfield_11001":null,"aggregatetimespent":null,"resolution":null,"customfield_10310":null,"customfield_10311":null,"customfield_11401":null,"customfield_11400":null,"customfield_10104":[],"customfield_10303":null,"customfield_10105":null,"customfield_10304":null,"customfield_10700":null,"customfield_10701":null,"customfield_10702":null,"customfield_10306":null,"customfield_10703":null,"customfield_10308":null,"customfield_10704":null,"resolutiondate":null,"customfield_10705":null,"customfield_10309":null,"workratio":-1,"watches":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/EUCA-12866/watchers","watchCount":3,"isWatching":false},"lastViewed":null,"created":"2016-10-24T13:47:18.136-0500","customfield_12000":null,"priority":{"self":"https://eucalyptus.atlassian.net/rest/api/2/priority/3","iconUrl":"https://eucalyptus.atlassian.net/images/icons/priorities/major.svg","name":"Major","id":"3"},"customfield_12400":null,"customfield_12201":null,"customfield_10102":null,"customfield_12600":"{}","labels":[],"customfield_11700":null,"aggregatetimeoriginalestimate":null,"timeestimate":null,"customfield_11901":null,"versions":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/version/18200","id":"18200","description":"Eucalyptus 4.3.0.1","name":"4.3.0.1","archived":false,"released":true,"releaseDate":"2016-09-21"}],"issuelinks":[],"assignee":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=jcarroll","name":"jcarroll","key":"jcarroll","accountId":"557058:20f8bca8-7023-4a30-9338-c10e76f7734e","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/3d12e553a8592e80c9aa5e1ea19a1bde?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Djcarroll%26avatarId%3D16000%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/3d12e553a8592e80c9aa5e1ea19a1bde?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Djcarroll%26avatarId%3D16000%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/3d12e553a8592e80c9aa5e1ea19a1bde?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Djcarroll%26avatarId%3D16000%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/3d12e553a8592e80c9aa5e1ea19a1bde?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Djcarroll%26avatarId%3D16000%26noRedirect%3Dtrue"},"displayName":"Jim Carroll","active":true,"timeZone":"US/Central"},"updated":"2016-11-10T16:05:46.098-0600","status":{"self":"https://eucalyptus.atlassian.net/rest/api/2/status/10007","description":"The assignee is validating and attempting to reproduce this issue.","iconUrl":"https://eucalyptus.atlassian.net/images/icons/statuses/generic.png","name":"Investigating","id":"10007","statusCategory":{"self":"https://eucalyptus.atlassian.net/rest/api/2/statuscategory/4","id":4,"key":"indeterminate","colorName":"yellow","name":"In Progress"}},"components":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/component/10014","id":"10014","name":"Storage Controller"}],"timeoriginalestimate":null,"description":"h3. Brief Scenario\r\n\r\nWhen very carefully/deliberately attaching 2 or more volumes to a single instance as shown below, the predictability of what the virtual device special filename {{/dev/vd?}} will be appears to be very predictable. E.g.,\r\n\r\n{quote}\r\n1) attach EBS1 as {{/dev/vdc}}\r\n2) wait for EBS1 to attach\r\n3) attach EBS2 as {{/dev/vdd}} \r\n4) wait for EBS2 to attach\r\n{quote}\r\n\r\nthe above will always result in EBS1 being mounted in the instance as {{/dev/vdc}}, and EBS2 being mounted as {{/dev/vdd}}.\r\n\r\nHowever, when rapidly (ie, with minimal delay) attaching 2 or more volumes to a single instance as shown below, the predictability of what the virtual device special filename {{/dev/vd?}} will be appears to be not terribly predictable at all. E.g.,\r\n\r\n{quote}\r\n1) attach EBS1 as {{/dev/vdc}}\r\n2) immediately attach EBS2 as {{/dev/vdd}}\r\n3) wait for both volumes to attach\r\n{quote}\r\n\r\nthere's no guarantee that EBS1 will end up with {{/dev/vdc}} (and likewise EBS2 with {{/dev/vdd}}).\r\n\r\nIt appears that waiting for a mount request to complete before proceeding to the next mount request in a sequence of mount requests (for a specific instance) will provide the desired end state. To state another way, it would be desirable to have some way to delay mount requests (queue them) just long enough to validate that the prior mount request has completed, before permitting the next mount request to be passed to KVM.\r\n\r\nh3. Use Case\r\n\r\nThis issue was noticed within a Docker environment where they use Flocker volume manager as the Docker volume manager on Mesos. Flocker does all the volume work, from create and mkfs to (de)attach and (u)mount. As a single instance usually runs multiple containers, the volumes end up with unexpectedly incorrect virtual device special filenames after a while.\r\n\r\nIt appears per EUCA-2394 that we've run into something like this previously, although as of this writing it appears at present to be considerably more predictable when attaching/detaching/attaching a volume; the specified device appears to always achieve the desired result.","customfield_13000":null,"customfield_13200":null,"customfield_11300":null,"customfield_11500":null,"timetracking":{},"customfield_10401":null,"customfield_10005":null,"customfield_10600":null,"customfield_12900":null,"attachment":[],"aggregatetimeestimate":null,"summary":"improve /dev/vd? predictability when quickly attaching more than one volume back-to-back","creator":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=jcarroll","name":"jcarroll","key":"jcarroll","accountId":"557058:20f8bca8-7023-4a30-9338-c10e76f7734e","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/3d12e553a8592e80c9aa5e1ea19a1bde?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Djcarroll%26avatarId%3D16000%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/3d12e553a8592e80c9aa5e1ea19a1bde?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Djcarroll%26avatarId%3D16000%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/3d12e553a8592e80c9aa5e1ea19a1bde?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Djcarroll%26avatarId%3D16000%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/3d12e553a8592e80c9aa5e1ea19a1bde?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Djcarroll%26avatarId%3D16000%26noRedirect%3Dtrue"},"displayName":"Jim Carroll","active":true,"timeZone":"US/Central"},"subtasks":[],"reporter":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=jcarroll","name":"jcarroll","key":"jcarroll","accountId":"557058:20f8bca8-7023-4a30-9338-c10e76f7734e","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/3d12e553a8592e80c9aa5e1ea19a1bde?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Djcarroll%26avatarId%3D16000%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/3d12e553a8592e80c9aa5e1ea19a1bde?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Djcarroll%26avatarId%3D16000%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/3d12e553a8592e80c9aa5e1ea19a1bde?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Djcarroll%26avatarId%3D16000%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/3d12e553a8592e80c9aa5e1ea19a1bde?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Djcarroll%26avatarId%3D16000%26noRedirect%3Dtrue"},"displayName":"Jim Carroll","active":true,"timeZone":"US/Central"},"aggregateprogress":{"progress":0,"total":0},"customfield_12100":"0|i03yuv:","customfield_10000":null,"customfield_10001":"2016-10-27T16:09:23.138-0500","customfield_10002":null,"customfield_10200":null,"customfield_10003":null,"customfield_10400":null,"customfield_12500":null,"customfield_11600":["dmitrii(dmitrii)","jcarroll(jcarroll)","mclark(mclark)"],"customfield_10116":null,"customfield_10117":null,"environment":null,"customfield_11800":null,"customfield_11802":null,"duedate":null,"customfield_11805":null,"customfield_11806":null,"progress":{"progress":0,"total":0},"votes":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/EUCA-12866/votes","votes":0,"hasVoted":false},"comment":{"comments":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/49601/comment/112229","id":"112229","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=dmitrii","name":"dmitrii","key":"dmitrii","accountId":"557058:1e0ea807-434b-4b54-967f-1dec4a9ede55","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue"},"displayName":"Dmitrii Calzago","active":false,"timeZone":"America/Los_Angeles"},"body":"Let's see if serial number helps identify which disk is which.","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=dmitrii","name":"dmitrii","key":"dmitrii","accountId":"557058:1e0ea807-434b-4b54-967f-1dec4a9ede55","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue"},"displayName":"Dmitrii Calzago","active":false,"timeZone":"America/Los_Angeles"},"created":"2016-10-27T16:09:23.138-0500","updated":"2016-10-27T16:09:23.138-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/49601/comment/112235","id":"112235","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=mclark","name":"mclark","key":"mclark","accountId":"557058:9b68e4d6-90d8-47d3-9c86-519770009164","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/4227b07e7ea0ea725670fc4e987ed04d?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FavatarId%3D10122%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/4227b07e7ea0ea725670fc4e987ed04d?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26avatarId%3D10122%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/4227b07e7ea0ea725670fc4e987ed04d?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26avatarId%3D10122%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/4227b07e7ea0ea725670fc4e987ed04d?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26avatarId%3D10122%26noRedirect%3Dtrue"},"displayName":"Matt Clark","active":true,"timeZone":"America/Los_Angeles"},"body":"Not sure if this helps, but on the eucalyptus volume id should be present on the guest as part of the block device's serial number. This can be used to identify which block dev on the guest correlates to which EBS volume.\r\n \r\nFor example:\r\nroot@euca-172-31-9-111:~# ll /dev/disk/by-id/virtio-euca-vol-a3aad53d-de \r\nlrwxrwxrwx 1 root root 9 Oct 27 21:33 /dev/disk/by-id/virtio-euca-vol-a3aad53d-de -> ../../vdc\r\n\r\nThanks, \r\n-M\r\n\r\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=mclark","name":"mclark","key":"mclark","accountId":"557058:9b68e4d6-90d8-47d3-9c86-519770009164","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/4227b07e7ea0ea725670fc4e987ed04d?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FavatarId%3D10122%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/4227b07e7ea0ea725670fc4e987ed04d?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26avatarId%3D10122%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/4227b07e7ea0ea725670fc4e987ed04d?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26avatarId%3D10122%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/4227b07e7ea0ea725670fc4e987ed04d?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26avatarId%3D10122%26noRedirect%3Dtrue"},"displayName":"Matt Clark","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-10-27T16:47:50.936-0500","updated":"2016-10-27T16:47:50.936-0500"}],"maxResults":2,"total":2,"startAt":0},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_11808":null}}
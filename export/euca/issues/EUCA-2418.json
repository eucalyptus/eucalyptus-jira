{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"13913","self":"https://eucalyptus.atlassian.net/rest/api/2/issue/13913","key":"EUCA-2418","fields":{"issuetype":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://eucalyptus.atlassian.net/secure/viewavatar?size=xsmall&avatarId=14803&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":14803},"timespent":null,"customfield_13100":null,"project":{"self":"https://eucalyptus.atlassian.net/rest/api/2/project/10000","id":"10000","key":"EUCA","name":"Eucalyptus","avatarUrls":{"48x48":"https://eucalyptus.atlassian.net/secure/projectavatar?pid=10000&avatarId=10011","24x24":"https://eucalyptus.atlassian.net/secure/projectavatar?size=small&pid=10000&avatarId=10011","16x16":"https://eucalyptus.atlassian.net/secure/projectavatar?size=xsmall&pid=10000&avatarId=10011","32x32":"https://eucalyptus.atlassian.net/secure/projectavatar?size=medium&pid=10000&avatarId=10011"}},"customfield_11000":null,"customfield_11001":null,"fixVersions":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/version/10201","id":"10201","description":"Eucalyptus 3.1.1","name":"3.1.1","archived":false,"released":true,"releaseDate":"2012-08-24"}],"aggregatetimespent":null,"customfield_10310":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/10211","value":"RHEL 6","id":"10211"}],"resolution":{"self":"https://eucalyptus.atlassian.net/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_10311":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/10308","value":"Managed-NOVLAN","id":"10308"}],"customfield_11401":null,"customfield_11400":null,"customfield_10302":null,"customfield_10104":["com.atlassian.greenhopper.service.sprint.Sprint@3beaf346[id=4,rapidViewId=<null>,state=CLOSED,name=3.2 Sprint 1,goal=<null>,startDate=2012-07-16T19:42:00.000Z,endDate=2012-08-04T04:49:00.000Z,completeDate=2012-08-03T23:40:35.344Z,sequence=4]","com.atlassian.greenhopper.service.sprint.Sprint@52a7a726[id=5,rapidViewId=<null>,state=CLOSED,name=3.2 Sprint 2,goal=<null>,startDate=2012-08-07T04:59:00.000Z,endDate=2012-08-23T04:59:00.000Z,completeDate=2012-08-23T14:54:48.967Z,sequence=5]"],"customfield_10500":{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/10403","value":"Not Applicable","id":"10403"},"customfield_10105":null,"customfield_10303":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=wenye","name":"wenye","key":"wenye","accountId":"557058:410304ee-1904-4d8c-8ca1-b1148436b5a6","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/b87135ce3de714cf85240f6d40638792?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FavatarId%3D10122%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/b87135ce3de714cf85240f6d40638792?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26avatarId%3D10122%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/b87135ce3de714cf85240f6d40638792?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26avatarId%3D10122%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/b87135ce3de714cf85240f6d40638792?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26avatarId%3D10122%26noRedirect%3Dtrue"},"displayName":"Ye Wen","active":false,"timeZone":"America/Los_Angeles"},"customfield_10700":null,"customfield_10304":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/version/10201","id":"10201","description":"Eucalyptus 3.1.1","name":"3.1.1","archived":false,"released":true,"releaseDate":"2012-08-24"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/version/10112","id":"10112","description":"Eucalyptus 3.2.0","name":"3.2.0","archived":false,"released":true,"releaseDate":"2012-12-19"}],"customfield_10701":null,"customfield_10306":{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/10201","value":"Medium","id":"10201"},"customfield_10702":null,"customfield_10703":null,"resolutiondate":"2012-08-11T17:49:56.650-0500","customfield_10704":null,"customfield_10308":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=hspencer","name":"hspencer","key":"hspencer","accountId":"557058:4a3a93bc-21f8-4658-9f5b-9cb484c910a7","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue"},"displayName":"Harold Spencer Jr.","active":true,"timeZone":"America/Los_Angeles"},"customfield_10309":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/10204","value":"KVM","id":"10204"}],"customfield_10705":null,"workratio":-1,"lastViewed":null,"watches":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/EUCA-2418/watchers","watchCount":5,"isWatching":false},"created":"2012-07-04T02:17:50.762-0500","customfield_12000":null,"priority":{"self":"https://eucalyptus.atlassian.net/rest/api/2/priority/3","iconUrl":"https://eucalyptus.atlassian.net/images/icons/priorities/major.svg","name":"Major","id":"3"},"customfield_12400":null,"customfield_12201":null,"customfield_12600":"{repository={count=3, dataType=repository}, json={\"cachedValue\":{\"errors\":[],\"summary\":{\"repository\":{\"overall\":{\"count\":3,\"lastUpdated\":\"2012-08-10T02:19:05.000-0500\",\"dataType\":\"repository\"},\"byInstanceType\":{\"github\":{\"count\":3,\"name\":\"GitHub\"}}}}},\"isStale\":true}}","customfield_10300":null,"customfield_10102":null,"customfield_10301":null,"labels":["sustaining"],"customfield_11700":null,"aggregatetimeoriginalestimate":null,"timeestimate":null,"customfield_11901":null,"versions":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/version/10005","id":"10005","description":"Eucalyptus 3.1.0","name":"3.1.0","archived":false,"released":true,"releaseDate":"2012-06-25"}],"issuelinks":[{"id":"11902","self":"https://eucalyptus.atlassian.net/rest/api/2/issueLink/11902","type":{"id":"10103","name":"Relates","inward":"relates to","outward":"relates to","self":"https://eucalyptus.atlassian.net/rest/api/2/issueLinkType/10103"},"outwardIssue":{"id":"13158","key":"EUCA-2046","self":"https://eucalyptus.atlassian.net/rest/api/2/issue/13158","fields":{"summary":"Policy using \"numlteq\" is rejected (short form of NumericLessThanEquals)","status":{"self":"https://eucalyptus.atlassian.net/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://eucalyptus.atlassian.net/images/icons/statuses/generic.png","name":"Closed","id":"6","statusCategory":{"self":"https://eucalyptus.atlassian.net/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://eucalyptus.atlassian.net/rest/api/2/priority/4","iconUrl":"https://eucalyptus.atlassian.net/images/icons/priorities/minor.svg","name":"Minor","id":"4"},"issuetype":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://eucalyptus.atlassian.net/secure/viewavatar?size=xsmall&avatarId=14803&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":14803}}}}],"assignee":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=chuck","name":"chuck","key":"chuck","accountId":"557058:95e4b012-7cd1-4fd1-995d-eba573d35653","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/39b69736417cafd9d6dddeb1c2e00169?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dchuck%26avatarId%3D12900%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/39b69736417cafd9d6dddeb1c2e00169?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dchuck%26avatarId%3D12900%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/39b69736417cafd9d6dddeb1c2e00169?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dchuck%26avatarId%3D12900%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/39b69736417cafd9d6dddeb1c2e00169?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dchuck%26avatarId%3D12900%26noRedirect%3Dtrue"},"displayName":"Chuck","active":false,"timeZone":"America/Los_Angeles"},"updated":"2013-01-09T20:03:46.139-0600","status":{"self":"https://eucalyptus.atlassian.net/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://eucalyptus.atlassian.net/images/icons/statuses/generic.png","name":"Closed","id":"6","statusCategory":{"self":"https://eucalyptus.atlassian.net/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/component/10002","id":"10002","name":"Cloud Controller"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/component/10004","id":"10004","name":"Database"}],"timeoriginalestimate":null,"customfield_13000":null,"description":"Hi All,\r\n\r\nTrying to upgrade a 3.0.2 cloud (was working fine) to 3.1 the upgrade process fails. \r\n\r\nSteps to reproduce: \r\n\r\n{code}\r\na) Terminate all running instances on the cloud\r\nb) Stop eucalyptus-nc, eucalyptus-cloud (clc/walrus/sc) and eucalyptus-cc\r\nc) rm -f /etc/yum.repos.d/euca2ools.repo /etc/yum.repos.d/eucalyptus-enterprise.repo\r\nd) yum install http://downloads.eucalyptus.com/software/eucalyptus/3.1/rhel/6/x86_64/eucalyptus-release-3.1.noarch.rpm\r\ne) yum install http://downloads.eucalyptus.com/software/euca2ools/2.1/rhel/6/x86_64/euca2ools-release-2.1.noarch.rpm\r\nf) yum install http://downloads.eucalyptus.com/software/eucalyptus/3.1/rhel/6/x86_64/epel-release-6.noarch.rpm\r\ng) yum install http://downloads.eucalyptus.com/software/eucalyptus/3.1/rhel/6/x86_64/elrepo-release-6.noarch.rpm\r\nh) rpm -Uvh eucalyptus-enterprise-release-3.1-1.EucalyptusTest.Unlimited.noarch.rpm\r\ni) yum clean expire-cache\r\nj) yum update\r\nk) yum groupinstall -y eucalyptus-cloud-controller (this installs vmware-broker-libs and san-storage-libs RPM, when the cloud itself does not use SAN or VMWare)\r\nl) mv /etc/eucalyptus/cloud.d/upgrade/upgrade_30_31.groovy /root/upgrade_30_31.groovy.bak\r\nm) wget https://raw.github.com/eucalyptus/eucalyptus/testing/clc/modules/core/conf/upgrade/upgrade_30_31.groovy\r\nn) mv upgrade_30_31.groovy /etc/eucalyptus/cloud.d/upgrade/\r\no) service eucalyptus-cloud start\r\n{code}\r\n\r\nFollowing is shown on the terminal\r\n\r\n{code}\r\nStarting Eucalyptus services: Attempting database upgrade from 3.0.2 at /var/lib/eucalyptus/upgrade/eucalyptus.backup.1341383885...\r\n#                           UPGRADE INFORMATION\r\n#================================================================================\r\n# Old Version:              3.0.2       \r\n# New Version:              3.1.0       \r\n# Upgrade keys:             false              using:                \r\n# Upgrade configuration:    false              using:                \r\n# Upgrade database:         true               using: upgrade_db     \r\n# Same version:             false              using:                \r\n# Start upgrading: db\r\nUpgrading your database...\r\nTue Jul 3 23:47:19 2012 ERROR [com.eucalyptus.upgrade.StandalonePersistence.main(StandalonePersistence.java):70] com.eucalyptus.auth.PolicyParseException: net.sf.json.JSONException: Condition type 'NumericLessThanEquals' is not supported\r\ncom.eucalyptus.auth.PolicyParseException: net.sf.json.JSONException: Condition type 'NumericLessThanEquals' is not supported\r\n\tat com.eucalyptus.auth.policy.PolicyParser.parse(PolicyParser.java:78)\r\n\tat com.eucalyptus.auth.DatabaseGroupProxy.addPolicy(DatabaseGroupProxy.java:218)\r\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)\r\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n\tat java.lang.reflect.Method.invoke(Method.java:616)\r\n\tat org.codehaus.groovy.runtime.callsite.PojoMetaMethodSite$PojoCachedMethodSiteNoUnwrapNoCoerce.invoke(PojoMetaMethodSite.java:229)\r\n\tat org.codehaus.groovy.runtime.callsite.PojoMetaMethodSite.call(PojoMetaMethodSite.java:52)\r\n\tat org.codehaus.groovy.runtime.callsite.AbstractCallSite.call(AbstractCallSite.java:129)\r\n\tat upgrade_30_31$_upgradeAuth_closure2_closure15_closure17.doCall(upgrade_30_31.groovy:331)\r\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)\r\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n\tat java.lang.reflect.Method.invoke(Method.java:616)\r\n\tat org.codehaus.groovy.reflection.CachedMethod.invoke(CachedMethod.java:88)\r\n\tat groovy.lang.MetaMethod.doMethodInvoke(MetaMethod.java:233)\r\n\tat groovy.lang.MetaClassImpl.invokeMethod(MetaClassImpl.java:1058)\r\n\tat groovy.lang.ExpandoMetaClass.invokeMethod(ExpandoMetaClass.java:1067)\r\n\tat groovy.lang.MetaClassImpl.invokeMethod(MetaClassImpl.java:886)\r\n\tat groovy.lang.Closure.call(Closure.java:276)\r\n\tat groovy.lang.Closure.call(Closure.java:289)\r\n\tat org.codehaus.groovy.runtime.DefaultGroovyMethods.each(DefaultGroovyMethods.java:1176)\r\n\tat org.codehaus.groovy.runtime.DefaultGroovyMethods.each(DefaultGroovyMethods.java:1152)\r\n\tat org.codehaus.groovy.runtime.dgm$114.invoke(Unknown Source)\r\n\tat org.codehaus.groovy.runtime.callsite.PojoMetaMethodSite$PojoMetaMethodSiteNoUnwrapNoCoerce.invoke(PojoMetaMethodSite.java:270)\r\n\tat org.codehaus.groovy.runtime.callsite.PojoMetaMethodSite.call(PojoMetaMethodSite.java:52)\r\n\tat org.codehaus.groovy.runtime.callsite.AbstractCallSite.call(AbstractCallSite.java:125)\r\n\tat upgrade_30_31$_upgradeAuth_closure2_closure15.doCall(upgrade_30_31.groovy:328)\r\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)\r\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n\tat java.lang.reflect.Method.invoke(Method.java:616)\r\n\tat org.codehaus.groovy.reflection.CachedMethod.invoke(CachedMethod.java:88)\r\n\tat groovy.lang.MetaMethod.doMethodInvoke(MetaMethod.java:233)\r\n\tat groovy.lang.MetaClassImpl.invokeMethod(MetaClassImpl.java:1058)\r\n\tat groovy.lang.ExpandoMetaClass.invokeMethod(ExpandoMetaClass.java:1067)\r\n\tat groovy.lang.MetaClassImpl.invokeMethod(MetaClassImpl.java:886)\r\n\tat groovy.lang.Closure.call(Closure.java:276)\r\n\tat groovy.lang.Closure.call(Closure.java:289)\r\n\tat org.codehaus.groovy.runtime.DefaultGroovyMethods.each(DefaultGroovyMethods.java:1176)\r\n\tat org.codehaus.groovy.runtime.DefaultGroovyMethods.each(DefaultGroovyMethods.java:1152)\r\n\tat org.codehaus.groovy.runtime.dgm$114.invoke(Unknown Source)\r\n\tat org.codehaus.groovy.runtime.callsite.PojoMetaMethodSite$PojoMetaMethodSiteNoUnwrapNoCoerce.invoke(PojoMetaMethodSite.java:270)\r\n\tat org.codehaus.groovy.runtime.callsite.PojoMetaMethodSite.call(PojoMetaMethodSite.java:52)\r\n\tat org.codehaus.groovy.runtime.callsite.AbstractCallSite.call(AbstractCallSite.java:125)\r\n\tat upgrade_30_31$_upgradeAuth_closure2.doCall(upgrade_30_31.groovy:318)\r\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)\r\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n\tat java.lang.reflect.Method.invoke(Method.java:616)\r\n\tat org.codehaus.groovy.reflection.CachedMethod.invoke(CachedMethod.java:88)\r\n\tat groovy.lang.MetaMethod.doMethodInvoke(MetaMethod.java:233)\r\n\tat groovy.lang.MetaClassImpl.invokeMethod(MetaClassImpl.java:1058)\r\n\tat groovy.lang.ExpandoMetaClass.invokeMethod(ExpandoMetaClass.java:1067)\r\n\tat groovy.lang.MetaClassImpl.invokeMethod(MetaClassImpl.java:886)\r\n\tat groovy.lang.Closure.call(Closure.java:276)\r\n\tat groovy.lang.Closure.call(Closure.java:289)\r\n\tat org.codehaus.groovy.runtime.DefaultGroovyMethods.each(DefaultGroovyMethods.java:1176)\r\n\tat org.codehaus.groovy.runtime.DefaultGroovyMethods.each(DefaultGroovyMethods.java:1152)\r\n\tat org.codehaus.groovy.runtime.dgm$114.invoke(Unknown Source)\r\n\tat org.codehaus.groovy.runtime.callsite.PojoMetaMethodSite$PojoMetaMethodSiteNoUnwrapNoCoerce.invoke(PojoMetaMethodSite.java:270)\r\n\tat org.codehaus.groovy.runtime.callsite.PojoMetaMethodSite.call(PojoMetaMethodSite.java:52)\r\n\tat org.codehaus.groovy.runtime.callsite.CallSiteArray.defaultCall(CallSiteArray.java:40)\r\n\tat org.codehaus.groovy.runtime.callsite.AbstractCallSite.call(AbstractCallSite.java:117)\r\n\tat org.codehaus.groovy.runtime.callsite.AbstractCallSite.call(AbstractCallSite.java:125)\r\n\tat upgrade_30_31.upgradeAuth(upgrade_30_31.groovy:299)\r\n\tat upgrade_30_31.this$3$upgradeAuth(upgrade_30_31.groovy)\r\n\tat upgrade_30_31$this$3$upgradeAuth.callCurrent(Unknown Source)\r\n\tat org.codehaus.groovy.runtime.callsite.CallSiteArray.defaultCallCurrent(CallSiteArray.java:44)\r\n\tat org.codehaus.groovy.runtime.callsite.AbstractCallSite.callCurrent(AbstractCallSite.java:143)\r\n\tat org.codehaus.groovy.runtime.callsite.AbstractCallSite.callCurrent(AbstractCallSite.java:147)\r\n\tat upgrade_30_31.upgrade(upgrade_30_31.groovy:206)\r\n\tat com.eucalyptus.upgrade.StandalonePersistence.runUpgrade(StandalonePersistence.java:82)\r\n\tat com.eucalyptus.upgrade.StandalonePersistence.main(StandalonePersistence.java:66)\r\nCaused by: net.sf.json.JSONException: Condition type 'NumericLessThanEquals' is not supported\r\n\tat com.eucalyptus.auth.policy.PolicyParser.checkConditionType(PolicyParser.java:283)\r\n\tat com.eucalyptus.auth.policy.PolicyParser.parseConditions(PolicyParser.java:230)\r\n\tat com.eucalyptus.auth.policy.PolicyParser.parseStatement(PolicyParser.java:118)\r\n\tat com.eucalyptus.auth.policy.PolicyParser.parseStatements(PolicyParser.java:93)\r\n\tat com.eucalyptus.auth.policy.PolicyParser.parse(PolicyParser.java:73)\r\n\t... 73 more\r\ncom.eucalyptus.auth.PolicyParseException: net.sf.json.JSONException: Condition type 'NumericLessThanEquals' is not supported\r\n\tat com.eucalyptus.auth.policy.PolicyParser.parse(PolicyParser.java:78)\r\n\tat com.eucalyptus.auth.DatabaseGroupProxy.addPolicy(DatabaseGroupProxy.java:218)\r\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)\r\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n\tat java.lang.reflect.Method.invoke(Method.java:616)\r\n\tat org.codehaus.groovy.runtime.callsite.PojoMetaMethodSite$PojoCachedMethodSiteNoUnwrapNoCoerce.invoke(PojoMetaMethodSite.java:229)\r\n\tat org.codehaus.groovy.runtime.callsite.PojoMetaMethodSite.call(PojoMetaMethodSite.java:52)\r\n\tat org.codehaus.groovy.runtime.callsite.AbstractCallSite.call(AbstractCallSite.java:129)\r\n\tat upgrade_30_31$_upgradeAuth_closure2_closure15_closure17.doCall(upgrade_30_31.groovy:331)\r\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)\r\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n\tat java.lang.reflect.Method.invoke(Method.java:616)\r\n\tat org.codehaus.groovy.reflection.CachedMethod.invoke(CachedMethod.java:88)\r\n\tat groovy.lang.MetaMethod.doMethodInvoke(MetaMethod.java:233)\r\n\tat groovy.lang.MetaClassImpl.invokeMethod(MetaClassImpl.java:1058)\r\n\tat groovy.lang.ExpandoMetaClass.invokeMethod(ExpandoMetaClass.java:1067)\r\n\tat groovy.lang.MetaClassImpl.invokeMethod(MetaClassImpl.java:886)\r\n\tat groovy.lang.Closure.call(Closure.java:276)\r\n\tat groovy.lang.Closure.call(Closure.java:289)\r\n\tat org.codehaus.groovy.runtime.DefaultGroovyMethods.each(DefaultGroovyMethods.java:1176)\r\n\tat org.codehaus.groovy.runtime.DefaultGroovyMethods.each(DefaultGroovyMethods.java:1152)\r\n\tat org.codehaus.groovy.runtime.dgm$114.invoke(Unknown Source)\r\n\tat org.codehaus.groovy.runtime.callsite.PojoMetaMethodSite$PojoMetaMethodSiteNoUnwrapNoCoerce.invoke(PojoMetaMethodSite.java:270)\r\n\tat org.codehaus.groovy.runtime.callsite.PojoMetaMethodSite.call(PojoMetaMethodSite.java:52)\r\n\tat org.codehaus.groovy.runtime.callsite.AbstractCallSite.call(AbstractCallSite.java:125)\r\n\tat upgrade_30_31$_upgradeAuth_closure2_closure15.doCall(upgrade_30_31.groovy:328)\r\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)\r\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n\tat java.lang.reflect.Method.invoke(Method.java:616)\r\n\tat org.codehaus.groovy.reflection.CachedMethod.invoke(CachedMethod.java:88)\r\n\tat groovy.lang.MetaMethod.doMethodInvoke(MetaMethod.java:233)\r\n\tat groovy.lang.MetaClassImpl.invokeMethod(MetaClassImpl.java:1058)\r\n\tat groovy.lang.ExpandoMetaClass.invokeMethod(ExpandoMetaClass.java:1067)\r\n\tat groovy.lang.MetaClassImpl.invokeMethod(MetaClassImpl.java:886)\r\n\tat groovy.lang.Closure.call(Closure.java:276)\r\n\tat groovy.lang.Closure.call(Closure.java:289)\r\n\tat org.codehaus.groovy.runtime.DefaultGroovyMethods.each(DefaultGroovyMethods.java:1176)\r\n\tat org.codehaus.groovy.runtime.DefaultGroovyMethods.each(DefaultGroovyMethods.java:1152)\r\n\tat org.codehaus.groovy.runtime.dgm$114.invoke(Unknown Source)\r\n\tat org.codehaus.groovy.runtime.callsite.PojoMetaMethodSite$PojoMetaMethodSiteNoUnwrapNoCoerce.invoke(PojoMetaMethodSite.java:270)\r\n\tat org.codehaus.groovy.runtime.callsite.PojoMetaMethodSite.call(PojoMetaMethodSite.java:52)\r\n\tat org.codehaus.groovy.runtime.callsite.AbstractCallSite.call(AbstractCallSite.java:125)\r\n\tat upgrade_30_31$_upgradeAuth_closure2.doCall(upgrade_30_31.groovy:318)\r\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)\r\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n\tat java.lang.reflect.Method.invoke(Method.java:616)\r\n\tat org.codehaus.groovy.reflection.CachedMethod.invoke(CachedMethod.java:88)\r\n\tat groovy.lang.MetaMethod.doMethodInvoke(MetaMethod.java:233)\r\n\tat groovy.lang.MetaClassImpl.invokeMethod(MetaClassImpl.java:1058)\r\n\tat groovy.lang.ExpandoMetaClass.invokeMethod(ExpandoMetaClass.java:1067)\r\n\tat groovy.lang.MetaClassImpl.invokeMethod(MetaClassImpl.java:886)\r\n\tat groovy.lang.Closure.call(Closure.java:276)\r\n\tat groovy.lang.Closure.call(Closure.java:289)\r\n\tat org.codehaus.groovy.runtime.DefaultGroovyMethods.each(DefaultGroovyMethods.java:1176)\r\n\tat org.codehaus.groovy.runtime.DefaultGroovyMethods.each(DefaultGroovyMethods.java:1152)\r\n\tat org.codehaus.groovy.runtime.dgm$114.invoke(Unknown Source)\r\n\tat org.codehaus.groovy.runtime.callsite.PojoMetaMethodSite$PojoMetaMethodSiteNoUnwrapNoCoerce.invoke(PojoMetaMethodSite.java:270)\r\n\tat org.codehaus.groovy.runtime.callsite.PojoMetaMethodSite.call(PojoMetaMethodSite.java:52)\r\n\tat org.codehaus.groovy.runtime.callsite.CallSiteArray.defaultCall(CallSiteArray.java:40)\r\n\tat org.codehaus.groovy.runtime.callsite.AbstractCallSite.call(AbstractCallSite.java:117)\r\n\tat org.codehaus.groovy.runtime.callsite.AbstractCallSite.call(AbstractCallSite.java:125)\r\n\tat upgrade_30_31.upgradeAuth(upgrade_30_31.groovy:299)\r\n\tat upgrade_30_31.this$3$upgradeAuth(upgrade_30_31.groovy)\r\n\tat upgrade_30_31$this$3$upgradeAuth.callCurrent(Unknown Source)\r\n\tat org.codehaus.groovy.runtime.callsite.CallSiteArray.defaultCallCurrent(CallSiteArray.java:44)\r\n\tat org.codehaus.groovy.runtime.callsite.AbstractCallSite.callCurrent(AbstractCallSite.java:143)\r\n\tat org.codehaus.groovy.runtime.callsite.AbstractCallSite.callCurrent(AbstractCallSite.java:147)\r\n\tat upgrade_30_31.upgrade(upgrade_30_31.groovy:206)\r\n\tat com.eucalyptus.upgrade.StandalonePersistence.runUpgrade(StandalonePersistence.java:82)\r\n\tat com.eucalyptus.upgrade.StandalonePersistence.main(StandalonePersistence.java:66)\r\nCaused by: net.sf.json.JSONException: Condition type 'NumericLessThanEquals' is not supported\r\n\tat com.eucalyptus.auth.policy.PolicyParser.checkConditionType(PolicyParser.java:283)\r\n\tat com.eucalyptus.auth.policy.PolicyParser.parseConditions(PolicyParser.java:230)\r\n\tat com.eucalyptus.auth.policy.PolicyParser.parseStatement(PolicyParser.java:118)\r\n\tat com.eucalyptus.auth.policy.PolicyParser.parseStatements(PolicyParser.java:93)\r\n\tat com.eucalyptus.auth.policy.PolicyParser.parse(PolicyParser.java:73)\r\n\t... 73 more\r\nDatabase upgrade failed! Please //var/log/eucalyptus/upgrade.log for details and contact Eucalyptus support for assistance.\r\nUpgrade failed. Aborting start.\r\n{code}\r\n\r\nAttached with this ticket is the upgrade.log file from the upgrade process. \r\n\r\nAppears to be an IAM policy which was the problem here? \r\n\r\nPerhaps the IAM changes from 3.0.2 to 3.1?\r\n\r\nLet me know if there are any questions.\r\n\r\nCheers!\r\nDeependra","customfield_13200":null,"customfield_11300":null,"customfield_11500":null,"timetracking":{},"customfield_10005":null,"customfield_10401":null,"customfield_10600":null,"customfield_12900":null,"aggregatetimeestimate":null,"attachment":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/attachment/11500","id":"11500","filename":"upgrade.log","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=dshekhawat","name":"dshekhawat","key":"dshekhawat","accountId":"557058:dc10d216-39f8-4d84-a5ff-7d4daf8a44ed","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/7cda271db1cec24c198fdfb42ec8a8ae?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Ddshekhawat%26avatarId%3D15400%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/7cda271db1cec24c198fdfb42ec8a8ae?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Ddshekhawat%26avatarId%3D15400%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/7cda271db1cec24c198fdfb42ec8a8ae?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Ddshekhawat%26avatarId%3D15400%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/7cda271db1cec24c198fdfb42ec8a8ae?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Ddshekhawat%26avatarId%3D15400%26noRedirect%3Dtrue"},"displayName":"Deependra Shekhawat","active":false,"timeZone":"Asia/Kolkata"},"created":"2012-07-04T02:17:50.783-0500","size":159895,"mimeType":"text/plain","content":"https://eucalyptus.atlassian.net/secure/attachment/11500/upgrade.log"}],"summary":"upgrade from 3.0.2 to 3.1 fails complains quota policy has got NumericLessThanEquals","creator":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=dshekhawat","name":"dshekhawat","key":"dshekhawat","accountId":"557058:dc10d216-39f8-4d84-a5ff-7d4daf8a44ed","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/7cda271db1cec24c198fdfb42ec8a8ae?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Ddshekhawat%26avatarId%3D15400%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/7cda271db1cec24c198fdfb42ec8a8ae?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Ddshekhawat%26avatarId%3D15400%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/7cda271db1cec24c198fdfb42ec8a8ae?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Ddshekhawat%26avatarId%3D15400%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/7cda271db1cec24c198fdfb42ec8a8ae?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Ddshekhawat%26avatarId%3D15400%26noRedirect%3Dtrue"},"displayName":"Deependra Shekhawat","active":false,"timeZone":"Asia/Kolkata"},"subtasks":[],"reporter":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=dshekhawat","name":"dshekhawat","key":"dshekhawat","accountId":"557058:dc10d216-39f8-4d84-a5ff-7d4daf8a44ed","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/7cda271db1cec24c198fdfb42ec8a8ae?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Ddshekhawat%26avatarId%3D15400%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/7cda271db1cec24c198fdfb42ec8a8ae?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Ddshekhawat%26avatarId%3D15400%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/7cda271db1cec24c198fdfb42ec8a8ae?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Ddshekhawat%26avatarId%3D15400%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/7cda271db1cec24c198fdfb42ec8a8ae?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Ddshekhawat%26avatarId%3D15400%26noRedirect%3Dtrue"},"displayName":"Deependra Shekhawat","active":false,"timeZone":"Asia/Kolkata"},"customfield_10000":"3_*:*_2_*:*_439964098_*|*_10001_*:*_4_*:*_1989050751_*|*_10002_*:*_2_*:*_589968646_*|*_10000_*:*_1_*:*_44541133_*|*_10006_*:*_1_*:*_0_*|*_10003_*:*_3_*:*_275573613_*|*_10007_*:*_1_*:*_27664","aggregateprogress":{"progress":0,"total":0},"customfield_12100":"0|i00wsv:","customfield_10001":"2012-07-23T13:54:58.394-0500","customfield_10200":null,"customfield_10002":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/10000","value":"Customer Affecting","id":"10000"}],"customfield_10003":null,"customfield_10400":null,"customfield_12500":null,"customfield_10116":null,"customfield_11600":["agrimm(agrimm)","chuck(chuck)","dshekhawat(dshekhawat)","viglesias(viglesias)","wenye(wenye)"],"customfield_10117":null,"environment":"Internal Lab Environment","customfield_11800":null,"customfield_11802":null,"customfield_11805":null,"duedate":null,"progress":{"progress":0,"total":0},"customfield_11806":null,"comment":{"comments":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/13913/comment/28719","id":"28719","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=dshekhawat","name":"dshekhawat","key":"dshekhawat","accountId":"557058:dc10d216-39f8-4d84-a5ff-7d4daf8a44ed","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/7cda271db1cec24c198fdfb42ec8a8ae?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Ddshekhawat%26avatarId%3D15400%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/7cda271db1cec24c198fdfb42ec8a8ae?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Ddshekhawat%26avatarId%3D15400%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/7cda271db1cec24c198fdfb42ec8a8ae?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Ddshekhawat%26avatarId%3D15400%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/7cda271db1cec24c198fdfb42ec8a8ae?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Ddshekhawat%26avatarId%3D15400%26noRedirect%3Dtrue"},"displayName":"Deependra Shekhawat","active":false,"timeZone":"Asia/Kolkata"},"body":"Had the following quota policy on one of the accounts (account name: support) in 3.0.2 cloud, before the upgrade, so might be required to have such configuration in \"Steps to Reproduce\"\r\n\r\n{code}\r\n{\r\n\"Statement\":[{\r\n   \"Effect\":\"Limit\",\r\n   \"Action\":\"ec2:RunInstances\",\r\n   \"Resource\":\"*\",\r\n   \"Condition\":{\r\n     \"NumericLessThanEquals\":{\r\n       \"ec2:quota-vminstancenumber\":\"2\"\r\n     }\r\n   }\r\n }]\r\n}\r\n{code}\r\n\r\n\r\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=dshekhawat","name":"dshekhawat","key":"dshekhawat","accountId":"557058:dc10d216-39f8-4d84-a5ff-7d4daf8a44ed","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/7cda271db1cec24c198fdfb42ec8a8ae?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Ddshekhawat%26avatarId%3D15400%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/7cda271db1cec24c198fdfb42ec8a8ae?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Ddshekhawat%26avatarId%3D15400%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/7cda271db1cec24c198fdfb42ec8a8ae?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Ddshekhawat%26avatarId%3D15400%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/7cda271db1cec24c198fdfb42ec8a8ae?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Ddshekhawat%26avatarId%3D15400%26noRedirect%3Dtrue"},"displayName":"Deependra Shekhawat","active":false,"timeZone":"Asia/Kolkata"},"created":"2012-07-04T03:52:11.675-0500","updated":"2012-07-04T03:52:11.675-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/13913/comment/28720","id":"28720","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=dshekhawat","name":"dshekhawat","key":"dshekhawat","accountId":"557058:dc10d216-39f8-4d84-a5ff-7d4daf8a44ed","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/7cda271db1cec24c198fdfb42ec8a8ae?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Ddshekhawat%26avatarId%3D15400%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/7cda271db1cec24c198fdfb42ec8a8ae?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Ddshekhawat%26avatarId%3D15400%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/7cda271db1cec24c198fdfb42ec8a8ae?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Ddshekhawat%26avatarId%3D15400%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/7cda271db1cec24c198fdfb42ec8a8ae?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Ddshekhawat%26avatarId%3D15400%26noRedirect%3Dtrue"},"displayName":"Deependra Shekhawat","active":false,"timeZone":"Asia/Kolkata"},"body":"So here is what was done next,\r\n\r\nmanually start the OLD mysql database and remove the quota policy on the account from eucalyptus_auth db. Then re-run the upgrade, it just went smoothly afterwards.\r\n\r\nVerified:\r\n\r\n{code}\r\nSERVICE\tbootstrap      \tbootstrap      \t192.168.35.17  \tENABLED   \t17  \thttp://192.168.35.17:8773/services/Empyrean\tarn:euca:bootstrap:::192.168.35.17/\r\nSERVICE\tstorage        \tjeevan-cluster \tjeevan-scs-001 \tENABLED   \t17  \thttp://192.168.35.17:8773/services/Storage\tarn:euca:eucalyptus:jeevan-cluster:storage:jeevan-scs-001/\r\nSERVICE\teucalyptus     \teucalyptus     \t192.168.35.17  \tENABLED   \t17  \thttp://192.168.35.17:8773/services/Eucalyptus\tarn:euca:eucalyptus:::192.168.35.17/\r\nSERVICE\twalrus         \twalrus         \tjeevan-walrus-1\tENABLED   \t17  \thttp://192.168.35.17:8773/services/Walrus\tarn:euca:bootstrap:walrus:walrus:jeevan-walrus-1/\r\nSERVICE\tdns            \teucalyptus     \t192.168.35.17  \tENABLED   \t17  \thttp://192.168.35.17:8773/services/Dns  \tarn:euca:eucalyptus::dns:192.168.35.17/\r\nSERVICE\tcluster        \tjeevan-cluster \tjeevan-cluster-001\tENABLED   \t17  \thttp://192.168.35.17:8774/axis2/services/EucalyptusCC\tarn:euca:eucalyptus:jeevan-cluster:cluster:jeevan-cluster-001/\r\n{code}\r\n\r\nThen applied the same quota policy to the account and it worked just fine. What could have gone wrong at the upgrade? ","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=dshekhawat","name":"dshekhawat","key":"dshekhawat","accountId":"557058:dc10d216-39f8-4d84-a5ff-7d4daf8a44ed","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/7cda271db1cec24c198fdfb42ec8a8ae?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Ddshekhawat%26avatarId%3D15400%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/7cda271db1cec24c198fdfb42ec8a8ae?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Ddshekhawat%26avatarId%3D15400%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/7cda271db1cec24c198fdfb42ec8a8ae?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Ddshekhawat%26avatarId%3D15400%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/7cda271db1cec24c198fdfb42ec8a8ae?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Ddshekhawat%26avatarId%3D15400%26noRedirect%3Dtrue"},"displayName":"Deependra Shekhawat","active":false,"timeZone":"Asia/Kolkata"},"created":"2012-07-04T05:21:46.614-0500","updated":"2012-07-04T05:21:46.614-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/13913/comment/30114","id":"30114","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"body":"There is a known issue related to the shorthand form \"numlteq\" not working in 3.1.0.  I'm wondering if this is somehow related.\r\n\r\nIt appears that there's a registration process that maps which condition types are valid for a given statement type, but I don't completely understand how it works.\r\n\r\n[~wenye], can you help me with this?","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"created":"2012-07-23T13:54:58.394-0500","updated":"2012-07-23T13:54:58.394-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/13913/comment/30319","id":"30319","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"body":"After talking to [~chuck] and [~sjones] about this, and adding some debug info to the upgrade script, I see that the problem was definitely that the condition map was not populated at all.  That can be fixed either in the upgrade script or in the standalone persistence code.  A fix in the upgrade script could look like this:\n\n{noformat}\n+++ b/clc/modules/core/conf/upgrade/upgrade_30_31.groovy\n@@ -149,6 +149,11 @@ import com.eucalyptus.images.BlockStorageDeviceMapping;\n \n import com.eucalyptus.util.BlockStorageUtil;\n \n+// Perform discovery for EUARE policy maps\n+import com.eucalyptus.auth.policy.condition.ConditionOpDiscovery;\n+import com.eucalyptus.auth.policy.key.KeyDiscovery;\n+import com.eucalyptus.bootstrap.ServiceJarDiscovery;\n+\n class upgrade_30_31 extends AbstractUpgradeScript {\n     static final List<String> FROM_VERSION = [\"3.0.0\", \"3.0.1\", \"3.0.2\"];\n     static final List<String> TO_VERSION   = [\"3.1.0\", \"3.1.1\"];\n@@ -184,6 +189,9 @@ class upgrade_30_31 extends AbstractUpgradeScript {\n \n     @Override\n     public void upgrade(File oldEucaHome, File newEucaHome) {\n+        ServiceJarDiscovery.runDiscovery(new ConditionOpDiscovery());\n+        ServiceJarDiscovery.runDiscovery(new KeyDiscovery());\n+\n         buildConnectionMap();\n \n         // VMware\n{noformat}\n\nI wonder whether there are other maps which also should be populated this way.","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"created":"2012-07-27T21:13:58.099-0500","updated":"2012-07-27T21:13:58.099-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/13913/comment/30440","id":"30440","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=chuck","name":"chuck","key":"chuck","accountId":"557058:95e4b012-7cd1-4fd1-995d-eba573d35653","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/39b69736417cafd9d6dddeb1c2e00169?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dchuck%26avatarId%3D12900%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/39b69736417cafd9d6dddeb1c2e00169?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dchuck%26avatarId%3D12900%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/39b69736417cafd9d6dddeb1c2e00169?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dchuck%26avatarId%3D12900%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/39b69736417cafd9d6dddeb1c2e00169?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dchuck%26avatarId%3D12900%26noRedirect%3Dtrue"},"displayName":"Chuck","active":false,"timeZone":"America/Los_Angeles"},"body":"commit 14c9d07e740cc845a15b94fce78aba9d5ebad003\r\nAuthor: chuck <chuck@eucalyptus.com> 2012-07-31 15:54:30\r\nCommitter: chuck <chuck@eucalyptus.com> 2012-07-31 15:54:30\r\nParent: 69a309001ceccf3c52321d12c0a5d4e8c20eaa16 (Upgrade: Fixes for policy and group memberships)\r\nBranches: team/clc-dev/EUCA-2418\r\n\r\nFixes EUCA-2418 where some policies fail to upgrade.\r\n-------------- clc/modules/core/conf/upgrade/upgrade_30_31.groovy -------------\r\ndiff --git a/clc/modules/core/conf/upgrade/upgrade_30_31.groovy b/clc/modules/core/conf/upgrade/upgrade_30_31.groovy\r\nindex df26704..9bf2408 100644\r\n--- a/clc/modules/core/conf/upgrade/upgrade_30_31.groovy\r\n+++ b/clc/modules/core/conf/upgrade/upgrade_30_31.groovy\r\n@@ -142,7 +142,14 @@\r\n import com.eucalyptus.images.MachineImageInfo;\r\n import com.eucalyptus.images.RamdiskImageInfo;\r\n \r\n+import com.eucalyptus.images.BlockStorageDeviceMapping;\r\n+\r\n import com.eucalyptus.util.BlockStorageUtil;\r\n+\r\n+// Perform discovery for EUARE policy maps\r\n+import com.eucalyptus.auth.policy.condition.ConditionOpDiscovery;\r\n+import com.eucalyptus.auth.policy.key.KeyDiscovery;\r\n+import com.eucalyptus.bootstrap.ServiceJarDiscovery;\r\n \r\n class upgrade_30_31 extends AbstractUpgradeScript {\r\n     static final List<String> FROM_VERSION = [\"3.0.0\", \"3.0.1\", \"3.0.2\"];\r\n@@ -178,6 +185,9 @@\r\n \r\n     @Override\r\n     public void upgrade(File oldEucaHome, File newEucaHome) {\r\n+\t\tServiceJarDiscovery.runDiscovery(new ConditionOpDiscovery());\r\n+\t\tServiceJarDiscovery.runDiscovery(new KeyDiscovery());\r\n+\t\t\r\n         buildConnectionMap();\r\n \r\n         // VMware\r\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=chuck","name":"chuck","key":"chuck","accountId":"557058:95e4b012-7cd1-4fd1-995d-eba573d35653","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/39b69736417cafd9d6dddeb1c2e00169?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dchuck%26avatarId%3D12900%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/39b69736417cafd9d6dddeb1c2e00169?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dchuck%26avatarId%3D12900%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/39b69736417cafd9d6dddeb1c2e00169?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dchuck%26avatarId%3D12900%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/39b69736417cafd9d6dddeb1c2e00169?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dchuck%26avatarId%3D12900%26noRedirect%3Dtrue"},"displayName":"Chuck","active":false,"timeZone":"America/Los_Angeles"},"created":"2012-07-31T17:55:09.914-0500","updated":"2012-07-31T17:55:09.914-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/13913/comment/30471","id":"30471","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=chuck","name":"chuck","key":"chuck","accountId":"557058:95e4b012-7cd1-4fd1-995d-eba573d35653","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/39b69736417cafd9d6dddeb1c2e00169?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dchuck%26avatarId%3D12900%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/39b69736417cafd9d6dddeb1c2e00169?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dchuck%26avatarId%3D12900%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/39b69736417cafd9d6dddeb1c2e00169?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dchuck%26avatarId%3D12900%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/39b69736417cafd9d6dddeb1c2e00169?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dchuck%26avatarId%3D12900%26noRedirect%3Dtrue"},"displayName":"Chuck","active":false,"timeZone":"America/Los_Angeles"},"body":"Ye, can you review this proposed fix from Andy to make sure there's not anything else that should be done. Thanks.","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=chuck","name":"chuck","key":"chuck","accountId":"557058:95e4b012-7cd1-4fd1-995d-eba573d35653","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/39b69736417cafd9d6dddeb1c2e00169?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dchuck%26avatarId%3D12900%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/39b69736417cafd9d6dddeb1c2e00169?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dchuck%26avatarId%3D12900%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/39b69736417cafd9d6dddeb1c2e00169?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dchuck%26avatarId%3D12900%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/39b69736417cafd9d6dddeb1c2e00169?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dchuck%26avatarId%3D12900%26noRedirect%3Dtrue"},"displayName":"Chuck","active":false,"timeZone":"America/Los_Angeles"},"created":"2012-08-01T12:52:19.173-0500","updated":"2012-08-01T12:52:19.173-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/13913/comment/30767","id":"30767","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=wenye","name":"wenye","key":"wenye","accountId":"557058:410304ee-1904-4d8c-8ca1-b1148436b5a6","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/b87135ce3de714cf85240f6d40638792?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FavatarId%3D10122%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/b87135ce3de714cf85240f6d40638792?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26avatarId%3D10122%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/b87135ce3de714cf85240f6d40638792?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26avatarId%3D10122%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/b87135ce3de714cf85240f6d40638792?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26avatarId%3D10122%26noRedirect%3Dtrue"},"displayName":"Ye Wen","active":false,"timeZone":"America/Los_Angeles"},"body":"Looks good to me. Thanks!","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=wenye","name":"wenye","key":"wenye","accountId":"557058:410304ee-1904-4d8c-8ca1-b1148436b5a6","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/b87135ce3de714cf85240f6d40638792?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FavatarId%3D10122%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/b87135ce3de714cf85240f6d40638792?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26avatarId%3D10122%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/b87135ce3de714cf85240f6d40638792?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26avatarId%3D10122%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/b87135ce3de714cf85240f6d40638792?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26avatarId%3D10122%26noRedirect%3Dtrue"},"displayName":"Ye Wen","active":false,"timeZone":"America/Los_Angeles"},"created":"2012-08-07T13:13:32.192-0500","updated":"2012-08-07T13:13:32.192-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/13913/comment/30829","id":"30829","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=viglesias","name":"viglesias","key":"viglesias","accountId":"557058:49b276ff-ebf9-4dd6-ada3-b568a2898707","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/5608e0aa05bd6e5d73b855a08079cceb?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dviglesias%26avatarId%3D10405%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/5608e0aa05bd6e5d73b855a08079cceb?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dviglesias%26avatarId%3D10405%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/5608e0aa05bd6e5d73b855a08079cceb?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dviglesias%26avatarId%3D10405%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/5608e0aa05bd6e5d73b855a08079cceb?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dviglesias%26avatarId%3D10405%26noRedirect%3Dtrue"},"displayName":"Victor Iglesias","active":true,"timeZone":"America/Los_Angeles"},"body":"Was able to reproduce by using NumericEquals policy:\r\ncom.eucalyptus.auth.PolicyParseException: net.sf.json.JSONException: Condition type 'NumericEquals' is not supported\r\n        at com.eucalyptus.auth.policy.PolicyParser.parse(PolicyParser.java:78)\r\n        at com.eucalyptus.auth.DatabaseGroupProxy.addPolicy(DatabaseGroupProxy.java:218)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:616)\r\n        at org.codehaus.groovy.runtime.callsite.PojoMetaMethodSite$PojoCachedMethodSiteNoUnwrapNoCoerce.invoke(PojoMetaMethodSite.java:229)\r\n        at org.codehaus.groovy.runtime.callsite.PojoMetaMethodSite.call(PojoMetaMethodSite.java:52)\r\n        at org.codehaus.groovy.runtime.callsite.AbstractCallSite.call(AbstractCallSite.java:129)\r\n        at upgrade_30_31$_upgradeAuth_closure2_closure15_closure17.doCall(upgrade_30_31.groovy:331)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:616)\r\n        at org.codehaus.groovy.reflection.CachedMethod.invoke(CachedMethod.java:88)\r\n        at groovy.lang.MetaMethod.doMethodInvoke(MetaMethod.java:233)\r\n        at groovy.lang.MetaClassImpl.invokeMethod(MetaClassImpl.java:1058)\r\n        at groovy.lang.ExpandoMetaClass.invokeMethod(ExpandoMetaClass.java:1067)\r\n        at groovy.lang.MetaClassImpl.invokeMethod(MetaClassImpl.java:886)\r\n        at groovy.lang.Closure.call(Closure.java:276)\r\n        at groovy.lang.Closure.call(Closure.java:289)\r\n        at org.codehaus.groovy.runtime.DefaultGroovyMethods.each(DefaultGroovyMethods.java:1176)\r\n        at org.codehaus.groovy.runtime.DefaultGroovyMethods.each(DefaultGroovyMethods.java:1152)\r\n        at org.codehaus.groovy.runtime.dgm$114.invoke(Unknown Source)\r\n        at org.codehaus.groovy.runtime.callsite.PojoMetaMethodSite$PojoMetaMethodSiteNoUnwrapNoCoerce.invoke(PojoMetaMethodSite.java:270)\r\n        at org.codehaus.groovy.runtime.callsite.PojoMetaMethodSite.call(PojoMetaMethodSite.java:52)\r\n        at org.codehaus.groovy.runtime.callsite.AbstractCallSite.call(AbstractCallSite.java:125)\r\n        at upgrade_30_31$_upgradeAuth_closure2_closure15.doCall(upgrade_30_31.groovy:328)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=viglesias","name":"viglesias","key":"viglesias","accountId":"557058:49b276ff-ebf9-4dd6-ada3-b568a2898707","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/5608e0aa05bd6e5d73b855a08079cceb?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dviglesias%26avatarId%3D10405%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/5608e0aa05bd6e5d73b855a08079cceb?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dviglesias%26avatarId%3D10405%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/5608e0aa05bd6e5d73b855a08079cceb?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dviglesias%26avatarId%3D10405%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/5608e0aa05bd6e5d73b855a08079cceb?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dviglesias%26avatarId%3D10405%26noRedirect%3Dtrue"},"displayName":"Victor Iglesias","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-08-08T18:27:52.821-0500","updated":"2012-08-08T18:27:52.821-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/13913/comment/30868","id":"30868","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=chuck","name":"chuck","key":"chuck","accountId":"557058:95e4b012-7cd1-4fd1-995d-eba573d35653","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/39b69736417cafd9d6dddeb1c2e00169?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dchuck%26avatarId%3D12900%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/39b69736417cafd9d6dddeb1c2e00169?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dchuck%26avatarId%3D12900%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/39b69736417cafd9d6dddeb1c2e00169?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dchuck%26avatarId%3D12900%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/39b69736417cafd9d6dddeb1c2e00169?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dchuck%26avatarId%3D12900%26noRedirect%3Dtrue"},"displayName":"Chuck","active":false,"timeZone":"America/Los_Angeles"},"body":"Will merge code soon into testing","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=chuck","name":"chuck","key":"chuck","accountId":"557058:95e4b012-7cd1-4fd1-995d-eba573d35653","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/39b69736417cafd9d6dddeb1c2e00169?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dchuck%26avatarId%3D12900%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/39b69736417cafd9d6dddeb1c2e00169?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dchuck%26avatarId%3D12900%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/39b69736417cafd9d6dddeb1c2e00169?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dchuck%26avatarId%3D12900%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/39b69736417cafd9d6dddeb1c2e00169?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dchuck%26avatarId%3D12900%26noRedirect%3Dtrue"},"displayName":"Chuck","active":false,"timeZone":"America/Los_Angeles"},"created":"2012-08-09T17:56:41.411-0500","updated":"2012-08-09T17:56:41.411-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/13913/comment/30872","id":"30872","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"body":"I merged the code yesterday after Vic pointed out the failure.  should have moved this back to QA, sorry.","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"created":"2012-08-09T18:30:58.397-0500","updated":"2012-08-09T18:30:58.397-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/13913/comment/30934","id":"30934","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=viglesias","name":"viglesias","key":"viglesias","accountId":"557058:49b276ff-ebf9-4dd6-ada3-b568a2898707","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/5608e0aa05bd6e5d73b855a08079cceb?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dviglesias%26avatarId%3D10405%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/5608e0aa05bd6e5d73b855a08079cceb?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dviglesias%26avatarId%3D10405%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/5608e0aa05bd6e5d73b855a08079cceb?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dviglesias%26avatarId%3D10405%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/5608e0aa05bd6e5d73b855a08079cceb?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dviglesias%26avatarId%3D10405%26noRedirect%3Dtrue"},"displayName":"Victor Iglesias","active":true,"timeZone":"America/Los_Angeles"},"body":"Verified in maint/3.1/testing","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=viglesias","name":"viglesias","key":"viglesias","accountId":"557058:49b276ff-ebf9-4dd6-ada3-b568a2898707","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/5608e0aa05bd6e5d73b855a08079cceb?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dviglesias%26avatarId%3D10405%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/5608e0aa05bd6e5d73b855a08079cceb?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dviglesias%26avatarId%3D10405%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/5608e0aa05bd6e5d73b855a08079cceb?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dviglesias%26avatarId%3D10405%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/5608e0aa05bd6e5d73b855a08079cceb?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dviglesias%26avatarId%3D10405%26noRedirect%3Dtrue"},"displayName":"Victor Iglesias","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-08-11T17:49:56.663-0500","updated":"2012-08-11T17:49:56.663-0500"}],"maxResults":11,"total":11,"startAt":0},"votes":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/EUCA-2418/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_11808":null}}
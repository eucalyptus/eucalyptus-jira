{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"56801","self":"https://eucalyptus.atlassian.net/rest/api/2/issue/56801","key":"EUCA-13334","fields":{"issuetype":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://eucalyptus.atlassian.net/secure/viewavatar?size=xsmall&avatarId=14803&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":14803},"timespent":null,"customfield_13100":null,"project":{"self":"https://eucalyptus.atlassian.net/rest/api/2/project/10000","id":"10000","key":"EUCA","name":"Eucalyptus","avatarUrls":{"48x48":"https://eucalyptus.atlassian.net/secure/projectavatar?pid=10000&avatarId=10011","24x24":"https://eucalyptus.atlassian.net/secure/projectavatar?size=small&pid=10000&avatarId=10011","16x16":"https://eucalyptus.atlassian.net/secure/projectavatar?size=xsmall&pid=10000&avatarId=10011","32x32":"https://eucalyptus.atlassian.net/secure/projectavatar?size=medium&pid=10000&avatarId=10011"}},"customfield_11000":null,"customfield_11001":null,"fixVersions":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/version/18601","id":"18601","description":"Eucalyptus 4.4.1","name":"4.4.1","archived":false,"released":true,"releaseDate":"2017-05-09"}],"aggregatetimespent":null,"customfield_10310":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/12601","value":"CentOS 7","id":"12601"}],"resolution":{"self":"https://eucalyptus.atlassian.net/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_10311":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/12401","value":"VPC-MIDO","id":"12401"}],"customfield_11401":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=tony","name":"tony","key":"tony","accountId":"557058:353956db-b78c-4f3b-9096-f8f58e6709c8","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/14ec1b18e630cc0743492fc327a12df7?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dtony%26avatarId%3D16600%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/14ec1b18e630cc0743492fc327a12df7?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dtony%26avatarId%3D16600%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/14ec1b18e630cc0743492fc327a12df7?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dtony%26avatarId%3D16600%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/14ec1b18e630cc0743492fc327a12df7?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dtony%26avatarId%3D16600%26noRedirect%3Dtrue"},"displayName":"Tony Beckham","active":true,"timeZone":"America/Tijuana"},"customfield_11400":null,"customfield_10302":null,"customfield_10500":{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/10403","value":"Not Applicable","id":"10403"},"customfield_10104":["com.atlassian.greenhopper.service.sprint.Sprint@6d8885c[id=148,rapidViewId=118,state=CLOSED,name=5.0 Sprint 1,goal=,startDate=2017-03-16T04:00:04.312Z,endDate=2017-04-06T04:00:00.000Z,completeDate=2017-04-07T18:58:06.909Z,sequence=148]"],"customfield_10303":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=sjones","name":"sjones","key":"sjones","accountId":"557058:f5dce1b0-db45-4dd6-a0e8-3cea5effb5ce","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue"},"displayName":"Steve Jones","active":true,"timeZone":"America/Los_Angeles"},"customfield_10105":null,"customfield_10700":null,"customfield_10304":null,"customfield_10701":null,"customfield_10306":null,"customfield_10702":null,"customfield_10703":null,"customfield_10308":null,"customfield_10704":null,"resolutiondate":"2017-04-14T19:36:31.946-0500","customfield_10309":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/10204","value":"KVM","id":"10204"}],"customfield_10705":null,"workratio":-1,"watches":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/EUCA-13334/watchers","watchCount":3,"isWatching":false},"lastViewed":null,"created":"2017-03-30T15:22:51.096-0500","customfield_12000":null,"customfield_12400":null,"priority":{"self":"https://eucalyptus.atlassian.net/rest/api/2/priority/3","iconUrl":"https://eucalyptus.atlassian.net/images/icons/priorities/major.svg","name":"Major","id":"3"},"customfield_12201":null,"customfield_12600":"{repository={count=2, dataType=repository}, json={\"cachedValue\":{\"errors\":[],\"summary\":{\"repository\":{\"overall\":{\"count\":2,\"lastUpdated\":\"2017-04-05T13:12:44.000-0500\",\"dataType\":\"repository\"},\"byInstanceType\":{\"github\":{\"count\":2,\"name\":\"GitHub\"}}}}},\"isStale\":true}}","customfield_10102":null,"customfield_10300":null,"customfield_10301":null,"labels":[],"customfield_11700":null,"aggregatetimeoriginalestimate":null,"timeestimate":null,"customfield_11901":null,"versions":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/version/18100","id":"18100","description":"Eucalyptus 4.4.0","name":"4.4.0","archived":false,"released":true,"releaseDate":"2017-03-07"}],"issuelinks":[{"id":"50905","self":"https://eucalyptus.atlassian.net/rest/api/2/issueLink/50905","type":{"id":"10600","name":"Bonfire Testing","inward":"discovered while testing","outward":"testing discovered","self":"https://eucalyptus.atlassian.net/rest/api/2/issueLinkType/10600"},"inwardIssue":{"id":"48905","key":"EUCA-12786","self":"https://eucalyptus.atlassian.net/rest/api/2/issue/48905","fields":{"summary":"CFN UpdateStack: Instance Resource with Disable API Termination results with failed instance","status":{"self":"https://eucalyptus.atlassian.net/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://eucalyptus.atlassian.net/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://eucalyptus.atlassian.net/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://eucalyptus.atlassian.net/rest/api/2/priority/3","iconUrl":"https://eucalyptus.atlassian.net/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://eucalyptus.atlassian.net/secure/viewavatar?size=xsmall&avatarId=14803&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":14803}}}}],"assignee":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=hspencer","name":"hspencer","key":"hspencer","accountId":"557058:4a3a93bc-21f8-4658-9f5b-9cb484c910a7","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue"},"displayName":"Harold Spencer Jr.","active":true,"timeZone":"America/Los_Angeles"},"updated":"2017-04-14T19:36:31.963-0500","status":{"self":"https://eucalyptus.atlassian.net/rest/api/2/status/10006","description":"A fix has been committed, and will be part of the next release","iconUrl":"https://eucalyptus.atlassian.net/images/icons/statuses/generic.png","name":"Release Pending","id":"10006","statusCategory":{"self":"https://eucalyptus.atlassian.net/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/component/12900","id":"12900","name":"CloudFormation"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/component/11504","id":"11504","name":"EC2"}],"timeoriginalestimate":null,"description":"Discovered while investigating EUCA-12786.  Seems like the issue is around the {{DisableApiTermination}} property.  I ran another test where I used the same instance but modified only the instance attribute {{DisableApiTermination}}.  Same result:\r\n# Differences between templates:\r\n{code}\r\n[root@g-22-04 ~]# diff cfn-instance-test-update4a.json cfn-instance-test-update4b.json\r\n5c5\r\n<     \"Description\" : \"Cloudformation UpdateStack #4-A: Enable DisableApiTermination on instance store-backed HVM instance\",\r\n---\r\n>     \"Description\" : \"Cloudformation UpdateStack #4-B: Disable DisableApiTermination on instance store-backed HVM instance\",\r\n222d221\r\n<                     \"DisableApiTermination\" : \"true\",\r\n{code}\r\n# Deployed stack using linked {{cfn-instance-test-update4a.json}} template:\r\n{code}\r\n[root@g-22-04 ~]# euform-create-stack InstanceTest --template-file cfn-instance-test-update4a.json --parameter ImageId=emi-d978f0ca --parameter KeyName=sales-admin --region sales-admin@\r\narn:aws:cloudformation::002598321247:stack/InstanceTest/3a5d2fef-be4d-4f6a-80e3-3f9d4e85dbba\r\n[root@g-22-04 ~]# euform-describe-stacks --region sales-admin@\r\nSTACK\tInstanceTest\tCREATE_COMPLETE\t\tCloudformation UpdateStack #4-A: Enable DisableApiTermination on instance store-backed HVM instance\t2016-09-28T13:10:11.381Z\r\nPARAMETER\tImageId\t\temi-d978f0ca\r\nPARAMETER\tInstanceType\t\tm1.medium\r\nPARAMETER\tKeyName\t\tsales-admin\r\nOUTPUT\tInstanceId\ti-361de541\r\nOUTPUT\tAZ\tds2\r\nOUTPUT\tPublicIP\t10.116.155.136\r\n[root@g-22-04 ~]# curl -I 10.116.155.136\r\nHTTP/1.1 200 OK\r\nServer: nginx/1.10.0 (Ubuntu)\r\nDate: Wed, 28 Sep 2016 13:43:51 GMT\r\nContent-Type: text/html\r\nContent-Length: 612\r\nLast-Modified: Wed, 28 Sep 2016 13:14:16 GMT\r\nConnection: keep-alive\r\nETag: \"57ebc228-264\"\r\nAccept-Ranges: bytes\r\n\r\n{code}\r\n# Ran UpdateStack using linked {{cfn-instance-test-update4b.json}} template with deployed stack:\r\n{code}\r\n[root@g-22-04 ~]# euform-update-stack InstanceTest --template-file cfn-instance-test-update4b.json --parameter ImageId=emi-d978f0ca --parameter KeyName=sales-admin --region sales-admin@\r\narn:aws:cloudformation::002598321247:stack/InstanceTest/3a5d2fef-be4d-4f6a-80e3-3f9d4e85dbba\r\n[root@g-22-04 ~]# euform-describe-stacks --region sales-admin@\r\nSTACK\tInstanceTest\tUPDATE_COMPLETE\t\tCloudformation UpdateStack #4-B: Disable DisableApiTermination on instance store-backed HVM instance\t2016-09-28T13:10:11.381Z\r\nPARAMETER\tImageId\t\temi-d978f0ca\r\nPARAMETER\tInstanceType\t\tm1.medium\r\nPARAMETER\tKeyName\t\tsales-admin\r\nOUTPUT\tInstanceId\ti-361de541\r\nOUTPUT\tAZ\tds2\r\nOUTPUT\tPublicIP\t10.116.155.136\r\n[root@g-22-04 ~]# curl -I 10.116.155.136\r\n^C\r\n{code}\r\n# Confirmed {{--disable-api-termination}} attribute correctly changed:\r\n{code}\r\n[root@g-22-04 ~]# euca-describe-instance-attribute --disable-api-termination i-361de541 --region sales-admin@\r\ndisableApiTermination\ti-361de541\tfalse\r\n{code}\r\n# List of stack events:\r\n{code}\r\n[root@g-22-04 ~]# euform-describe-stack-events InstanceTest --region sales-admin@\r\nEVENT\tInstanceTest\t0324afd5-de4f-435e-be97-76d83a531c01\tAWS::CloudFormation::Stack\tInstanceTest\tarn:aws:cloudformation::002598321247:stack/InstanceTest/3a5d2fef-be4d-4f6a-80e3-3f9d4e85dbba\t2016-09-28T13:44:42.023Z\tUPDATE_COMPLETE\r\nEVENT\tInstanceTest\t882d32c4-f9b7-4aef-b26d-3a5cf1b267bc\tAWS::CloudFormation::Stack\tInstanceTest\tarn:aws:cloudformation::002598321247:stack/InstanceTest/3a5d2fef-be4d-4f6a-80e3-3f9d4e85dbba\t2016-09-28T13:44:32.526Z\tUPDATE_COMPLETE_CLEANUP_IN_PROGRESS\r\nEVENT\tInstanceTest\tIPAddress-UPDATE_COMPLETE-1475070272090\tAWS::EC2::EIP\tIPAddress\t10.116.155.136\t2016-09-28T13:44:32.090Z\tUPDATE_COMPLETE\r\nEVENT\tInstanceTest\tIPAddress-UPDATE_IN_PROGRESS-1475070271456\tAWS::EC2::EIP\tIPAddress\t10.116.155.136\t2016-09-28T13:44:31.456Z\tUPDATE_IN_PROGRESS\r\nEVENT\tInstanceTest\tInstance-UPDATE_COMPLETE-1475070270905\tAWS::EC2::Instance\tInstance\ti-361de541\t2016-09-28T13:44:30.905Z\tUPDATE_COMPLETE\r\nEVENT\tInstanceTest\tInstance-UPDATE_IN_PROGRESS-1475070268392\tAWS::EC2::Instance\tInstance\ti-361de541\t2016-09-28T13:44:28.392Z\tUPDATE_IN_PROGRESS\r\nEVENT\tInstanceTest\t92dbb1e7-dc0b-45be-bac9-a4f1f9e3eebd\tAWS::CloudFormation::Stack\tInstanceTest\tarn:aws:cloudformation::002598321247:stack/InstanceTest/3a5d2fef-be4d-4f6a-80e3-3f9d4e85dbba\t2016-09-28T13:44:25.417Z\tUPDATE_IN_PROGRESS\tUser Initiated\r\nEVENT\tInstanceTest\tafcbc3b1-7f79-4065-80cf-3a0946ba0d61\tAWS::CloudFormation::Stack\tInstanceTest\tarn:aws:cloudformation::002598321247:stack/InstanceTest/3a5d2fef-be4d-4f6a-80e3-3f9d4e85dbba\t2016-09-28T13:11:10.655Z\tCREATE_COMPLETE\r\nEVENT\tInstanceTest\tIPAddress-CREATE_COMPLETE-1475068269894\tAWS::EC2::EIP\tIPAddress\t10.116.155.136\t2016-09-28T13:11:09.894Z\tCREATE_COMPLETE\r\nEVENT\tInstanceTest\tIPAddress-CREATE_IN_PROGRESS-1475068268852\tAWS::EC2::EIP\tIPAddress\t10.116.155.136\t2016-09-28T13:11:08.852Z\tCREATE_IN_PROGRESSResource creation Initiated\r\nEVENT\tInstanceTest\tIPAddress-CREATE_IN_PROGRESS-1475068268470\tAWS::EC2::EIP\tIPAddress\t\t2016-09-28T13:11:08.470Z\tCREATE_IN_PROGRESS\r\nEVENT\tInstanceTest\tInstance-CREATE_COMPLETE-1475068267845\tAWS::EC2::Instance\tInstance\ti-361de541\t2016-09-28T13:11:07.845Z\tCREATE_COMPLETE\r\nEVENT\tInstanceTest\tInstance-CREATE_IN_PROGRESS-1475068221726\tAWS::EC2::Instance\tInstance\ti-361de541\t2016-09-28T13:10:21.726Z\tCREATE_IN_PROGRESS\tResource creation Initiated\r\nEVENT\tInstanceTest\tSubnetNetworkAclAssociation-CREATE_COMPLETE-1475068221382\tAWS::EC2::SubnetNetworkAclAssociation\tSubnetNetworkAclAssociation\taclassoc-cfca91bf\t2016-09-28T13:10:21.382Z\tCREATE_COMPLETE\r\nEVENT\tInstanceTest\tSubnetRouteTableAssocaiation-CREATE_COMPLETE-1475068221324\tAWS::EC2::SubnetRouteTableAssociation\tSubnetRouteTableAssocaiation\trtbassoc-9007ea73\t2016-09-28T13:10:21.324Z\tCREATE_COMPLETE\r\nEVENT\tInstanceTest\tSubnetNetworkAclAssociation-CREATE_IN_PROGRESS-1475068220940\tAWS::EC2::SubnetNetworkAclAssociation\tSubnetNetworkAclAssociation\taclassoc-cfca91bf\t2016-09-28T13:10:20.940Z\tCREATE_IN_PROGRESS\tResource creation Initiated\r\nEVENT\tInstanceTest\tSubnetRouteTableAssocaiation-CREATE_IN_PROGRESS-1475068220836\tAWS::EC2::SubnetRouteTableAssociation\tSubnetRouteTableAssocaiation\trtbassoc-9007ea73\t2016-09-28T13:10:20.836Z\tCREATE_IN_PROGRESS\tResource creation Initiated\r\nEVENT\tInstanceTest\tInstance-CREATE_IN_PROGRESS-1475068220807\tAWS::EC2::Instance\tInstance\t\t2016-09-28T13:10:20.807Z\tCREATE_IN_PROGRESS\r\nEVENT\tInstanceTest\tOutboundResponsePortsNetworkAclEntry-CREATE_COMPLETE-1475068220015\tAWS::EC2::NetworkAclEntry\tOutboundResponsePortsNetworkAclEntry\tInstanceTest-OutboundResponsePortsNetworkAclEntry-UCY2VCJQFFFFO\t2016-09-28T13:10:20.015Z\tCREATE_COMPLETE\r\nEVENT\tInstanceTest\tOutBoundHTTPSNetworkAclEntry-CREATE_COMPLETE-1475068219974\tAWS::EC2::NetworkAclEntry\tOutBoundHTTPSNetworkAclEntry\tInstanceTest-OutBoundHTTPSNetworkAclEntry-TSNGANJLRXUNM\t2016-09-28T13:10:19.974Z\tCREATE_COMPLETE\r\nEVENT\tInstanceTest\tInboundResponsePortsNetworkAclEntry-CREATE_COMPLETE-1475068219941\tAWS::EC2::NetworkAclEntry\tInboundResponsePortsNetworkAclEntry\tInstanceTest-InboundResponsePortsNetworkAclEntry-A1MYORQ2A3LGE\t2016-09-28T13:10:19.941Z\tCREATE_COMPLETE\r\nEVENT\tInstanceTest\tInboundSSHNetworkAclEntry-CREATE_COMPLETE-1475068219907\tAWS::EC2::NetworkAclEntry\tInboundSSHNetworkAclEntry\tInstanceTest-InboundSSHNetworkAclEntry-HJIJZ9X1USNCF\t2016-09-28T13:10:19.907Z\tCREATE_COMPLETE\r\nEVENT\tInstanceTest\tInboundHTTPNetworkAclEntry-CREATE_COMPLETE-1475068219874\tAWS::EC2::NetworkAclEntry\tInboundHTTPNetworkAclEntry\tInstanceTest-InboundHTTPNetworkAclEntry-MTXW568HMHCWE\t2016-09-28T13:10:19.874Z\tCREATE_COMPLETE\r\nEVENT\tInstanceTest\tOutBoundHTTPNetworkAclEntry-CREATE_COMPLETE-1475068219840\tAWS::EC2::NetworkAclEntry\tOutBoundHTTPNetworkAclEntry\tInstanceTest-OutBoundHTTPNetworkAclEntry-6EJDSL3YWSKQP\t2016-09-28T13:10:19.840Z\tCREATE_COMPLETE\r\nEVENT\tInstanceTest\tRoute-CREATE_COMPLETE-1475068219480\tAWS::EC2::Route\tRoute\tInstanceTest-Route-NRKRHQHL9QPC2\t2016-09-28T13:10:19.480Z\tCREATE_COMPLETE\r\nEVENT\tInstanceTest\tSubnetNetworkAclAssociation-CREATE_IN_PROGRESS-1475068219446\tAWS::EC2::SubnetNetworkAclAssociation\tSubnetNetworkAclAssociation\t\t2016-09-28T13:10:19.446Z\tCREATE_IN_PROGRESS\r\nEVENT\tInstanceTest\tSubnetRouteTableAssocaiation-CREATE_IN_PROGRESS-1475068219321\tAWS::EC2::SubnetRouteTableAssociation\tSubnetRouteTableAssocaiation\t\t2016-09-28T13:10:19.321Z\tCREATE_IN_PROGRESS\r\nEVENT\tInstanceTest\tOutboundResponsePortsNetworkAclEntry-CREATE_IN_PROGRESS-1475068219016\tAWS::EC2::NetworkAclEntry\tOutboundResponsePortsNetworkAclEntry\tInstanceTest-OutboundResponsePortsNetworkAclEntry-UCY2VCJQFFFFO\t2016-09-28T13:10:19.016Z\tCREATE_IN_PROGRESS\tResource creation Initiated\r\nEVENT\tInstanceTest\tOutBoundHTTPSNetworkAclEntry-CREATE_IN_PROGRESS-1475068218993\tAWS::EC2::NetworkAclEntry\tOutBoundHTTPSNetworkAclEntry\tInstanceTest-OutBoundHTTPSNetworkAclEntry-TSNGANJLRXUNM\t2016-09-28T13:10:18.993Z\tCREATE_IN_PROGRESS\tResource creation Initiated\r\nEVENT\tInstanceTest\tOutBoundHTTPNetworkAclEntry-CREATE_IN_PROGRESS-1475068218949\tAWS::EC2::NetworkAclEntry\tOutBoundHTTPNetworkAclEntry\tInstanceTest-OutBoundHTTPNetworkAclEntry-6EJDSL3YWSKQP\t2016-09-28T13:10:18.949Z\tCREATE_IN_PROGRESS\tResource creation Initiated\r\nEVENT\tInstanceTest\tInboundResponsePortsNetworkAclEntry-CREATE_IN_PROGRESS-1475068218811\tAWS::EC2::NetworkAclEntry\tInboundResponsePortsNetworkAclEntry\tInstanceTest-InboundResponsePortsNetworkAclEntry-A1MYORQ2A3LGE\t2016-09-28T13:10:18.811Z\tCREATE_IN_PROGRESS\tResource creation Initiated\r\nEVENT\tInstanceTest\tInboundHTTPNetworkAclEntry-CREATE_IN_PROGRESS-1475068218766\tAWS::EC2::NetworkAclEntry\tInboundHTTPNetworkAclEntry\tInstanceTest-InboundHTTPNetworkAclEntry-MTXW568HMHCWE\t2016-09-28T13:10:18.766Z\tCREATE_IN_PROGRESS\tResource creation Initiated\r\nEVENT\tInstanceTest\tInboundSSHNetworkAclEntry-CREATE_IN_PROGRESS-1475068218724\tAWS::EC2::NetworkAclEntry\tInboundSSHNetworkAclEntry\tInstanceTest-InboundSSHNetworkAclEntry-HJIJZ9X1USNCF\t2016-09-28T13:10:18.724Z\tCREATE_IN_PROGRESS\tResource creation Initiated\r\nEVENT\tInstanceTest\tRoute-CREATE_IN_PROGRESS-1475068218524\tAWS::EC2::Route\tRoute\tInstanceTest-Route-NRKRHQHL9QPC2\t2016-09-28T13:10:18.524Z\tCREATE_IN_PROGRESS\tResource creation Initiated\r\nEVENT\tInstanceTest\tSecurityGroup-CREATE_COMPLETE-1475068218304\tAWS::EC2::SecurityGroup\tSecurityGroup\tsg-d04f12a1\t2016-09-28T13:10:18.304Z\tCREATE_COMPLETE\r\nEVENT\tInstanceTest\tOutboundResponsePortsNetworkAclEntry-CREATE_IN_PROGRESS-1475068218013\tAWS::EC2::NetworkAclEntry\tOutboundResponsePortsNetworkAclEntry\t\t2016-09-28T13:10:18.013Z\tCREATE_IN_PROGRESS\r\nEVENT\tInstanceTest\tOutBoundHTTPSNetworkAclEntry-CREATE_IN_PROGRESS-1475068217971\tAWS::EC2::NetworkAclEntry\tOutBoundHTTPSNetworkAclEntry\t\t2016-09-28T13:10:17.971Z\tCREATE_IN_PROGRESS\r\nEVENT\tInstanceTest\tOutBoundHTTPNetworkAclEntry-CREATE_IN_PROGRESS-1475068217938\tAWS::EC2::NetworkAclEntry\tOutBoundHTTPNetworkAclEntry\t\t2016-09-28T13:10:17.938Z\tCREATE_IN_PROGRESS\r\nEVENT\tInstanceTest\tInboundResponsePortsNetworkAclEntry-CREATE_IN_PROGRESS-1475068217905\tAWS::EC2::NetworkAclEntry\tInboundResponsePortsNetworkAclEntry\t\t2016-09-28T13:10:17.905Z\tCREATE_IN_PROGRESS\r\nEVENT\tInstanceTest\tInboundHTTPNetworkAclEntry-CREATE_IN_PROGRESS-1475068217871\tAWS::EC2::NetworkAclEntry\tInboundHTTPNetworkAclEntry\t\t2016-09-28T13:10:17.871Z\tCREATE_IN_PROGRESS\r\nEVENT\tInstanceTest\tInboundSSHNetworkAclEntry-CREATE_IN_PROGRESS-1475068217840\tAWS::EC2::NetworkAclEntry\tInboundSSHNetworkAclEntry\t\t2016-09-28T13:10:17.840Z\tCREATE_IN_PROGRESS\r\nEVENT\tInstanceTest\tRoute-CREATE_IN_PROGRESS-1475068217554\tAWS::EC2::Route\tRoute\t\t2016-09-28T13:10:17.554Z\tCREATE_IN_PROGRESS\r\nEVENT\tInstanceTest\tSubnet-CREATE_COMPLETE-1475068217312\tAWS::EC2::Subnet\tSubnet\tsubnet-db192673\t2016-09-28T13:10:17.312Z\tCREATE_COMPLETE\r\nEVENT\tInstanceTest\tNetworkAcl-CREATE_COMPLETE-1475068216371\tAWS::EC2::NetworkAcl\tNetworkAcl\tacl-c3ad5b91\t2016-09-28T13:10:16.371Z\tCREATE_COMPLETE\r\nEVENT\tInstanceTest\tRouteTable-CREATE_COMPLETE-1475068216154\tAWS::EC2::RouteTable\tRouteTable\trtb-533e9b9d\t2016-09-28T13:10:16.154Z\tCREATE_COMPLETE\r\nEVENT\tInstanceTest\tAttachGateway-CREATE_COMPLETE-1475068215579\tAWS::EC2::VPCGatewayAttachment\tAttachGateway\tInstanceTest-AttachGateway-CS96UKHE0HI7T\t2016-09-28T13:10:15.579Z\tCREATE_COMPLETE\r\nEVENT\tInstanceTest\tSecurityGroup-CREATE_IN_PROGRESS-1475068215407\tAWS::EC2::SecurityGroup\tSecurityGroup\tsg-d04f12a1\t2016-09-28T13:10:15.407Z\tCREATE_IN_PROGRESS\tResource creation Initiated\r\nEVENT\tInstanceTest\tSubnet-CREATE_IN_PROGRESS-1475068215349\tAWS::EC2::Subnet\tSubnet\tsubnet-db192673\t2016-09-28T13:10:15.349Z\tCREATE_IN_PROGRESS\tResource creation Initiated\r\nEVENT\tInstanceTest\tNetworkAcl-CREATE_IN_PROGRESS-1475068215248\tAWS::EC2::NetworkAcl\tNetworkAcl\tacl-c3ad5b91\t2016-09-28T13:10:15.248Z\tCREATE_IN_PROGRESS\tResource creation Initiated\r\nEVENT\tInstanceTest\tRouteTable-CREATE_IN_PROGRESS-1475068215216\tAWS::EC2::RouteTable\tRouteTable\trtb-533e9b9d\t2016-09-28T13:10:15.216Z\tCREATE_IN_PROGRESS\tResource creation Initiated\r\nEVENT\tInstanceTest\tAttachGateway-CREATE_IN_PROGRESS-1475068215169\tAWS::EC2::VPCGatewayAttachment\tAttachGateway\tInstanceTest-AttachGateway-CS96UKHE0HI7T\t2016-09-28T13:10:15.169Z\tCREATE_IN_PROGRESS\tResource creation Initiated\r\nEVENT\tInstanceTest\tSecurityGroup-CREATE_IN_PROGRESS-1475068214809\tAWS::EC2::SecurityGroup\tSecurityGroup\t\t2016-09-28T13:10:14.809Z\tCREATE_IN_PROGRESS\r\nEVENT\tInstanceTest\tNetworkAcl-CREATE_IN_PROGRESS-1475068214775\tAWS::EC2::NetworkAcl\tNetworkAcl\t\t2016-09-28T13:10:14.775Z\tCREATE_IN_PROGRESS\r\nEVENT\tInstanceTest\tRouteTable-CREATE_IN_PROGRESS-1475068214750\tAWS::EC2::RouteTable\tRouteTable\t\t2016-09-28T13:10:14.750Z\tCREATE_IN_PROGRESS\r\nEVENT\tInstanceTest\tSubnet-CREATE_IN_PROGRESS-1475068214725\tAWS::EC2::Subnet\tSubnet\t\t2016-09-28T13:10:14.725Z\tCREATE_IN_PROGRESS\r\nEVENT\tInstanceTest\tAttachGateway-CREATE_IN_PROGRESS-1475068214717\tAWS::EC2::VPCGatewayAttachment\tAttachGateway\t\t2016-09-28T13:10:14.717Z\tCREATE_IN_PROGRESS\r\nEVENT\tInstanceTest\tVPC-CREATE_COMPLETE-1475068214050\tAWS::EC2::VPC\tVPC\tvpc-4e0866fd\t2016-09-28T13:10:14.050Z\tCREATE_COMPLETE\r\nEVENT\tInstanceTest\tInternetGateway-CREATE_COMPLETE-1475068213508\tAWS::EC2::InternetGateway\tInternetGateway\tigw-bd749a1a\t2016-09-28T13:10:13.508Z\tCREATE_COMPLETE\r\nEVENT\tInstanceTest\tVPC-CREATE_IN_PROGRESS-1475068213030\tAWS::EC2::VPC\tVPC\tvpc-4e0866fd\t2016-09-28T13:10:13.030Z\tCREATE_IN_PROGRESS\tResource creation Initiated\r\nEVENT\tInstanceTest\tInternetGateway-CREATE_IN_PROGRESS-1475068212845\tAWS::EC2::InternetGateway\tInternetGateway\tigw-bd749a1a\t2016-09-28T13:10:12.845Z\tCREATE_IN_PROGRESS\tResource creation Initiated\r\nEVENT\tInstanceTest\tInternetGateway-CREATE_IN_PROGRESS-1475068212399\tAWS::EC2::InternetGateway\tInternetGateway\t\t2016-09-28T13:10:12.399Z\tCREATE_IN_PROGRESS\r\nEVENT\tInstanceTest\tVPC-CREATE_IN_PROGRESS-1475068212390\tAWS::EC2::VPC\tVPC\t\t2016-09-28T13:10:12.390Z\tCREATE_IN_PROGRESS\r\nEVENT\tInstanceTest\t3362a7c5-2121-4776-833c-cc2830799bcd\tAWS::CloudFormation::Stack\tInstanceTest\tarn:aws:cloudformation::002598321247:stack/InstanceTest/3a5d2fef-be4d-4f6a-80e3-3f9d4e85dbba\t2016-09-28T13:10:11.791Z\tCREATE_IN_PROGRESS\tUser Initiated\r\n{code}\r\n\r\n*Workaround*\r\n\r\n[~sjones] mentioned a workaround in EUCA-12786:\r\n\r\n{quote}\r\nLooks like the security group for the instance is reset to the default for the vpc when the instance is updated:\r\n\r\n{code}\r\n#\r\n# euform-create-stack --template-file cfn-instance-test-update-4a.json --parameter ImageId=emi-8c527d23 --parameter KeyName=root instance-test-update-1\r\narn:aws:cloudformation::000202537975:stack/instance-test-update-1/bb87718a-b346-440f-83bb-164aa57e382e\r\n# \r\n# \r\n# euform-describe-stacks instance-test-update-1\r\nSTACK\tinstance-test-update-1\tCREATE_COMPLETE\t\tCloudformation UpdateStack #4-A: Enable DisableApiTermination on instance store-backed HVM instance\t2017-03-29T04:39:20.394Z\r\nPARAMETER\tImageId\t\temi-8c527d23\r\nPARAMETER\tInstanceType\t\tm1.medium\r\nPARAMETER\tKeyName\t\troot\r\nOUTPUT\tInstanceId\ti-8832e2ae\r\nOUTPUT\tAZ\tone\r\nOUTPUT\tPublicIP\t10.116.155.44\r\n# \r\n# \r\n# euca-describe-instance-attribute -g i-8832e2ae\r\ngroupSet\ti-8832e2ae\tsg-ec7b6e18\r\n# \r\n# \r\n# euform-update-stack --template-file cfn-instance-test-update-4b.json --parameter ImageId=emi-8c527d23 --parameter KeyName=root instance-test-update-1\r\narn:aws:cloudformation::000202537975:stack/instance-test-update-1/bb87718a-b346-440f-83bb-164aa57e382e\r\n# \r\n# \r\n# euform-describe-stacks instance-test-update-1\r\nSTACK\tinstance-test-update-1\tUPDATE_COMPLETE\t\tCloudformation UpdateStack #4-B: Disable DisableApiTermination on instance store-backed HVM instance\t2017-03-29T04:39:20.394Z\r\nPARAMETER\tImageId\t\temi-8c527d23\r\nPARAMETER\tInstanceType\t\tm1.medium\r\nPARAMETER\tKeyName\t\troot\r\nOUTPUT\tInstanceId\ti-8832e2ae\r\nOUTPUT\tAZ\tone\r\nOUTPUT\tPublicIP\t10.116.155.44\r\n# \r\n# \r\n# euca-describe-instance-attribute -g i-8832e2ae\r\ngroupSet\ti-8832e2ae\tsg-350a7db7\r\n# \r\n# \r\n# euca-describe-groups sg-350a7db7\r\nGROUP\tsg-350a7db7\t000202537975\tdefault\tdefault VPC security group\tvpc-c9cefea0\r\nPERMISSION\t000202537975\tdefault\tALLOWS\t-1\t\t\tFROM\tUSER\t000202537975\tNAME\tdefault\tID\tsg-350a7db7\tingress\r\nPERMISSION\t000202537975\tdefault\tALLOWS\t-1\t\t\tTO\tCIDR\t0.0.0.0/0\tegress\r\n# \r\n# \r\n{code}\r\n\r\nyou can manually change the group back to the expected one and ssh to the instance:\r\n\r\n{code}\r\n# \r\n# euca-modify-instance-attribute -g sg-ec7b6e18 i-8832e2ae\r\n# \r\n# \r\n# euca-describe-instance-attribute -g i-8832e2ae\r\ngroupSet\ti-8832e2ae\tsg-ec7b6e18\r\n# \r\n# \r\n# ssh euca-10-116-155-44.eucalyptus.c-25.autoqa.qa1.eucalyptus-systems.com\r\nThe authenticity of host 'euca-10-116-155-44.eucalyptus.c-25.autoqa.qa1.eucalyptus-systems.com (10.116.155.44)' can't be established.\r\nRSA key fingerprint is 9b:43:72:71:56:51:8a:68:5a:8a:a9:02:d5:fc:54:c2.\r\nAre you sure you want to continue connecting (yes/no)? yes\r\nWarning: Permanently added 'euca-10-116-155-44.eucalyptus.c-25.autoqa.qa1.eucalyptus-systems.com,10.116.155.44' (RSA) to the list of known hosts.\r\n# exit\r\nConnection to euca-10-116-155-44.eucalyptus.c-25.autoqa.qa1.eucalyptus-systems closed.\r\n# \r\n{code}\r\n{quote}","customfield_13000":null,"customfield_13200":null,"customfield_11300":null,"customfield_11500":null,"timetracking":{},"customfield_10401":null,"customfield_10005":null,"customfield_10600":null,"customfield_12900":null,"attachment":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/attachment/41201","id":"41201","filename":"cfn-instance-test-update4a.json","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=hspencer","name":"hspencer","key":"hspencer","accountId":"557058:4a3a93bc-21f8-4658-9f5b-9cb484c910a7","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue"},"displayName":"Harold Spencer Jr.","active":true,"timeZone":"America/Los_Angeles"},"created":"2017-03-30T15:20:49.282-0500","size":9808,"mimeType":"application/json","content":"https://eucalyptus.atlassian.net/secure/attachment/41201/cfn-instance-test-update4a.json"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/attachment/41200","id":"41200","filename":"cfn-instance-test-update4b.json","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=hspencer","name":"hspencer","key":"hspencer","accountId":"557058:4a3a93bc-21f8-4658-9f5b-9cb484c910a7","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue"},"displayName":"Harold Spencer Jr.","active":true,"timeZone":"America/Los_Angeles"},"created":"2017-03-30T15:20:49.343-0500","size":9755,"mimeType":"application/json","content":"https://eucalyptus.atlassian.net/secure/attachment/41200/cfn-instance-test-update4b.json"}],"aggregatetimeestimate":null,"summary":"CFN UpdateStack: Disable API Termination update triggers SG change","creator":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=hspencer","name":"hspencer","key":"hspencer","accountId":"557058:4a3a93bc-21f8-4658-9f5b-9cb484c910a7","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue"},"displayName":"Harold Spencer Jr.","active":true,"timeZone":"America/Los_Angeles"},"subtasks":[],"reporter":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=hspencer","name":"hspencer","key":"hspencer","accountId":"557058:4a3a93bc-21f8-4658-9f5b-9cb484c910a7","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue"},"displayName":"Harold Spencer Jr.","active":true,"timeZone":"America/Los_Angeles"},"aggregateprogress":{"progress":0,"total":0},"customfield_10000":"3_*:*_1_*:*_114340_*|*_10000_*:*_1_*:*_3013863_*|*_10002_*:*_1_*:*_61833536_*|*_10001_*:*_1_*:*_455027989_*|*_10003_*:*_1_*:*_791231173_*|*_10006_*:*_1_*:*_0","customfield_12100":"0|i043qz:","customfield_10001":"2017-04-04T22:38:47.250-0500","customfield_10002":null,"customfield_10200":null,"customfield_10003":null,"customfield_12500":null,"customfield_10400":null,"customfield_10116":null,"customfield_11600":["ethomas(ethomas)","hspencer(hspencer)","sjones(sjones)"],"environment":"[hspencer-603-maint-4.4|http://jenkins.qa1.eucalyptus-systems.com/job/Quick%20Launch%20Maint_4.4/603/]","customfield_10117":null,"customfield_11800":null,"customfield_11802":null,"customfield_11805":null,"duedate":null,"progress":{"progress":0,"total":0},"customfield_11806":null,"comment":{"comments":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/56801/comment/120325","id":"120325","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=ethomas","name":"ethomas","key":"ethomas","accountId":"557058:8f092f9a-0724-44c0-84a3-0220705f856a","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/a01d066493c57e5dee4b94dc87395576?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FavatarId%3D10122%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/a01d066493c57e5dee4b94dc87395576?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26avatarId%3D10122%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/a01d066493c57e5dee4b94dc87395576?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26avatarId%3D10122%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/a01d066493c57e5dee4b94dc87395576?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26avatarId%3D10122%26noRedirect%3Dtrue"},"displayName":"Evan Thomas","active":false,"timeZone":"America/Los_Angeles"},"body":"git branch dev-ethomas-EUCA-13334\r\ngit show ae4ded3ba74b7adf6902ccb459b79de3be8ca9ad\r\n\r\nThe issue here was that cloudformation was checking the 'SecurityGroupIds' properties and if not set, assumed we wanted to use the default security group in the vpc case.  This is not the case when the NetworkInterfaces property is present, so a check for that is done.\r\n\r\nI have verified that Harold's issue described in this ticket now does the right thing.","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=ethomas","name":"ethomas","key":"ethomas","accountId":"557058:8f092f9a-0724-44c0-84a3-0220705f856a","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/a01d066493c57e5dee4b94dc87395576?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FavatarId%3D10122%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/a01d066493c57e5dee4b94dc87395576?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26avatarId%3D10122%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/a01d066493c57e5dee4b94dc87395576?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26avatarId%3D10122%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/a01d066493c57e5dee4b94dc87395576?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26avatarId%3D10122%26noRedirect%3Dtrue"},"displayName":"Evan Thomas","active":false,"timeZone":"America/Los_Angeles"},"created":"2017-04-04T22:38:47.250-0500","updated":"2017-04-04T22:38:47.250-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/56801/comment/120410","id":"120410","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=sjones","name":"sjones","key":"sjones","accountId":"557058:f5dce1b0-db45-4dd6-a0e8-3cea5effb5ce","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue"},"displayName":"Steve Jones","active":true,"timeZone":"America/Los_Angeles"},"body":"[~ethomas], the fix looks good to me. Should we also add checks for security groups and network interfaces both being specified?","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=sjones","name":"sjones","key":"sjones","accountId":"557058:f5dce1b0-db45-4dd6-a0e8-3cea5effb5ce","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue"},"displayName":"Steve Jones","active":true,"timeZone":"America/Los_Angeles"},"created":"2017-04-05T12:23:30.946-0500","updated":"2017-04-05T12:23:30.946-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/56801/comment/120837","id":"120837","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=hspencer","name":"hspencer","key":"hspencer","accountId":"557058:4a3a93bc-21f8-4658-9f5b-9cb484c910a7","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue"},"displayName":"Harold Spencer Jr.","active":true,"timeZone":"America/Los_Angeles"},"body":"*Eucalyptus Version*\r\n\r\n{{4.4.0-0.25876.33.20170412git5f0e510.el7}}\r\n\r\n*Steps*\r\n\r\n# Deploy Eucalyptus 4.4 cloud with VPC - [hspencer-672-maint-4.4|http://jenkins.qa1.eucalyptus-systems.com/job/Quick%20Launch%20Maint_4.4/672/]\r\n# Create non-eucalyptus account (e.g. {{development-operations}}):\r\n{code}\r\n[root@a-16-l ~]# euare-accountcreate -a development-operations -w > .euca/devops-admin.ini\r\n{code}\r\n# Import SSH key pair:\r\n{code}\r\n[root@a-16-l ~]# ssh-keygen -t rsa -b 4096 -C \"Developement Operations Admin Key\"\r\n[root@a-16-l ~]# euca-import-keypair -f devops-admin-pk.pub devops-admin --region devops-admin@\r\nKEYPAIR\tdevops-admin\tb8:ea:b0:d4:d4:40:26:5f:14:91:ba:a9:05:20:9d:72\r\n{code}\r\n# Bundle, upload and register Ubuntu Xenial cloud image:\r\n{code}\r\n[root@a-16-l ~]# euca-describe-images --all --region devops-admin@\r\nIMAGE\temi-d64c38f0\tubuntu-xenial-x86_64-hvm-20170413/xenial-server-cloudimg-amd64-disk1.raw.manifest.xml\t000756474874\tavailable\tpublic\tx86_64\tmachine\t\t\t\tinstance-store\thvm\r\n{code}\r\n# Create stack using {{cfn-instance-test-update4a.json}} template:\r\n{code}\r\n[root@a-16-l ~]# euform-create-stack EUCA13334Stack --template-file cfn-instance-test-update4a.json --parameter ImageId=emi-d64c38f0 --parameter KeyName=devops-admin --region devops-admin@\r\narn:aws:cloudformation::000571701517:stack/EUCA13334Stack/b1961625-2a88-4b04-bedd-750abffd707c\r\n[root@a-16-l ~]# euform-describe-stacks --region devops-admin@\r\nSTACK\tEUCA13334Stack\tCREATE_COMPLETE\t\tCloudformation UpdateStack #4-A: Enable DisableApiTermination on instance store-backed HVM instance\t2017-04-14T18:28:55.032Z\r\nPARAMETER\tImageId\t\temi-d64c38f0\r\nPARAMETER\tInstanceType\t\tm1.medium\r\nPARAMETER\tKeyName\t\tdevops-admin\r\nOUTPUT\tInstanceId\ti-28be0e1a\r\nOUTPUT\tAZ\tblack-dollar\r\nOUTPUT\tPublicIP\t10.116.131.46\r\n[root@a-16-l ~]# curl -I 10.116.131.46\r\nHTTP/1.1 200 OK\r\nServer: nginx/1.10.0 (Ubuntu)\r\nDate: Fri, 14 Apr 2017 18:45:21 GMT\r\nContent-Type: text/html\r\nContent-Length: 612\r\nLast-Modified: Fri, 14 Apr 2017 18:33:44 GMT\r\nConnection: keep-alive\r\nETag: \"58f11608-264\"\r\nAccept-Ranges: bytes\r\n{code}\r\n# Using {{cfn-instance-test-update4b.json}} template, update deployed stack:\r\n{code}\r\n[root@a-16-l ~]# euform-update-stack EUCA13334Stack --template-file cfn-instance-test-update4b.json --parameter ImageId=emi-d64c38f0 --parameter KeyName=devops-admin --region devops-admin@\r\narn:aws:cloudformation::000571701517:stack/EUCA13334Stack/b1961625-2a88-4b04-bedd-750abffd707c\r\n[root@a-16-l ~]# euform-describe-stacks --region devops-admin@\r\nSTACK\tEUCA13334Stack\tUPDATE_COMPLETE\t\tCloudformation UpdateStack #4-B: Disable DisableApiTermination on instance store-backed HVM instance\t2017-04-14T18:28:55.032Z\r\nPARAMETER\tImageId\t\temi-d64c38f0\r\nPARAMETER\tInstanceType\t\tm1.medium\r\nPARAMETER\tKeyName\t\tdevops-admin\r\nOUTPUT\tInstanceId\ti-28be0e1a\r\nOUTPUT\tAZ\tblack-dollar\r\nOUTPUT\tPublicIP\t10.116.131.46\r\n{code}\r\n# Confirm curl still works:\r\n{code}\r\n[root@a-16-l ~]# curl -I 10.116.131.46\r\nHTTP/1.1 200 OK\r\nServer: nginx/1.10.0 (Ubuntu)\r\nDate: Fri, 14 Apr 2017 19:00:51 GMT\r\nContent-Type: text/html\r\nContent-Length: 612\r\nLast-Modified: Fri, 14 Apr 2017 18:33:44 GMT\r\nConnection: keep-alive\r\nETag: \"58f11608-264\"\r\nAccept-Ranges: bytes\r\n{code}\r\n# Confirm instance attribute has {{disable-api-termination}} set to {{false}}:\r\n{code}\r\n[root@a-16-l ~]# euca-describe-instance-attribute --disable-api-termination i-28be0e1a --region devops-admin@\r\ndisableApiTermination\ti-28be0e1a\tfalse\r\n{code}\r\n# Delete stack:\r\n{code}\r\n[root@a-16-l ~]# euform-delete-stack EUCA13334Stack --region devops-admin@\r\n[root@a-16-l ~]# euform-describe-stacks --region devops-admin@\r\n[root@a-16-l ~]#\r\n{code}\r\n# Confirm instance was terminated:\r\n{code}\r\n[root@a-16-l ~]# euca-describe-instances --region devops-admin@\r\n[root@a-16-l ~]#\r\n{code}\r\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=hspencer","name":"hspencer","key":"hspencer","accountId":"557058:4a3a93bc-21f8-4658-9f5b-9cb484c910a7","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue"},"displayName":"Harold Spencer Jr.","active":true,"timeZone":"America/Los_Angeles"},"created":"2017-04-14T19:36:31.956-0500","updated":"2017-04-14T19:36:31.956-0500"}],"maxResults":3,"total":3,"startAt":0},"votes":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/EUCA-13334/votes","votes":0,"hasVoted":false},"customfield_11808":null,"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]}}}
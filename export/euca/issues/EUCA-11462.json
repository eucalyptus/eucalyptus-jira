{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"38616","self":"https://eucalyptus.atlassian.net/rest/api/2/issue/38616","key":"EUCA-11462","fields":{"issuetype":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://eucalyptus.atlassian.net/secure/viewavatar?size=xsmall&avatarId=14803&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":14803},"timespent":null,"customfield_13100":null,"project":{"self":"https://eucalyptus.atlassian.net/rest/api/2/project/10000","id":"10000","key":"EUCA","name":"Eucalyptus","avatarUrls":{"48x48":"https://eucalyptus.atlassian.net/secure/projectavatar?pid=10000&avatarId=10011","24x24":"https://eucalyptus.atlassian.net/secure/projectavatar?size=small&pid=10000&avatarId=10011","16x16":"https://eucalyptus.atlassian.net/secure/projectavatar?size=xsmall&pid=10000&avatarId=10011","32x32":"https://eucalyptus.atlassian.net/secure/projectavatar?size=medium&pid=10000&avatarId=10011"}},"customfield_11000":null,"customfield_11001":null,"fixVersions":[],"aggregatetimespent":null,"customfield_10310":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/10209","value":"CentOS 6","id":"10209"}],"resolution":null,"customfield_10311":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/11500","value":"Edge","id":"11500"}],"customfield_11401":null,"customfield_11400":null,"customfield_10104":[],"customfield_10302":null,"customfield_10500":{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/10403","value":"Not Applicable","id":"10403"},"customfield_10105":null,"customfield_10303":null,"customfield_10304":null,"customfield_10700":null,"customfield_10701":null,"customfield_10702":null,"customfield_10306":{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/10202","value":"Low","id":"10202"},"customfield_10703":null,"customfield_10308":null,"resolutiondate":null,"customfield_10704":null,"customfield_10705":null,"customfield_10309":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/10204","value":"KVM","id":"10204"}],"workratio":-1,"watches":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/EUCA-11462/watchers","watchCount":2,"isWatching":false},"lastViewed":null,"created":"2015-10-06T16:25:47.240-0500","customfield_12000":null,"priority":{"self":"https://eucalyptus.atlassian.net/rest/api/2/priority/3","iconUrl":"https://eucalyptus.atlassian.net/images/icons/priorities/major.svg","name":"Major","id":"3"},"customfield_12400":null,"customfield_12201":null,"customfield_10102":null,"customfield_10300":null,"customfield_12600":"{}","labels":[],"customfield_10301":null,"customfield_11700":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_11901":null,"versions":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/version/14801","id":"14801","description":"Eucalyptus 4.2.0","name":"4.2.0","archived":false,"released":true,"releaseDate":"2015-10-22"}],"issuelinks":[{"id":"32712","self":"https://eucalyptus.atlassian.net/rest/api/2/issueLink/32712","type":{"id":"10600","name":"Bonfire Testing","inward":"discovered while testing","outward":"testing discovered","self":"https://eucalyptus.atlassian.net/rest/api/2/issueLinkType/10600"},"inwardIssue":{"id":"36940","key":"EUCA-11031","self":"https://eucalyptus.atlassian.net/rest/api/2/issue/36940","fields":{"summary":"ec2:Region condition no longer works when used with multiple regions","status":{"self":"https://eucalyptus.atlassian.net/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://eucalyptus.atlassian.net/images/icons/statuses/generic.png","name":"Closed","id":"6","statusCategory":{"self":"https://eucalyptus.atlassian.net/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://eucalyptus.atlassian.net/rest/api/2/priority/2","iconUrl":"https://eucalyptus.atlassian.net/images/icons/priorities/critical.svg","name":"Critical","id":"2"},"issuetype":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://eucalyptus.atlassian.net/secure/viewavatar?size=xsmall&avatarId=14803&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":14803}}}},{"id":"32714","self":"https://eucalyptus.atlassian.net/rest/api/2/issueLink/32714","type":{"id":"10103","name":"Relates","inward":"relates to","outward":"relates to","self":"https://eucalyptus.atlassian.net/rest/api/2/issueLinkType/10103"},"outwardIssue":{"id":"26104","key":"EUCA-8513","self":"https://eucalyptus.atlassian.net/rest/api/2/issue/26104","fields":{"summary":"User with no IAM policy is able to access some Service APIs","status":{"self":"https://eucalyptus.atlassian.net/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://eucalyptus.atlassian.net/images/icons/statuses/generic.png","name":"Closed","id":"6","statusCategory":{"self":"https://eucalyptus.atlassian.net/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://eucalyptus.atlassian.net/rest/api/2/priority/2","iconUrl":"https://eucalyptus.atlassian.net/images/icons/priorities/critical.svg","name":"Critical","id":"2"},"issuetype":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://eucalyptus.atlassian.net/secure/viewavatar?size=xsmall&avatarId=14803&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":14803}}}},{"id":"32715","self":"https://eucalyptus.atlassian.net/rest/api/2/issueLink/32715","type":{"id":"10103","name":"Relates","inward":"relates to","outward":"relates to","self":"https://eucalyptus.atlassian.net/rest/api/2/issueLinkType/10103"},"outwardIssue":{"id":"26701","key":"EUCA-8554","self":"https://eucalyptus.atlassian.net/rest/api/2/issue/26701","fields":{"summary":"Terminate instance/describe instances from non-admin user behavior incompatible with AWS","status":{"self":"https://eucalyptus.atlassian.net/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://eucalyptus.atlassian.net/images/icons/statuses/generic.png","name":"Closed","id":"6","statusCategory":{"self":"https://eucalyptus.atlassian.net/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://eucalyptus.atlassian.net/rest/api/2/priority/3","iconUrl":"https://eucalyptus.atlassian.net/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://eucalyptus.atlassian.net/secure/viewavatar?size=xsmall&avatarId=14803&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":14803}}}},{"id":"32713","self":"https://eucalyptus.atlassian.net/rest/api/2/issueLink/32713","type":{"id":"10103","name":"Relates","inward":"relates to","outward":"relates to","self":"https://eucalyptus.atlassian.net/rest/api/2/issueLinkType/10103"},"inwardIssue":{"id":"34438","key":"EUCA-10479","self":"https://eucalyptus.atlassian.net/rest/api/2/issue/34438","fields":{"summary":"IAMGLOB : Region specific policies","status":{"self":"https://eucalyptus.atlassian.net/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://eucalyptus.atlassian.net/images/icons/statuses/generic.png","name":"Closed","id":"6","statusCategory":{"self":"https://eucalyptus.atlassian.net/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://eucalyptus.atlassian.net/rest/api/2/priority/3","iconUrl":"https://eucalyptus.atlassian.net/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issuetype/7","id":"7","description":"A user story. Created by JIRA Software - do not edit or delete.","iconUrl":"https://eucalyptus.atlassian.net/secure/viewavatar?size=xsmall&avatarId=14815&avatarType=issuetype","name":"Story","subtask":false,"avatarId":14815}}}}],"assignee":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=kedwards","name":"kedwards","key":"kedwards","accountId":"557058:f9c2f8da-1fc6-4aa7-8fb0-750e7e422b6b","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/d1746a6d05a30ca027012a7da4545962?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dkedwards%26avatarId%3D10200%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/d1746a6d05a30ca027012a7da4545962?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dkedwards%26avatarId%3D10200%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/d1746a6d05a30ca027012a7da4545962?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dkedwards%26avatarId%3D10200%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/d1746a6d05a30ca027012a7da4545962?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dkedwards%26avatarId%3D10200%26noRedirect%3Dtrue"},"displayName":"Ken Edwards","active":true,"timeZone":"America/Los_Angeles"},"updated":"2015-12-04T19:04:52.905-0600","status":{"self":"https://eucalyptus.atlassian.net/rest/api/2/status/10001","description":"This issue has been validated/reproduced, but has not been prioritized yet.","iconUrl":"https://eucalyptus.atlassian.net/images/icons/statuses/generic.png","name":"Confirmed","id":"10001","statusCategory":{"self":"https://eucalyptus.atlassian.net/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"components":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/component/11503","id":"11503","name":"IAM"}],"timeoriginalestimate":null,"description":"*Assessment*\r\n\r\nDiscovered while testing EUCA-11031.  If any authorized API action is ran against an region other than is what has been specified as the 'ec2:Region' value, no error message is returned.  \r\n{code}\r\n# euare-grouplistpolicies -g restricted-actions -v --region devops-admin@future\r\nrestricted-ec2-s3-per-region\r\n{\r\n    \"Statement\":[\r\n      {\r\n        \"Effect\": \"Allow\",\r\n        \"Action\": [ \"ec2:*\" ],\r\n        \"Resource\": \"*\",\r\n        \"Condition\": {\r\n          \"StringEquals\": {\r\n            \"ec2:Region\": \"future\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"Effect\": \"Allow\",\r\n        \"Action\": [ \"s3:*\" ],\r\n        \"Resource\": \"*\",\r\n        \"Condition\": {\r\n          \"StringEquals\": {\r\n            \"ec2:Region\": \"big-grams\"\r\n          }\r\n        }\r\n      }\r\n    ]\r\n}\r\n\r\n# euare-grouplistusers -g restricted-actions --region devops-admin@future\r\narn:aws:iam::001373439898:group/restricted-actions\r\n   users\r\n   arn:aws:iam::001373439898:user/user02\r\n\r\n# euca-describe-keypairs --region devops-admin@big-grams\r\nKEYPAIR\tdevops-admin\t18:52:4b:ea:a4:42:0f:55:0c:f7:19:e7:11:66:f1:a1:82:c1:20:19\r\n\r\n## AWS Error Code should be returned ##\r\n# euca-describe-keypairs --region devops-user02@big-grams\r\n#\r\n{code}\r\n\r\n*Additional Information*\r\n\r\n* Debug message:\r\n{code}\r\n[root@d-02 ~]# euca-describe-keypairs --region devops-user02@big-grams --debug\r\n2015-10-06 08:19:14,658 DEBUG   DescribeKeyPairs parsed arguments: {'filters': None, 'security_token': None, 'url': None, 'region': 'devops-user02@big-grams', 'KeyName': [], 'show_empty_fields': False, 'key_id': None, 'secret_key': None}\r\n2015-10-06 08:19:14,659 INFO    Config finding region option ec2-url\r\n2015-10-06 08:19:14,659 DEBUG   Config   section big-grams\r\n2015-10-06 08:19:14,659 INFO    Config   found   big-grams::ec2-url = 'http://compute.c-40.autoqa.qa1.eucalyptus-systems.com:8773/'\r\n2015-10-06 08:19:14,659 INFO    Config finding region option name\r\n2015-10-06 08:19:14,659 DEBUG   Config   section big-grams\r\n2015-10-06 08:19:14,659 INFO    Config   found   big-grams::name = 'big-grams'\r\n2015-10-06 08:19:14,659 INFO    Config finding global option max-retries\r\n2015-10-06 08:19:14,659 INFO    Config   novalue for max-retries\r\n2015-10-06 08:19:14,659 INFO    Config finding global option timeout\r\n2015-10-06 08:19:14,659 INFO    Config   novalue for timeout\r\n2015-10-06 08:19:14,659 INFO    Config finding region option verify-ssl\r\n2015-10-06 08:19:14,659 DEBUG   Config   section big-grams\r\n2015-10-06 08:19:14,659 DEBUG   Config   section *\r\n2015-10-06 08:19:14,659 INFO    Config   novalue for verify-ssl\r\n2015-10-06 08:19:14,659 INFO    Config finding user option key-id\r\n2015-10-06 08:19:14,660 DEBUG   Config   section devops-user02\r\n2015-10-06 08:19:14,660 INFO    Config   found   devops-user02::key-id = 'AKIABZR45R7LWW5XPW2O'\r\n2015-10-06 08:19:14,660 INFO    Config finding user option secret-key\r\n2015-10-06 08:19:14,660 DEBUG   Config   section devops-user02\r\n2015-10-06 08:19:14,660 INFO    Config   found   devops-user02::secret-key = <redacted>\r\n2015-10-06 08:19:14,660 DEBUG   HmacV4Auth using auth info from configuration\r\n2015-10-06 08:19:14,660 INFO    DescribeKeyPairs parameters: {'Action': 'DescribeKeyPairs', 'Version': '2014-06-15'}\r\n2015-10-06 08:19:14,660 DEBUG   DescribeKeyPairs sending flattened params as form data\r\n2015-10-06 08:19:14,663 INFO    EC2 sending request (attempt 1 of 3)\r\n2015-10-06 08:19:14,669 DEBUG   HmacV4Auth payload hash: 707cfbfe01f2556426e489c0a125bc5a94ef2506b3346ace4f3e868992b05d3a\r\n2015-10-06 08:19:14,669 DEBUG   HmacV4Auth scope: 20151006/big-grams/ec2/aws4_request\r\n2015-10-06 08:19:14,669 DEBUG   HmacV4Auth canonical URI: /\r\n2015-10-06 08:19:14,670 DEBUG   HmacV4Auth canonical query:\r\n2015-10-06 08:19:14,670 DEBUG   HmacV4Auth canonical headers: ['accept:*/*', 'accept-encoding:gzip, deflate', 'connection:keep-alive', 'content-length:42', 'content-type:application/x-www-form-urlencoded', 'host:compute.c-40.autoqa.qa1.eucalyptus-systems.com:8773', 'x-amz-content-sha256:707cfbfe01f2556426e489c0a125bc5a94ef2506b3346ace4f3e868992b05d3a', 'x-amz-date:20151006T151914Z']\r\n2015-10-06 08:19:14,670 DEBUG   HmacV4Auth signed headers: accept;accept-encoding;connection;content-length;content-type;host;x-amz-content-sha256;x-amz-date\r\n2015-10-06 08:19:14,670 DEBUG   HmacV4Auth canonical request: 'POST\\n/\\n\\naccept:*/*\\naccept-encoding:gzip, deflate\\nconnection:keep-alive\\ncontent-length:42\\ncontent-type:application/x-www-form-urlencoded\\nhost:compute.c-40.autoqa.qa1.eucalyptus-systems.com:8773\\nx-amz-content-sha256:707cfbfe01f2556426e489c0a125bc5a94ef2506b3346ace4f3e868992b05d3a\\nx-amz-date:20151006T151914Z\\n\\naccept;accept-encoding;connection;content-length;content-type;host;x-amz-content-sha256;x-amz-date\\n707cfbfe01f2556426e489c0a125bc5a94ef2506b3346ace4f3e868992b05d3a'\r\n2015-10-06 08:19:14,670 DEBUG   HmacV4Auth string to sign: 'AWS4-HMAC-SHA256\\n20151006T151914Z\\n20151006/big-grams/ec2/aws4_request\\n6abfae4134826e23950913bfe77ba467ff4391130462187269a68db141631ccc'\r\n2015-10-06 08:19:14,670 DEBUG   HmacV4Auth signature: dd743c93d57a9a9688b6e5d02a8ecbc84a566780465117c4e0951f1b3bc88360\r\n2015-10-06 08:19:14,670 DEBUG   HmacV4Auth signed headers: accept;accept-encoding;connection;content-length;content-type;host;x-amz-content-sha256;x-amz-date\r\n2015-10-06 08:19:14,670 DEBUG   EC2 request method: POST\r\n2015-10-06 08:19:14,670 DEBUG   EC2 request url:    http://compute.c-40.autoqa.qa1.eucalyptus-systems.com:8773/\r\n2015-10-06 08:19:14,670 DEBUG   EC2 request header: Accept: */*\r\n2015-10-06 08:19:14,671 DEBUG   EC2 request header: Accept-Encoding: gzip, deflate\r\n2015-10-06 08:19:14,671 DEBUG   EC2 request header: Authorization: AWS4-HMAC-SHA256 Credential=AKIABZR45R7LWW5XPW2O/20151006/big-grams/ec2/aws4_request, SignedHeaders=accept;accept-encoding;connection;content-length;content-type;host;x-amz-content-sha256;x-amz-date, Signature=dd743c93d57a9a9688b6e5d02a8ecbc84a566780465117c4e0951f1b3bc88360\r\n2015-10-06 08:19:14,671 DEBUG   EC2 request header: Connection: keep-alive\r\n2015-10-06 08:19:14,671 DEBUG   EC2 request header: Content-Length: 42\r\n2015-10-06 08:19:14,671 DEBUG   EC2 request header: Content-Type: application/x-www-form-urlencoded\r\n2015-10-06 08:19:14,671 DEBUG   EC2 request header: Host: compute.c-40.autoqa.qa1.eucalyptus-systems.com:8773\r\n2015-10-06 08:19:14,671 DEBUG   EC2 request header: User-Agent: euca2ools/3.3.0-pre1-12-g67774c3 (CPython 2.6.6; Linux 2.6.32-573.7.1.el6.x86_64; x86_64) requestbuilder/0.4.0 requests/2.6.0\r\n2015-10-06 08:19:14,671 DEBUG   EC2 request header: X-Amz-Content-SHA256: 707cfbfe01f2556426e489c0a125bc5a94ef2506b3346ace4f3e868992b05d3a\r\n2015-10-06 08:19:14,671 DEBUG   EC2 request header: X-Amz-Date: 20151006T151914Z\r\n2015-10-06 08:19:14,671 DEBUG   EC2 request data:   Action: DescribeKeyPairs\r\n2015-10-06 08:19:14,671 DEBUG   EC2 request data:   Version: 2014-06-15\r\n2015-10-06 08:19:14,794 DEBUG   EC2 response time: 0.123 seconds\r\n2015-10-06 08:19:14,794 INFO    EC2 response status: 200\r\n2015-10-06 08:19:14,795 DEBUG   EC2 response header: content-length: 170\r\n2015-10-06 08:19:14,795 DEBUG   EC2 response header: content-type: application/xml; charset=UTF-8\r\n2015-10-06 08:19:14,795 DEBUG   EC2 response header: date: Tue, 06 Oct 2015 15:19:14 UTC\r\n2015-10-06 08:19:14,795 DEBUG   DescribeKeyPairs -- response content --\r\n<DescribeKeyPairsResponse xmlns=\"http://ec2.amazonaws.com/doc/2014-06-15/\"><requestId>d7dc55d5-f89d-42d1-a5ac-f6a240af85a5</requestId><keySet/></DescribeKeyPairsResponse>\r\n2015-10-06 08:19:14,796 DEBUG   DescribeKeyPairs -- end of response content --\r\n{code}\r\n\r\n*Steps*\r\n\r\n# Set up two Eucalyptus 4.2 (4.2.0-0.0.23957.682.20151001git294b61a.el6) cloud with Eucalyptus DNS enabled\r\n#* [hspencer-1487|http://jenkins.qa1.eucalyptus-systems.com/job/Quick%20Launch%20Master/1487/]\r\n#* [hspencer-1486|http://jenkins.qa1.eucalyptus-systems.com/job/Quick%20Launch%20Master/1486/]\r\n# Use region-configuration script to create region-configuration file:\r\n{code}\r\n# ./region-config-tool.py region_name=future,cloud_cert=future-cert.pem,domain_name=d-02.autoqa.qa1.eucalyptus-systems.com region_name=big-grams,cloud_cert=big-grams-region-cert.pem,domain_name=c-40.autoqa.qa1.eucalyptus-systems.com -f region-config.json\r\n\r\n[root@d-02 ~]# cat region-config.json\r\n{\r\n    \"Regions\": [\r\n        {\r\n            \"CertificateFingerprint\": \"B1:94:FF:9A:BC:2A:2D:95:89:E1:8B:2A:9E:6E:14:AD:20:88:D8:9A:97:44:17:4B:F8:1F:EB:98:08:0D:00:DE\",\r\n            \"CertificateFingerprintDigest\": \"SHA-256\",\r\n            \"IdentifierPartitions\": [\r\n                1\r\n            ],\r\n            \"Name\": \"future\",\r\n            \"Services\": [\r\n                {\r\n                    \"Endpoints\": [\r\n                        \"http://identity.d-02.autoqa.qa1.eucalyptus-systems.com:8773/\"\r\n                    ],\r\n                    \"Type\": \"identity\"\r\n                },\r\n                {\r\n                    \"Endpoints\": [\r\n                        \"http://compute.d-02.autoqa.qa1.eucalyptus-systems.com:8773/\"\r\n                    ],\r\n                    \"Type\": \"compute\"\r\n                }\r\n            ]\r\n        },\r\n        {\r\n            \"CertificateFingerprint\": \"EB:74:48:EA:12:82:BB:4E:7D:B0:AA:04:51:F2:34:7E:D5:63:7A:E3:E8:03:A0:92:90:D7:2A:52:EE:76:5D:D8\",\r\n            \"CertificateFingerprintDigest\": \"SHA-256\",\r\n            \"IdentifierPartitions\": [\r\n                2\r\n            ],\r\n            \"Name\": \"big-grams\",\r\n            \"Services\": [\r\n                {\r\n                    \"Endpoints\": [\r\n                        \"http://identity.c-40.autoqa.qa1.eucalyptus-systems.com:8773/\"\r\n                    ],\r\n                    \"Type\": \"identity\"\r\n                },\r\n                {\r\n                    \"Endpoints\": [\r\n                        \"http://compute.c-40.autoqa.qa1.eucalyptus-systems.com:8773/\"\r\n                    ],\r\n                    \"Type\": \"compute\"\r\n                }\r\n            ]\r\n        }\r\n    ]\r\n}\r\n{code}\r\n# Set region_name value on both clouds:\r\n{code}\r\n[root@d-02 ~]# euctl region.region_name=future --region @localhost\r\nregion.region_name = future\r\n\r\n[root@e-18 ~]# euctl region.region_name=big-grams --region @localhost\r\nregion.region_name = big-grams\r\n{code}\r\n# Uploaded region configuration file on both clouds:\r\n{code}\r\n[root@e-18 ~]# euctl region.region_configuration=@region-config.json --region @localhost\r\n[root@e-18 ~]# euctl region.region_configuration --region @localhost --dump\r\n{\r\n  \"Regions\": [\r\n    {\r\n      \"IdentifierPartitions\": [\r\n        1\r\n      ],\r\n      \"Services\": [\r\n        {\r\n          \"Endpoints\": [\r\n            \"http://identity.d-02.autoqa.qa1.eucalyptus-systems.com:8773/\"\r\n          ],\r\n          \"Type\": \"identity\"\r\n        },\r\n        {\r\n          \"Endpoints\": [\r\n            \"http://compute.d-02.autoqa.qa1.eucalyptus-systems.com:8773/\"\r\n          ],\r\n          \"Type\": \"compute\"\r\n        }\r\n      ],\r\n      \"Name\": \"future\",\r\n      \"CertificateFingerprint\": \"B1:94:FF:9A:BC:2A:2D:95:89:E1:8B:2A:9E:6E:14:AD:20:88:D8:9A:97:44:17:4B:F8:1F:EB:98:08:0D:00:DE\",\r\n      \"CertificateFingerprintDigest\": \"SHA-256\"\r\n    },\r\n    {\r\n      \"IdentifierPartitions\": [\r\n        2\r\n      ],\r\n      \"Services\": [\r\n        {\r\n          \"Endpoints\": [\r\n            \"http://identity.c-40.autoqa.qa1.eucalyptus-systems.com:8773/\"\r\n          ],\r\n          \"Type\": \"identity\"\r\n        },\r\n        {\r\n          \"Endpoints\": [\r\n            \"http://compute.c-40.autoqa.qa1.eucalyptus-systems.com:8773/\"\r\n          ],\r\n          \"Type\": \"compute\"\r\n        }\r\n      ],\r\n      \"Name\": \"big-grams\",\r\n      \"CertificateFingerprint\": \"EB:74:48:EA:12:82:BB:4E:7D:B0:AA:04:51:F2:34:7E:D5:63:7A:E3:E8:03:A0:92:90:D7:2A:52:EE:76:5D:D8\",\r\n      \"CertificateFingerprintDigest\": \"SHA-256\"\r\n    }\r\n  ]\r\n}\r\n\r\n[root@d-02 ~]# euctl region.region_configuration=@region-config.json --region @localhost\r\n[root@d-02 ~]# euctl region.region_configuration --region @localhost --dump\r\n{\r\n  \"Regions\": [\r\n    {\r\n      \"IdentifierPartitions\": [\r\n        1\r\n      ],\r\n      \"Services\": [\r\n        {\r\n          \"Endpoints\": [\r\n            \"http://identity.d-02.autoqa.qa1.eucalyptus-systems.com:8773/\"\r\n          ],\r\n          \"Type\": \"identity\"\r\n        },\r\n        {\r\n          \"Endpoints\": [\r\n            \"http://compute.d-02.autoqa.qa1.eucalyptus-systems.com:8773/\"\r\n          ],\r\n          \"Type\": \"compute\"\r\n        }\r\n      ],\r\n      \"Name\": \"future\",\r\n      \"CertificateFingerprint\": \"B1:94:FF:9A:BC:2A:2D:95:89:E1:8B:2A:9E:6E:14:AD:20:88:D8:9A:97:44:17:4B:F8:1F:EB:98:08:0D:00:DE\",\r\n      \"CertificateFingerprintDigest\": \"SHA-256\"\r\n    },\r\n    {\r\n      \"IdentifierPartitions\": [\r\n        2\r\n      ],\r\n      \"Services\": [\r\n        {\r\n          \"Endpoints\": [\r\n            \"http://identity.c-40.autoqa.qa1.eucalyptus-systems.com:8773/\"\r\n          ],\r\n          \"Type\": \"identity\"\r\n        },\r\n        {\r\n          \"Endpoints\": [\r\n            \"http://compute.c-40.autoqa.qa1.eucalyptus-systems.com:8773/\"\r\n          ],\r\n          \"Type\": \"compute\"\r\n        }\r\n      ],\r\n      \"Name\": \"big-grams\",\r\n      \"CertificateFingerprint\": \"EB:74:48:EA:12:82:BB:4E:7D:B0:AA:04:51:F2:34:7E:D5:63:7A:E3:E8:03:A0:92:90:D7:2A:52:EE:76:5D:D8\",\r\n      \"CertificateFingerprintDigest\": \"SHA-256\"\r\n    }\r\n  ]\r\n}\r\n{code}\r\n# Set {{region.region_ssl_verify_hostnames}} to False since HTTP is being used on this setup:\r\n{code}\r\n[root@e-18 ~]# euctl region.region_ssl_verify_hostnames=false --region @localhost\r\nregion.region_ssl_verify_hostnames = false\r\n\r\n[root@d-02 ~]# euctl region.region_ssl_verify_hostnames=false --region @localhost\r\nregion.region_ssl_verify_hostnames = false\r\n{code}\r\n# Confirmed both clouds were configured correctly for federation:\r\n{code}\r\n[root@d-02 ~]# euca-describe-regions --region @future\r\nREGION\tbig-grams\thttp://compute.c-40.autoqa.qa1.eucalyptus-systems.com:8773/\r\nREGION\tfuture\thttp://compute.d-02.autoqa.qa1.eucalyptus-systems.com:8773/\r\n\r\n[root@e-18 ~]# euca-describe-regions --region @big-grams\r\nREGION\tbig-grams\thttp://compute.c-40.autoqa.qa1.eucalyptus-systems.com:8773/\r\nREGION\tfuture\thttp://compute.d-02.autoqa.qa1.eucalyptus-systems.com:8773/\r\n{code}\r\n# Created non-'eucalyptus' account\r\n{code}\r\n[root@d-02 ~]# euare-accountcreate -a development-operations --region @future\r\ndevelopment-operations\t001373439898\r\n\r\n[root@d-02 ~]# euare-accountcreate -a development-operations --region @future\r\ndevelopment-operations\t001373439898\r\n[root@d-02 ~]# euare-accountlist --region @future\r\n(eucalyptus)database\t000486636942\r\n(eucalyptus)cloudformation\t000583227594\r\n(eucalyptus)imaging\t000298465834\r\n(eucalyptus)loadbalancing\t000743233981\r\n(eucalyptus)blockstorage\t000507174146\r\ndevelopment-operations\t001373439898\r\neucalyptus\t000101784746\r\n(eucalyptus)objectstorage\t000990001069\r\n(eucalyptus)aws-exec-read\t000406676951\r\n{code}\r\n# Added access and secret keys to 'developement-operations/admin' user\r\n# Created 'user02' under 'development-operations' account:\r\n{code}\r\n# euare-usercreate -w -u user02 -d d-02.autoqa.qa1.eucalyptus-systems.com > .euca/devops-user02.ini --region devops-admin@future\r\n{code}\r\n# Created group 'restricted-actions', uploaded policy, and added 'user02' to group:\r\n{code}\r\n# euare-grouplistpolicies -g restricted-actions -v --region devops-admin@future\r\nrestricted-ec2-s3-per-region\r\n{\r\n    \"Statement\":[\r\n      {\r\n        \"Effect\": \"Allow\",\r\n        \"Action\": [ \"ec2:*\" ],\r\n        \"Resource\": \"*\",\r\n        \"Condition\": {\r\n          \"StringEquals\": {\r\n            \"ec2:Region\": \"future\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"Effect\": \"Allow\",\r\n        \"Action\": [ \"s3:*\" ],\r\n        \"Resource\": \"*\",\r\n        \"Condition\": {\r\n          \"StringEquals\": {\r\n            \"ec2:Region\": \"big-grams\"\r\n          }\r\n        }\r\n      }\r\n    ]\r\n}\r\n\r\n# euare-grouplistusers -g restricted-actions --region devops-admin@future\r\narn:aws:iam::001373439898:group/restricted-actions\r\n   users\r\n   arn:aws:iam::001373439898:user/user02\r\n{code}\r\n# Created keypair using 'development-operations/admin' user under 'future' region\r\n{code}\r\n# euca-describe-keypairs --region devops-admin@future\r\nKEYPAIR\tdevops-admin\tcb:a1:73:f0:b2:23:e7:8e:72:d7:a1:0f:26:79:d9:89:54:e1:af:d1\r\n{code}\r\n# *\\[Works\\]* List keypairs using 'development-operations/user02' user under 'future' region\r\n{code}\r\n# euca-describe-keypairs --region devops-user02@future\r\nKEYPAIR\tdevops-admin\tcb:a1:73:f0:b2:23:e7:8e:72:d7:a1:0f:26:79:d9:89:54:e1:af:d1\r\n{code}\r\n# Created keypair using 'development-operations/admin' user under 'big-grams' region:\r\n{code}\r\n# euca-describe-keypairs --region devops-admin@big-grams\r\nKEYPAIR\tdevops-admin\t18:52:4b:ea:a4:42:0f:55:0c:f7:19:e7:11:66:f1:a1:82:c1:20:19\r\n{code}\r\n# *\\[Should Return Error\\]* List keypairs using 'development-operations/user02' user under 'big-grams' region:\r\n{code}\r\n# euca-describe-keypairs --region devops-user02@big-grams\r\n#\r\n{code}\r\n# Doing the same test with S3 (OSG) produced the same results (i.e. no error message returned)","customfield_13000":null,"customfield_13200":null,"customfield_11300":null,"customfield_11500":null,"timetracking":{},"customfield_10005":null,"customfield_10401":null,"customfield_10600":null,"customfield_12900":null,"aggregatetimeestimate":null,"attachment":[],"summary":"IAM Access Policy Using 'ec2:Region' Condition Fails to Return Error Messages Against Unauthorized Regions","creator":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=hspencer","name":"hspencer","key":"hspencer","accountId":"557058:4a3a93bc-21f8-4658-9f5b-9cb484c910a7","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue"},"displayName":"Harold Spencer Jr.","active":true,"timeZone":"America/Los_Angeles"},"subtasks":[],"reporter":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=hspencer","name":"hspencer","key":"hspencer","accountId":"557058:4a3a93bc-21f8-4658-9f5b-9cb484c910a7","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue"},"displayName":"Harold Spencer Jr.","active":true,"timeZone":"America/Los_Angeles"},"aggregateprogress":{"progress":0,"total":0},"customfield_10000":null,"customfield_12100":"0|i03fin:","customfield_10001":"2015-10-06T16:45:25.213-0500","customfield_10002":null,"customfield_10200":null,"customfield_10003":null,"customfield_12500":null,"customfield_10400":null,"customfield_11600":["hspencer(hspencer)","kedwards(kedwards)","sjones(sjones)"],"customfield_10116":null,"environment":"Federated clouds","customfield_10117":null,"customfield_11800":null,"customfield_11802":null,"customfield_11805":null,"duedate":null,"customfield_11806":null,"progress":{"progress":0,"total":0},"votes":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/EUCA-11462/votes","votes":0,"hasVoted":false},"comment":{"comments":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/38616/comment/93018","id":"93018","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=sjones","name":"sjones","key":"sjones","accountId":"557058:f5dce1b0-db45-4dd6-a0e8-3cea5effb5ce","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue"},"displayName":"Steve Jones","active":true,"timeZone":"America/Los_Angeles"},"body":"The current behaviour is that if a user has no allow permissions for the action we fail with an error as per AWS. When the action is allowed we process the request and evaluate any additional constraints, such as conditions, against each resource, filtering the returned items rather than failing the request with an error (which is what we did for all requests prior to 4.0)","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=sjones","name":"sjones","key":"sjones","accountId":"557058:f5dce1b0-db45-4dd6-a0e8-3cea5effb5ce","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/037fddf6d3bf6d691a448e01136f233a?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dsjones%26avatarId%3D18300%26noRedirect%3Dtrue"},"displayName":"Steve Jones","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-10-06T16:45:25.213-0500","updated":"2015-10-06T16:45:25.213-0500"}],"maxResults":1,"total":1,"startAt":0},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_11808":null}}
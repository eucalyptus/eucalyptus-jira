{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"19792","self":"https://eucalyptus.atlassian.net/rest/api/2/issue/19792","key":"EUCA-5337","fields":{"issuetype":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://eucalyptus.atlassian.net/secure/viewavatar?size=xsmall&avatarId=14803&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":14803},"timespent":null,"customfield_13100":null,"project":{"self":"https://eucalyptus.atlassian.net/rest/api/2/project/10000","id":"10000","key":"EUCA","name":"Eucalyptus","avatarUrls":{"48x48":"https://eucalyptus.atlassian.net/secure/projectavatar?pid=10000&avatarId=10011","24x24":"https://eucalyptus.atlassian.net/secure/projectavatar?size=small&pid=10000&avatarId=10011","16x16":"https://eucalyptus.atlassian.net/secure/projectavatar?size=xsmall&pid=10000&avatarId=10011","32x32":"https://eucalyptus.atlassian.net/secure/projectavatar?size=medium&pid=10000&avatarId=10011"}},"customfield_11000":null,"customfield_11001":null,"fixVersions":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/version/10602","id":"10602","description":"Eucalyptus 3.3.0","name":"3.3.0","archived":false,"released":true,"releaseDate":"2013-06-18"}],"aggregatetimespent":null,"resolution":{"self":"https://eucalyptus.atlassian.net/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_10310":null,"customfield_10311":null,"customfield_11401":null,"customfield_11400":null,"customfield_10104":["com.atlassian.greenhopper.service.sprint.Sprint@66944735[id=17,rapidViewId=<null>,state=CLOSED,name=3.3 Sprint 7,goal=<null>,startDate=2013-04-24T18:15:38.418Z,endDate=2013-05-13T23:15:38.418Z,completeDate=2013-05-15T22:07:12.075Z,sequence=17]","com.atlassian.greenhopper.service.sprint.Sprint@e4fd76f[id=18,rapidViewId=<null>,state=CLOSED,name=3.3 Sprint 8,goal=<null>,startDate=2013-05-15T22:11:05.921Z,endDate=2013-05-31T22:11:05.921Z,completeDate=2013-06-07T17:47:14.384Z,sequence=18]"],"customfield_10500":{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/10403","value":"Not Applicable","id":"10403"},"customfield_10302":null,"customfield_10303":null,"customfield_10105":{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/10101","value":"No","id":"10101"},"customfield_10304":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/version/10602","id":"10602","description":"Eucalyptus 3.3.0","name":"3.3.0","archived":false,"released":true,"releaseDate":"2013-06-18"}],"customfield_10700":null,"customfield_10701":null,"customfield_10702":null,"customfield_10306":{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/10200","value":"High","id":"10200"},"customfield_10703":null,"customfield_10308":null,"resolutiondate":"2013-05-21T15:56:01.259-0500","customfield_10704":null,"customfield_10309":null,"customfield_10705":null,"workratio":-1,"watches":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/EUCA-5337/watchers","watchCount":4,"isWatching":false},"lastViewed":null,"created":"2013-03-08T19:56:13.932-0600","customfield_12000":null,"customfield_12400":null,"priority":{"self":"https://eucalyptus.atlassian.net/rest/api/2/priority/2","iconUrl":"https://eucalyptus.atlassian.net/images/icons/priorities/critical.svg","name":"Critical","id":"2"},"customfield_12201":null,"customfield_10300":null,"customfield_10102":null,"customfield_12600":"{repository={count=2, dataType=repository}, json={\"cachedValue\":{\"errors\":[],\"summary\":{\"repository\":{\"overall\":{\"count\":2,\"lastUpdated\":\"2013-05-02T00:25:15.000-0500\",\"dataType\":\"repository\"},\"byInstanceType\":{\"github\":{\"count\":2,\"name\":\"GitHub\"}}}}},\"isStale\":true}}","customfield_10301":null,"labels":[],"customfield_11700":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"versions":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/version/10801","id":"10801","name":"3.1.2","archived":false,"released":true,"releaseDate":"2012-10-04"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/version/10112","id":"10112","description":"Eucalyptus 3.2.0","name":"3.2.0","archived":false,"released":true,"releaseDate":"2012-12-19"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/version/11300","id":"11300","name":"3.2.1","archived":false,"released":true,"releaseDate":"2013-02-14"}],"customfield_11901":null,"issuelinks":[{"id":"17843","self":"https://eucalyptus.atlassian.net/rest/api/2/issueLink/17843","type":{"id":"10103","name":"Relates","inward":"relates to","outward":"relates to","self":"https://eucalyptus.atlassian.net/rest/api/2/issueLinkType/10103"},"inwardIssue":{"id":"21082","key":"EUCA-6024","self":"https://eucalyptus.atlassian.net/rest/api/2/issue/21082","fields":{"summary":"Regression: multiple migrations from a host are now serialized, are timing out, and sometimes are \"lost\"","status":{"self":"https://eucalyptus.atlassian.net/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://eucalyptus.atlassian.net/images/icons/statuses/generic.png","name":"Closed","id":"6","statusCategory":{"self":"https://eucalyptus.atlassian.net/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://eucalyptus.atlassian.net/rest/api/2/priority/2","iconUrl":"https://eucalyptus.atlassian.net/images/icons/priorities/critical.svg","name":"Critical","id":"2"},"issuetype":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://eucalyptus.atlassian.net/secure/viewavatar?size=xsmall&avatarId=14803&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":14803}}}},{"id":"17842","self":"https://eucalyptus.atlassian.net/rest/api/2/issueLink/17842","type":{"id":"10103","name":"Relates","inward":"relates to","outward":"relates to","self":"https://eucalyptus.atlassian.net/rest/api/2/issueLinkType/10103"},"inwardIssue":{"id":"21070","key":"EUCA-6013","self":"https://eucalyptus.atlassian.net/rest/api/2/issue/21070","fields":{"summary":"default_booting_cleanup_threshold is too short for multiple migrations.","status":{"self":"https://eucalyptus.atlassian.net/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://eucalyptus.atlassian.net/images/icons/statuses/generic.png","name":"Closed","id":"6","statusCategory":{"self":"https://eucalyptus.atlassian.net/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://eucalyptus.atlassian.net/rest/api/2/priority/3","iconUrl":"https://eucalyptus.atlassian.net/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://eucalyptus.atlassian.net/secure/viewavatar?size=xsmall&avatarId=14803&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":14803}}}}],"assignee":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=dmitrii","name":"dmitrii","key":"dmitrii","accountId":"557058:1e0ea807-434b-4b54-967f-1dec4a9ede55","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue"},"displayName":"Dmitrii Calzago","active":false,"timeZone":"America/Los_Angeles"},"updated":"2014-06-16T16:21:37.924-0500","status":{"self":"https://eucalyptus.atlassian.net/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://eucalyptus.atlassian.net/images/icons/statuses/generic.png","name":"Closed","id":"6","statusCategory":{"self":"https://eucalyptus.atlassian.net/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/component/10010","id":"10010","name":"Node Controller"}],"timeoriginalestimate":null,"customfield_13000":null,"description":"All uses of {{conn}} obtained from {{check_hypervisor_conn}} must be protected. Otherwise something like this happens:\r\n\r\n{code}\r\n2013-03-07 23:10:33 DEBUG 000031240 doRebootInstance         | [i-89ED43C1] invoked\r\n2013-03-07 23:10:33 DEBUG 000001225 rebooting_thread         | [i-89ED43C1] spawning rebooting thread\r\n2013-03-07 23:10:33 DEBUG 000001225 rebooting_thread         | [i-89ED43C1] destroying domain\r\n2013-03-07 23:10:33  WARN 000031346 libvirt_err_handler      | libvirt: Domain not found: no domain with matching name 'i-89ED43C1' (code=42)\r\n2013-03-07 23:10:33  WARN 000031346 refresh_instance_info    | [i-89ED43C1] hypervisor failed to find domain, will retry 4 more times\r\n2013-03-07 23:10:33  INFO 000001225 rebooting_thread         | [i-89ED43C1] rebooting\r\n2013-03-07 23:10:33 ERROR 000001225 libvirt_err_handler      | libvirt: invalid connection pointer in virDomainCreateXML (code=6)\r\n{code}","customfield_13200":null,"customfield_11300":"EUCA-5210","customfield_11500":null,"timetracking":{},"customfield_10401":null,"customfield_10005":null,"customfield_10600":null,"customfield_12900":null,"attachment":[],"aggregatetimeestimate":null,"summary":"NC: race for hypervisor connection leads to non-deterministic failures","creator":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=dmitrii","name":"dmitrii","key":"dmitrii","accountId":"557058:1e0ea807-434b-4b54-967f-1dec4a9ede55","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue"},"displayName":"Dmitrii Calzago","active":false,"timeZone":"America/Los_Angeles"},"subtasks":[],"reporter":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=dmitrii","name":"dmitrii","key":"dmitrii","accountId":"557058:1e0ea807-434b-4b54-967f-1dec4a9ede55","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue"},"displayName":"Dmitrii Calzago","active":false,"timeZone":"America/Los_Angeles"},"aggregateprogress":{"progress":0,"total":0},"customfield_12100":"0|i021of:","customfield_10000":"3_*:*_1_*:*_58138410_*|*_10001_*:*_1_*:*_4592557821_*|*_10002_*:*_1_*:*_30018116_*|*_10000_*:*_1_*:*_193820_*|*_10006_*:*_1_*:*_0_*|*_10003_*:*_1_*:*_1694679181","customfield_10001":"2013-05-02T22:56:06.073-0500","customfield_10002":null,"customfield_10200":null,"customfield_10003":null,"customfield_12500":null,"customfield_10400":null,"customfield_10116":null,"customfield_11600":["dmitrii(dmitrii)","juphoff(juphoff)","pweiss(pweiss)","tjcramer(tjcramer)"],"environment":null,"customfield_10117":null,"customfield_11800":null,"customfield_11802":null,"customfield_11805":null,"duedate":null,"customfield_11806":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/19792/comment/41360","id":"41360","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=dmitrii","name":"dmitrii","key":"dmitrii","accountId":"557058:1e0ea807-434b-4b54-967f-1dec4a9ede55","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue"},"displayName":"Dmitrii Calzago","active":false,"timeZone":"America/Los_Angeles"},"body":"All uses of {{conn}} obtained from {{check_hypervisor_conn}} must be protected. Otherwise the following condition may occur (in this case reboot fails, due to {{reboot_thread}} losing the race with {{monitoring_thread}}, but other detrimental interleavings are possible).\n\n{code}\n2013-03-07 23:10:33 DEBUG 000031240 doRebootInstance         | [i-89ED43C1] invoked\n2013-03-07 23:10:33 DEBUG 000001225 rebooting_thread         | [i-89ED43C1] spawning rebooting thread\n2013-03-07 23:10:33 DEBUG 000001225 rebooting_thread         | [i-89ED43C1] destroying domain\n2013-03-07 23:10:33  WARN 000031346 libvirt_err_handler      | libvirt: Domain not found: no domain with matching name 'i-89ED43C1' (code=42)\n2013-03-07 23:10:33  WARN 000031346 refresh_instance_info    | [i-89ED43C1] hypervisor failed to find domain, will retry 4 more times\n2013-03-07 23:10:33  INFO 000001225 rebooting_thread         | [i-89ED43C1] rebooting\n2013-03-07 23:10:33 ERROR 000001225 libvirt_err_handler      | libvirt: invalid connection pointer in virDomainCreateXML (code=6)\n{code}","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=dmitrii","name":"dmitrii","key":"dmitrii","accountId":"557058:1e0ea807-434b-4b54-967f-1dec4a9ede55","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue"},"displayName":"Dmitrii Calzago","active":false,"timeZone":"America/Los_Angeles"},"created":"2013-03-08T20:13:28.113-0600","updated":"2013-03-08T20:13:28.113-0600"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/19792/comment/44646","id":"44646","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=dmitrii","name":"dmitrii","key":"dmitrii","accountId":"557058:1e0ea807-434b-4b54-967f-1dec4a9ede55","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue"},"displayName":"Dmitrii Calzago","active":false,"timeZone":"America/Los_Angeles"},"body":"*QA:* Very difficult to reproduce the races themselves. We've seen maybe one or two of these in the past. The main concern with this commit is regression potential (new deadlocks due to incorrect use of lock/unlock). I believe our churn tests will exercise all the happy paths (instance start/stop, with and without volumes). I've tested some of the negative paths manually. We could sit down and outline a more thorough approach to negative testing on the NC (something we haven't done in the past, to my knowledge).","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=dmitrii","name":"dmitrii","key":"dmitrii","accountId":"557058:1e0ea807-434b-4b54-967f-1dec4a9ede55","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue"},"displayName":"Dmitrii Calzago","active":false,"timeZone":"America/Los_Angeles"},"created":"2013-05-02T01:11:22.096-0500","updated":"2013-05-02T01:11:22.096-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/19792/comment/44732","id":"44732","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=juphoff","name":"juphoff","key":"juphoff","accountId":"557058:c2c52741-c1d7-497e-87c9-57845be682d0","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/11a22041bb5fb0250638e57dc0ddf8c5?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Djuphoff%26avatarId%3D10503%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/11a22041bb5fb0250638e57dc0ddf8c5?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Djuphoff%26avatarId%3D10503%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/11a22041bb5fb0250638e57dc0ddf8c5?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Djuphoff%26avatarId%3D10503%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/11a22041bb5fb0250638e57dc0ddf8c5?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Djuphoff%26avatarId%3D10503%26noRedirect%3Dtrue"},"displayName":"Jeff Uphoff","active":false,"timeZone":"America/New_York"},"body":"It appears this commit has introduced a regression in instance migration. I'm now seeing migration failures I don't recall having seen before, and sometimes the migration failure causes the instance itself to be lost.","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=juphoff","name":"juphoff","key":"juphoff","accountId":"557058:c2c52741-c1d7-497e-87c9-57845be682d0","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/11a22041bb5fb0250638e57dc0ddf8c5?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Djuphoff%26avatarId%3D10503%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/11a22041bb5fb0250638e57dc0ddf8c5?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Djuphoff%26avatarId%3D10503%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/11a22041bb5fb0250638e57dc0ddf8c5?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Djuphoff%26avatarId%3D10503%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/11a22041bb5fb0250638e57dc0ddf8c5?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Djuphoff%26avatarId%3D10503%26noRedirect%3Dtrue"},"displayName":"Jeff Uphoff","active":false,"timeZone":"America/New_York"},"created":"2013-05-02T22:56:06.073-0500","updated":"2013-05-02T22:56:06.073-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/19792/comment/44733","id":"44733","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=juphoff","name":"juphoff","key":"juphoff","accountId":"557058:c2c52741-c1d7-497e-87c9-57845be682d0","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/11a22041bb5fb0250638e57dc0ddf8c5?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Djuphoff%26avatarId%3D10503%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/11a22041bb5fb0250638e57dc0ddf8c5?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Djuphoff%26avatarId%3D10503%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/11a22041bb5fb0250638e57dc0ddf8c5?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Djuphoff%26avatarId%3D10503%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/11a22041bb5fb0250638e57dc0ddf8c5?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Djuphoff%26avatarId%3D10503%26noRedirect%3Dtrue"},"displayName":"Jeff Uphoff","active":false,"timeZone":"America/New_York"},"body":"More on the above comment.\n\nOn the source NC, I'm seeing:\n\n{quote}\n2013-05-02 20:34:21  INFO 000004694 doMigrateInstances       | [i-83644135] migration source initiating 10.111.5.10 > 10.111.5.20 [creds=present]\n2013-05-02 20:34:21 DEBUG 000006165 migrating_thread         | [i-83644135] connecting to remote hypervisor at 'qemu+tls://10.111.5.20/system'\n2013-05-02 20:34:21  INFO 000006165 migrating_thread         | [i-83644135] migrating instance\n2013-05-02 20:34:29 ERROR 000006165 libvirt_err_handler      | libvirt: Unable to read from monitor: Connection reset by peer (code=38)\n2013-05-02 20:34:29 ERROR 000006165 migrating_thread         | [i-83644135] cannot migrate instance i-83644135, giving up and rolling back.\n2013-05-02 20:34:29  WARN 000004702 libvirt_err_handler      | libvirt: Domain not found: no domain with matching name 'i-83644135' (code=42)\n2013-05-02 20:34:29  INFO 000004702 refresh_instance_info    | [i-83644135] migration completed, cleaning up\n2013-05-02 20:34:29 DEBUG 000004702 change_state             | [i-83644135] state change for instance: Running -> Shutoff (Extant)\n2013-05-02 20:34:29  INFO 000004702 monitoring_thread        | [i-83644135] cleaning up state for instance\n2013-05-02 20:34:31 DEBUG 000004702 change_state             | [i-83644135] state change for instance: Shutoff -> Teardown (Teardown)\n2013-05-02 20:34:31  INFO 000006165 migration_rollback       | [i-83644135] starting migration rollback of instance on source 10.111.5.10\n2013-05-02 20:34:31 DEBUG 000006165 save_instance_struct     | [i-83644135] save_instance_struct: failed to create instance checkpoint at /disk1/storage/eucalyptus/instances/work/MJWDIQ0XCXYZA1JX1EGI9/i-83644135/instance.checkpoint\n2013-05-02 20:34:31  INFO 000006165 migration_rollback       | [i-83644135] migration source rolled back\n2013-05-02 20:34:31 DEBUG 000006165 migrating_thread         | done\n...\n2013-05-02 20:34:38 DEBUG 000004694 doDescribeInstances      | [i-83644135] Teardown (not migrating) pub=10.111.102.11 vols=\n{quote}\n\nMeanwhile, on the destination NC, it's permanently stuck in an incoming-migration state. It saw the connection from the source, and it started to receive it.\n\n{quote}\n2013-05-02 20:34:24  INFO 000000585 refresh_instance_info    | [i-83644135] incoming (10.111.5.20 < 10.111.5.10) migration in progress (1 of 1)\n2013-05-02 20:34:24 DEBUG 000000585 refresh_instance_info    | [i-83644135] incoming (10.111.5.20 < 10.111.5.10) migration_state set to 'migrating'\n2013-05-02 20:34:24 DEBUG 000000585 change_state             | [i-83644135] state change for instance: Booting -> Paused (Extant)\n...\n2013-05-02 20:34:30 DEBUG 000000577 doDescribeInstances      | [i-83644135] Extant (migrating <10.111.5.10) pub=10.111.102.11 vols=\n{quote}\n\nSince this migration never completes, this instance gets \"lost.\"","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=juphoff","name":"juphoff","key":"juphoff","accountId":"557058:c2c52741-c1d7-497e-87c9-57845be682d0","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/11a22041bb5fb0250638e57dc0ddf8c5?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Djuphoff%26avatarId%3D10503%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/11a22041bb5fb0250638e57dc0ddf8c5?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Djuphoff%26avatarId%3D10503%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/11a22041bb5fb0250638e57dc0ddf8c5?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Djuphoff%26avatarId%3D10503%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/11a22041bb5fb0250638e57dc0ddf8c5?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Djuphoff%26avatarId%3D10503%26noRedirect%3Dtrue"},"displayName":"Jeff Uphoff","active":false,"timeZone":"America/New_York"},"created":"2013-05-02T23:05:07.063-0500","updated":"2013-05-02T23:05:07.063-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/19792/comment/46221","id":"46221","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=pweiss","name":"pweiss","key":"pweiss","accountId":"557058:03f33f29-aebd-44f0-87aa-425c748d152f","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/64e13e86643316795d88f1aaa9e31e90?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FavatarId%3D10122%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/64e13e86643316795d88f1aaa9e31e90?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26avatarId%3D10122%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/64e13e86643316795d88f1aaa9e31e90?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26avatarId%3D10122%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/64e13e86643316795d88f1aaa9e31e90?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26avatarId%3D10122%26noRedirect%3Dtrue"},"displayName":"Paul Weiss","active":true,"timeZone":"America/Chicago"},"body":"Approved fix for release","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=pweiss","name":"pweiss","key":"pweiss","accountId":"557058:03f33f29-aebd-44f0-87aa-425c748d152f","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/64e13e86643316795d88f1aaa9e31e90?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FavatarId%3D10122%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/64e13e86643316795d88f1aaa9e31e90?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26avatarId%3D10122%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/64e13e86643316795d88f1aaa9e31e90?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26avatarId%3D10122%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/64e13e86643316795d88f1aaa9e31e90?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26avatarId%3D10122%26noRedirect%3Dtrue"},"displayName":"Paul Weiss","active":true,"timeZone":"America/Chicago"},"created":"2013-05-21T15:56:01.271-0500","updated":"2013-05-21T15:56:01.271-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/19792/comment/48803","id":"48803","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=tjcramer","name":"tjcramer","key":"tjcramer","accountId":"557058:e076cf45-80ca-4b67-befb-7b0c21f32739","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/65e7a5c18fc469f1978f6367993c3bf0?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dtjcramer%26avatarId%3D10401%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/65e7a5c18fc469f1978f6367993c3bf0?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dtjcramer%26avatarId%3D10401%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/65e7a5c18fc469f1978f6367993c3bf0?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dtjcramer%26avatarId%3D10401%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/65e7a5c18fc469f1978f6367993c3bf0?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dtjcramer%26avatarId%3D10401%26noRedirect%3Dtrue"},"displayName":"Tim Cramer","active":true,"timeZone":"America/Los_Angeles"},"body":"Resolved in the 3.3.0 release","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=tjcramer","name":"tjcramer","key":"tjcramer","accountId":"557058:e076cf45-80ca-4b67-befb-7b0c21f32739","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/65e7a5c18fc469f1978f6367993c3bf0?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dtjcramer%26avatarId%3D10401%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/65e7a5c18fc469f1978f6367993c3bf0?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dtjcramer%26avatarId%3D10401%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/65e7a5c18fc469f1978f6367993c3bf0?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dtjcramer%26avatarId%3D10401%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/65e7a5c18fc469f1978f6367993c3bf0?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dtjcramer%26avatarId%3D10401%26noRedirect%3Dtrue"},"displayName":"Tim Cramer","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-06-26T21:46:00.866-0500","updated":"2013-06-26T21:46:00.866-0500"}],"maxResults":6,"total":6,"startAt":0},"votes":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/EUCA-5337/votes","votes":0,"hasVoted":false},"customfield_11808":null,"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]}}}
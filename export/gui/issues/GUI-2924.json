{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"59707","self":"https://eucalyptus.atlassian.net/rest/api/2/issue/59707","key":"GUI-2924","fields":{"issuetype":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issuetype/4","id":"4","description":"An improvement or enhancement to an existing feature or task.","iconUrl":"https://eucalyptus.atlassian.net/secure/viewavatar?size=xsmall&avatarId=14810&avatarType=issuetype","name":"Improvement","subtask":false,"avatarId":14810},"timespent":null,"customfield_13100":null,"project":{"self":"https://eucalyptus.atlassian.net/rest/api/2/project/11301","id":"11301","key":"GUI","name":"Management Console","avatarUrls":{"48x48":"https://eucalyptus.atlassian.net/secure/projectavatar?pid=11301&avatarId=10011","24x24":"https://eucalyptus.atlassian.net/secure/projectavatar?size=small&pid=11301&avatarId=10011","16x16":"https://eucalyptus.atlassian.net/secure/projectavatar?size=xsmall&pid=11301&avatarId=10011","32x32":"https://eucalyptus.atlassian.net/secure/projectavatar?size=medium&pid=11301&avatarId=10011"}},"customfield_11000":null,"fixVersions":[],"customfield_11001":null,"aggregatetimespent":null,"resolution":null,"customfield_10310":null,"customfield_11401":null,"customfield_11400":null,"customfield_10104":[],"customfield_10105":null,"customfield_10303":null,"customfield_10304":null,"customfield_10700":null,"customfield_10701":null,"customfield_10702":null,"customfield_10306":null,"customfield_10703":null,"customfield_10704":null,"resolutiondate":null,"customfield_10705":null,"customfield_10309":null,"workratio":-1,"lastViewed":null,"watches":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/GUI-2924/watchers","watchCount":1,"isWatching":false},"created":"2017-06-12T09:04:08.188-0500","customfield_12000":null,"priority":{"self":"https://eucalyptus.atlassian.net/rest/api/2/priority/3","iconUrl":"https://eucalyptus.atlassian.net/images/icons/priorities/major.svg","name":"Major","id":"3"},"customfield_12400":null,"customfield_12201":null,"customfield_12600":"{}","customfield_10102":null,"labels":[],"aggregatetimeoriginalestimate":null,"timeestimate":null,"customfield_11901":null,"versions":[],"issuelinks":[],"assignee":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=kedwards","name":"kedwards","key":"kedwards","accountId":"557058:f9c2f8da-1fc6-4aa7-8fb0-750e7e422b6b","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/d1746a6d05a30ca027012a7da4545962?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dkedwards%26avatarId%3D10200%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/d1746a6d05a30ca027012a7da4545962?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dkedwards%26avatarId%3D10200%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/d1746a6d05a30ca027012a7da4545962?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dkedwards%26avatarId%3D10200%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/d1746a6d05a30ca027012a7da4545962?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dkedwards%26avatarId%3D10200%26noRedirect%3Dtrue"},"displayName":"Ken Edwards","active":true,"timeZone":"America/Los_Angeles"},"updated":"2017-06-22T10:55:56.804-0500","status":{"self":"https://eucalyptus.atlassian.net/rest/api/2/status/10001","description":"This issue has been validated/reproduced, but has not been prioritized yet.","iconUrl":"https://eucalyptus.atlassian.net/images/icons/statuses/generic.png","name":"Confirmed","id":"10001","statusCategory":{"self":"https://eucalyptus.atlassian.net/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"components":[],"timeoriginalestimate":null,"description":"As per customer request:\r\n\r\nThere are two problems with Eucalyptus\r\n            \r\na) boto library is not able to handle \"no_proxy\" properly.\r\nsolution is below\r\nModify/Create /etc/boto.cfg and add next setting: \r\n---------------------------------------------------------------------------------------- \r\ndebug = 2 \r\nnum_retries = 2 \r\n\r\nis_secure = True \r\nhttps_validate_certificates = False \r\nproxy = PROXY_FQDN\r\nproxy_port = PROXY_PORT\r\nproxy_user = USERNAME \r\nproxy_pass = PASSWORD \r\nno_proxy = localhost,IP_ADDRESS_1, IP_ADDRESS_2,NAME_1,NAME2\r\n---------------------------------------------------------------------------------------- \r\n\r\nModify file /usr/lib/python2.7/site-packages/boto/connection.py : \r\n\r\nSearch for: \r\n self.no_proxy = os.environ.get('no_proxy', '') or os.environ.get('NO_PROXY', '') \r\n\r\nAdd below: \r\nif not self.no_proxy: \r\n        self.no_proxy = config.get_value('Boto', 'no_proxy', None)\r\n\r\n--------------\r\n2) problem with Eucalyptus console, it is not able to work AWS over proxy (just not capable).\r\n                Details (solution) from Jira is below (probably some adjustments for euca 4.4.1 is needed as that patches are from 4.3.1):  \r\n1) edit /etc/eucaconsole/console.ini, add next line to [app:main] section : \r\nhttps_proxy=https://USERNAME:PASSWORD@PROXYFQDN:PORT/ \r\n\r\n\r\n2) edit /usr/lib/python2.7/site-packages/eucaconsole/views/login.py \r\nPatch file: \r\n--- login.py 2017-02-22 15:40:32.938912840 +0000 \r\n+++ patched/login.py 2017-02-22 15:13:13.853216340 +0000 \r\n@@ -221,9 +221,17 @@ \r\n             logging.info(conn) \r\n             conn = None \r\n             ca_certs_file = self.request.registry.settings.get('connection.ssl.certfile', ca_certs_file) \r\n+ https_proxy= self.request.registry.settings.get('https_proxy', None) \r\n+ \r\n             auth = AWSAuthenticator(package=package, validate_certs=validate_certs, ca_certs=ca_certs_file) \r\n             try: \r\n- creds = auth.authenticate(timeout=10) \r\n+ if https_proxy is not None: \r\n+ proxy = { \r\n+ 'https': https_proxy \r\n+ } \r\n+ creds = auth.authenticate_proxy(timeout=10,proxy=proxy) \r\n+ else: \r\n+ creds = auth.authenticate(timeout=10) \r\n                 logging.info(u\"Authenticated AWS user from {ip}\".format(ip=BaseView.get_remote_addr(self.request))) \r\n                 default_region = self.request.registry.settings.get('aws.default.region', 'us-east-1') \r\n                 session.invalidate() # Refresh session \r\n \r\n\r\n\r\n3) edit /usr/lib/python2.7/site-packages/eucaconsole/models/auth.py \r\nPatch file: \r\n--- auth.py 2017-02-19 12:39:14.000000000 +0000 \r\n+++ patched/auth.py 2017-02-22 15:08:12.301298572 +0000 \r\n@@ -34,6 +34,7 @@ \r\n import socket \r\n import ssl \r\n import urllib2 \r\n+import requests \r\n from urlparse import urlparse \r\n\r\n from defusedxml.sax import parseString \r\n@@ -470,3 +471,24 @@ \r\n                 raise urllib2.URLError(err[1]) \r\n         except socket.error as err: \r\n             raise urllib2.URLError(err.message) \r\n+ def authenticate_proxy(self, timeout, proxy): \r\n+ \"\"\" Make authentication request to AWS STS service via proxy \r\n+ Timeout defaults to 20 seconds\"\"\" \r\n+ headers = {\"Content-type\": \"application/x-www-form-urlencoded\"} \r\n+ try: \r\n+ connection = requests.post('https://sts.amazonaws.com&#39;, data=self.package, verify=False, headers=headers, proxies=proxy, timeout=timeout) \r\n+ if connection.status_code != 200: \r\n+ raise urllib2.HTTPError(url='', code=connection.status_code, msg=connection.reason, hdrs=None, fp=None) \r\n+ body = connection.content \r\n+ # parse AccessKeyId, SecretAccessKey and SessionToken \r\n+ creds = Credentials() \r\n+ h = BotoXmlHandler(creds, None) \r\n+ parseString(body, h) \r\n+ return creds \r\n+ except SSLError as err: \r\n+ if err.message != '': \r\n+ raise urllib2.URLError(err.message) \r\n+ else: \r\n+ raise urllib2.URLError(err[1]) \r\n+ except socket.error as err: \r\n+ raise urllib2.URLError(err.message)\r\n","customfield_13000":null,"customfield_13200":null,"customfield_11300":null,"customfield_11500":null,"timetracking":{},"customfield_10401":null,"customfield_10005":null,"customfield_10600":null,"customfield_12900":null,"aggregatetimeestimate":null,"attachment":[],"summary":"Support for http/https proxy","creator":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=dmccue","name":"dmccue","key":"dmccue","accountId":"557058:ed3db3e7-1778-45e1-a9ca-da74c4afc860","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/c6d14a696c9a8cbab9b66ec225f8bc8e?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FavatarId%3D10122%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/c6d14a696c9a8cbab9b66ec225f8bc8e?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26avatarId%3D10122%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/c6d14a696c9a8cbab9b66ec225f8bc8e?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26avatarId%3D10122%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/c6d14a696c9a8cbab9b66ec225f8bc8e?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26avatarId%3D10122%26noRedirect%3Dtrue"},"displayName":"David McCue","active":true,"timeZone":"Europe/London"},"subtasks":[],"reporter":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=dmccue","name":"dmccue","key":"dmccue","accountId":"557058:ed3db3e7-1778-45e1-a9ca-da74c4afc860","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/c6d14a696c9a8cbab9b66ec225f8bc8e?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FavatarId%3D10122%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/c6d14a696c9a8cbab9b66ec225f8bc8e?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26avatarId%3D10122%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/c6d14a696c9a8cbab9b66ec225f8bc8e?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26avatarId%3D10122%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/c6d14a696c9a8cbab9b66ec225f8bc8e?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26avatarId%3D10122%26noRedirect%3Dtrue"},"displayName":"David McCue","active":true,"timeZone":"Europe/London"},"customfield_12100":"0|i044uf:","customfield_10000":null,"aggregateprogress":{"progress":0,"total":0},"customfield_10001":null,"customfield_10200":null,"customfield_10002":null,"customfield_10003":null,"customfield_12500":null,"customfield_10400":null,"customfield_10116":null,"customfield_11600":["dmccue(dmccue)","kedwards(kedwards)"],"environment":"Eucalyptus 4.4.1 w/ eucaconsole","customfield_10117":null,"customfield_11800":null,"customfield_11802":null,"duedate":null,"customfield_11805":null,"customfield_11806":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/59707/comment/123303","id":"123303","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=dmccue","name":"dmccue","key":"dmccue","accountId":"557058:ed3db3e7-1778-45e1-a9ca-da74c4afc860","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/c6d14a696c9a8cbab9b66ec225f8bc8e?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FavatarId%3D10122%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/c6d14a696c9a8cbab9b66ec225f8bc8e?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26avatarId%3D10122%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/c6d14a696c9a8cbab9b66ec225f8bc8e?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26avatarId%3D10122%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/c6d14a696c9a8cbab9b66ec225f8bc8e?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26avatarId%3D10122%26noRedirect%3Dtrue"},"displayName":"David McCue","active":true,"timeZone":"Europe/London"},"body":"Suggested to customer to raise a pull request with patch details to github.com/eucalyptus/eucaconsole","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=dmccue","name":"dmccue","key":"dmccue","accountId":"557058:ed3db3e7-1778-45e1-a9ca-da74c4afc860","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/c6d14a696c9a8cbab9b66ec225f8bc8e?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FavatarId%3D10122%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/c6d14a696c9a8cbab9b66ec225f8bc8e?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26avatarId%3D10122%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/c6d14a696c9a8cbab9b66ec225f8bc8e?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26avatarId%3D10122%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/c6d14a696c9a8cbab9b66ec225f8bc8e?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26avatarId%3D10122%26noRedirect%3Dtrue"},"displayName":"David McCue","active":true,"timeZone":"Europe/London"},"created":"2017-06-12T09:07:16.054-0500","updated":"2017-06-12T09:07:16.054-0500"}],"maxResults":1,"total":1,"startAt":0},"votes":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/GUI-2924/votes","votes":0,"hasVoted":false},"customfield_11808":null,"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]}}}
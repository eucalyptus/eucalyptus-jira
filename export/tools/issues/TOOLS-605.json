{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"39241","self":"https://eucalyptus.atlassian.net/rest/api/2/issue/39241","key":"TOOLS-605","fields":{"issuetype":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://eucalyptus.atlassian.net/secure/viewavatar?size=xsmall&avatarId=14803&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":14803},"timespent":null,"customfield_13100":null,"project":{"self":"https://eucalyptus.atlassian.net/rest/api/2/project/10001","id":"10001","key":"TOOLS","name":"Euca2ools","avatarUrls":{"48x48":"https://eucalyptus.atlassian.net/secure/projectavatar?pid=10001&avatarId=10011","24x24":"https://eucalyptus.atlassian.net/secure/projectavatar?size=small&pid=10001&avatarId=10011","16x16":"https://eucalyptus.atlassian.net/secure/projectavatar?size=xsmall&pid=10001&avatarId=10011","32x32":"https://eucalyptus.atlassian.net/secure/projectavatar?size=medium&pid=10001&avatarId=10011"}},"customfield_11000":null,"fixVersions":[],"customfield_11001":null,"aggregatetimespent":null,"customfield_10310":null,"resolution":{"self":"https://eucalyptus.atlassian.net/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_11401":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=tony","name":"tony","key":"tony","accountId":"557058:353956db-b78c-4f3b-9096-f8f58e6709c8","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/14ec1b18e630cc0743492fc327a12df7?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dtony%26avatarId%3D16600%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/14ec1b18e630cc0743492fc327a12df7?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dtony%26avatarId%3D16600%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/14ec1b18e630cc0743492fc327a12df7?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dtony%26avatarId%3D16600%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/14ec1b18e630cc0743492fc327a12df7?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dtony%26avatarId%3D16600%26noRedirect%3Dtrue"},"displayName":"Tony Beckham","active":true,"timeZone":"America/Tijuana"},"customfield_11400":null,"customfield_10500":{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/10401","value":"Standard","id":"10401"},"customfield_10302":null,"customfield_10104":[],"customfield_10105":{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/10100","value":"Yes","id":"10100"},"customfield_10303":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=gholms","name":"gholms","key":"gholms","accountId":"557058:6e5fdc25-c797-4d3d-8fd4-55c3c4ed99b0","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/3e16def22dd4a96dbe507df70f15f37f?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dgholms%26avatarId%3D18100%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/3e16def22dd4a96dbe507df70f15f37f?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dgholms%26avatarId%3D18100%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/3e16def22dd4a96dbe507df70f15f37f?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dgholms%26avatarId%3D18100%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/3e16def22dd4a96dbe507df70f15f37f?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dgholms%26avatarId%3D18100%26noRedirect%3Dtrue"},"displayName":"Garrett Holmstrom","active":true,"timeZone":"America/Los_Angeles"},"customfield_10304":null,"customfield_10700":null,"customfield_10701":null,"customfield_10702":null,"customfield_10306":null,"customfield_10703":null,"resolutiondate":"2016-12-08T18:20:42.625-0600","customfield_10308":null,"customfield_10704":null,"customfield_10309":null,"customfield_10705":null,"workratio":-1,"watches":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/TOOLS-605/watchers","watchCount":5,"isWatching":false},"lastViewed":null,"created":"2015-11-15T23:53:05.437-0600","customfield_12000":null,"customfield_12400":null,"priority":{"self":"https://eucalyptus.atlassian.net/rest/api/2/priority/3","iconUrl":"https://eucalyptus.atlassian.net/images/icons/priorities/major.svg","name":"Major","id":"3"},"customfield_12201":null,"customfield_10300":null,"customfield_12600":"{}","customfield_10102":null,"customfield_10301":null,"labels":["regression"],"customfield_11700":null,"aggregatetimeoriginalestimate":null,"timeestimate":null,"customfield_11901":null,"versions":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/version/16203","id":"16203","description":"3.3.0","name":"3.3.0","archived":false,"released":true,"releaseDate":"2015-10-22"}],"issuelinks":[{"id":"35123","self":"https://eucalyptus.atlassian.net/rest/api/2/issueLink/35123","type":{"id":"10600","name":"Bonfire Testing","inward":"discovered while testing","outward":"testing discovered","self":"https://eucalyptus.atlassian.net/rest/api/2/issueLinkType/10600"},"outwardIssue":{"id":"40822","key":"EUCA-12010","self":"https://eucalyptus.atlassian.net/rest/api/2/issue/40822","fields":{"summary":"Sigv4 validation errors should have code SignatureDoesNotMatch and server-calculated values for signature inputs","status":{"self":"https://eucalyptus.atlassian.net/rest/api/2/status/10001","description":"This issue has been validated/reproduced, but has not been prioritized yet.","iconUrl":"https://eucalyptus.atlassian.net/images/icons/statuses/generic.png","name":"Confirmed","id":"10001","statusCategory":{"self":"https://eucalyptus.atlassian.net/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"priority":{"self":"https://eucalyptus.atlassian.net/rest/api/2/priority/3","iconUrl":"https://eucalyptus.atlassian.net/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://eucalyptus.atlassian.net/secure/viewavatar?size=xsmall&avatarId=14803&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":14803}}}}],"assignee":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=tony","name":"tony","key":"tony","accountId":"557058:353956db-b78c-4f3b-9096-f8f58e6709c8","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/14ec1b18e630cc0743492fc327a12df7?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dtony%26avatarId%3D16600%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/14ec1b18e630cc0743492fc327a12df7?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dtony%26avatarId%3D16600%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/14ec1b18e630cc0743492fc327a12df7?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dtony%26avatarId%3D16600%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/14ec1b18e630cc0743492fc327a12df7?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dtony%26avatarId%3D16600%26noRedirect%3Dtrue"},"displayName":"Tony Beckham","active":true,"timeZone":"America/Tijuana"},"updated":"2016-12-15T15:46:57.909-0600","status":{"self":"https://eucalyptus.atlassian.net/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://eucalyptus.atlassian.net/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://eucalyptus.atlassian.net/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[],"timeoriginalestimate":null,"customfield_13000":null,"description":"Prior to 4.2, I created an Nginx proxy configuration to terminate SSL which worked with both the Management Console and UFS when running on the same host. This worked great with 4.2.1, and allowed me to configure both Euca2ools and AWSCLI to work against the resulting HTTPS endpoints.\r\n\r\nJust prior to the 4.2 release, due to changes in Python dependencies which caused SSL certificates to be validated, I started to get warnings indicating the SSL certificate was not being validated. In conversations with Garrett about this, he thought if I turned on certificate validation with the appropriate line in the [region] definition, that would fix it and it did.\r\n\r\nOnce 4.2 came out, I found that now Nginx is a dependency of Eucaconsole, and the Eucaconsole init script starts Nginx in a bundled configuration. This bundled version can be disabled by an /etc/sysconfig/eucaconsole setting.\r\n\r\nBecause I typically install UFS and Console on the same host in demo and POC environments, if I want to use HTTPS endpoints in both, I must replace the default bundled Nginx configuration with a more flexible reverse proxy configuration which handles both. While there is a method of adding SSL directly to the UFS via modifications the Java KeyStore, this can't work as it results in a conflict between eucalyptus-cloud running as a Java application and Nginx - they can't both bind to the standard HTTPS port (443).\r\n\r\nBy using a more recent version of Nginx than what's in EPEL (needed for HTTP 1.1 pipelining support), combined with an upstream configuration to point to separate UFS and console applications, combined with two (or more, if UFS were running on separate or multiple hosts) virtual host (i.e. \"server\" in nginx) configurations, I can run both together, on the same single host IP address, without any problems discovered prior to 4.2. I'd argue this is a very common reverse proxy scenario with Java applications, and could be needed if a separate DMZ between a Euca cloud and the Internet is needed. I also think it's more efficient to handle SSL processing as native C code in Nginx as compared to Java byte-code efficiency, which is why in my experience it's more common to terminate SSL on a reverse proxy in front of the Java app.\r\n\r\nSo, now, with an identical configuration to what worked with 4.2.1, this no longer works with Euca2ools 3.3. Once I convert the [region] specification to use https endpoints, such as:\r\n\r\n    ec2-url = https://compute.hp-gol01-d6.mjc.prc.eucalyptus-systems.com/services/compute/\r\n\r\nI get this error when running commands:\r\n\r\n    # euca-describe-availability-zones verbose --region $USER_REGION\r\n    euca-describe-availability-zones: error (403 Forbidden): Signature validation failed\r\n\r\nHowever, on the same host (CLC only, UFS on separate host for this cloud), with AWSCLI configured, I can run equivalent AWS CLI commands via the same HTTPS endpoints without a problem, same as before:\r\n\r\n    # aws ec2 describe-availability-zones\r\n    AVAILABILITYZONES               available       hp-gol01-d6a\r\n\r\nAdditionally, if I configure the region with HTTPS endpoints on a separate management workstation running Euca2ools 3.2, it also works against the HTTPS endpoints without a problem, same as before:\r\n\r\n    $ euca-describe-availability-zones \r\n    AVAILABILITYZONE        hp-gol01-d6a    available\r\n\r\nBoth of these success cases with 4.2, and prior success with 4.1, leads me to believe there's nothing wrong with my Nginx SSL reverse proxy configuration, but something changed with Euca2ools 3.3 which is causing this problem.\r\n\r\nI'm hoping this is a quick fix as most of my demos are designed around the interoperability and ease of switching between euca2ools and AWSCLI. I can fall back to http endpoints within the Euca2ools [region] where Euca2ools 3.3 is installed, but that diminishes the story I want to show about how compatible Eucalyptus is with the existing AWS infrastructure. I can keep the more comprehensive Nginx proxy config in place, and run AWS CLI via HTTPS while running Euca2ools against the HTTP URLs until this is fixed.\r\n\r\nThis problem exists currently on my hp-gol01-d6 region, CLC on odc-d-13, UFS+MC on odc-d-14, built via this manual procedure: [https://github.com/eucalyptus/euca-demo/blob/feature/4.2/installs/install-20-manual/docs/install-20-manual-install-hp-gol01-d6.md]. See a section where I adjust the existing embedded Nginx proxy configuration to use custom SSL certs: [https://github.com/eucalyptus/euca-demo/blob/feature/4.2/installs/install-20-manual/docs/install-20-manual-install-hp-gol01-d6.md#configure-management-console-and-embedded-nginx-to-use-custom-ssl-certificates], followed by the section where I replace the embedded Nginx proxy with my own configuration: [https://github.com/eucalyptus/euca-demo/blob/feature/4.2/installs/install-20-manual/docs/install-20-manual-install-hp-gol01-d6.md#replace-management-console-embedded-nginx-with-alternative-which-also-supports-ufs]. This procedure also shows how I configure AWSCLI with the HTTPS endpoints: [https://github.com/eucalyptus/euca-demo/blob/feature/4.2/installs/install-20-manual/docs/install-20-manual-install-hp-gol01-d6.md#configure-awscli].\r\n\r\nHere is my /etc/euca2ools/conf.d/hp-gol01-d6.ini with HTTPS endpoints, works under 3.2, but broken under 3.3:\r\n; Eucalyptus Region hp-gol01-d6\r\n\r\n[region hp-gol01-d6]\r\nautoscaling-url = https://autoscaling.hp-gol01-d6.mjc.prc.eucalyptus-systems.com/services/AutoScaling/\r\ncloudformation-url = https://cloudformation.hp-gol01-d6.mjc.prc.eucalyptus-systems.com/services/CloudFormation/\r\nec2-url = https://compute.hp-gol01-d6.mjc.prc.eucalyptus-systems.com/services/compute/\r\nelasticloadbalancing-url = https://loadbalancing.hp-gol01-d6.mjc.prc.eucalyptus-systems.com/services/LoadBalancing/\r\niam-url = https://euare.hp-gol01-d6.mjc.prc.eucalyptus-systems.com/services/Euare/\r\nmonitoring-url = https://cloudwatch.hp-gol01-d6.mjc.prc.eucalyptus-systems.com/services/CloudWatch/\r\ns3-url = https://objectstorage.hp-gol01-d6.mjc.prc.eucalyptus-systems.com/services/objectstorage/\r\nsts-url = https://tokens.hp-gol01-d6.mjc.prc.eucalyptus-systems.com/services/Tokens/\r\nswf-url = https://simpleworkflow.hp-gol01-d6.mjc.prc.eucalyptus-systems.com/services/SimpleWorkflow/\r\nuser = hp-gol01-d6-admin\r\n\r\nbootstrap-url = https://bootstrap.hp-gol01-d6.mjc.prc.eucalyptus-systems.com/services/Empyrean/\r\nproperties-url = https://properties.hp-gol01-d6.mjc.prc.eucalyptus-systems.com/services/Properties/\r\nreporting-url = https://reporting.hp-gol01-d6.mjc.prc.eucalyptus-systems.com/services/Reporting/\r\n\r\ncertificate = /usr/share/euca2ools/certs/cert-hp-gol01-d6.pem\r\nverify-ssl = true\r\n\r\n----\r\n\r\nHere is my /etc/euca2ools/conf.d/hp-gol01-d6.ini with HTTP endpoints, works under both:\r\n; Eucalyptus Region hp-gol01-d6\r\n\r\n[region hp-gol01-d6]\r\nautoscaling-url = https://autoscaling.hp-gol01-d6.mjc.prc.eucalyptus-systems.com/services/AutoScaling/\r\ncloudformation-url = https://cloudformation.hp-gol01-d6.mjc.prc.eucalyptus-systems.com/services/CloudFormation/\r\nec2-url = https://compute.hp-gol01-d6.mjc.prc.eucalyptus-systems.com/services/compute/\r\nelasticloadbalancing-url = https://loadbalancing.hp-gol01-d6.mjc.prc.eucalyptus-systems.com/services/LoadBalancing/\r\niam-url = https://euare.hp-gol01-d6.mjc.prc.eucalyptus-systems.com/services/Euare/\r\nmonitoring-url = https://cloudwatch.hp-gol01-d6.mjc.prc.eucalyptus-systems.com/services/CloudWatch/\r\ns3-url = https://objectstorage.hp-gol01-d6.mjc.prc.eucalyptus-systems.com/services/objectstorage/\r\nsts-url = https://tokens.hp-gol01-d6.mjc.prc.eucalyptus-systems.com/services/Tokens/\r\nswf-url = https://simpleworkflow.hp-gol01-d6.mjc.prc.eucalyptus-systems.com/services/SimpleWorkflow/\r\nuser = hp-gol01-d6-admin\r\n\r\nbootstrap-url = https://bootstrap.hp-gol01-d6.mjc.prc.eucalyptus-systems.com/services/Empyrean/\r\nproperties-url = https://properties.hp-gol01-d6.mjc.prc.eucalyptus-systems.com/services/Properties/\r\nreporting-url = https://reporting.hp-gol01-d6.mjc.prc.eucalyptus-systems.com/services/Reporting/\r\n\r\ncertificate = /usr/share/euca2ools/certs/cert-hp-gol01-d6.pem\r\nverify-ssl = true\r\n\r\n----","customfield_13200":null,"customfield_11300":null,"customfield_11500":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=gholms","name":"gholms","key":"gholms","accountId":"557058:6e5fdc25-c797-4d3d-8fd4-55c3c4ed99b0","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/3e16def22dd4a96dbe507df70f15f37f?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dgholms%26avatarId%3D18100%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/3e16def22dd4a96dbe507df70f15f37f?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dgholms%26avatarId%3D18100%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/3e16def22dd4a96dbe507df70f15f37f?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dgholms%26avatarId%3D18100%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/3e16def22dd4a96dbe507df70f15f37f?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dgholms%26avatarId%3D18100%26noRedirect%3Dtrue"},"displayName":"Garrett Holmstrom","active":true,"timeZone":"America/Los_Angeles"},"timetracking":{},"customfield_10401":null,"customfield_10005":null,"customfield_10600":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/version/16203","id":"16203","description":"3.3.0","name":"3.3.0","archived":false,"released":true,"releaseDate":"2015-10-22"}],"customfield_12900":null,"aggregatetimeestimate":null,"attachment":[],"summary":"Euca2ools 3.3 doesn't work against endpoints behind Nginx SSL reverse proxy","creator":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=mcrawford","name":"mcrawford","key":"mcrawford","accountId":"557058:75e0a4e1-089b-40d0-a2fa-f65a508a115e","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/3737aee022e72f1e8f391d899fb15e1e?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dmcrawford%26avatarId%3D15800%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/3737aee022e72f1e8f391d899fb15e1e?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dmcrawford%26avatarId%3D15800%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/3737aee022e72f1e8f391d899fb15e1e?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dmcrawford%26avatarId%3D15800%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/3737aee022e72f1e8f391d899fb15e1e?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dmcrawford%26avatarId%3D15800%26noRedirect%3Dtrue"},"displayName":"Michael Crawford","active":true,"timeZone":"America/Los_Angeles"},"subtasks":[],"reporter":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=mcrawford","name":"mcrawford","key":"mcrawford","accountId":"557058:75e0a4e1-089b-40d0-a2fa-f65a508a115e","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/3737aee022e72f1e8f391d899fb15e1e?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dmcrawford%26avatarId%3D15800%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/3737aee022e72f1e8f391d899fb15e1e?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dmcrawford%26avatarId%3D15800%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/3737aee022e72f1e8f391d899fb15e1e?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dmcrawford%26avatarId%3D15800%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/3737aee022e72f1e8f391d899fb15e1e?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dmcrawford%26avatarId%3D15800%26noRedirect%3Dtrue"},"displayName":"Michael Crawford","active":true,"timeZone":"America/Los_Angeles"},"aggregateprogress":{"progress":0,"total":0},"customfield_12100":"0|i03i1z:","customfield_10000":"10007_*:*_1_*:*_6263825_*|*_3_*:*_2_*:*_696802564_*|*_10000_*:*_1_*:*_7489309184_*|*_10002_*:*_1_*:*_20396_*|*_10001_*:*_2_*:*_20475114963_*|*_10003_*:*_1_*:*_4922146277_*|*_10006_*:*_1_*:*_0","customfield_10001":"2015-11-19T15:48:47.390-0600","customfield_10002":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/10000","value":"Customer Affecting","id":"10000"}],"customfield_10200":null,"customfield_10003":null,"customfield_10400":null,"customfield_12500":null,"customfield_11600":["dmitrii(dmitrii)","gholms(gholms)","mcrawford(mcrawford)","tony(tony)"],"customfield_10116":null,"environment":null,"customfield_10117":null,"customfield_11800":null,"customfield_11802":null,"customfield_11805":null,"duedate":null,"progress":{"progress":0,"total":0},"customfield_11806":null,"votes":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/TOOLS-605/votes","votes":0,"hasVoted":false},"comment":{"comments":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/39241/comment/95974","id":"95974","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=gholms","name":"gholms","key":"gholms","accountId":"557058:6e5fdc25-c797-4d3d-8fd4-55c3c4ed99b0","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/3e16def22dd4a96dbe507df70f15f37f?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dgholms%26avatarId%3D18100%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/3e16def22dd4a96dbe507df70f15f37f?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dgholms%26avatarId%3D18100%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/3e16def22dd4a96dbe507df70f15f37f?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dgholms%26avatarId%3D18100%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/3e16def22dd4a96dbe507df70f15f37f?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dgholms%26avatarId%3D18100%26noRedirect%3Dtrue"},"displayName":"Garrett Holmstrom","active":true,"timeZone":"America/Los_Angeles"},"body":"When you file euca2ools bugs please include --debug output, which will include the contents of any error responses from the service.\r\n\r\nYour reverse proxy might be a red herring.  DNS-based service URLs should not include paths; they are redundant.  Do things begin working if you remove the service paths?  Euca2ools 3.3 switched to signature version 4, so the new validation that performs may wind up rejecting requests that signature version 2 would have accepted.","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=gholms","name":"gholms","key":"gholms","accountId":"557058:6e5fdc25-c797-4d3d-8fd4-55c3c4ed99b0","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/3e16def22dd4a96dbe507df70f15f37f?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dgholms%26avatarId%3D18100%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/3e16def22dd4a96dbe507df70f15f37f?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dgholms%26avatarId%3D18100%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/3e16def22dd4a96dbe507df70f15f37f?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dgholms%26avatarId%3D18100%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/3e16def22dd4a96dbe507df70f15f37f?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dgholms%26avatarId%3D18100%26noRedirect%3Dtrue"},"displayName":"Garrett Holmstrom","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-11-19T15:48:47.390-0600","updated":"2015-11-19T15:48:47.390-0600"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/39241/comment/96700","id":"96700","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=mcrawford","name":"mcrawford","key":"mcrawford","accountId":"557058:75e0a4e1-089b-40d0-a2fa-f65a508a115e","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/3737aee022e72f1e8f391d899fb15e1e?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dmcrawford%26avatarId%3D15800%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/3737aee022e72f1e8f391d899fb15e1e?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dmcrawford%26avatarId%3D15800%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/3737aee022e72f1e8f391d899fb15e1e?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dmcrawford%26avatarId%3D15800%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/3737aee022e72f1e8f391d899fb15e1e?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dmcrawford%26avatarId%3D15800%26noRedirect%3Dtrue"},"displayName":"Michael Crawford","active":true,"timeZone":"America/Los_Angeles"},"body":"Per our last discussion, I removed the PATH portion of the URLs, and tested again with both http and port 8773, which worked, and with https and no port, which had the same error. Here's my /etc/euca2ools/conf.d/hp-gol01-d6.ini with https:\r\n---\r\n; Eucalyptus Region hp-gol01-d6\r\n\r\n[region hp-gol01-d6]\r\nautoscaling-url = https://autoscaling.hp-gol01-d6.mjc.prc.eucalyptus-systems.com/\r\nbootstrap-url = https://bootstrap.hp-gol01-d6.mjc.prc.eucalyptus-systems.com/\r\ncloudformation-url = https://cloudformation.hp-gol01-d6.mjc.prc.eucalyptus-systems.com/\r\nec2-url = https://ec2.hp-gol01-d6.mjc.prc.eucalyptus-systems.com/\r\nelasticloadbalancing-url = https://elasticloadbalancing.hp-gol01-d6.mjc.prc.eucalyptus-systems.com/\r\niam-url = https://iam.hp-gol01-d6.mjc.prc.eucalyptus-systems.com/\r\nmonitoring-url = https://monitoring.hp-gol01-d6.mjc.prc.eucalyptus-systems.com/\r\nproperties-url = https://properties.hp-gol01-d6.mjc.prc.eucalyptus-systems.com/\r\nreporting-url = https://reporting.hp-gol01-d6.mjc.prc.eucalyptus-systems.com/\r\ns3-url = https://s3.hp-gol01-d6.mjc.prc.eucalyptus-systems.com/\r\nsts-url = https://sts.hp-gol01-d6.mjc.prc.eucalyptus-systems.com/\r\nuser=hp-gol01-d6-admin\r\n\r\nbootstrap-url = https://bootstrap.hp-gol01-d6.mjc.prc.eucalyptus-systems.com/\r\nproperties-url = https://properties.hp-gol01-d6.mjc.prc.eucalyptus-systems.com/\r\nreporting-url = https://reporting.hp-gol01-d6.mjc.prc.eucalyptus-systems.com/\r\n\r\ncertificate = /usr/share/euca2ools/certs/cert-hp-gol01-d6.pem\r\nverify-ssl = true\r\n---\r\n\r\nHere's the results when running a command which works against the http endpoints but not with https with --debug:\r\n[root@odc-d-13 ~]# euca-describe-keypairs --region hp-gol01-d6-demo-admin@hp-gol01-d6 --debug\r\n2015-12-06 22:20:48,972 DEBUG   DescribeKeyPairs parsed arguments: {'filters': None, 'security_token': None, 'url': None, 'region': 'hp-gol01-d6-demo-admin@hp-gol01-d6', 'KeyName': [], 'show_empty_fields': False, 'key_id': None, 'secret_key': None}\r\n2015-12-06 22:20:48,972 INFO    Config finding region option ec2-url\r\n2015-12-06 22:20:48,972 DEBUG   Config   section hp-gol01-d6\r\n2015-12-06 22:20:48,972 INFO    Config   found   hp-gol01-d6::ec2-url = 'https://ec2.hp-gol01-d6.mjc.prc.eucalyptus-systems.com/'\r\n2015-12-06 22:20:48,972 INFO    Config finding region option name\r\n2015-12-06 22:20:48,973 DEBUG   Config   section hp-gol01-d6\r\n2015-12-06 22:20:48,973 INFO    Config   found   hp-gol01-d6::name = 'hp-gol01-d6'\r\n2015-12-06 22:20:48,973 INFO    Config finding global option max-retries\r\n2015-12-06 22:20:48,973 INFO    Config   novalue for max-retries\r\n2015-12-06 22:20:48,973 INFO    Config finding global option timeout\r\n2015-12-06 22:20:48,973 INFO    Config   novalue for timeout\r\n2015-12-06 22:20:48,973 INFO    Config finding region option verify-ssl\r\n2015-12-06 22:20:48,973 DEBUG   Config   section hp-gol01-d6\r\n2015-12-06 22:20:48,973 INFO    Config   found   hp-gol01-d6::verify-ssl = 'true'\r\n2015-12-06 22:20:48,973 INFO    Config finding user option key-id\r\n2015-12-06 22:20:48,974 DEBUG   Config   section hp-gol01-d6-demo-admin\r\n2015-12-06 22:20:48,974 INFO    Config   found   hp-gol01-d6-demo-admin::key-id = 'AKIAA5KGVIDGMSHPTI6O'\r\n2015-12-06 22:20:48,974 INFO    Config finding user option secret-key\r\n2015-12-06 22:20:48,974 DEBUG   Config   section hp-gol01-d6-demo-admin\r\n2015-12-06 22:20:48,974 INFO    Config   found   hp-gol01-d6-demo-admin::secret-key = <redacted>\r\n2015-12-06 22:20:48,974 DEBUG   HmacV4Auth using auth info from configuration\r\n2015-12-06 22:20:48,974 INFO    DescribeKeyPairs parameters: {'Action': 'DescribeKeyPairs', 'Version': '2014-06-15'}\r\n2015-12-06 22:20:48,974 DEBUG   DescribeKeyPairs sending flattened params as form data\r\n2015-12-06 22:20:48,978 INFO    EC2 sending request (attempt 1 of 3)\r\n2015-12-06 22:20:48,986 DEBUG   HmacV4Auth payload hash: 707cfbfe01f2556426e489c0a125bc5a94ef2506b3346ace4f3e868992b05d3a\r\n2015-12-06 22:20:48,986 DEBUG   HmacV4Auth scope: 20151207/hp-gol01-d6/ec2/aws4_request\r\n2015-12-06 22:20:48,986 DEBUG   HmacV4Auth canonical URI: /\r\n2015-12-06 22:20:48,987 DEBUG   HmacV4Auth canonical query: \r\n2015-12-06 22:20:48,987 DEBUG   HmacV4Auth canonical headers: ['accept:*/*', 'accept-encoding:gzip, deflate', 'connection:keep-alive', 'content-length:42', 'content-type:application/x-www-form-urlencoded', 'host:ec2.hp-gol01-d6.mjc.prc.eucalyptus-systems.com', 'x-amz-content-sha256:707cfbfe01f2556426e489c0a125bc5a94ef2506b3346ace4f3e868992b05d3a', 'x-amz-date:20151207T062048Z']\r\n2015-12-06 22:20:48,987 DEBUG   HmacV4Auth signed headers: accept;accept-encoding;connection;content-length;content-type;host;x-amz-content-sha256;x-amz-date\r\n2015-12-06 22:20:48,987 DEBUG   HmacV4Auth canonical request: 'POST\\n/\\n\\naccept:*/*\\naccept-encoding:gzip, deflate\\nconnection:keep-alive\\ncontent-length:42\\ncontent-type:application/x-www-form-urlencoded\\nhost:ec2.hp-gol01-d6.mjc.prc.eucalyptus-systems.com\\nx-amz-content-sha256:707cfbfe01f2556426e489c0a125bc5a94ef2506b3346ace4f3e868992b05d3a\\nx-amz-date:20151207T062048Z\\n\\naccept;accept-encoding;connection;content-length;content-type;host;x-amz-content-sha256;x-amz-date\\n707cfbfe01f2556426e489c0a125bc5a94ef2506b3346ace4f3e868992b05d3a'\r\n2015-12-06 22:20:48,987 DEBUG   HmacV4Auth string to sign: 'AWS4-HMAC-SHA256\\n20151207T062048Z\\n20151207/hp-gol01-d6/ec2/aws4_request\\n281d2962451a15ec365ead686998803edb6bbde05fd27d71918a3233fe2c4e07'\r\n2015-12-06 22:20:48,987 DEBUG   HmacV4Auth signature: 06b3569d4be99e15252309dff502969263ca0a0a0610d35acd8632f9e361fde4\r\n2015-12-06 22:20:48,988 DEBUG   HmacV4Auth signed headers: accept;accept-encoding;connection;content-length;content-type;host;x-amz-content-sha256;x-amz-date\r\n2015-12-06 22:20:48,988 DEBUG   EC2 request method: POST\r\n2015-12-06 22:20:48,988 DEBUG   EC2 request url:    https://ec2.hp-gol01-d6.mjc.prc.eucalyptus-systems.com/\r\n2015-12-06 22:20:48,988 DEBUG   EC2 request header: Accept: */*\r\n2015-12-06 22:20:48,988 DEBUG   EC2 request header: Accept-Encoding: gzip, deflate\r\n2015-12-06 22:20:48,988 DEBUG   EC2 request header: Authorization: AWS4-HMAC-SHA256 Credential=AKIAA5KGVIDGMSHPTI6O/20151207/hp-gol01-d6/ec2/aws4_request, SignedHeaders=accept;accept-encoding;connection;content-length;content-type;host;x-amz-content-sha256;x-amz-date, Signature=06b3569d4be99e15252309dff502969263ca0a0a0610d35acd8632f9e361fde4\r\n2015-12-06 22:20:48,988 DEBUG   EC2 request header: Connection: keep-alive\r\n2015-12-06 22:20:48,988 DEBUG   EC2 request header: Content-Length: 42\r\n2015-12-06 22:20:48,988 DEBUG   EC2 request header: Content-Type: application/x-www-form-urlencoded\r\n2015-12-06 22:20:48,988 DEBUG   EC2 request header: Host: ec2.hp-gol01-d6.mjc.prc.eucalyptus-systems.com\r\n2015-12-06 22:20:48,989 DEBUG   EC2 request header: User-Agent: euca2ools/3.3.0 (CPython 2.6.6; Linux 2.6.32-573.8.1.el6.x86_64; x86_64) requestbuilder/0.4.0 requests/2.6.0\r\n2015-12-06 22:20:48,989 DEBUG   EC2 request header: X-Amz-Content-SHA256: 707cfbfe01f2556426e489c0a125bc5a94ef2506b3346ace4f3e868992b05d3a\r\n2015-12-06 22:20:48,989 DEBUG   EC2 request header: X-Amz-Date: 20151207T062048Z\r\n2015-12-06 22:20:48,989 DEBUG   EC2 request data:   Action: DescribeKeyPairs\r\n2015-12-06 22:20:48,989 DEBUG   EC2 request data:   Version: 2014-06-15\r\n2015-12-06 22:20:49,030 DEBUG   EC2 response time: 0.040 seconds\r\n2015-12-06 22:20:49,030 ERROR   EC2 response status: 403\r\n2015-12-06 22:20:49,030 DEBUG   EC2 response header: connection: keep-alive\r\n2015-12-06 22:20:49,030 DEBUG   EC2 response header: content-length: 196\r\n2015-12-06 22:20:49,030 DEBUG   EC2 response header: content-type: text/plain; charset=UTF-8\r\n2015-12-06 22:20:49,030 DEBUG   EC2 response header: date: Mon, 07 Dec 2015 06:20:49 GMT\r\n2015-12-06 22:20:49,030 DEBUG   EC2 response header: server: nginx/1.8.0\r\n2015-12-06 22:20:49,031 DEBUG   DescribeKeyPairs -- response content --\r\n<?xml version=\"1.0\"?><Response><Errors><Error><Code>403 Forbidden</Code><Message>Signature validation failed</Message></Error></Errors><RequestID>Signature validation failed</RequestID></Response>\r\n2015-12-06 22:20:49,031 DEBUG   DescribeKeyPairs -- end of response content --\r\n2015-12-06 22:20:49,031 INFO    DescribeKeyPairs result: failure\r\neuca-describe-keypairs: error (403 Forbidden): Signature validation failed\r\nTraceback (most recent call last):\r\n  File \"/usr/bin/euca-describe-keypairs\", line 6, in <module>\r\n    euca2ools.commands.ec2.describekeypairs.DescribeKeyPairs.run()\r\n  File \"/usr/lib/python2.6/site-packages/requestbuilder/command.py\", line 305, in run\r\n    cmd.handle_cli_exception(err)\r\n  File \"/usr/lib/python2.6/site-packages/requestbuilder/command.py\", line 302, in run\r\n    result = cmd.main()\r\n  File \"/usr/lib/python2.6/site-packages/requestbuilder/request.py\", line 205, in main\r\n    response = self.send()\r\n  File \"/usr/lib/python2.6/site-packages/requestbuilder/request.py\", line 276, in send\r\n    return BaseRequest.send(self)\r\n  File \"/usr/lib/python2.6/site-packages/requestbuilder/request.py\", line 171, in send\r\n    return self.handle_server_error(err)\r\n  File \"/usr/lib/python2.6/site-packages/requestbuilder/request.py\", line 158, in send\r\n    auth=self.auth)\r\n  File \"/usr/lib/python2.6/site-packages/requestbuilder/service.py\", line 226, in send_request\r\n    self.handle_http_error(response)\r\n  File \"/usr/lib/python2.6/site-packages/euca2ools/commands/ec2/__init__.py\", line 64, in handle_http_error\r\n    raise AWSError(response)\r\neuca2ools.exceptions.AWSError: (403, 'Forbidden', '403 Forbidden', 'Signature validation failed')\r\n---\r\n\r\nI have AWSCLI installed and have modified _endpoints.json to go through the https endpoints via the Nginx reverse proxy in front of both the Console and UFS, and that works with no trouble, same as with 3.2, and I'm pretty sure it's using signature version 4. This seems to be something specific to Euca2ools 3.3. I haven't had time to test adding SSL via the Java KeyStore method yet to see if that has the same behavior I see with the reverse proxy terminating SSL. \r\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=mcrawford","name":"mcrawford","key":"mcrawford","accountId":"557058:75e0a4e1-089b-40d0-a2fa-f65a508a115e","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/3737aee022e72f1e8f391d899fb15e1e?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dmcrawford%26avatarId%3D15800%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/3737aee022e72f1e8f391d899fb15e1e?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dmcrawford%26avatarId%3D15800%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/3737aee022e72f1e8f391d899fb15e1e?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dmcrawford%26avatarId%3D15800%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/3737aee022e72f1e8f391d899fb15e1e?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dmcrawford%26avatarId%3D15800%26noRedirect%3Dtrue"},"displayName":"Michael Crawford","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-12-07T00:28:55.662-0600","updated":"2015-12-07T00:28:55.662-0600"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/39241/comment/99110","id":"99110","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=gholms","name":"gholms","key":"gholms","accountId":"557058:6e5fdc25-c797-4d3d-8fd4-55c3c4ed99b0","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/3e16def22dd4a96dbe507df70f15f37f?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dgholms%26avatarId%3D18100%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/3e16def22dd4a96dbe507df70f15f37f?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dgholms%26avatarId%3D18100%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/3e16def22dd4a96dbe507df70f15f37f?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dgholms%26avatarId%3D18100%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/3e16def22dd4a96dbe507df70f15f37f?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dgholms%26avatarId%3D18100%26noRedirect%3Dtrue"},"displayName":"Garrett Holmstrom","active":true,"timeZone":"America/Los_Angeles"},"body":"Your proxy is rewriting the {{Connection: keep-alive}} header that euca2ools commands include in their requests.  This header is signed, so meddling with that is what causes signature validation to fail.","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=gholms","name":"gholms","key":"gholms","accountId":"557058:6e5fdc25-c797-4d3d-8fd4-55c3c4ed99b0","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/3e16def22dd4a96dbe507df70f15f37f?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dgholms%26avatarId%3D18100%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/3e16def22dd4a96dbe507df70f15f37f?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dgholms%26avatarId%3D18100%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/3e16def22dd4a96dbe507df70f15f37f?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dgholms%26avatarId%3D18100%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/3e16def22dd4a96dbe507df70f15f37f?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dgholms%26avatarId%3D18100%26noRedirect%3Dtrue"},"displayName":"Garrett Holmstrom","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-02-10T17:59:18.442-0600","updated":"2016-02-10T17:59:18.442-0600"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/39241/comment/99112","id":"99112","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=mcrawford","name":"mcrawford","key":"mcrawford","accountId":"557058:75e0a4e1-089b-40d0-a2fa-f65a508a115e","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/3737aee022e72f1e8f391d899fb15e1e?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dmcrawford%26avatarId%3D15800%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/3737aee022e72f1e8f391d899fb15e1e?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dmcrawford%26avatarId%3D15800%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/3737aee022e72f1e8f391d899fb15e1e?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dmcrawford%26avatarId%3D15800%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/3737aee022e72f1e8f391d899fb15e1e?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dmcrawford%26avatarId%3D15800%26noRedirect%3Dtrue"},"displayName":"Michael Crawford","active":true,"timeZone":"America/Los_Angeles"},"body":"First, thanks so much for looking into this today. I really appreciate the timely and efficient determination of the issue!\r\n\r\nTwo questions/comments in response to yours:\r\n#. Why does AWSCLI work through this proxy in it's current configuration? They must not be including this header, or the same problem would happen with them, unless I'm missing something? If that's the case (they don't include it in their requests) why does euca2ools need it when they don't? Please don't think I'm questioning your implementation decision - this is to help me understand how this works - Give that our client tool is using the same underlying python libraries to hit against their API endpoint, I would have thought our implementation would have to send the EXACT same request as they do. Are they just ignoring this header if sent? Is this something Eucalyptus likely requires but which isn't needed with AWS endpoints? I've been able to use AWSCLI against Euca API endpoints without any visible trouble for months, if that's not sending this header, how could things work without visible trouble?\r\n#. So, what's the solution, then? If euca2ools does need to send this header for some reason, I'm totally happy adjusting my proxy configuration in any way that's needed to prevent changing this header on transit. Or, if you think this header doesn't need to be sent, will you be removing it from euca2ools? Even if the latter, I'm happy adjusting my SSL proxy config to not touch this header, just not sure how to do that and test it. Please feel free to adjust my SSL config in the PRC in any way you want to fix this, then let me know what you did.","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=mcrawford","name":"mcrawford","key":"mcrawford","accountId":"557058:75e0a4e1-089b-40d0-a2fa-f65a508a115e","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/3737aee022e72f1e8f391d899fb15e1e?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dmcrawford%26avatarId%3D15800%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/3737aee022e72f1e8f391d899fb15e1e?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dmcrawford%26avatarId%3D15800%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/3737aee022e72f1e8f391d899fb15e1e?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dmcrawford%26avatarId%3D15800%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/3737aee022e72f1e8f391d899fb15e1e?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dmcrawford%26avatarId%3D15800%26noRedirect%3Dtrue"},"displayName":"Michael Crawford","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-02-10T18:12:22.856-0600","updated":"2016-02-10T18:12:22.856-0600"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/39241/comment/99113","id":"99113","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=gholms","name":"gholms","key":"gholms","accountId":"557058:6e5fdc25-c797-4d3d-8fd4-55c3c4ed99b0","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/3e16def22dd4a96dbe507df70f15f37f?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dgholms%26avatarId%3D18100%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/3e16def22dd4a96dbe507df70f15f37f?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dgholms%26avatarId%3D18100%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/3e16def22dd4a96dbe507df70f15f37f?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dgholms%26avatarId%3D18100%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/3e16def22dd4a96dbe507df70f15f37f?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dgholms%26avatarId%3D18100%26noRedirect%3Dtrue"},"displayName":"Garrett Holmstrom","active":true,"timeZone":"America/Los_Angeles"},"body":"aws-cli works because it doesn't sign that particular header.  euca2ools probably shouldn't either.","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=gholms","name":"gholms","key":"gholms","accountId":"557058:6e5fdc25-c797-4d3d-8fd4-55c3c4ed99b0","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/3e16def22dd4a96dbe507df70f15f37f?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dgholms%26avatarId%3D18100%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/3e16def22dd4a96dbe507df70f15f37f?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dgholms%26avatarId%3D18100%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/3e16def22dd4a96dbe507df70f15f37f?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dgholms%26avatarId%3D18100%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/3e16def22dd4a96dbe507df70f15f37f?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dgholms%26avatarId%3D18100%26noRedirect%3Dtrue"},"displayName":"Garrett Holmstrom","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-02-10T18:25:34.754-0600","updated":"2016-02-10T18:25:34.754-0600"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/39241/comment/99173","id":"99173","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=dmitrii","name":"dmitrii","key":"dmitrii","accountId":"557058:1e0ea807-434b-4b54-967f-1dec4a9ede55","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue"},"displayName":"Dmitrii Calzago","active":false,"timeZone":"America/Los_Angeles"},"body":"Let's \"make it so\".","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=dmitrii","name":"dmitrii","key":"dmitrii","accountId":"557058:1e0ea807-434b-4b54-967f-1dec4a9ede55","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/efb56b507e22d4fc0d8d5e900e5651d5?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Ddmitrii%26avatarId%3D15900%26noRedirect%3Dtrue"},"displayName":"Dmitrii Calzago","active":false,"timeZone":"America/Los_Angeles"},"created":"2016-02-11T16:36:11.973-0600","updated":"2016-02-11T16:36:11.973-0600"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/39241/comment/111388","id":"111388","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=gholms","name":"gholms","key":"gholms","accountId":"557058:6e5fdc25-c797-4d3d-8fd4-55c3c4ed99b0","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/3e16def22dd4a96dbe507df70f15f37f?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dgholms%26avatarId%3D18100%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/3e16def22dd4a96dbe507df70f15f37f?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dgholms%26avatarId%3D18100%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/3e16def22dd4a96dbe507df70f15f37f?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dgholms%26avatarId%3D18100%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/3e16def22dd4a96dbe507df70f15f37f?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dgholms%26avatarId%3D18100%26noRedirect%3Dtrue"},"displayName":"Garrett Holmstrom","active":true,"timeZone":"America/Los_Angeles"},"body":"This was fixed in requestbuilder 0.5.","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=gholms","name":"gholms","key":"gholms","accountId":"557058:6e5fdc25-c797-4d3d-8fd4-55c3c4ed99b0","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/3e16def22dd4a96dbe507df70f15f37f?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dgholms%26avatarId%3D18100%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/3e16def22dd4a96dbe507df70f15f37f?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dgholms%26avatarId%3D18100%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/3e16def22dd4a96dbe507df70f15f37f?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dgholms%26avatarId%3D18100%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/3e16def22dd4a96dbe507df70f15f37f?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dgholms%26avatarId%3D18100%26noRedirect%3Dtrue"},"displayName":"Garrett Holmstrom","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-10-12T20:04:56.364-0500","updated":"2016-10-12T20:04:56.364-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/39241/comment/114151","id":"114151","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=tony","name":"tony","key":"tony","accountId":"557058:353956db-b78c-4f3b-9096-f8f58e6709c8","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/14ec1b18e630cc0743492fc327a12df7?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dtony%26avatarId%3D16600%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/14ec1b18e630cc0743492fc327a12df7?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dtony%26avatarId%3D16600%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/14ec1b18e630cc0743492fc327a12df7?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dtony%26avatarId%3D16600%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/14ec1b18e630cc0743492fc327a12df7?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dtony%26avatarId%3D16600%26noRedirect%3Dtrue"},"displayName":"Tony Beckham","active":true,"timeZone":"America/Tijuana"},"body":"Fix Verified.\r\n\r\nInstalled Packages\r\nName        : euca2ools\r\nArch        : noarch\r\nVersion     : 3.3.1\r\nRelease     : 0.1820.50.20161115gitdc4f158.el7\r\n\r\nThe connection header is not signed. Here is the relevant part of debug output in request:\r\n{code}\r\n...\r\n2016-12-08 16:11:53,626 DEBUG   HmacV4Auth signed headers: accept;accept-encoding;content-length;content-type;host;x-amz-content-sha256;x-amz-date\r\n...\r\n{code}","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=tony","name":"tony","key":"tony","accountId":"557058:353956db-b78c-4f3b-9096-f8f58e6709c8","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/14ec1b18e630cc0743492fc327a12df7?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dtony%26avatarId%3D16600%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/14ec1b18e630cc0743492fc327a12df7?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dtony%26avatarId%3D16600%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/14ec1b18e630cc0743492fc327a12df7?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dtony%26avatarId%3D16600%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/14ec1b18e630cc0743492fc327a12df7?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dtony%26avatarId%3D16600%26noRedirect%3Dtrue"},"displayName":"Tony Beckham","active":true,"timeZone":"America/Tijuana"},"created":"2016-12-08T18:20:42.643-0600","updated":"2016-12-08T18:20:42.643-0600"}],"maxResults":8,"total":8,"startAt":0},"customfield_11808":null,"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]}}}
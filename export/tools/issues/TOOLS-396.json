{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"24927","self":"https://eucalyptus.atlassian.net/rest/api/2/issue/24927","key":"TOOLS-396","fields":{"issuetype":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://eucalyptus.atlassian.net/secure/viewavatar?size=xsmall&avatarId=14803&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":14803},"timespent":null,"customfield_13100":null,"project":{"self":"https://eucalyptus.atlassian.net/rest/api/2/project/10001","id":"10001","key":"TOOLS","name":"Euca2ools","avatarUrls":{"48x48":"https://eucalyptus.atlassian.net/secure/projectavatar?pid=10001&avatarId=10011","24x24":"https://eucalyptus.atlassian.net/secure/projectavatar?size=small&pid=10001&avatarId=10011","16x16":"https://eucalyptus.atlassian.net/secure/projectavatar?size=xsmall&pid=10001&avatarId=10011","32x32":"https://eucalyptus.atlassian.net/secure/projectavatar?size=medium&pid=10001&avatarId=10011"}},"customfield_11000":null,"fixVersions":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/version/13403","id":"13403","description":"3.0.3","name":"3.0.3","archived":false,"released":true,"releaseDate":"2014-05-29"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/version/12502","id":"12502","description":"3.1.0","name":"3.1.0","archived":false,"released":true,"releaseDate":"2014-05-29"}],"customfield_11001":null,"aggregatetimespent":null,"customfield_10310":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/10209","value":"CentOS 6","id":"10209"}],"resolution":{"self":"https://eucalyptus.atlassian.net/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_11401":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=ccassler","name":"ccassler","key":"ccassler","accountId":"557058:8fb32702-a3cf-42d3-9846-95c74f801354","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/ace94e80ebc0a3b718cc5422760b57de?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dccassler%26avatarId%3D14700%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/ace94e80ebc0a3b718cc5422760b57de?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dccassler%26avatarId%3D14700%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/ace94e80ebc0a3b718cc5422760b57de?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dccassler%26avatarId%3D14700%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/ace94e80ebc0a3b718cc5422760b57de?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dccassler%26avatarId%3D14700%26noRedirect%3Dtrue"},"displayName":"Casey Cassler","active":true,"timeZone":"America/Los_Angeles"},"customfield_11400":null,"customfield_10500":{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/10403","value":"Not Applicable","id":"10403"},"customfield_10302":null,"customfield_10104":["com.atlassian.greenhopper.service.sprint.Sprint@4ea1e01a[id=59,rapidViewId=75,state=CLOSED,name=4.0 Sprint 8,goal=<null>,startDate=2014-04-29T13:38:45.824Z,endDate=2014-05-27T22:00:00.000Z,completeDate=2014-06-09T16:26:51.613Z,sequence=59]"],"customfield_10105":null,"customfield_10303":null,"customfield_10304":null,"customfield_10700":null,"customfield_10701":null,"customfield_10306":{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/10202","value":"Low","id":"10202"},"customfield_10702":null,"customfield_10703":null,"resolutiondate":"2014-05-20T02:50:04.096-0500","customfield_10704":null,"customfield_10308":null,"customfield_10309":null,"customfield_10705":null,"workratio":-1,"watches":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/TOOLS-396/watchers","watchCount":3,"isWatching":false},"lastViewed":null,"created":"2013-10-22T20:03:29.591-0500","customfield_12000":null,"customfield_12400":null,"priority":{"self":"https://eucalyptus.atlassian.net/rest/api/2/priority/4","iconUrl":"https://eucalyptus.atlassian.net/images/icons/priorities/minor.svg","name":"Minor","id":"4"},"customfield_12201":null,"customfield_10300":null,"customfield_12600":"{repository={count=1, dataType=repository}, json={\"cachedValue\":{\"errors\":[],\"summary\":{\"repository\":{\"overall\":{\"count\":1,\"lastUpdated\":\"2013-11-15T18:03:13.000-0600\",\"dataType\":\"repository\"},\"byInstanceType\":{\"github\":{\"count\":1,\"name\":\"GitHub\"}}}}},\"isStale\":true}}","customfield_10102":null,"labels":[],"customfield_10301":null,"customfield_11700":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_11901":null,"versions":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/version/12900","id":"12900","description":"3.0.2","name":"3.0.2","archived":false,"released":true,"releaseDate":"2013-10-02"}],"issuelinks":[],"assignee":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=ccassler","name":"ccassler","key":"ccassler","accountId":"557058:8fb32702-a3cf-42d3-9846-95c74f801354","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/ace94e80ebc0a3b718cc5422760b57de?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dccassler%26avatarId%3D14700%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/ace94e80ebc0a3b718cc5422760b57de?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dccassler%26avatarId%3D14700%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/ace94e80ebc0a3b718cc5422760b57de?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dccassler%26avatarId%3D14700%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/ace94e80ebc0a3b718cc5422760b57de?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dccassler%26avatarId%3D14700%26noRedirect%3Dtrue"},"displayName":"Casey Cassler","active":true,"timeZone":"America/Los_Angeles"},"updated":"2014-06-13T16:00:36.224-0500","status":{"self":"https://eucalyptus.atlassian.net/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://eucalyptus.atlassian.net/images/icons/statuses/generic.png","name":"Closed","id":"6","statusCategory":{"self":"https://eucalyptus.atlassian.net/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/component/10700","id":"10700","name":"AWS API Compatibility","description":"Compatibility with AWS APIs"}],"timeoriginalestimate":null,"customfield_13000":null,"description":"*Assessment*\r\n\r\neuare-userlistpolicies fails with an error when using _-v_ and _--pretty-print_ option.  \r\n\r\n*Signs*\r\n\r\nThe following is seen:\r\n{code}\r\n# euare-userlistpolicies --as-account account1 -u user02 -v --pretty-print --region eucalyptus-admin@\r\nec2-iam-limited\r\neuare-userlistpolicies: error: Expecting object: line 17 column 7 (char 362)\r\n{code}\r\n\r\nWhen running with _--debug_ option, it sheds more light on the error:\r\n{code}\r\n# euare-userlistpolicies --as-account account1 -u user02 -v --pretty-print --region eucalyptus-admin@ --debug\r\n2013-10-22 17:49:10,676 DEBUG   ListUserPolicies parsed arguments: {'UserName': 'user02', 'userregion': 'eucalyptus-admin@', 'verbose': True, 'url': None, 'DelegateAccount': 'account1', 'pretty_print': True, 'policy_name': None, 'deprecated_delegate': None, 'key_id': None, 'secret_key': None}\r\n2013-10-22 17:49:10,676 DEBUG   Config current user set to 'eucalyptus-admin'\r\n2013-10-22 17:49:10,676 DEBUG   Config searching regions for option 'iam-url'\r\n2013-10-22 17:49:10,677 DEBUG   Config   section 'BobMarley'\r\n2013-10-22 17:49:10,677 INFO    Config option 'iam-url' = 'http://10.104.10.6:8773/services/Euare/'\r\n2013-10-22 17:49:10,677 DEBUG   Config searching regions for option 'verify-ssl'\r\n2013-10-22 17:49:10,677 DEBUG   Config   section 'BobMarley'\r\n2013-10-22 17:49:10,677 DEBUG   Config   section '*'\r\n2013-10-22 17:49:10,677 INFO    Config option 'verify-ssl' not found\r\n2013-10-22 17:49:10,677 DEBUG   Config searching users for option 'key-id'\r\n2013-10-22 17:49:10,677 DEBUG   Config   section 'eucalyptus-admin'\r\n2013-10-22 17:49:10,677 INFO    Config option 'key-id' = 'AKIZKYODDZPMV9XQWN8R'\r\n2013-10-22 17:49:10,677 DEBUG   Config searching users for option 'secret-key'\r\n2013-10-22 17:49:10,678 DEBUG   Config   section 'eucalyptus-admin'\r\n2013-10-22 17:49:10,678 INFO    Config option 'secret-key' = <redacted>\r\n2013-10-22 17:49:10,681 INFO    ListUserPolicies parameters: {'UserName': 'user02', 'DelegateAccount': 'account1', 'Version': '2010-05-08', 'Action': 'ListUserPolicies'}\r\n2013-10-22 17:49:10,681 INFO    Euare sending request (attempt 1 of 3)\r\n2013-10-22 17:49:10,682 DEBUG   QuerySigV2Auth string to sign: 'POST\\n10.104.10.6:8773\\n/services/Euare/\\nAWSAccessKeyId=AKIZKYODDZPMV9XQWN8R&Action=ListUserPolicies&DelegateAccount=account1&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2013-10-23T00%3A49%3A10Z&UserName=user02&Version=2010-05-08'\r\n2013-10-22 17:49:10,682 DEBUG   QuerySigV2Auth b64-encoded signature: 7WbBGD29tMsqaB/d7iFUqqY/0vdI1Gq2UaBZb8SyTz8=\r\n2013-10-22 17:49:10,682 DEBUG   QuerySigV2Auth converting params to POST data\r\n2013-10-22 17:49:10,690 DEBUG   Euare request method: POST\r\n2013-10-22 17:49:10,690 DEBUG   Euare request url:    http://10.104.10.6:8773/services/Euare/\r\n2013-10-22 17:49:10,690 DEBUG   Euare request header: Content-Length: 261\r\n2013-10-22 17:49:10,690 DEBUG   Euare request header: Content-Type: application/x-www-form-urlencoded\r\n2013-10-22 17:49:10,690 DEBUG   Euare request header: Host: 10.104.10.6:8773\r\n2013-10-22 17:49:10,690 DEBUG   Euare request header: User-Agent: euca2ools/3.0.2 (CPython 2.6.6; Linux 2.6.32-358.18.1.el6.x86_64; x86_64) requestbuilder/0.1.0 requests/1.1.0\r\n2013-10-22 17:49:10,690 DEBUG   Euare request data:   AWSAccessKeyId: AKIZKYODDZPMV9XQWN8R\r\n2013-10-22 17:49:10,690 DEBUG   Euare request data:   Action: ListUserPolicies\r\n2013-10-22 17:49:10,690 DEBUG   Euare request data:   DelegateAccount: account1\r\n2013-10-22 17:49:10,691 DEBUG   Euare request data:   Signature: 7WbBGD29tMsqaB/d7iFUqqY/0vdI1Gq2UaBZb8SyTz8=\r\n2013-10-22 17:49:10,691 DEBUG   Euare request data:   SignatureMethod: HmacSHA256\r\n2013-10-22 17:49:10,691 DEBUG   Euare request data:   SignatureVersion: 2\r\n2013-10-22 17:49:10,691 DEBUG   Euare request data:   Timestamp: 2013-10-23T00:49:10Z\r\n2013-10-22 17:49:10,691 DEBUG   Euare request data:   UserName: user02\r\n2013-10-22 17:49:10,691 DEBUG   Euare request data:   Version: 2010-05-08\r\n2013-10-22 17:49:10,868 DEBUG   Euare response time: 0.176 seconds\r\n2013-10-22 17:49:10,868 INFO    Euare response status: 200\r\n2013-10-22 17:49:10,868 DEBUG   Euare response header: content-length: 369\r\n2013-10-22 17:49:10,868 DEBUG   Euare response header: content-type: application/xml; charset=UTF-8\r\n2013-10-22 17:49:10,869 DEBUG   ListUserPolicies -- response content --\r\n<ListUserPoliciesResponse xmlns=\"http://iam.amazonaws.com/doc/2010-05-08/\"><ListUserPoliciesResult><PolicyNames><member>ec2-iam-limited</member><member>cloudwatch-all</member></PolicyNames><IsTruncated>false</IsTruncated></ListUserPoliciesResult><ResponseMetadata><RequestId>65cdd9df-3149-47a7-a836-298c73405e34</RequestId></ResponseMetadata></ListUserPoliciesResponse>\r\n2013-10-22 17:49:10,869 DEBUG   ListUserPolicies -- end of response content --\r\nec2-iam-limited\r\n2013-10-22 17:49:10,870 INFO    GetUserPolicy parameters: {'UserName': 'user02', 'PolicyName': 'ec2-iam-limited', 'Version': '2010-05-08', 'Action': 'GetUserPolicy', 'DelegateAccount': 'account1'}\r\n2013-10-22 17:49:10,871 INFO    Euare sending request (attempt 1 of 3)\r\n2013-10-22 17:49:10,871 DEBUG   QuerySigV2Auth string to sign: 'POST\\n10.104.10.6:8773\\n/services/Euare/\\nAWSAccessKeyId=AKIZKYODDZPMV9XQWN8R&Action=GetUserPolicy&DelegateAccount=account1&PolicyName=ec2-iam-limited&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2013-10-23T00%3A49%3A10Z&UserName=user02&Version=2010-05-08'\r\n2013-10-22 17:49:10,871 DEBUG   QuerySigV2Auth b64-encoded signature: m5rmn+c6qcUlRJRuvRjHFkvOj7+1CwCGpc835CIVj2E=\r\n2013-10-22 17:49:10,871 DEBUG   QuerySigV2Auth converting params to POST data\r\n2013-10-22 17:49:10,872 DEBUG   Euare request method: POST\r\n2013-10-22 17:49:10,872 DEBUG   Euare request url:    http://10.104.10.6:8773/services/Euare/\r\n2013-10-22 17:49:10,872 DEBUG   Euare request header: Content-Length: 285\r\n2013-10-22 17:49:10,872 DEBUG   Euare request header: Content-Type: application/x-www-form-urlencoded\r\n2013-10-22 17:49:10,872 DEBUG   Euare request header: Host: 10.104.10.6:8773\r\n2013-10-22 17:49:10,872 DEBUG   Euare request header: User-Agent: euca2ools/3.0.2 (CPython 2.6.6; Linux 2.6.32-358.18.1.el6.x86_64; x86_64) requestbuilder/0.1.0 requests/1.1.0\r\n2013-10-22 17:49:10,872 DEBUG   Euare request data:   AWSAccessKeyId: AKIZKYODDZPMV9XQWN8R\r\n2013-10-22 17:49:10,872 DEBUG   Euare request data:   Action: GetUserPolicy\r\n2013-10-22 17:49:10,872 DEBUG   Euare request data:   DelegateAccount: account1\r\n2013-10-22 17:49:10,872 DEBUG   Euare request data:   PolicyName: ec2-iam-limited\r\n2013-10-22 17:49:10,872 DEBUG   Euare request data:   Signature: m5rmn+c6qcUlRJRuvRjHFkvOj7+1CwCGpc835CIVj2E=\r\n2013-10-22 17:49:10,873 DEBUG   Euare request data:   SignatureMethod: HmacSHA256\r\n2013-10-22 17:49:10,873 DEBUG   Euare request data:   SignatureVersion: 2\r\n2013-10-22 17:49:10,873 DEBUG   Euare request data:   Timestamp: 2013-10-23T00:49:10Z\r\n2013-10-22 17:49:10,873 DEBUG   Euare request data:   UserName: user02\r\n2013-10-22 17:49:10,873 DEBUG   Euare request data:   Version: 2010-05-08\r\n2013-10-22 17:49:11,025 DEBUG   Euare response time: 0.152 seconds\r\n2013-10-22 17:49:11,025 INFO    Euare response status: 200\r\n2013-10-22 17:49:11,025 DEBUG   Euare response header: content-length: 759\r\n2013-10-22 17:49:11,025 DEBUG   Euare response header: content-type: application/xml; charset=UTF-8\r\n2013-10-22 17:49:11,026 DEBUG   GetUserPolicy -- response content --\r\n<GetUserPolicyResponse xmlns=\"http://iam.amazonaws.com/doc/2010-05-08/\"><GetUserPolicyResult><UserName>user02</UserName><PolicyName>ec2-iam-limited</PolicyName><PolicyDocument>{\r\n  \"Statement\": [\r\n    {\r\n      \"Sid\": \"Stmt1381496061787\",\r\n      \"Action\": \"ec2:*\",\r\n      \"Effect\": \"Allow\",\r\n      \"Resource\": \"*\"\r\n    },\r\n    {\r\n      \"Sid\": \"Stmt1381496190183\",\r\n      \"Action\": [\r\n        \"iam:ListInstanceProfiles\",\r\n        \"iam:ListInstanceProfilesForRole\",\r\n        \"iam:ListRolePolicies\",\r\n        \"iam:ListRoles\",\r\n        \"iam:PassRole\",\r\n      ],\r\n      \"Effect\": \"Allow\",\r\n      \"Resource\": \"*\"\r\n    }\r\n  ]\r\n}\r\n</PolicyDocument></GetUserPolicyResult><ResponseMetadata><RequestId>428c1969-13cc-478d-9b2d-3d799b7045e1</RequestId></ResponseMetadata></GetUserPolicyResponse>\r\n2013-10-22 17:49:11,026 DEBUG   GetUserPolicy -- end of response content --\r\neuare-userlistpolicies: error: Expecting object: line 17 column 7 (char 362)\r\nTraceback (most recent call last):\r\n  File \"/usr/bin/euare-userlistpolicies\", line 6, in <module>\r\n    euca2ools.commands.euare.listuserpolicies.ListUserPolicies.run()\r\n  File \"/usr/lib/python2.6/site-packages/requestbuilder/command.py\", line 289, in run\r\n    cmd.handle_cli_exception(err)\r\n  File \"/usr/lib/python2.6/site-packages/requestbuilder/request.py\", line 200, in handle_cli_exception\r\n    BaseCommand.handle_cli_exception(self, err)\r\n  File \"/usr/lib/python2.6/site-packages/requestbuilder/command.py\", line 287, in run\r\n    cmd.print_result(result)\r\n  File \"/usr/lib/python2.6/site-packages/euca2ools/commands/euare/listuserpolicies.py\", line 74, in print_result\r\n    self.print_policy(policy_name)\r\n  File \"/usr/lib/python2.6/site-packages/euca2ools/commands/euare/listuserpolicies.py\", line 85, in print_policy\r\n    req.print_result(response)\r\n  File \"/usr/lib/python2.6/site-packages/euca2ools/commands/euare/getuserpolicy.py\", line 46, in print_result\r\n    policy_json = json.loads(policy_content)\r\n  File \"/usr/lib64/python2.6/json/__init__.py\", line 307, in loads\r\n    return _default_decoder.decode(s)\r\n  File \"/usr/lib64/python2.6/json/decoder.py\", line 319, in decode\r\n    obj, end = self.raw_decode(s, idx=_w(s, 0).end())\r\n  File \"/usr/lib64/python2.6/json/decoder.py\", line 336, in raw_decode\r\n    obj, end = self._scanner.iterscan(s, **kw).next()\r\n  File \"/usr/lib64/python2.6/json/scanner.py\", line 55, in iterscan\r\n    rval, next_pos = action(m, context)\r\n  File \"/usr/lib64/python2.6/json/decoder.py\", line 183, in JSONObject\r\n    value, end = iterscan(s, idx=end, context=context).next()\r\n  File \"/usr/lib64/python2.6/json/scanner.py\", line 55, in iterscan\r\n    rval, next_pos = action(m, context)\r\n  File \"/usr/lib64/python2.6/json/decoder.py\", line 217, in JSONArray\r\n    value, end = iterscan(s, idx=end, context=context).next()\r\n  File \"/usr/lib64/python2.6/json/scanner.py\", line 55, in iterscan\r\n    rval, next_pos = action(m, context)\r\n  File \"/usr/lib64/python2.6/json/decoder.py\", line 183, in JSONObject\r\n    value, end = iterscan(s, idx=end, context=context).next()\r\n  File \"/usr/lib64/python2.6/json/scanner.py\", line 55, in iterscan\r\n    rval, next_pos = action(m, context)\r\n  File \"/usr/lib64/python2.6/json/decoder.py\", line 219, in JSONArray\r\n    raise ValueError(errmsg(\"Expecting object\", s, end))\r\nValueError: Expecting object: line 17 column 7 (char 362)\r\n{code}\r\n\r\nIf _--pretty-print_ isn't used, the command runs successfully:\r\n{code}\r\n# euare-userlistpolicies --as-account account1 -u user02 -v --region eucalyptus-admin@\r\nec2-iam-limited\r\n{\r\n  \"Statement\": [\r\n    {\r\n      \"Sid\": \"Stmt1381496061787\",\r\n      \"Action\": \"ec2:*\",\r\n      \"Effect\": \"Allow\",\r\n      \"Resource\": \"*\"\r\n    },\r\n    {\r\n      \"Sid\": \"Stmt1381496190183\",\r\n      \"Action\": [\r\n        \"iam:ListInstanceProfiles\",\r\n        \"iam:ListInstanceProfilesForRole\",\r\n        \"iam:ListRolePolicies\",\r\n        \"iam:ListRoles\",\r\n        \"iam:PassRole\",\r\n      ],\r\n      \"Effect\": \"Allow\",\r\n      \"Resource\": \"*\"\r\n    }\r\n  ]\r\n}\r\n\r\ncloudwatch-all\r\n{\r\n  \"Statement\": [\r\n    {\r\n      \"Sid\": \"Stmt1381544067485\",\r\n      \"Action\": \"cloudwatch:*\",\r\n      \"Effect\": \"Allow\",\r\n      \"Resource\": \"*\"\r\n    }\r\n  ]\r\n}\r\n\r\nIsTruncated: false\r\n{code}\r\n\r\n*Steps*\r\n\r\n* Set up Eucalyptus 3.4 cloud\r\n* Add the following policies to a user in an account:\r\n{code}\r\nec2-iam-limited\r\n{\r\n  \"Statement\": [\r\n    {\r\n      \"Sid\": \"Stmt1381496061787\",\r\n      \"Action\": \"ec2:*\",\r\n      \"Effect\": \"Allow\",\r\n      \"Resource\": \"*\"\r\n    },\r\n    {\r\n      \"Sid\": \"Stmt1381496190183\",\r\n      \"Action\": [\r\n        \"iam:ListInstanceProfiles\",\r\n        \"iam:ListInstanceProfilesForRole\",\r\n        \"iam:ListRolePolicies\",\r\n        \"iam:ListRoles\",\r\n        \"iam:PassRole\",\r\n      ],\r\n      \"Effect\": \"Allow\",\r\n      \"Resource\": \"*\"\r\n    }\r\n  ]\r\n}\r\n\r\ncloudwatch-all\r\n{\r\n  \"Statement\": [\r\n    {\r\n      \"Sid\": \"Stmt1381544067485\",\r\n      \"Action\": \"cloudwatch:*\",\r\n      \"Effect\": \"Allow\",\r\n      \"Resource\": \"*\"\r\n    }\r\n  ]\r\n}\r\n{code}\r\n* run the following command:\r\n{code}\r\neuare-userlistpolicies --as-account <account-name> -u <user-name> -v --pretty-print --debug\r\n{code}\r\n\r\n*Pertinent Data*\r\n\r\nThis is used in eucalyptus-sos-plugins.  It would be helpful to have this information be presented in a readable manner.\r\n\r\n*Workaround*\r\n\r\nDon't use _--pretty-print_ option","customfield_13200":null,"customfield_11300":null,"customfield_11500":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=gholms","name":"gholms","key":"gholms","accountId":"557058:6e5fdc25-c797-4d3d-8fd4-55c3c4ed99b0","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/3e16def22dd4a96dbe507df70f15f37f?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dgholms%26avatarId%3D18100%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/3e16def22dd4a96dbe507df70f15f37f?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dgholms%26avatarId%3D18100%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/3e16def22dd4a96dbe507df70f15f37f?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dgholms%26avatarId%3D18100%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/3e16def22dd4a96dbe507df70f15f37f?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dgholms%26avatarId%3D18100%26noRedirect%3Dtrue"},"displayName":"Garrett Holmstrom","active":true,"timeZone":"America/Los_Angeles"},"timetracking":{},"customfield_10005":null,"customfield_10401":null,"customfield_10600":null,"customfield_12900":null,"aggregatetimeestimate":null,"attachment":[],"summary":"euare-userlistpolicies with --pretty-print option fails","creator":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=hspencer","name":"hspencer","key":"hspencer","accountId":"557058:4a3a93bc-21f8-4658-9f5b-9cb484c910a7","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue"},"displayName":"Harold Spencer Jr.","active":true,"timeZone":"America/Los_Angeles"},"subtasks":[],"reporter":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=hspencer","name":"hspencer","key":"hspencer","accountId":"557058:4a3a93bc-21f8-4658-9f5b-9cb484c910a7","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue"},"displayName":"Harold Spencer Jr.","active":true,"timeZone":"America/Los_Angeles"},"aggregateprogress":{"progress":0,"total":0},"customfield_12100":"0|i02cg7:","customfield_10000":"3_*:*_1_*:*_224767_*|*_10001_*:*_1_*:*_1304853183_*|*_10000_*:*_1_*:*_765326083_*|*_10006_*:*_1_*:*_0_*|*_10003_*:*_1_*:*_16011590548","customfield_10001":"2013-11-15T18:10:13.576-0600","customfield_10002":null,"customfield_10200":null,"customfield_10003":null,"customfield_12500":null,"customfield_10400":null,"customfield_11600":["ccassler(ccassler)","gholms(gholms)","hspencer(hspencer)"],"customfield_10116":null,"customfield_10117":null,"environment":null,"customfield_11800":null,"customfield_11802":null,"customfield_11805":null,"duedate":null,"customfield_11806":null,"progress":{"progress":0,"total":0},"votes":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/TOOLS-396/votes","votes":0,"hasVoted":false},"comment":{"comments":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/24927/comment/56816","id":"56816","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=hspencer","name":"hspencer","key":"hspencer","accountId":"557058:4a3a93bc-21f8-4658-9f5b-9cb484c910a7","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue"},"displayName":"Harold Spencer Jr.","active":true,"timeZone":"America/Los_Angeles"},"body":"It seems this bug happens when there is a large display returned regarding the policy information.  Its not limited by the number of policies that a resource has.  For example, these ran successfully:\r\n\r\n{code}\r\n# euare-userlistpolicies --as-account account1 -u user01 -v --pretty-print --region eucalyptus-admin@\r\nec2-iam-role-profile\r\n{\r\n    \"Statement\": [\r\n        {\r\n            \"Action\": \"ec2:*\",\r\n            \"Resource\": \"*\",\r\n            \"Effect\": \"Allow\",\r\n            \"Sid\": \"Stmt1381496061787\"\r\n        },\r\n        {\r\n            \"Action\": [\r\n                \"iam:AddRoleToInstanceProfile\",\r\n                \"iam:CreateInstanceProfile\",\r\n                \"iam:CreateRole\",\r\n                \"iam:DeleteInstanceProfile\",\r\n                \"iam:DeleteRole\",\r\n                \"iam:DeleteRolePolicy\",\r\n                \"iam:GetInstanceProfile\",\r\n                \"iam:GetRole\",\r\n                \"iam:GetRolePolicy\",\r\n                \"iam:ListInstanceProfiles\",\r\n                \"iam:ListInstanceProfilesForRole\",\r\n                \"iam:ListRolePolicies\",\r\n                \"iam:ListRoles\",\r\n                \"iam:PassRole\",\r\n                \"iam:PutRolePolicy\",\r\n                \"iam:RemoveRoleFromInstanceProfile\",\r\n                \"iam:UpdateAssumeRolePolicy\"\r\n            ],\r\n            \"Resource\": \"*\",\r\n            \"Effect\": \"Allow\",\r\n            \"Sid\": \"Stmt1381496190183\"\r\n        }\r\n    ]\r\n}\r\nIsTruncated: false\r\n\r\n# euare-userlistpolicies --as-account account1 -u user03 -v --pretty-print --region eucalyptus-admin@\r\nec2-all\r\n{\r\n    \"Statement\": [\r\n        {\r\n            \"Action\": \"ec2:*\",\r\n            \"Resource\": \"*\",\r\n            \"Effect\": \"Allow\",\r\n            \"Sid\": \"Stmt1381458319391\"\r\n        }\r\n    ]\r\n}\r\nautoscaling-all\r\n{\r\n    \"Statement\": [\r\n        {\r\n            \"Action\": \"autoscaling:*\",\r\n            \"Resource\": \"*\",\r\n            \"Effect\": \"Allow\",\r\n            \"Sid\": \"Stmt1381544192872\"\r\n        }\r\n    ]\r\n}\r\nIsTruncated: false\r\n{code}\r\n\r\n\r\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=hspencer","name":"hspencer","key":"hspencer","accountId":"557058:4a3a93bc-21f8-4658-9f5b-9cb484c910a7","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/ea43d7b9d5b27468a749f9bd25650176?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dhspencer%26avatarId%3D10407%26noRedirect%3Dtrue"},"displayName":"Harold Spencer Jr.","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-10-23T06:58:52.568-0500","updated":"2013-10-23T06:58:52.568-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/24927/comment/58342","id":"58342","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=gholms","name":"gholms","key":"gholms","accountId":"557058:6e5fdc25-c797-4d3d-8fd4-55c3c4ed99b0","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/3e16def22dd4a96dbe507df70f15f37f?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dgholms%26avatarId%3D18100%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/3e16def22dd4a96dbe507df70f15f37f?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dgholms%26avatarId%3D18100%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/3e16def22dd4a96dbe507df70f15f37f?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dgholms%26avatarId%3D18100%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/3e16def22dd4a96dbe507df70f15f37f?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dgholms%26avatarId%3D18100%26noRedirect%3Dtrue"},"displayName":"Garrett Holmstrom","active":true,"timeZone":"America/Los_Angeles"},"body":"You're running afoul of an obnoxious detail of the JSON specification.  Here is the policy you originally uploaded:\r\n\r\n{code:language=javascript}\r\n{\r\n  \"Statement\": [\r\n    {\r\n      \"Sid\": \"Stmt1381496061787\",\r\n      \"Action\": \"ec2:*\",\r\n      \"Effect\": \"Allow\",\r\n      \"Resource\": \"*\"\r\n    },\r\n    {\r\n      \"Sid\": \"Stmt1381496190183\",\r\n      \"Action\": [\r\n        \"iam:ListInstanceProfiles\",\r\n        \"iam:ListInstanceProfilesForRole\",\r\n        \"iam:ListRolePolicies\",\r\n        \"iam:ListRoles\",\r\n        \"iam:PassRole\",\r\n      ],\r\n      \"Effect\": \"Allow\",\r\n      \"Resource\": \"*\"\r\n    }\r\n  ]\r\n}\r\n{code}\r\n\r\nThe last item in the list of actions, {{iam:PassRole}}, has a trailing comma.  While ECMA5 allows trailing commas at the ends of lists, JSON does not, so when the {{\\--pretty-print}} option tells Python's JSON parser to read the policy so it can be reformatted, the failure you saw occurs.\r\n\r\nThe workarounds for this issue are to either replace policies that contain invalid JSON or avoid using {{\\--pretty-print}} with those policies.\r\n\r\nI can't realistically fix Python's JSON parser, but commit {{1dd9381}} (currently in the {{3.0-maint}} branch, and eventually in {{master}}) replaces the error message with a more descriptive one that indicates what is wrong:  \"policy $name does not appear to be valid JSON\".","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=gholms","name":"gholms","key":"gholms","accountId":"557058:6e5fdc25-c797-4d3d-8fd4-55c3c4ed99b0","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/3e16def22dd4a96dbe507df70f15f37f?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dgholms%26avatarId%3D18100%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/3e16def22dd4a96dbe507df70f15f37f?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dgholms%26avatarId%3D18100%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/3e16def22dd4a96dbe507df70f15f37f?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dgholms%26avatarId%3D18100%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/3e16def22dd4a96dbe507df70f15f37f?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dgholms%26avatarId%3D18100%26noRedirect%3Dtrue"},"displayName":"Garrett Holmstrom","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-11-15T18:10:13.576-0600","updated":"2013-11-15T18:10:13.576-0600"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/24927/comment/70703","id":"70703","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=ccassler","name":"ccassler","key":"ccassler","accountId":"557058:8fb32702-a3cf-42d3-9846-95c74f801354","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/ace94e80ebc0a3b718cc5422760b57de?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dccassler%26avatarId%3D14700%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/ace94e80ebc0a3b718cc5422760b57de?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dccassler%26avatarId%3D14700%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/ace94e80ebc0a3b718cc5422760b57de?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dccassler%26avatarId%3D14700%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/ace94e80ebc0a3b718cc5422760b57de?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dccassler%26avatarId%3D14700%26noRedirect%3Dtrue"},"displayName":"Casey Cassler","active":true,"timeZone":"America/Los_Angeles"},"body":"[~gholms]: I ran this command:  \"euare-userlistpolicies --as-account ccassler -u testuser1 -v --pretty-print --region eucalyptus-admin@\"\r\n\r\nAnd received the following output:\r\n\r\nPowerUserAccessPolicy-testuser1-20140502213750295\r\n{\r\n    \"Version\": \"2012-10-17\", \r\n    \"Statement\": [\r\n        {\r\n            \"NotAction\": \"iam:*\", \r\n            \"Resource\": \"*\", \r\n            \"Effect\": \"Allow\"\r\n        }\r\n    ]\r\n}\r\nIsTruncated: false","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=ccassler","name":"ccassler","key":"ccassler","accountId":"557058:8fb32702-a3cf-42d3-9846-95c74f801354","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/ace94e80ebc0a3b718cc5422760b57de?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dccassler%26avatarId%3D14700%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/ace94e80ebc0a3b718cc5422760b57de?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dccassler%26avatarId%3D14700%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/ace94e80ebc0a3b718cc5422760b57de?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dccassler%26avatarId%3D14700%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/ace94e80ebc0a3b718cc5422760b57de?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dccassler%26avatarId%3D14700%26noRedirect%3Dtrue"},"displayName":"Casey Cassler","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-05-20T02:49:53.429-0500","updated":"2014-05-20T02:49:53.429-0500"}],"maxResults":3,"total":3,"startAt":0},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_11808":null}}
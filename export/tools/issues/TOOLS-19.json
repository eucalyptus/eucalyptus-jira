{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"10830","self":"https://eucalyptus.atlassian.net/rest/api/2/issue/10830","key":"TOOLS-19","fields":{"issuetype":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://eucalyptus.atlassian.net/secure/viewavatar?size=xsmall&avatarId=14803&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":14803},"timespent":null,"customfield_13100":null,"project":{"self":"https://eucalyptus.atlassian.net/rest/api/2/project/10001","id":"10001","key":"TOOLS","name":"Euca2ools","avatarUrls":{"48x48":"https://eucalyptus.atlassian.net/secure/projectavatar?pid=10001&avatarId=10011","24x24":"https://eucalyptus.atlassian.net/secure/projectavatar?size=small&pid=10001&avatarId=10011","16x16":"https://eucalyptus.atlassian.net/secure/projectavatar?size=xsmall&pid=10001&avatarId=10011","32x32":"https://eucalyptus.atlassian.net/secure/projectavatar?size=medium&pid=10001&avatarId=10011"}},"customfield_11000":null,"fixVersions":[],"customfield_11001":null,"aggregatetimespent":null,"resolution":{"self":"https://eucalyptus.atlassian.net/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_10310":null,"customfield_11401":null,"customfield_11400":null,"customfield_10302":null,"customfield_10500":null,"customfield_10104":[],"customfield_10303":null,"customfield_10105":null,"customfield_10700":null,"customfield_10304":null,"customfield_10701":null,"customfield_10702":null,"customfield_10306":{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/10201","value":"Medium","id":"10201"},"customfield_10703":null,"resolutiondate":"2012-04-23T16:09:36.771-0500","customfield_10704":null,"customfield_10308":null,"customfield_10309":null,"customfield_10705":null,"workratio":-1,"watches":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/TOOLS-19/watchers","watchCount":2,"isWatching":false},"lastViewed":null,"created":"2012-04-23T16:08:45.406-0500","customfield_12000":null,"customfield_12400":null,"priority":{"self":"https://eucalyptus.atlassian.net/rest/api/2/priority/5","iconUrl":"https://eucalyptus.atlassian.net/images/icons/priorities/trivial.svg","name":"Trivial","id":"5"},"customfield_12201":null,"customfield_10300":null,"customfield_12600":"{}","customfield_10102":"RT-2458","labels":[],"customfield_10301":null,"customfield_11700":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_11901":null,"versions":[],"issuelinks":[],"assignee":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=gholms","name":"gholms","key":"gholms","accountId":"557058:6e5fdc25-c797-4d3d-8fd4-55c3c4ed99b0","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/3e16def22dd4a96dbe507df70f15f37f?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dgholms%26avatarId%3D18100%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/3e16def22dd4a96dbe507df70f15f37f?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dgholms%26avatarId%3D18100%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/3e16def22dd4a96dbe507df70f15f37f?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dgholms%26avatarId%3D18100%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/3e16def22dd4a96dbe507df70f15f37f?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dgholms%26avatarId%3D18100%26noRedirect%3Dtrue"},"displayName":"Garrett Holmstrom","active":true,"timeZone":"America/Los_Angeles"},"updated":"2012-05-23T22:32:30.111-0500","status":{"self":"https://eucalyptus.atlassian.net/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://eucalyptus.atlassian.net/images/icons/statuses/generic.png","name":"Closed","id":"6","statusCategory":{"self":"https://eucalyptus.atlassian.net/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[],"timeoriginalestimate":null,"description":"We need to think about how to implement retry in euca2ools/boto. With the\r\nreplay attach prevention, it does not make sense to retry the request after\r\nseeing a failure. Here is what I got: root@gushan:/opt/eucalyptus# euare-\r\nuseruploadpolicy --delegate test -u testuser -p testpolicy -f test2.policy\r\n--debug 2011-06-06 14:14:25,433 PutUserPolicy [DEBUG]:request_params:\r\n{'UserName': 'testuser', 'PolicyName': 'testpolicy', 'PolicyDocument': '{\\n\r\n\"Version\":\"2011-04-01\",\\n \"Statement\":[{\\n \"Sid\":\"1\",\\n \"Effect\":\"Allow\",\\n\r\n\"Action\":\"ec2:associateaddress\",\\n\r\n\"Resource\":\"arn:aws:ec2:::address/192.168.1.1\"\\n }]\\n}\\n', 'DelegateAccount':\r\n'test'} 2011-06-06 14:14:25,434 PutUserPolicy [DEBUG]:using _calc_signature_2\r\n2011-06-06 14:14:25,434 PutUserPolicy [DEBUG]:query string: AWSAccessKeyId=AOP\r\nF8LMMXIWYQLM4NZ0VE&Action;=PutUserPolicy&DelegateAccount;=test&PolicyDocument;\r\n=%7B%0A%20%20%22Version%22%3A%222011-04-01%22%2C%0A%20%20%22Statement%22%3A%5B\r\n%7B%0A%20%20%20%20%22Sid%22%3A%221%22%2C%0A%20%20%20%20%22Effect%22%3A%22Allow\r\n%22%2C%0A%20%20%20%20%22Action%22%3A%22ec2%3Aassociateaddress%22%2C%0A%20%20%2\r\n0%20%22Resource%22%3A%22arn%3Aaws%3Aec2%3A%3A%3Aaddress%2F192.168.1.1%22%0A%20\r\n%20%7D%5D%0A%7D%0A&PolicyName;=testpolicy&SignatureMethod;=HmacSHA256&Signatur\r\neVersion;=2&Timestamp;=2011-06-06T21%3A14%3A25Z&UserName;=testuser&Version;=20\r\n10-05-08 2011-06-06 14:14:25,434 PutUserPolicy [DEBUG]:string_to_sign: GET\r\ngushan.eucalyptus:8773 /services/Euare/ AWSAccessKeyId=AOPF8LMMXIWYQLM4NZ0VE&A\r\nction;=PutUserPolicy&DelegateAccount;=test&PolicyDocument;=%7B%0A%20%20%22Vers\r\nion%22%3A%222011-04-01%22%2C%0A%20%20%22Statement%22%3A%5B%7B%0A%20%20%20%20%2\r\n2Sid%22%3A%221%22%2C%0A%20%20%20%20%22Effect%22%3A%22Allow%22%2C%0A%20%20%20%2\r\n0%22Action%22%3A%22ec2%3Aassociateaddress%22%2C%0A%20%20%20%20%22Resource%22%3\r\nA%22arn%3Aaws%3Aec2%3A%3A%3Aaddress%2F192.168.1.1%22%0A%20%20%7D%5D%0A%7D%0A&P\r\nolicyName;=testpolicy&SignatureMethod;=HmacSHA256&SignatureVersion;=2&Timestam\r\np;=2011-06-06T21%3A14%3A25Z&UserName;=testuser&Version;=2010-05-08 2011-06-06\r\n14:14:25,434 PutUserPolicy [DEBUG]:len(b64)=44 2011-06-06 14:14:25,435\r\nPutUserPolicy [DEBUG]:base64 encoded digest:\r\n22tvnExeafRejR770cADvNcV3HymLY7StXPuEUEWDgk= 2011-06-06 14:14:25,435\r\nPutUserPolicy [DEBUG]:query_string: AWSAccessKeyId=AOPF8LMMXIWYQLM4NZ0VE&Actio\r\nn;=PutUserPolicy&DelegateAccount;=test&PolicyDocument;=%7B%0A%20%20%22Version%\r\n22%3A%222011-04-01%22%2C%0A%20%20%22Statement%22%3A%5B%7B%0A%20%20%20%20%22Sid\r\n%22%3A%221%22%2C%0A%20%20%20%20%22Effect%22%3A%22Allow%22%2C%0A%20%20%20%20%22\r\nAction%22%3A%22ec2%3Aassociateaddress%22%2C%0A%20%20%20%20%22Resource%22%3A%22\r\narn%3Aaws%3Aec2%3A%3A%3Aaddress%2F192.168.1.1%22%0A%20%20%7D%5D%0A%7D%0A&Polic\r\nyName;=testpolicy&SignatureMethod;=HmacSHA256&SignatureVersion;=2&Timestamp;=2\r\n011-06-06T21%3A14%3A25Z&UserName;=testuser&Version;=2010-05-08 Signature:\r\n22tvnExeafRejR770cADvNcV3HymLY7StXPuEUEWDgk= 2011-06-06 14:14:25,435\r\nPutUserPolicy [DEBUG]:Method: GET 2011-06-06 14:14:25,435 PutUserPolicy\r\n[DEBUG]:Path: /services/Euare/?AWSAccessKeyId=AOPF8LMMXIWYQLM4NZ0VE&Action;=Pu\r\ntUserPolicy&DelegateAccount;=test&PolicyDocument;=%7B%0A%20%20%22Version%22%3A\r\n%222011-04-01%22%2C%0A%20%20%22Statement%22%3A%5B%7B%0A%20%20%20%20%22Sid%22%3\r\nA%221%22%2C%0A%20%20%20%20%22Effect%22%3A%22Allow%22%2C%0A%20%20%20%20%22Actio\r\nn%22%3A%22ec2%3Aassociateaddress%22%2C%0A%20%20%20%20%22Resource%22%3A%22arn%3\r\nAaws%3Aec2%3A%3A%3Aaddress%2F192.168.1.1%22%0A%20%20%7D%5D%0A%7D%0A&PolicyName\r\n;=testpolicy&SignatureMethod;=HmacSHA256&SignatureVersion;=2&Timestamp;=2011-0\r\n6-06T21%3A14%3A25Z&UserName;=testuser&Version;=2010-05-08&Signature;=22tvnExea\r\nfRejR770cADvNcV3HymLY7StXPuEUEWDgk%3D 2011-06-06 14:14:25,435 PutUserPolicy\r\n[DEBUG]:Data: 2011-06-06 14:14:25,435 PutUserPolicy [DEBUG]:Headers:\r\n{'Content-Length': '0', 'User-Agent': 'Boto/2.0b5 (linux2)'} 2011-06-06\r\n14:14:25,435 PutUserPolicy [DEBUG]:Host: gushan.eucalyptus:8773 2011-06-06\r\n14:14:25,435 PutUserPolicy [DEBUG]:establishing HTTP connection: kwargs={}\r\nsend: 'GET /services/Euare/?AWSAccessKeyId=AOPF8LMMXIWYQLM4NZ0VE&Action;=PutUs\r\nerPolicy&DelegateAccount;=test&PolicyDocument;=%7B%0A%20%20%22Version%22%3A%22\r\n2011-04-01%22%2C%0A%20%20%22Statement%22%3A%5B%7B%0A%20%20%20%20%22Sid%22%3A%2\r\n21%22%2C%0A%20%20%20%20%22Effect%22%3A%22Allow%22%2C%0A%20%20%20%20%22Action%2\r\n2%3A%22ec2%3Aassociateaddress%22%2C%0A%20%20%20%20%22Resource%22%3A%22arn%3Aaw\r\ns%3Aec2%3A%3A%3Aaddress%2F192.168.1.1%22%0A%20%20%7D%5D%0A%7D%0A&PolicyName;=t\r\nestpolicy&SignatureMethod;=HmacSHA256&SignatureVersion;=2&Timestamp;=2011-06-0\r\n6T21%3A14%3A25Z&UserName;=testuser&Version;=2010-05-08&Signature;=22tvnExeafRe\r\njR770cADvNcV3HymLY7StXPuEUEWDgk%3D HTTP/1.1\\r\\nHost: gushan.eucalyptus:8773\\r\r\n\\nAccept-Encoding: identity\\r\\nContent-Length: 0\\r\\nUser-Agent: Boto/2.0b5\r\n(linux2)\\r\\n\\r\\n' reply: 'HTTP/1.1 500 Internal Server Error\\r\\n' header:\r\nContent-Length: 244 header: Content-Type: application/xml; charset=UTF-8\r\n2011-06-06 14:14:25,556 PutUserPolicy [DEBUG]:received 500 response, retrying\r\nin 1 seconds send: 'GET /services/Euare/?AWSAccessKeyId=AOPF8LMMXIWYQLM4NZ0VE&\r\nAction;=PutUserPolicy&DelegateAccount;=test&PolicyDocument;=%7B%0A%20%20%22Ver\r\nsion%22%3A%222011-04-01%22%2C%0A%20%20%22Statement%22%3A%5B%7B%0A%20%20%20%20%\r\n22Sid%22%3A%221%22%2C%0A%20%20%20%20%22Effect%22%3A%22Allow%22%2C%0A%20%20%20%\r\n20%22Action%22%3A%22ec2%3Aassociateaddress%22%2C%0A%20%20%20%20%22Resource%22%\r\n3A%22arn%3Aaws%3Aec2%3A%3A%3Aaddress%2F192.168.1.1%22%0A%20%20%7D%5D%0A%7D%0A&\r\nPolicyName;=testpolicy&SignatureMethod;=HmacSHA256&SignatureVersion;=2&Timesta\r\nmp;=2011-06-06T21%3A14%3A25Z&UserName;=testuser&Version;=2010-05-08&Signature;\r\n=22tvnExeafRejR770cADvNcV3HymLY7StXPuEUEWDgk%3D HTTP/1.1\\r\\nHost:\r\ngushan.eucalyptus:8773\\r\\nAccept-Encoding: identity\\r\\nContent-Length: 0\\r\r\n\\nUser-Agent: Boto/2.0b5 (linux2)\\r\\n\\r\\n' reply: 'HTTP/1.1 403 Forbidden\\r\\n'\r\nheader: Content-Type: text/plain; charset=UTF-8 2011-06-06 14:14:26,566\r\nPutUserPolicy [DEBUG]:Failure: 403 Forbidden Message replay detected. Same\r\nsignature was used within the last 5 minutes 2011-06-06 14:14:26,566\r\nPutUserPolicy [ERROR]:403 Forbidden 2011-06-06 14:14:26,566 PutUserPolicy\r\n[ERROR]:Failure: 403 Forbidden Message replay detected. Same signature was\r\nused within the last 5 minutes Warning: failed to parse error message from\r\nAWS: :1:0: syntax error Error(None): None\r\n\r\n","customfield_13000":null,"customfield_13200":null,"customfield_11300":null,"customfield_11500":null,"timetracking":{},"customfield_10401":null,"customfield_10005":null,"customfield_10600":null,"customfield_12900":null,"attachment":[],"aggregatetimeestimate":null,"summary":"euca2ools retry in conflict with replay attack prevention","creator":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"subtasks":[],"reporter":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=wenye","name":"wenye","key":"wenye","accountId":"557058:410304ee-1904-4d8c-8ca1-b1148436b5a6","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/b87135ce3de714cf85240f6d40638792?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FavatarId%3D10122%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/b87135ce3de714cf85240f6d40638792?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26avatarId%3D10122%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/b87135ce3de714cf85240f6d40638792?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26avatarId%3D10122%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/b87135ce3de714cf85240f6d40638792?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26avatarId%3D10122%26noRedirect%3Dtrue"},"displayName":"Ye Wen","active":false,"timeZone":"America/Los_Angeles"},"customfield_10000":"1_*:*_1_*:*_51377_*|*_5_*:*_1_*:*_0","aggregateprogress":{"progress":0,"total":0},"customfield_12100":"0|i01173:","customfield_10001":"2012-04-23T16:08:50.122-0500","customfield_10002":null,"customfield_10200":51.0,"customfield_10003":null,"customfield_10400":null,"customfield_12500":null,"customfield_10116":null,"customfield_11600":["agrimm(agrimm)","dkavanagh(dkavanagh)","gholms(gholms)","rusvika(rusvika)","wenye(wenye)"],"customfield_10117":null,"environment":null,"customfield_11800":null,"customfield_11802":null,"duedate":null,"customfield_11805":null,"customfield_11806":null,"progress":{"progress":0,"total":0},"votes":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/TOOLS-19/votes","votes":0,"hasVoted":false},"comment":{"comments":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/10830/comment/14022","id":"14022","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"body":"Originally posted on 2011-06-06 21:18:55 by wenye\n\nMon Jun 06 14:18:54 2011: Request 2458 was acted upon.\n Transaction: Ticket created by wen.ye\n       Queue: Engineering Bugs\n     Subject: euca2ools retry in conflict with replay attach prevention\n       Owner: Nobody\n  Requestors: wenye@eucalyptus.com\n      Status: new\n Ticket <URL: http://support.eucalyptus.com/Ticket/Display.html?id=2458 >\n\n\nWe need to think about how to implement retry in euca2ools/boto. With the replay attach prevention, it does not make sense to retry the request after seeing a failure. Here is what I got:\n\nroot@gushan:/opt/eucalyptus# euare-useruploadpolicy --delegate test -u testuser -p testpolicy -f test2.policy --debug\n2011-06-06 14:14:25,433 PutUserPolicy [DEBUG]:request_params: {'UserName': 'testuser', 'PolicyName': 'testpolicy', 'PolicyDocument': '{\\n  \"Version\":\"2011-04-01\",\\n  \"Statement\":[{\\n    \"Sid\":\"1\",\\n    \"Effect\":\"Allow\",\\n    \"Action\":\"ec2:associateaddress\",\\n    \"Resource\":\"arn:aws:ec2:::address/192.168.1.1\"\\n  }]\\n}\\n', 'DelegateAccount': 'test'}\n2011-06-06 14:14:25,434 PutUserPolicy [DEBUG]:using _calc_signature_2\n2011-06-06 14:14:25,434 PutUserPolicy [DEBUG]:query string: AWSAccessKeyId=AOPF8LMMXIWYQLM4NZ0VE&Action=PutUserPolicy&DelegateAccount=test&PolicyDocument=%7B%0A%20%20%22Version%22%3A%222011-04-01%22%2C%0A%20%20%22Statement%22%3A%5B%7B%0A%20%20%20%20%22Sid%22%3A%221%22%2C%0A%20%20%20%20%22Effect%22%3A%22Allow%22%2C%0A%20%20%20%20%22Action%22%3A%22ec2%3Aassociateaddress%22%2C%0A%20%20%20%20%22Resource%22%3A%22arn%3Aaws%3Aec2%3A%3A%3Aaddress%2F192.168.1.1%22%0A%20%20%7D%5D%0A%7D%0A&PolicyName=testpolicy&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2011-06-06T21%3A14%3A25Z&UserName=testuser&Version=2010-05-08\n2011-06-06 14:14:25,434 PutUserPolicy [DEBUG]:string_to_sign: GET\ngushan.eucalyptus:8773\n/services/Euare/\nAWSAccessKeyId=AOPF8LMMXIWYQLM4NZ0VE&Action=PutUserPolicy&DelegateAccount=test&PolicyDocument=%7B%0A%20%20%22Version%22%3A%222011-04-01%22%2C%0A%20%20%22Statement%22%3A%5B%7B%0A%20%20%20%20%22Sid%22%3A%221%22%2C%0A%20%20%20%20%22Effect%22%3A%22Allow%22%2C%0A%20%20%20%20%22Action%22%3A%22ec2%3Aassociateaddress%22%2C%0A%20%20%20%20%22Resource%22%3A%22arn%3Aaws%3Aec2%3A%3A%3Aaddress%2F192.168.1.1%22%0A%20%20%7D%5D%0A%7D%0A&PolicyName=testpolicy&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2011-06-06T21%3A14%3A25Z&UserName=testuser&Version=2010-05-08\n2011-06-06 14:14:25,434 PutUserPolicy [DEBUG]:len(b64)=44\n2011-06-06 14:14:25,435 PutUserPolicy [DEBUG]:base64 encoded digest: 22tvnExeafRejR770cADvNcV3HymLY7StXPuEUEWDgk=\n2011-06-06 14:14:25,435 PutUserPolicy [DEBUG]:query_string: AWSAccessKeyId=AOPF8LMMXIWYQLM4NZ0VE&Action=PutUserPolicy&DelegateAccount=test&PolicyDocument=%7B%0A%20%20%22Version%22%3A%222011-04-01%22%2C%0A%20%20%22Statement%22%3A%5B%7B%0A%20%20%20%20%22Sid%22%3A%221%22%2C%0A%20%20%20%20%22Effect%22%3A%22Allow%22%2C%0A%20%20%20%20%22Action%22%3A%22ec2%3Aassociateaddress%22%2C%0A%20%20%20%20%22Resource%22%3A%22arn%3Aaws%3Aec2%3A%3A%3Aaddress%2F192.168.1.1%22%0A%20%20%7D%5D%0A%7D%0A&PolicyName=testpolicy&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2011-06-06T21%3A14%3A25Z&UserName=testuser&Version=2010-05-08 Signature: 22tvnExeafRejR770cADvNcV3HymLY7StXPuEUEWDgk=\n2011-06-06 14:14:25,435 PutUserPolicy [DEBUG]:Method: GET\n2011-06-06 14:14:25,435 PutUserPolicy [DEBUG]:Path: /services/Euare/?AWSAccessKeyId=AOPF8LMMXIWYQLM4NZ0VE&Action=PutUserPolicy&DelegateAccount=test&PolicyDocument=%7B%0A%20%20%22Version%22%3A%222011-04-01%22%2C%0A%20%20%22Statement%22%3A%5B%7B%0A%20%20%20%20%22Sid%22%3A%221%22%2C%0A%20%20%20%20%22Effect%22%3A%22Allow%22%2C%0A%20%20%20%20%22Action%22%3A%22ec2%3Aassociateaddress%22%2C%0A%20%20%20%20%22Resource%22%3A%22arn%3Aaws%3Aec2%3A%3A%3Aaddress%2F192.168.1.1%22%0A%20%20%7D%5D%0A%7D%0A&PolicyName=testpolicy&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2011-06-06T21%3A14%3A25Z&UserName=testuser&Version=2010-05-08&Signature=22tvnExeafRejR770cADvNcV3HymLY7StXPuEUEWDgk%3D\n2011-06-06 14:14:25,435 PutUserPolicy [DEBUG]:Data: \n2011-06-06 14:14:25,435 PutUserPolicy [DEBUG]:Headers: {'Content-Length': '0', 'User-Agent': 'Boto/2.0b5 (linux2)'}\n2011-06-06 14:14:25,435 PutUserPolicy [DEBUG]:Host: gushan.eucalyptus:8773\n2011-06-06 14:14:25,435 PutUserPolicy [DEBUG]:establishing HTTP connection: kwargs={}\nsend: 'GET /services/Euare/?AWSAccessKeyId=AOPF8LMMXIWYQLM4NZ0VE&Action=PutUserPolicy&DelegateAccount=test&PolicyDocument=%7B%0A%20%20%22Version%22%3A%222011-04-01%22%2C%0A%20%20%22Statement%22%3A%5B%7B%0A%20%20%20%20%22Sid%22%3A%221%22%2C%0A%20%20%20%20%22Effect%22%3A%22Allow%22%2C%0A%20%20%20%20%22Action%22%3A%22ec2%3Aassociateaddress%22%2C%0A%20%20%20%20%22Resource%22%3A%22arn%3Aaws%3Aec2%3A%3A%3Aaddress%2F192.168.1.1%22%0A%20%20%7D%5D%0A%7D%0A&PolicyName=testpolicy&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2011-06-06T21%3A14%3A25Z&UserName=testuser&Version=2010-05-08&Signature=22tvnExeafRejR770cADvNcV3HymLY7StXPuEUEWDgk%3D HTTP/1.1\\r\\nHost: gushan.eucalyptus:8773\\r\\nAccept-Encoding: identity\\r\\nContent-Length: 0\\r\\nUser-Agent: Boto/2.0b5 (linux2)\\r\\n\\r\\n'\nreply: 'HTTP/1.1 500 Internal Server Error\\r\\n'\nheader: Content-Length: 244\nheader: Content-Type: application/xml; charset=UTF-8\n2011-06-06 14:14:25,556 PutUserPolicy [DEBUG]:received 500 response, retrying in 1 seconds\nsend: 'GET /services/Euare/?AWSAccessKeyId=AOPF8LMMXIWYQLM4NZ0VE&Action=PutUserPolicy&DelegateAccount=test&PolicyDocument=%7B%0A%20%20%22Version%22%3A%222011-04-01%22%2C%0A%20%20%22Statement%22%3A%5B%7B%0A%20%20%20%20%22Sid%22%3A%221%22%2C%0A%20%20%20%20%22Effect%22%3A%22Allow%22%2C%0A%20%20%20%20%22Action%22%3A%22ec2%3Aassociateaddress%22%2C%0A%20%20%20%20%22Resource%22%3A%22arn%3Aaws%3Aec2%3A%3A%3Aaddress%2F192.168.1.1%22%0A%20%20%7D%5D%0A%7D%0A&PolicyName=testpolicy&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2011-06-06T21%3A14%3A25Z&UserName=testuser&Version=2010-05-08&Signature=22tvnExeafRejR770cADvNcV3HymLY7StXPuEUEWDgk%3D HTTP/1.1\\r\\nHost: gushan.eucalyptus:8773\\r\\nAccept-Encoding: identity\\r\\nContent-Length: 0\\r\\nUser-Agent: Boto/2.0b5 (linux2)\\r\\n\\r\\n'\nreply: 'HTTP/1.1 403 Forbidden\\r\\n'\nheader: Content-Type: text/plain; charset=UTF-8\n2011-06-06 14:14:26,566 PutUserPolicy [DEBUG]:Failure: 403 Forbidden\nMessage replay detected.  Same signature was used within the last 5 minutes\n2011-06-06 14:14:26,566 PutUserPolicy [ERROR]:403 Forbidden\n2011-06-06 14:14:26,566 PutUserPolicy [ERROR]:Failure: 403 Forbidden\nMessage replay detected.  Same signature was used within the last 5 minutes\nWarning: failed to parse error message from AWS: <unknown>:1:0: syntax error\nError(None): None\n\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"created":"2012-04-23T16:08:50.122-0500","updated":"2012-04-23T16:08:50.122-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/10830/comment/14023","id":"14023","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"body":"Originally posted on 2011-06-06 21:20:57 by wenye\nSorry. I mean \"attack\" not \"attach\"\n\n  \nOn Mon Jun 06 14:18:54 2011, wen.ye wrote:\n\n> We need to think about how to implement retry in euca2ools/boto. With\n\n> the replay attach prevention, it does not make sense to retry the\n\n> request after seeing a failure. Here is what I got:\n\n>\n\n> root@gushan:/opt/eucalyptus# euare-useruploadpolicy --delegate test -u\n\n> testuser -p testpolicy -f test2.policy --debug\n\n> 2011-06-06 14:14:25,433 PutUserPolicy [DEBUG]:request_params:\n\n> {'UserName': 'testuser', 'PolicyName': 'testpolicy',\n\n> 'PolicyDocument': '{\\n \"Version\":\"2011-04-01\",\\n \"Statement\":[{\\n\n\n> \"Sid\":\"1\",\\n \"Effect\":\"Allow\",\\n\n\n> \"Action\":\"ec2:associateaddress\",\\n\n\n> \"Resource\":\"arn:aws:ec2:::address/192.168.1.1\"\\n }]\\n}\\n',\n\n> 'DelegateAccount': 'test'}\n\n> 2011-06-06 14:14:25,434 PutUserPolicy [DEBUG]:using _calc_signature_2\n\n> 2011-06-06 14:14:25,434 PutUserPolicy [DEBUG]:query string:\n\n> AWSAccessKeyId=AOPF8LMMXIWYQLM4NZ0VE&Action=PutUserPolicy&DelegateAccount=te\nst&PolicyDocument=%7B%0A%20%20%22Version%22%3A%222011-\n\n> 04-\n\n> 01%22%2C%0A%20%20%22Statement%22%3A%5B%7B%0A%20%20%20%20%22Sid%22%3A%221%22%\n2C%0A%20%20%20%20%22Effect%22%3A%22Allow%22%2C%0A%20%20%20%20%22Action%22%3A%2\n2ec2%3Aassociateaddress%22%2C%0A%20%20%20%20%22Resource%22%3A%22arn%3Aaws%3Aec\n2%3A%3A%3Aaddress%2F192.168.1.1%22%0A%20%20%7D%5D%0A%7D%0A&PolicyName=testpoli\ncy&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2011-\n\n> 06-06T21%3A14%3A25Z&UserName=testuser&Version=2010-05-08\n\n> 2011-06-06 14:14:25,434 PutUserPolicy [DEBUG]:string_to_sign: GET\n\n> gushan.eucalyptus:8773\n\n> /services/Euare/\n\n> AWSAccessKeyId=AOPF8LMMXIWYQLM4NZ0VE&Action=PutUserPolicy&DelegateAccount=te\nst&PolicyDocument=%7B%0A%20%20%22Version%22%3A%222011-\n\n> 04-\n\n> 01%22%2C%0A%20%20%22Statement%22%3A%5B%7B%0A%20%20%20%20%22Sid%22%3A%221%22%\n2C%0A%20%20%20%20%22Effect%22%3A%22Allow%22%2C%0A%20%20%20%20%22Action%22%3A%2\n2ec2%3Aassociateaddress%22%2C%0A%20%20%20%20%22Resource%22%3A%22arn%3Aaws%3Aec\n2%3A%3A%3Aaddress%2F192.168.1.1%22%0A%20%20%7D%5D%0A%7D%0A&PolicyName=testpoli\ncy&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2011-\n\n> 06-06T21%3A14%3A25Z&UserName=testuser&Version=2010-05-08\n\n> 2011-06-06 14:14:25,434 PutUserPolicy [DEBUG]:len(b64)=44\n\n> 2011-06-06 14:14:25,435 PutUserPolicy [DEBUG]:base64 encoded digest:\n\n> 22tvnExeafRejR770cADvNcV3HymLY7StXPuEUEWDgk=\n\n> 2011-06-06 14:14:25,435 PutUserPolicy [DEBUG]:query_string:\n\n> AWSAccessKeyId=AOPF8LMMXIWYQLM4NZ0VE&Action=PutUserPolicy&DelegateAccount=te\nst&PolicyDocument=%7B%0A%20%20%22Version%22%3A%222011-\n\n> 04-\n\n> 01%22%2C%0A%20%20%22Statement%22%3A%5B%7B%0A%20%20%20%20%22Sid%22%3A%221%22%\n2C%0A%20%20%20%20%22Effect%22%3A%22Allow%22%2C%0A%20%20%20%20%22Action%22%3A%2\n2ec2%3Aassociateaddress%22%2C%0A%20%20%20%20%22Resource%22%3A%22arn%3Aaws%3Aec\n2%3A%3A%3Aaddress%2F192.168.1.1%22%0A%20%20%7D%5D%0A%7D%0A&PolicyName=testpoli\ncy&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2011-\n\n> 06-06T21%3A14%3A25Z&UserName=testuser&Version=2010-05-08 Signature:\n\n> 22tvnExeafRejR770cADvNcV3HymLY7StXPuEUEWDgk=\n\n> 2011-06-06 14:14:25,435 PutUserPolicy [DEBUG]:Method: GET\n\n> 2011-06-06 14:14:25,435 PutUserPolicy [DEBUG]:Path:\n\n> /services/Euare/?AWSAccessKeyId=AOPF8LMMXIWYQLM4NZ0VE&Action=PutUserPolicy&D\nelegateAccount=test&PolicyDocument=%7B%0A%20%20%22Version%22%3A%222011-\n\n> 04-\n\n> 01%22%2C%0A%20%20%22Statement%22%3A%5B%7B%0A%20%20%20%20%22Sid%22%3A%221%22%\n2C%0A%20%20%20%20%22Effect%22%3A%22Allow%22%2C%0A%20%20%20%20%22Action%22%3A%2\n2ec2%3Aassociateaddress%22%2C%0A%20%20%20%20%22Resource%22%3A%22arn%3Aaws%3Aec\n2%3A%3A%3Aaddress%2F192.168.1.1%22%0A%20%20%7D%5D%0A%7D%0A&PolicyName=testpoli\ncy&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2011-\n\n> 06-06T21%3A14%3A25Z&UserName=testuser&Version=2010-05-\n\n> 08&Signature=22tvnExeafRejR770cADvNcV3HymLY7StXPuEUEWDgk%3D\n\n> 2011-06-06 14:14:25,435 PutUserPolicy [DEBUG]:Data:\n\n> 2011-06-06 14:14:25,435 PutUserPolicy [DEBUG]:Headers: {'Content-\n\n> Length': '0', 'User-Agent': 'Boto/2.0b5 (linux2)'}\n\n> 2011-06-06 14:14:25,435 PutUserPolicy [DEBUG]:Host:\n\n> gushan.eucalyptus:8773\n\n> 2011-06-06 14:14:25,435 PutUserPolicy [DEBUG]:establishing HTTP\n\n> connection: kwargs={}\n\n> send: 'GET\n\n> /services/Euare/?AWSAccessKeyId=AOPF8LMMXIWYQLM4NZ0VE&Action=PutUserPolicy&D\nelegateAccount=test&PolicyDocument=%7B%0A%20%20%22Version%22%3A%222011-\n\n> 04-\n\n> 01%22%2C%0A%20%20%22Statement%22%3A%5B%7B%0A%20%20%20%20%22Sid%22%3A%221%22%\n2C%0A%20%20%20%20%22Effect%22%3A%22Allow%22%2C%0A%20%20%20%20%22Action%22%3A%2\n2ec2%3Aassociateaddress%22%2C%0A%20%20%20%20%22Resource%22%3A%22arn%3Aaws%3Aec\n2%3A%3A%3Aaddress%2F192.168.1.1%22%0A%20%20%7D%5D%0A%7D%0A&PolicyName=testpoli\ncy&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2011-\n\n> 06-06T21%3A14%3A25Z&UserName=testuser&Version=2010-05-\n\n> 08&Signature=22tvnExeafRejR770cADvNcV3HymLY7StXPuEUEWDgk%3D\n\n> HTTP/1.1\\r\\nHost: gushan.eucalyptus:8773\\r\\nAccept-Encoding:\n\n> identity\\r\\nContent-Length: 0\\r\\nUser-Agent: Boto/2.0b5\n\n> (linux2)\\r\\n\\r\\n'\n\n> reply: 'HTTP/1.1 500 Internal Server Error\\r\\n'\n\n> header: Content-Length: 244\n\n> header: Content-Type: application/xml; charset=UTF-8\n\n> 2011-06-06 14:14:25,556 PutUserPolicy [DEBUG]:received 500 response,\n\n> retrying in 1 seconds\n\n> send: 'GET\n\n> /services/Euare/?AWSAccessKeyId=AOPF8LMMXIWYQLM4NZ0VE&Action=PutUserPolicy&D\nelegateAccount=test&PolicyDocument=%7B%0A%20%20%22Version%22%3A%222011-\n\n> 04-\n\n> 01%22%2C%0A%20%20%22Statement%22%3A%5B%7B%0A%20%20%20%20%22Sid%22%3A%221%22%\n2C%0A%20%20%20%20%22Effect%22%3A%22Allow%22%2C%0A%20%20%20%20%22Action%22%3A%2\n2ec2%3Aassociateaddress%22%2C%0A%20%20%20%20%22Resource%22%3A%22arn%3Aaws%3Aec\n2%3A%3A%3Aaddress%2F192.168.1.1%22%0A%20%20%7D%5D%0A%7D%0A&PolicyName=testpoli\ncy&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2011-\n\n> 06-06T21%3A14%3A25Z&UserName=testuser&Version=2010-05-\n\n> 08&Signature=22tvnExeafRejR770cADvNcV3HymLY7StXPuEUEWDgk%3D\n\n> HTTP/1.1\\r\\nHost: gushan.eucalyptus:8773\\r\\nAccept-Encoding:\n\n> identity\\r\\nContent-Length: 0\\r\\nUser-Agent: Boto/2.0b5\n\n> (linux2)\\r\\n\\r\\n'\n\n> reply: 'HTTP/1.1 403 Forbidden\\r\\n'\n\n> header: Content-Type: text/plain; charset=UTF-8\n\n> 2011-06-06 14:14:26,566 PutUserPolicy [DEBUG]:Failure: 403 Forbidden\n\n> Message replay detected. Same signature was used within the last 5\n\n> minutes\n\n> 2011-06-06 14:14:26,566 PutUserPolicy [ERROR]:403 Forbidden\n\n> 2011-06-06 14:14:26,566 PutUserPolicy [ERROR]:Failure: 403 Forbidden\n\n> Message replay detected. Same signature was used within the last 5\n\n> minutes\n\n> Warning: failed to parse error message from AWS: <unknown>:1:0: syntax\n\n> error\n\n> Error(None): None\n\n  \n  \n\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"created":"2012-04-23T16:08:50.724-0500","updated":"2012-04-23T16:08:50.724-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/10830/comment/14024","id":"14024","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"body":"Originally posted on 2011-06-06 21:20:58 by wenye\n\n<URL: http://support.eucalyptus.com/Ticket/Display.html?id=2458 >\n\nSorry. I mean \"attack\" not \"attach\"\n\nOn Mon Jun 06 14:18:54 2011, wen.ye wrote:\n> We need to think about how to implement retry in euca2ools/boto. With\n> the replay attach prevention, it does not make sense to retry the\n> request after seeing a failure. Here is what I got:\n>\n> root@gushan:/opt/eucalyptus# euare-useruploadpolicy --delegate test -u\n> testuser -p testpolicy -f test2.policy --debug\n> 2011-06-06 14:14:25,433 PutUserPolicy [DEBUG]:request_params:\n> {'UserName': 'testuser', 'PolicyName': 'testpolicy',\n> 'PolicyDocument': '{\\n \"Version\":\"2011-04-01\",\\n \"Statement\":[{\\n\n> \"Sid\":\"1\",\\n \"Effect\":\"Allow\",\\n\n> \"Action\":\"ec2:associateaddress\",\\n\n> \"Resource\":\"arn:aws:ec2:::address/192.168.1.1\"\\n }]\\n}\\n',\n> 'DelegateAccount': 'test'}\n> 2011-06-06 14:14:25,434 PutUserPolicy [DEBUG]:using _calc_signature_2\n> 2011-06-06 14:14:25,434 PutUserPolicy [DEBUG]:query string:\n>\nAWSAccessKeyId=AOPF8LMMXIWYQLM4NZ0VE&Action=PutUserPolicy&DelegateAccount=test&PolicyDocument=%7B%0A%20%20%22Version%22%3A%222011-\n> 04-\n>\n01%22%2C%0A%20%20%22Statement%22%3A%5B%7B%0A%20%20%20%20%22Sid%22%3A%221%22%2C%0A%20%20%20%20%22Effect%22%3A%22Allow%22%2C%0A%20%20%20%20%22Action%22%3A%22ec2%3Aassociateaddress%22%2C%0A%20%20%20%20%22Resource%22%3A%22arn%3Aaws%3Aec2%3A%3A%3Aaddress%2F192.168.1.1%22%0A%20%20%7D%5D%0A%7D%0A&PolicyName=testpolicy&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2011-\n> 06-06T21%3A14%3A25Z&UserName=testuser&Version=2010-05-08\n> 2011-06-06 14:14:25,434 PutUserPolicy [DEBUG]:string_to_sign: GET\n> gushan.eucalyptus:8773\n> /services/Euare/\n>\nAWSAccessKeyId=AOPF8LMMXIWYQLM4NZ0VE&Action=PutUserPolicy&DelegateAccount=test&PolicyDocument=%7B%0A%20%20%22Version%22%3A%222011-\n> 04-\n>\n01%22%2C%0A%20%20%22Statement%22%3A%5B%7B%0A%20%20%20%20%22Sid%22%3A%221%22%2C%0A%20%20%20%20%22Effect%22%3A%22Allow%22%2C%0A%20%20%20%20%22Action%22%3A%22ec2%3Aassociateaddress%22%2C%0A%20%20%20%20%22Resource%22%3A%22arn%3Aaws%3Aec2%3A%3A%3Aaddress%2F192.168.1.1%22%0A%20%20%7D%5D%0A%7D%0A&PolicyName=testpolicy&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2011-\n> 06-06T21%3A14%3A25Z&UserName=testuser&Version=2010-05-08\n> 2011-06-06 14:14:25,434 PutUserPolicy [DEBUG]:len(b64)=44\n> 2011-06-06 14:14:25,435 PutUserPolicy [DEBUG]:base64 encoded digest:\n> 22tvnExeafRejR770cADvNcV3HymLY7StXPuEUEWDgk=\n> 2011-06-06 14:14:25,435 PutUserPolicy [DEBUG]:query_string:\n>\nAWSAccessKeyId=AOPF8LMMXIWYQLM4NZ0VE&Action=PutUserPolicy&DelegateAccount=test&PolicyDocument=%7B%0A%20%20%22Version%22%3A%222011-\n> 04-\n>\n01%22%2C%0A%20%20%22Statement%22%3A%5B%7B%0A%20%20%20%20%22Sid%22%3A%221%22%2C%0A%20%20%20%20%22Effect%22%3A%22Allow%22%2C%0A%20%20%20%20%22Action%22%3A%22ec2%3Aassociateaddress%22%2C%0A%20%20%20%20%22Resource%22%3A%22arn%3Aaws%3Aec2%3A%3A%3Aaddress%2F192.168.1.1%22%0A%20%20%7D%5D%0A%7D%0A&PolicyName=testpolicy&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2011-\n> 06-06T21%3A14%3A25Z&UserName=testuser&Version=2010-05-08 Signature:\n> 22tvnExeafRejR770cADvNcV3HymLY7StXPuEUEWDgk=\n> 2011-06-06 14:14:25,435 PutUserPolicy [DEBUG]:Method: GET\n> 2011-06-06 14:14:25,435 PutUserPolicy [DEBUG]:Path:\n>\n/services/Euare/?AWSAccessKeyId=AOPF8LMMXIWYQLM4NZ0VE&Action=PutUserPolicy&DelegateAccount=test&PolicyDocument=%7B%0A%20%20%22Version%22%3A%222011-\n> 04-\n>\n01%22%2C%0A%20%20%22Statement%22%3A%5B%7B%0A%20%20%20%20%22Sid%22%3A%221%22%2C%0A%20%20%20%20%22Effect%22%3A%22Allow%22%2C%0A%20%20%20%20%22Action%22%3A%22ec2%3Aassociateaddress%22%2C%0A%20%20%20%20%22Resource%22%3A%22arn%3Aaws%3Aec2%3A%3A%3Aaddress%2F192.168.1.1%22%0A%20%20%7D%5D%0A%7D%0A&PolicyName=testpolicy&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2011-\n> 06-06T21%3A14%3A25Z&UserName=testuser&Version=2010-05-\n> 08&Signature=22tvnExeafRejR770cADvNcV3HymLY7StXPuEUEWDgk%3D\n> 2011-06-06 14:14:25,435 PutUserPolicy [DEBUG]:Data:\n> 2011-06-06 14:14:25,435 PutUserPolicy [DEBUG]:Headers: {'Content-\n> Length': '0', 'User-Agent': 'Boto/2.0b5 (linux2)'}\n> 2011-06-06 14:14:25,435 PutUserPolicy [DEBUG]:Host:\n> gushan.eucalyptus:8773\n> 2011-06-06 14:14:25,435 PutUserPolicy [DEBUG]:establishing HTTP\n> connection: kwargs={}\n> send: 'GET\n>\n/services/Euare/?AWSAccessKeyId=AOPF8LMMXIWYQLM4NZ0VE&Action=PutUserPolicy&DelegateAccount=test&PolicyDocument=%7B%0A%20%20%22Version%22%3A%222011-\n> 04-\n>\n01%22%2C%0A%20%20%22Statement%22%3A%5B%7B%0A%20%20%20%20%22Sid%22%3A%221%22%2C%0A%20%20%20%20%22Effect%22%3A%22Allow%22%2C%0A%20%20%20%20%22Action%22%3A%22ec2%3Aassociateaddress%22%2C%0A%20%20%20%20%22Resource%22%3A%22arn%3Aaws%3Aec2%3A%3A%3Aaddress%2F192.168.1.1%22%0A%20%20%7D%5D%0A%7D%0A&PolicyName=testpolicy&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2011-\n> 06-06T21%3A14%3A25Z&UserName=testuser&Version=2010-05-\n> 08&Signature=22tvnExeafRejR770cADvNcV3HymLY7StXPuEUEWDgk%3D\n> HTTP/1.1\\r\\nHost: gushan.eucalyptus:8773\\r\\nAccept-Encoding:\n> identity\\r\\nContent-Length: 0\\r\\nUser-Agent: Boto/2.0b5\n> (linux2)\\r\\n\\r\\n'\n> reply: 'HTTP/1.1 500 Internal Server Error\\r\\n'\n> header: Content-Length: 244\n> header: Content-Type: application/xml; charset=UTF-8\n> 2011-06-06 14:14:25,556 PutUserPolicy [DEBUG]:received 500 response,\n> retrying in 1 seconds\n> send: 'GET\n>\n/services/Euare/?AWSAccessKeyId=AOPF8LMMXIWYQLM4NZ0VE&Action=PutUserPolicy&DelegateAccount=test&PolicyDocument=%7B%0A%20%20%22Version%22%3A%222011-\n> 04-\n>\n01%22%2C%0A%20%20%22Statement%22%3A%5B%7B%0A%20%20%20%20%22Sid%22%3A%221%22%2C%0A%20%20%20%20%22Effect%22%3A%22Allow%22%2C%0A%20%20%20%20%22Action%22%3A%22ec2%3Aassociateaddress%22%2C%0A%20%20%20%20%22Resource%22%3A%22arn%3Aaws%3Aec2%3A%3A%3Aaddress%2F192.168.1.1%22%0A%20%20%7D%5D%0A%7D%0A&PolicyName=testpolicy&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2011-\n> 06-06T21%3A14%3A25Z&UserName=testuser&Version=2010-05-\n> 08&Signature=22tvnExeafRejR770cADvNcV3HymLY7StXPuEUEWDgk%3D\n> HTTP/1.1\\r\\nHost: gushan.eucalyptus:8773\\r\\nAccept-Encoding:\n> identity\\r\\nContent-Length: 0\\r\\nUser-Agent: Boto/2.0b5\n> (linux2)\\r\\n\\r\\n'\n> reply: 'HTTP/1.1 403 Forbidden\\r\\n'\n> header: Content-Type: text/plain; charset=UTF-8\n> 2011-06-06 14:14:26,566 PutUserPolicy [DEBUG]:Failure: 403 Forbidden\n> Message replay detected. Same signature was used within the last 5\n> minutes\n> 2011-06-06 14:14:26,566 PutUserPolicy [ERROR]:403 Forbidden\n> 2011-06-06 14:14:26,566 PutUserPolicy [ERROR]:Failure: 403 Forbidden\n> Message replay detected. Same signature was used within the last 5\n> minutes\n> Warning: failed to parse error message from AWS: <unknown>:1:0: syntax\n> error\n> Error(None): None\n\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"created":"2012-04-23T16:08:51.246-0500","updated":"2012-04-23T16:08:51.246-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/10830/comment/14025","id":"14025","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"body":"Originally posted on 2011-06-06 21:28:53 by admin\nSeems like there are a couple of options, at least.\n\n  \nFirst, I wonder if it's possible for the retry mechanism to ignore requests\nthat fail with a 500 error.  If those could be ignored, then the retry from\nboto would not trigger the replay prevention.\n\n  \nSecond, I could modify boto to resign each retry.  It doesn't do this at the\nmoment and AWS doesn't require it although if you keep retrying past the\nserver configured request timeout window (15 minutes, I think) they would\nstart failing at that point.  I'll have to look at the existing code to see\nhow difficult it would be to re-sign on retry.  I really don't like the idea\nof making that kind of change to code that is so central to all of the boto\nmodules.\n\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"created":"2012-04-23T16:08:51.823-0500","updated":"2012-04-23T16:08:51.823-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/10830/comment/14026","id":"14026","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"body":"Originally posted on 2011-06-06 21:28:53 by admin\nhttp://support.eucalyptus.com/Ticket/Display.html?id=2458 This is a comment.\nIt is not sent to the Requestor(s): Seems like there are a couple of options,\nat least. First, I wonder if it's possible for the retry mechanism to ignore\nrequests that fail with a 500 error. If those could be ignored, then the retry\nfrom boto would not trigger the replay prevention. Second, I could modify boto\nto resign each retry. It doesn't do this at the moment and AWS doesn't require\nit although if you keep retrying past the server configured request timeout\nwindow (15 minutes, I think) they would start failing at that point. I'll have\nto look at the existing code to see how difficult it would be to re-sign on\nretry. I really don't like the idea of making that kind of change to code that\nis so central to all of the boto modules.\n\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"created":"2012-04-23T16:08:52.420-0500","updated":"2012-04-23T16:08:52.420-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/10830/comment/14027","id":"14027","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"body":"Originally posted on 2011-06-06 21:31:37 by wenye\nSorry. It seems that something else is happening. This bug may not be valid.\nOn Mon, Jun 6, 2011 at 2:28 PM, Mitch Garnaat via RT <\nbugs@support.eucalyptus.com> wrote: > >\nhttp://support.eucalyptus.com/Ticket/Display.html?id=2458 > This is a comment.\nIt is not sent to the Requestor(s): > > Seems like there are a couple of\noptions, at least. > > First, I wonder if it's possible for the retry\nmechanism to ignore requests > that fail with a 500 error. If those could be\nignored, then the retry from > boto > would not trigger the replay prevention.\n> > Second, I could modify boto to resign each retry. It doesn't do this at\nthe > moment and AWS doesn't require it although if you keep retrying past the\n> server > configured request timeout window (15 minutes, I think) they would\nstart > failing at that point. I'll have to look at the existing code to see\nhow > difficult it would be to re-sign on retry. I really don't like the idea\nof > making that kind of change to code that is so central to all of the boto\n> modules. > >\n\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"created":"2012-04-23T16:08:52.993-0500","updated":"2012-04-23T16:08:52.993-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/10830/comment/14028","id":"14028","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"body":"Originally posted on 2011-06-06 21:31:37 by wenye\nSorry. It seems that something else is happening. This bug may not be valid.<br><br><div class=\"gmail_quote\">On Mon, Jun 6, 2011 at 2:28 PM, Mitch Garnaat via RT <span dir=\"ltr\"><<a href=\"mailto:bugs@support.eucalyptus.com\">bugs@support.eucalyptus.com</a>></span> wrote:<br>\n\n<blockquote class=\"gmail_quote\" style=\"margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex;\"><br>\n<a href=\"http://support.eucalyptus.com/Ticket/Display.html?id=2458\" target=\"_blank\">http://support.eucalyptus.com/Ticket/Display.html?id=2458</a><br>\nThis is a comment.   It is not sent to the Requestor(s):<br>\n<br>\n  Seems like there are a couple of options, at least.<br>\n<br>\nFirst, I wonder if it&#39;s possible for the retry mechanism to ignore requests<br>\nthat fail with a 500 error. If those could be ignored, then the retry from boto<br>\nwould not trigger the replay prevention.<br>\n<br>\nSecond, I could modify boto to resign each retry. It doesn&#39;t do this at the<br>\nmoment and AWS doesn&#39;t require it although if you keep retrying past the server<br>\nconfigured request timeout window (15 minutes, I think) they would start<br>\nfailing at that point. I&#39;ll have to look at the existing code to see how<br>\ndifficult it would be to re-sign on retry. I really don&#39;t like the idea of<br>\nmaking that kind of change to code that is so central to all of the boto<br>\nmodules.<br>\n<br>\n</blockquote></div><br>\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"created":"2012-04-23T16:08:53.572-0500","updated":"2012-04-23T16:08:53.572-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/10830/comment/14029","id":"14029","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"body":"Originally posted on 2011-06-06 21:31:38 by wenye\n\n<URL: http://support.eucalyptus.com/Ticket/Display.html?id=2458 >\n\nSorry. It seems that something else is happening. This bug may not be valid.\n\nOn Mon, Jun 6, 2011 at 2:28 PM, Mitch Garnaat via RT <\nbugs@support.eucalyptus.com> wrote:\n\n>\n> http://support.eucalyptus.com/Ticket/Display.html?id=2458\n> This is a comment.  It is not sent to the Requestor(s):\n>\n>  Seems like there are a couple of options, at least.\n>\n> First, I wonder if it's possible for the retry mechanism to ignore requests\n> that fail with a 500 error. If those could be ignored, then the retry from\n> boto\n> would not trigger the replay prevention.\n>\n> Second, I could modify boto to resign each retry. It doesn't do this at the\n> moment and AWS doesn't require it although if you keep retrying past the\n> server\n> configured request timeout window (15 minutes, I think) they would start\n> failing at that point. I'll have to look at the existing code to see how\n> difficult it would be to re-sign on retry. I really don't like the idea of\n> making that kind of change to code that is so central to all of the boto\n> modules.\n>\n>\n\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"created":"2012-04-23T16:08:54.134-0500","updated":"2012-04-23T16:08:54.134-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/10830/comment/14030","id":"14030","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"body":"Originally posted on 2011-06-06 22:09:09 by wenye\nMitch: I talked with Dan and Chris. It seemed to be a discussion long ago. A\nsimple solution would be adding a 1 second interval between each retry. Would\nthat be a difficult change to make in boto? Ye On Mon, Jun 6, 2011 at 2:28 PM,\nMitch Garnaat via RT < bugs@support.eucalyptus.com> wrote: > >\nhttp://support.eucalyptus.com/Ticket/Display.html?id=2458 > This is a comment.\nIt is not sent to the Requestor(s): > > Seems like there are a couple of\noptions, at least. > > First, I wonder if it's possible for the retry\nmechanism to ignore requests > that fail with a 500 error. If those could be\nignored, then the retry from > boto > would not trigger the replay prevention.\n> > Second, I could modify boto to resign each retry. It doesn't do this at\nthe > moment and AWS doesn't require it although if you keep retrying past the\n> server > configured request timeout window (15 minutes, I think) they would\nstart > failing at that point. I'll have to look at the existing code to see\nhow > difficult it would be to re-sign on retry. I really don't like the idea\nof > making that kind of change to code that is so central to all of the boto\n> modules. > >\n\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"created":"2012-04-23T16:08:54.697-0500","updated":"2012-04-23T16:08:54.697-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/10830/comment/14031","id":"14031","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"body":"Originally posted on 2011-06-06 22:09:09 by wenye\nMitch:<div><br></div><div>I talked with Dan and Chris. It seemed to be a discussion long ago. A simple solution would be adding a 1 second interval between each retry. Would that be a difficult change to make in boto?</div>\n\n<div><br></div><div>Ye<br><br><div class=\"gmail_quote\">On Mon, Jun 6, 2011 at 2:28 PM, Mitch Garnaat via RT <span dir=\"ltr\"><<a href=\"mailto:bugs@support.eucalyptus.com\">bugs@support.eucalyptus.com</a>></span> wrote:<br>\n\n<blockquote class=\"gmail_quote\" style=\"margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex;\"><br>\n<a href=\"http://support.eucalyptus.com/Ticket/Display.html?id=2458\" target=\"_blank\">http://support.eucalyptus.com/Ticket/Display.html?id=2458</a><br>\nThis is a comment.   It is not sent to the Requestor(s):<br>\n<br>\n  Seems like there are a couple of options, at least.<br>\n<br>\nFirst, I wonder if it&#39;s possible for the retry mechanism to ignore requests<br>\nthat fail with a 500 error. If those could be ignored, then the retry from boto<br>\nwould not trigger the replay prevention.<br>\n<br>\nSecond, I could modify boto to resign each retry. It doesn&#39;t do this at the<br>\nmoment and AWS doesn&#39;t require it although if you keep retrying past the server<br>\nconfigured request timeout window (15 minutes, I think) they would start<br>\nfailing at that point. I&#39;ll have to look at the existing code to see how<br>\ndifficult it would be to re-sign on retry. I really don&#39;t like the idea of<br>\nmaking that kind of change to code that is so central to all of the boto<br>\nmodules.<br>\n<br>\n</blockquote></div><br></div>\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"created":"2012-04-23T16:08:55.316-0500","updated":"2012-04-23T16:08:55.316-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/10830/comment/14032","id":"14032","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"body":"Originally posted on 2011-06-06 22:09:09 by wenye\n\n<URL: http://support.eucalyptus.com/Ticket/Display.html?id=2458 >\n\nMitch:\n\nI talked with Dan and Chris. It seemed to be a discussion long ago. A simple\nsolution would be adding a 1 second interval between each retry. Would that\nbe a difficult change to make in boto?\n\nYe\n\nOn Mon, Jun 6, 2011 at 2:28 PM, Mitch Garnaat via RT <\nbugs@support.eucalyptus.com> wrote:\n\n>\n> http://support.eucalyptus.com/Ticket/Display.html?id=2458\n> This is a comment.  It is not sent to the Requestor(s):\n>\n>  Seems like there are a couple of options, at least.\n>\n> First, I wonder if it's possible for the retry mechanism to ignore requests\n> that fail with a 500 error. If those could be ignored, then the retry from\n> boto\n> would not trigger the replay prevention.\n>\n> Second, I could modify boto to resign each retry. It doesn't do this at the\n> moment and AWS doesn't require it although if you keep retrying past the\n> server\n> configured request timeout window (15 minutes, I think) they would start\n> failing at that point. I'll have to look at the existing code to see how\n> difficult it would be to re-sign on retry. I really don't like the idea of\n> making that kind of change to code that is so central to all of the boto\n> modules.\n>\n>\n\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"created":"2012-04-23T16:08:55.838-0500","updated":"2012-04-23T16:08:55.838-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/10830/comment/14033","id":"14033","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"body":"Originally posted on 2011-06-06 22:16:31 by admin\nThere is already a delay before retrying.  Boto uses an exponential backoff so\nit waits 1,2,4,8,16,32,... seconds between retries.  I think the issue is that\nthe retries are not re-signed.  The exact same request is tried again.\n\n  \nAs I said before, the only way I can see to get around this is to change the\nlogic on the server side so that error responses do not trigger the replay\ndetection or to change boto to re-sign all retries.\n\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"created":"2012-04-23T16:08:56.365-0500","updated":"2012-04-23T16:08:56.365-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/10830/comment/14034","id":"14034","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"body":"Originally posted on 2011-06-06 22:16:31 by admin\nhttp://support.eucalyptus.com/Ticket/Display.html?id=2458 This is a comment.\nIt is not sent to the Requestor(s): There is already a delay before retrying.\nBoto uses an exponential backoff so it waits 1,2,4,8,16,32,... seconds between\nretries. I think the issue is that the retries are not re-signed. The exact\nsame request is tried again. As I said before, the only way I can see to get\naround this is to change the logic on the server side so that error responses\ndo not trigger the replay detection or to change boto to re-sign all retries.\n\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"created":"2012-04-23T16:08:56.984-0500","updated":"2012-04-23T16:08:56.984-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/10830/comment/14035","id":"14035","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"body":"Originally posted on 2011-06-06 22:20:45 by admin\nI will investigate making the change in boto.  However, this behavior is\nsignificantly different than AWS and will probably cause problems for other\nclients and libraries.\n\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"created":"2012-04-23T16:08:57.541-0500","updated":"2012-04-23T16:08:57.541-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/10830/comment/14036","id":"14036","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"body":"Originally posted on 2011-06-06 22:20:45 by admin\nhttp://support.eucalyptus.com/Ticket/Display.html?id=2458 This is a comment.\nIt is not sent to the Requestor(s): I will investigate making the change in\nboto. However, this behavior is significantly different than AWS and will\nprobably cause problems for other clients and libraries.\n\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"created":"2012-04-23T16:08:58.082-0500","updated":"2012-04-23T16:08:58.082-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/10830/comment/14037","id":"14037","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"body":"Originally posted on 2011-06-06 22:23:55 by wenye\nMitch: Let's talk about it first before making any changes. I'm still\ninvestigating the problem I just saw. It might be the case that your backoff\nalgorithm works, but something else is wrong. I will let you know. Thanks! Ye\nOn Mon, Jun 6, 2011 at 3:20 PM, Mitch Garnaat via RT <\nbugs@support.eucalyptus.com> wrote: > >\nhttp://support.eucalyptus.com/Ticket/Display.html?id=2458 > This is a comment.\nIt is not sent to the Requestor(s): > > I will investigate making the change\nin boto. However, this behavior is > significantly different than AWS and will\nprobably cause problems for other > clients and libraries. > >\n\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"created":"2012-04-23T16:08:58.655-0500","updated":"2012-04-23T16:08:58.655-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/10830/comment/14038","id":"14038","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"body":"Originally posted on 2011-06-06 22:23:55 by wenye\nMitch:<div><br></div><div>Let&#39;s talk about it first before making any changes. I&#39;m still investigating the problem I just saw. It might be the case that your backoff algorithm works, but something else is wrong. I will let you know.</div>\n\n<div><br></div><div>Thanks!</div><div>Ye<br><br><div class=\"gmail_quote\">On Mon, Jun 6, 2011 at 3:20 PM, Mitch Garnaat via RT <span dir=\"ltr\"><<a href=\"mailto:bugs@support.eucalyptus.com\">bugs@support.eucalyptus.com</a>></span> wrote:<br>\n\n<blockquote class=\"gmail_quote\" style=\"margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex;\"><div class=\"im\"><br>\n<a href=\"http://support.eucalyptus.com/Ticket/Display.html?id=2458\" target=\"_blank\">http://support.eucalyptus.com/Ticket/Display.html?id=2458</a><br>\nThis is a comment.   It is not sent to the Requestor(s):<br>\n<br>\n</div>  I will investigate making the change in boto. However, this behavior is<br>\nsignificantly different than AWS and will probably cause problems for other<br>\nclients and libraries.<br>\n<br>\n</blockquote></div><br></div>\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"created":"2012-04-23T16:08:59.241-0500","updated":"2012-04-23T16:08:59.241-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/10830/comment/14039","id":"14039","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"body":"Originally posted on 2011-06-06 22:23:55 by wenye\n\n<URL: http://support.eucalyptus.com/Ticket/Display.html?id=2458 >\n\nMitch:\n\nLet's talk about it first before making any changes. I'm still investigating\nthe problem I just saw. It might be the case that your backoff algorithm\nworks, but something else is wrong. I will let you know.\n\nThanks!\nYe\n\nOn Mon, Jun 6, 2011 at 3:20 PM, Mitch Garnaat via RT <\nbugs@support.eucalyptus.com> wrote:\n\n>\n> http://support.eucalyptus.com/Ticket/Display.html?id=2458\n> This is a comment.  It is not sent to the Requestor(s):\n>\n>  I will investigate making the change in boto. However, this behavior is\n> significantly different than AWS and will probably cause problems for other\n> clients and libraries.\n>\n>\n\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"created":"2012-04-23T16:08:59.838-0500","updated":"2012-04-23T16:08:59.838-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/10830/comment/14040","id":"14040","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"body":"Originally posted on 2011-06-07 01:08:47 by wenye\nMitch:\n\nWhat is the first backoff time? It seems that it is not long enough to\nprevent the replay attack prevention mechanism. The real problem here is\nthat the first error is obscured by the replay attack error, which is very\ninconvenient for users.\n\nYe\n\nOn Mon, Jun 6, 2011 at 3:23 PM, Ye Wen <wenye@eucalyptus.com> wrote:\n\n> Mitch:\n>\n> Let's talk about it first before making any changes. I'm still\n> investigating the problem I just saw. It might be the case that your backoff\n> algorithm works, but something else is wrong. I will let you know.\n>\n> Thanks!\n> Ye\n>\n>\n> On Mon, Jun 6, 2011 at 3:20 PM, Mitch Garnaat via RT <\n> bugs@support.eucalyptus.com> wrote:\n>\n>>\n>> http://support.eucalyptus.com/Ticket/Display.html?id=2458\n>> This is a comment.  It is not sent to the Requestor(s):\n>>\n>>  I will investigate making the change in boto. However, this behavior is\n>> significantly different than AWS and will probably cause problems for\n>> other\n>> clients and libraries.\n>>\n>>\n>\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"created":"2012-04-23T16:09:00.664-0500","updated":"2012-04-23T16:09:00.664-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/10830/comment/14041","id":"14041","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"body":"Originally posted on 2011-06-07 01:08:47 by wenye\nMitch:<div><br></div><div>What is the first backoff time? It seems that it is not long enough to prevent the replay attack prevention mechanism. The real problem here is that the first error is obscured by the replay attack error, which is very inconvenient for users.</div>\n\n<div><br></div><div>Ye<br><br><div class=\"gmail_quote\">On Mon, Jun 6, 2011 at 3:23 PM, Ye Wen <span dir=\"ltr\"><<a href=\"mailto:wenye@eucalyptus.com\">wenye@eucalyptus.com</a>></span> wrote:<br><blockquote class=\"gmail_quote\" style=\"margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex;\">\n\nMitch:<div><br></div><div>Let&#39;s talk about it first before making any changes. I&#39;m still investigating the problem I just saw. It might be the case that your backoff algorithm works, but something else is wrong. I will let you know.</div>\n\n\n<div><br></div><div>Thanks!</div><div>Ye<div><div></div><div class=\"h5\"><br><br><div class=\"gmail_quote\">On Mon, Jun 6, 2011 at 3:20 PM, Mitch Garnaat via RT <span dir=\"ltr\"><<a href=\"mailto:bugs@support.eucalyptus.com\" target=\"_blank\">bugs@support.eucalyptus.com</a>></span> wrote:<br>\n\n\n<blockquote class=\"gmail_quote\" style=\"margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex\"><div><br>\n<a href=\"http://support.eucalyptus.com/Ticket/Display.html?id=2458\" target=\"_blank\">http://support.eucalyptus.com/Ticket/Display.html?id=2458</a><br>\nThis is a comment.   It is not sent to the Requestor(s):<br>\n<br>\n</div>  I will investigate making the change in boto. However, this behavior is<br>\nsignificantly different than AWS and will probably cause problems for other<br>\nclients and libraries.<br>\n<br>\n</blockquote></div><br></div></div></div>\n</blockquote></div><br></div>\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"created":"2012-04-23T16:09:01.237-0500","updated":"2012-04-23T16:09:01.237-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/10830/comment/14042","id":"14042","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"body":"Originally posted on 2011-06-07 01:08:48 by wenye\n\n<URL: http://support.eucalyptus.com/Ticket/Display.html?id=2458 >\n\nMitch:\n\nWhat is the first backoff time? It seems that it is not long enough to\nprevent the replay attack prevention mechanism. The real problem here is\nthat the first error is obscured by the replay attack error, which is very\ninconvenient for users.\n\nYe\n\nOn Mon, Jun 6, 2011 at 3:23 PM, Ye Wen <wenye@eucalyptus.com> wrote:\n\n> Mitch:\n>\n> Let's talk about it first before making any changes. I'm still\n> investigating the problem I just saw. It might be the case that your backoff\n> algorithm works, but something else is wrong. I will let you know.\n>\n> Thanks!\n> Ye\n>\n>\n> On Mon, Jun 6, 2011 at 3:20 PM, Mitch Garnaat via RT <\n> bugs@support.eucalyptus.com> wrote:\n>\n>>\n>> http://support.eucalyptus.com/Ticket/Display.html?id=2458\n>> This is a comment.  It is not sent to the Requestor(s):\n>>\n>>  I will investigate making the change in boto. However, this behavior is\n>> significantly different than AWS and will probably cause problems for\n>> other\n>> clients and libraries.\n>>\n>>\n>\n\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"created":"2012-04-23T16:09:01.791-0500","updated":"2012-04-23T16:09:01.791-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/10830/comment/14043","id":"14043","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"body":"Originally posted on 2011-06-07 01:27:41 by admin\nOn Mon Jun 06 18:08:47 2011, wen.ye wrote:\n\n> Mitch:\n\n>\n\n> What is the first backoff time? It seems that it is not long enough to\n\n> prevent the replay attack prevention mechanism. The real problem here\n\n> is\n\n> that the first error is obscured by the replay attack error, which is\n\n> very\n\n> inconvenient for users.\n\n>\n\n> Ye\n\n>\n\n> On Mon, Jun 6, 2011 at 3:23 PM, Ye Wen <wenye@eucalyptus.com> wrote:\n\n>\n\n> > Mitch:\n\n> >\n\n> > Let's talk about it first before making any changes. I'm still\n\n> > investigating the problem I just saw. It might be the case that your\n\n> backoff\n\n> > algorithm works, but something else is wrong. I will let you know.\n\n> >\n\n> > Thanks!\n\n> > Ye\n\n> >\n\n> >\n\n> > On Mon, Jun 6, 2011 at 3:20 PM, Mitch Garnaat via RT <\n\n> > bugs@support.eucalyptus.com> wrote:\n\n> >\n\n> >>\n\n> >> http://support.eucalyptus.com/Ticket/Display.html?id=2458\n\n> >> This is a comment. It is not sent to the Requestor(s):\n\n> >>\n\n> >> I will investigate making the change in boto. However, this\n\n> behavior is\n\n> >> significantly different than AWS and will probably cause problems\n\n> for\n\n> >> other\n\n> >> clients and libraries.\n\n> >>\n\n> >>\n\n> >\n\n  \nIf boto receives a 500 error, it will attempt a retry.  There is a loop\ncontrolling the number of retries (this is settable via the boto config file)\nbut each time through the loop, this line is executed:\n\n  \n\ntime.sleep(2 ** i)\n\n  \ninitially, I has a value of 0 so the delay would be 1 second.  The second time\nthrough, it would be 2, then 4, 8 16, etc.  So, I don't see how it could be\nretrying the request in less than a second\n\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"created":"2012-04-23T16:09:02.381-0500","updated":"2012-04-23T16:09:02.381-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/10830/comment/14044","id":"14044","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"body":"Originally posted on 2011-06-07 01:27:42 by mitch.garnaat@eucalyptus.com\n\n<URL: http://support.eucalyptus.com/Ticket/Display.html?id=2458 >\n\nOn Mon Jun 06 18:08:47 2011, wen.ye wrote:\n> Mitch:\n>\n> What is the first backoff time? It seems that it is not long enough to\n> prevent the replay attack prevention mechanism. The real problem here\n> is\n> that the first error is obscured by the replay attack error, which is\n> very\n> inconvenient for users.\n>\n> Ye\n>\n> On Mon, Jun 6, 2011 at 3:23 PM, Ye Wen <wenye@eucalyptus.com> wrote:\n>\n> > Mitch:\n> >\n> > Let's talk about it first before making any changes. I'm still\n> > investigating the problem I just saw. It might be the case that your\n> backoff\n> > algorithm works, but something else is wrong. I will let you know.\n> >\n> > Thanks!\n> > Ye\n> >\n> >\n> > On Mon, Jun 6, 2011 at 3:20 PM, Mitch Garnaat via RT <\n> > bugs@support.eucalyptus.com> wrote:\n> >\n> >>\n> >> http://support.eucalyptus.com/Ticket/Display.html?id=2458\n> >> This is a comment. It is not sent to the Requestor(s):\n> >>\n> >> I will investigate making the change in boto. However, this\n> behavior is\n> >> significantly different than AWS and will probably cause problems\n> for\n> >> other\n> >> clients and libraries.\n> >>\n> >>\n> >\n\nIf boto receives a 500 error, it will attempt a retry. There is a loop\ncontrolling the number of retries (this is settable via the boto config file)\nbut each time through the loop, this line is executed:\n\ntime.sleep(2 ** i)\ninitially, I has a value of 0 so the delay would be 1 second. The second time\nthrough, it would be 2, then 4, 8 16, etc. So, I don't see how it could be\nretrying the request in less than a second\n\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"created":"2012-04-23T16:09:02.996-0500","updated":"2012-04-23T16:09:02.996-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/10830/comment/14045","id":"14045","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"body":"Originally posted on 2011-06-07 01:27:42 by mitch.garnaat@eucalyptus.com\nOn Mon Jun 06 18:08:47 2011, wen.ye wrote:\n> Mitch:\n>\n> What is the first backoff time? It seems that it is not long enough to\n> prevent the replay attack prevention mechanism. The real problem here\n> is\n> that the first error is obscured by the replay attack error, which is\n> very\n> inconvenient for users.\n>\n> Ye\n>\n> On Mon, Jun 6, 2011 at 3:23 PM, Ye Wen <wenye@eucalyptus.com> wrote:\n>\n> > Mitch:\n> >\n> > Let's talk about it first before making any changes. I'm still\n> > investigating the problem I just saw. It might be the case that your\n> backoff\n> > algorithm works, but something else is wrong. I will let you know.\n> >\n> > Thanks!\n> > Ye\n> >\n> >\n> > On Mon, Jun 6, 2011 at 3:20 PM, Mitch Garnaat via RT <\n> > bugs@support.eucalyptus.com> wrote:\n> >\n> >>\n> >> http://support.eucalyptus.com/Ticket/Display.html?id=2458\n> >> This is a comment. It is not sent to the Requestor(s):\n> >>\n> >> I will investigate making the change in boto. However, this\n> behavior is\n> >> significantly different than AWS and will probably cause problems\n> for\n> >> other\n> >> clients and libraries.\n> >>\n> >>\n> >\n\nIf boto receives a 500 error, it will attempt a retry. There is a loop\ncontrolling the number of retries (this is settable via the boto config file)\nbut each time through the loop, this line is executed:\n\ntime.sleep(2 ** i)\ninitially, I has a value of 0 so the delay would be 1 second. The second time\nthrough, it would be 2, then 4, 8 16, etc. So, I don't see how it could be\nretrying the request in less than a second\n\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"created":"2012-04-23T16:09:03.525-0500","updated":"2012-04-23T16:09:03.525-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/10830/comment/14046","id":"14046","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"body":"Originally posted on 2011-06-07 01:32:55 by wenye\n\n<URL: http://support.eucalyptus.com/Ticket/Display.html?id=2458 >\n\nThe exact problem here is somewhere in my code throwing an NPE and causing a\n500 error, which was then overridden by the replay attack error. So I guess\nwe could do better in the backend, but it is useful to have tools showing\nthe real error. Anyway, could you point me to the code, maybe I can try\nplaying with the backoff time a little?\n\nThanks!\n\nOn Mon, Jun 6, 2011 at 6:27 PM, Mitch Garnaat via RT <\nbugs@support.eucalyptus.com> wrote:\n\n> On Mon Jun 06 18:08:47 2011, wen.ye wrote:\n> > Mitch:\n> >\n> > What is the first backoff time? It seems that it is not long enough to\n> > prevent the replay attack prevention mechanism. The real problem here\n> > is\n> > that the first error is obscured by the replay attack error, which is\n> > very\n> > inconvenient for users.\n> >\n> > Ye\n> >\n> > On Mon, Jun 6, 2011 at 3:23 PM, Ye Wen <wenye@eucalyptus.com> wrote:\n> >\n> > > Mitch:\n> > >\n> > > Let's talk about it first before making any changes. I'm still\n> > > investigating the problem I just saw. It might be the case that your\n> > backoff\n> > > algorithm works, but something else is wrong. I will let you know.\n> > >\n> > > Thanks!\n> > > Ye\n> > >\n> > >\n> > > On Mon, Jun 6, 2011 at 3:20 PM, Mitch Garnaat via RT <\n> > > bugs@support.eucalyptus.com> wrote:\n> > >\n> > >>\n> > >> http://support.eucalyptus.com/Ticket/Display.html?id=2458\n> > >> This is a comment. It is not sent to the Requestor(s):\n> > >>\n> > >> I will investigate making the change in boto. However, this\n> > behavior is\n> > >> significantly different than AWS and will probably cause problems\n> > for\n> > >> other\n> > >> clients and libraries.\n> > >>\n> > >>\n> > >\n>\n> If boto receives a 500 error, it will attempt a retry. There is a loop\n> controlling the number of retries (this is settable via the boto config\n> file)\n> but each time through the loop, this line is executed:\n>\n> time.sleep(2 ** i)\n> initially, I has a value of 0 so the delay would be 1 second. The second\n> time\n> through, it would be 2, then 4, 8 16, etc. So, I don't see how it could be\n> retrying the request in less than a second\n>\n>\n\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"created":"2012-04-23T16:09:04.062-0500","updated":"2012-04-23T16:09:04.062-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/10830/comment/14047","id":"14047","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"body":"Originally posted on 2011-06-07 01:32:55 by wenye\nThe exact problem here is somewhere in my code throwing an NPE and causing a\n500 error, which was then overridden by the replay attack error. So I guess\nwe could do better in the backend, but it is useful to have tools showing\nthe real error. Anyway, could you point me to the code, maybe I can try\nplaying with the backoff time a little?\n\nThanks!\n\nOn Mon, Jun 6, 2011 at 6:27 PM, Mitch Garnaat via RT <\nbugs@support.eucalyptus.com> wrote:\n\n> On Mon Jun 06 18:08:47 2011, wen.ye wrote:\n> > Mitch:\n> >\n> > What is the first backoff time? It seems that it is not long enough to\n> > prevent the replay attack prevention mechanism. The real problem here\n> > is\n> > that the first error is obscured by the replay attack error, which is\n> > very\n> > inconvenient for users.\n> >\n> > Ye\n> >\n> > On Mon, Jun 6, 2011 at 3:23 PM, Ye Wen <wenye@eucalyptus.com> wrote:\n> >\n> > > Mitch:\n> > >\n> > > Let's talk about it first before making any changes. I'm still\n> > > investigating the problem I just saw. It might be the case that your\n> > backoff\n> > > algorithm works, but something else is wrong. I will let you know.\n> > >\n> > > Thanks!\n> > > Ye\n> > >\n> > >\n> > > On Mon, Jun 6, 2011 at 3:20 PM, Mitch Garnaat via RT <\n> > > bugs@support.eucalyptus.com> wrote:\n> > >\n> > >>\n> > >> http://support.eucalyptus.com/Ticket/Display.html?id=2458\n> > >> This is a comment. It is not sent to the Requestor(s):\n> > >>\n> > >> I will investigate making the change in boto. However, this\n> > behavior is\n> > >> significantly different than AWS and will probably cause problems\n> > for\n> > >> other\n> > >> clients and libraries.\n> > >>\n> > >>\n> > >\n>\n> If boto receives a 500 error, it will attempt a retry. There is a loop\n> controlling the number of retries (this is settable via the boto config\n> file)\n> but each time through the loop, this line is executed:\n>\n> time.sleep(2 ** i)\n> initially, I has a value of 0 so the delay would be 1 second. The second\n> time\n> through, it would be 2, then 4, 8 16, etc. So, I don't see how it could be\n> retrying the request in less than a second\n>\n>\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"created":"2012-04-23T16:09:04.621-0500","updated":"2012-04-23T16:09:04.621-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/10830/comment/14048","id":"14048","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"body":"Originally posted on 2011-06-07 01:32:55 by wenye\nThe exact problem here is somewhere in my code throwing an NPE and causing a\n500 error, which was then overridden by the replay attack error. So I guess we\ncould do better in the backend, but it is useful to have tools showing the\nreal error. Anyway, could you point me to the code, maybe I can try playing\nwith the backoff time a little?\n\n  \n\nThanks!\n\n  \n\nOn Mon, Jun 6, 2011 at 6:27 PM, Mitch Garnaat via RT\n<[bugs@support.eucalyptus.com](mailto:bugs@support.eucalyptus.com)> wrote:\n\n> On Mon Jun 06 18:08:47 2011, [wen.ye](http://wen.ye) wrote:\n\n> Mitch:\n\n>\n\n> What is the first backoff time? It seems that it is not long enough to\n\n> prevent the replay attack prevention mechanism. The real problem here\n\n> is\n\n> that the first error is obscured by the replay attack error, which is\n\n> very\n\n> inconvenient for users.\n\n>\n\n> Ye\n\n>\n\n> On Mon, Jun 6, 2011 at 3:23 PM, Ye Wen\n<[wenye@eucalyptus.com](mailto:wenye@eucalyptus.com)> wrote:\n\n>\n\n> > Mitch:\n\n> >\n\n> > Let's talk about it first before making any changes. I'm still\n\n> > investigating the problem I just saw. It might be the case that your\n\n> backoff\n\n> > algorithm works, but something else is wrong. I will let you know.\n\n> >\n\n> > Thanks!\n\n> > Ye\n\n> >\n\n> >\n\n> > On Mon, Jun 6, 2011 at 3:20 PM, Mitch Garnaat via RT <\n\n> > [bugs@support.eucalyptus.com](mailto:bugs@support.eucalyptus.com)> wrote:\n\n> >\n\n> >>\n\n> >> [http://support.eucalyptus.com/Ticket/Display.html?id=2458](http://suppor\nt.eucalyptus.com/Ticket/Display.html?id=2458)\n\n> >> This is a comment. It is not sent to the Requestor(s):\n\n> >>\n\n> >> I will investigate making the change in boto. However, this\n\n> behavior is\n\n> >> significantly different than AWS and will probably cause problems\n\n> for\n\n> >> other\n\n> >> clients and libraries.\n\n> >>\n\n> >>\n\n> >\n\n  \n\n>\n\n> If boto receives a 500 error, it will attempt a retry. There is a loop\n\ncontrolling the number of retries (this is settable via the boto config file)\n\nbut each time through the loop, this line is executed:\n\n  \ntime.sleep(2 ** i)\n\ninitially, I has a value of 0 so the delay would be 1 second. The second time\n\nthrough, it would be 2, then 4, 8 16, etc. So, I don't see how it could be\n\nretrying the request in less than a second\n\n  \n\n  \n\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"created":"2012-04-23T16:09:05.183-0500","updated":"2012-04-23T16:09:05.183-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/10830/comment/14049","id":"14049","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"body":"Originally posted on 2011-06-07 01:37:06 by admin\nOn Mon Jun 06 18:32:55 2011, wen.ye wrote:\n\n> The exact problem here is somewhere in my code throwing an NPE and causing a\n\n> 500 error, which was then overridden by the replay attack error. So I guess\n\n> we could do better in the backend, but it is useful to have tools showing\n\n> the real error. Anyway, could you point me to the code, maybe I can try\n\n> playing with the backoff time a little?\n\n>\n\n> Thanks!\n\n>\n\n> On Mon, Jun 6, 2011 at 6:27 PM, Mitch Garnaat via RT <\n\n> bugs@support.eucalyptus.com> wrote:\n\n>\n\n> > On Mon Jun 06 18:08:47 2011, wen.ye wrote:\n\n> > > Mitch:\n\n> > >\n\n> > > What is the first backoff time? It seems that it is not long enough to\n\n> > > prevent the replay attack prevention mechanism. The real problem here\n\n> > > is\n\n> > > that the first error is obscured by the replay attack error, which is\n\n> > > very\n\n> > > inconvenient for users.\n\n> > >\n\n> > > Ye\n\n> > >\n\n> > > On Mon, Jun 6, 2011 at 3:23 PM, Ye Wen <wenye@eucalyptus.com> wrote:\n\n> > >\n\n> > > > Mitch:\n\n> > > >\n\n> > > > Let's talk about it first before making any changes. I'm still\n\n> > > > investigating the problem I just saw. It might be the case that your\n\n> > > backoff\n\n> > > > algorithm works, but something else is wrong. I will let you know.\n\n> > > >\n\n> > > > Thanks!\n\n> > > > Ye\n\n> > > >\n\n> > > >\n\n> > > > On Mon, Jun 6, 2011 at 3:20 PM, Mitch Garnaat via RT <\n\n> > > > bugs@support.eucalyptus.com> wrote:\n\n> > > >\n\n> > > >>\n\n> > > >> http://support.eucalyptus.com/Ticket/Display.html?id=2458\n\n> > > >> This is a comment. It is not sent to the Requestor(s):\n\n> > > >>\n\n> > > >> I will investigate making the change in boto. However, this\n\n> > > behavior is\n\n> > > >> significantly different than AWS and will probably cause problems\n\n> > > for\n\n> > > >> other\n\n> > > >> clients and libraries.\n\n> > > >>\n\n> > > >>\n\n> > > >\n\n> >\n\n> > If boto receives a 500 error, it will attempt a retry. There is a loop\n\n> > controlling the number of retries (this is settable via the boto config\n\n> > file)\n\n> > but each time through the loop, this line is executed:\n\n> >\n\n> > time.sleep(2 ** i)\n\n> > initially, I has a value of 0 so the delay would be 1 second. The second\n\n> > time\n\n> > through, it would be 2, then 4, 8 16, etc. So, I don't see how it could be\n\n> > retrying the request in less than a second\n\n> >\n\n> >\n\n  \nThe exact line I quoted above can be found at line 556 of\nboto/boto/connection.py.  You could just change that to a hard-coded value of\n5 or something and see what happens.  I'd definitely like to find out what's\nhappening so let me know if I can help at all.\n\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"created":"2012-04-23T16:09:05.738-0500","updated":"2012-04-23T16:09:05.738-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/10830/comment/14050","id":"14050","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"body":"Originally posted on 2011-06-07 01:37:06 by mitch.garnaat@eucalyptus.com\n\n<URL: http://support.eucalyptus.com/Ticket/Display.html?id=2458 >\n\nOn Mon Jun 06 18:32:55 2011, wen.ye wrote:\n> The exact problem here is somewhere in my code throwing an NPE and causing a\n> 500 error, which was then overridden by the replay attack error. So I guess\n> we could do better in the backend, but it is useful to have tools showing\n> the real error. Anyway, could you point me to the code, maybe I can try\n> playing with the backoff time a little?\n>\n> Thanks!\n>\n> On Mon, Jun 6, 2011 at 6:27 PM, Mitch Garnaat via RT <\n> bugs@support.eucalyptus.com> wrote:\n>\n> > On Mon Jun 06 18:08:47 2011, wen.ye wrote:\n> > > Mitch:\n> > >\n> > > What is the first backoff time? It seems that it is not long enough to\n> > > prevent the replay attack prevention mechanism. The real problem here\n> > > is\n> > > that the first error is obscured by the replay attack error, which is\n> > > very\n> > > inconvenient for users.\n> > >\n> > > Ye\n> > >\n> > > On Mon, Jun 6, 2011 at 3:23 PM, Ye Wen <wenye@eucalyptus.com> wrote:\n> > >\n> > > > Mitch:\n> > > >\n> > > > Let's talk about it first before making any changes. I'm still\n> > > > investigating the problem I just saw. It might be the case that your\n> > > backoff\n> > > > algorithm works, but something else is wrong. I will let you know.\n> > > >\n> > > > Thanks!\n> > > > Ye\n> > > >\n> > > >\n> > > > On Mon, Jun 6, 2011 at 3:20 PM, Mitch Garnaat via RT <\n> > > > bugs@support.eucalyptus.com> wrote:\n> > > >\n> > > >>\n> > > >> http://support.eucalyptus.com/Ticket/Display.html?id=2458\n> > > >> This is a comment. It is not sent to the Requestor(s):\n> > > >>\n> > > >> I will investigate making the change in boto. However, this\n> > > behavior is\n> > > >> significantly different than AWS and will probably cause problems\n> > > for\n> > > >> other\n> > > >> clients and libraries.\n> > > >>\n> > > >>\n> > > >\n> >\n> > If boto receives a 500 error, it will attempt a retry. There is a loop\n> > controlling the number of retries (this is settable via the boto config\n> > file)\n> > but each time through the loop, this line is executed:\n> >\n> > time.sleep(2 ** i)\n> > initially, I has a value of 0 so the delay would be 1 second. The second\n> > time\n> > through, it would be 2, then 4, 8 16, etc. So, I don't see how it could be\n> > retrying the request in less than a second\n> >\n> >\n\nThe exact line I quoted above can be found at line 556 of\nboto/boto/connection.py. You could just change that to a hard-coded value of 5\nor something and see what happens. I'd definitely like to find out what's\nhappening so let me know if I can help at all.\n\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"created":"2012-04-23T16:09:06.250-0500","updated":"2012-04-23T16:09:06.250-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/10830/comment/14051","id":"14051","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"body":"Originally posted on 2011-06-07 01:37:07 by mitch.garnaat@eucalyptus.com\nOn Mon Jun 06 18:32:55 2011, wen.ye wrote:\n> The exact problem here is somewhere in my code throwing an NPE and causing a\n> 500 error, which was then overridden by the replay attack error. So I guess\n> we could do better in the backend, but it is useful to have tools showing\n> the real error. Anyway, could you point me to the code, maybe I can try\n> playing with the backoff time a little?\n>\n> Thanks!\n>\n> On Mon, Jun 6, 2011 at 6:27 PM, Mitch Garnaat via RT <\n> bugs@support.eucalyptus.com> wrote:\n>\n> > On Mon Jun 06 18:08:47 2011, wen.ye wrote:\n> > > Mitch:\n> > >\n> > > What is the first backoff time? It seems that it is not long enough to\n> > > prevent the replay attack prevention mechanism. The real problem here\n> > > is\n> > > that the first error is obscured by the replay attack error, which is\n> > > very\n> > > inconvenient for users.\n> > >\n> > > Ye\n> > >\n> > > On Mon, Jun 6, 2011 at 3:23 PM, Ye Wen <wenye@eucalyptus.com> wrote:\n> > >\n> > > > Mitch:\n> > > >\n> > > > Let's talk about it first before making any changes. I'm still\n> > > > investigating the problem I just saw. It might be the case that your\n> > > backoff\n> > > > algorithm works, but something else is wrong. I will let you know.\n> > > >\n> > > > Thanks!\n> > > > Ye\n> > > >\n> > > >\n> > > > On Mon, Jun 6, 2011 at 3:20 PM, Mitch Garnaat via RT <\n> > > > bugs@support.eucalyptus.com> wrote:\n> > > >\n> > > >>\n> > > >> http://support.eucalyptus.com/Ticket/Display.html?id=2458\n> > > >> This is a comment. It is not sent to the Requestor(s):\n> > > >>\n> > > >> I will investigate making the change in boto. However, this\n> > > behavior is\n> > > >> significantly different than AWS and will probably cause problems\n> > > for\n> > > >> other\n> > > >> clients and libraries.\n> > > >>\n> > > >>\n> > > >\n> >\n> > If boto receives a 500 error, it will attempt a retry. There is a loop\n> > controlling the number of retries (this is settable via the boto config\n> > file)\n> > but each time through the loop, this line is executed:\n> >\n> > time.sleep(2 ** i)\n> > initially, I has a value of 0 so the delay would be 1 second. The second\n> > time\n> > through, it would be 2, then 4, 8 16, etc. So, I don't see how it could be\n> > retrying the request in less than a second\n> >\n> >\n\nThe exact line I quoted above can be found at line 556 of\nboto/boto/connection.py. You could just change that to a hard-coded value of 5\nor something and see what happens. I'd definitely like to find out what's\nhappening so let me know if I can help at all.\n\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"created":"2012-04-23T16:09:06.774-0500","updated":"2012-04-23T16:09:06.774-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/10830/comment/14052","id":"14052","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"body":"Originally posted on 2011-06-07 01:50:22 by wenye\n\n<URL: http://support.eucalyptus.com/Ticket/Display.html?id=2458 >\n\nThanks Mitch. I'll keep you posted.\n\nOn Mon, Jun 6, 2011 at 6:37 PM, Mitch Garnaat via RT <\nbugs@support.eucalyptus.com> wrote:\n\n> On Mon Jun 06 18:32:55 2011, wen.ye wrote:\n> > The exact problem here is somewhere in my code throwing an NPE and\n> causing a\n> > 500 error, which was then overridden by the replay attack error. So I\n> guess\n> > we could do better in the backend, but it is useful to have tools showing\n> > the real error. Anyway, could you point me to the code, maybe I can try\n> > playing with the backoff time a little?\n> >\n> > Thanks!\n> >\n> > On Mon, Jun 6, 2011 at 6:27 PM, Mitch Garnaat via RT <\n> > bugs@support.eucalyptus.com> wrote:\n> >\n> > > On Mon Jun 06 18:08:47 2011, wen.ye wrote:\n> > > > Mitch:\n> > > >\n> > > > What is the first backoff time? It seems that it is not long enough\n> to\n> > > > prevent the replay attack prevention mechanism. The real problem here\n> > > > is\n> > > > that the first error is obscured by the replay attack error, which is\n> > > > very\n> > > > inconvenient for users.\n> > > >\n> > > > Ye\n> > > >\n> > > > On Mon, Jun 6, 2011 at 3:23 PM, Ye Wen <wenye@eucalyptus.com> wrote:\n> > > >\n> > > > > Mitch:\n> > > > >\n> > > > > Let's talk about it first before making any changes. I'm still\n> > > > > investigating the problem I just saw. It might be the case that\n> your\n> > > > backoff\n> > > > > algorithm works, but something else is wrong. I will let you know.\n> > > > >\n> > > > > Thanks!\n> > > > > Ye\n> > > > >\n> > > > >\n> > > > > On Mon, Jun 6, 2011 at 3:20 PM, Mitch Garnaat via RT <\n> > > > > bugs@support.eucalyptus.com> wrote:\n> > > > >\n> > > > >>\n> > > > >> http://support.eucalyptus.com/Ticket/Display.html?id=2458\n> > > > >> This is a comment. It is not sent to the Requestor(s):\n> > > > >>\n> > > > >> I will investigate making the change in boto. However, this\n> > > > behavior is\n> > > > >> significantly different than AWS and will probably cause problems\n> > > > for\n> > > > >> other\n> > > > >> clients and libraries.\n> > > > >>\n> > > > >>\n> > > > >\n> > >\n> > > If boto receives a 500 error, it will attempt a retry. There is a loop\n> > > controlling the number of retries (this is settable via the boto config\n> > > file)\n> > > but each time through the loop, this line is executed:\n> > >\n> > > time.sleep(2 ** i)\n> > > initially, I has a value of 0 so the delay would be 1 second. The\n> second\n> > > time\n> > > through, it would be 2, then 4, 8 16, etc. So, I don't see how it could\n> be\n> > > retrying the request in less than a second\n> > >\n> > >\n>\n> The exact line I quoted above can be found at line 556 of\n> boto/boto/connection.py. You could just change that to a hard-coded value\n> of 5\n> or something and see what happens. I'd definitely like to find out what's\n> happening so let me know if I can help at all.\n>\n>\n\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"created":"2012-04-23T16:09:07.300-0500","updated":"2012-04-23T16:09:07.300-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/10830/comment/14053","id":"14053","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"body":"Originally posted on 2011-06-07 01:50:22 by wenye\nThanks Mitch. I'll keep you posted.\n\nOn Mon, Jun 6, 2011 at 6:37 PM, Mitch Garnaat via RT <\nbugs@support.eucalyptus.com> wrote:\n\n> On Mon Jun 06 18:32:55 2011, wen.ye wrote:\n> > The exact problem here is somewhere in my code throwing an NPE and\n> causing a\n> > 500 error, which was then overridden by the replay attack error. So I\n> guess\n> > we could do better in the backend, but it is useful to have tools showing\n> > the real error. Anyway, could you point me to the code, maybe I can try\n> > playing with the backoff time a little?\n> >\n> > Thanks!\n> >\n> > On Mon, Jun 6, 2011 at 6:27 PM, Mitch Garnaat via RT <\n> > bugs@support.eucalyptus.com> wrote:\n> >\n> > > On Mon Jun 06 18:08:47 2011, wen.ye wrote:\n> > > > Mitch:\n> > > >\n> > > > What is the first backoff time? It seems that it is not long enough\n> to\n> > > > prevent the replay attack prevention mechanism. The real problem here\n> > > > is\n> > > > that the first error is obscured by the replay attack error, which is\n> > > > very\n> > > > inconvenient for users.\n> > > >\n> > > > Ye\n> > > >\n> > > > On Mon, Jun 6, 2011 at 3:23 PM, Ye Wen <wenye@eucalyptus.com> wrote:\n> > > >\n> > > > > Mitch:\n> > > > >\n> > > > > Let's talk about it first before making any changes. I'm still\n> > > > > investigating the problem I just saw. It might be the case that\n> your\n> > > > backoff\n> > > > > algorithm works, but something else is wrong. I will let you know.\n> > > > >\n> > > > > Thanks!\n> > > > > Ye\n> > > > >\n> > > > >\n> > > > > On Mon, Jun 6, 2011 at 3:20 PM, Mitch Garnaat via RT <\n> > > > > bugs@support.eucalyptus.com> wrote:\n> > > > >\n> > > > >>\n> > > > >> http://support.eucalyptus.com/Ticket/Display.html?id=2458\n> > > > >> This is a comment. It is not sent to the Requestor(s):\n> > > > >>\n> > > > >> I will investigate making the change in boto. However, this\n> > > > behavior is\n> > > > >> significantly different than AWS and will probably cause problems\n> > > > for\n> > > > >> other\n> > > > >> clients and libraries.\n> > > > >>\n> > > > >>\n> > > > >\n> > >\n> > > If boto receives a 500 error, it will attempt a retry. There is a loop\n> > > controlling the number of retries (this is settable via the boto config\n> > > file)\n> > > but each time through the loop, this line is executed:\n> > >\n> > > time.sleep(2 ** i)\n> > > initially, I has a value of 0 so the delay would be 1 second. The\n> second\n> > > time\n> > > through, it would be 2, then 4, 8 16, etc. So, I don't see how it could\n> be\n> > > retrying the request in less than a second\n> > >\n> > >\n>\n> The exact line I quoted above can be found at line 556 of\n> boto/boto/connection.py. You could just change that to a hard-coded value\n> of 5\n> or something and see what happens. I'd definitely like to find out what's\n> happening so let me know if I can help at all.\n>\n>\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"created":"2012-04-23T16:09:07.967-0500","updated":"2012-04-23T16:09:07.967-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/10830/comment/14054","id":"14054","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"body":"Originally posted on 2011-06-07 01:50:22 by wenye\nThanks Mitch. I'll keep you posted.\n\n  \n\nOn Mon, Jun 6, 2011 at 6:37 PM, Mitch Garnaat via RT\n<[bugs@support.eucalyptus.com](mailto:bugs@support.eucalyptus.com)> wrote:\n\n> On Mon Jun 06 18:32:55 2011, [wen.ye](http://wen.ye) wrote:\n\n> The exact problem here is somewhere in my code throwing an NPE and causing a\n\n> 500 error, which was then overridden by the replay attack error. So I guess\n\n> we could do better in the backend, but it is useful to have tools showing\n\n> the real error. Anyway, could you point me to the code, maybe I can try\n\n> playing with the backoff time a little?\n\n>\n\n> Thanks!\n\n>\n\n> On Mon, Jun 6, 2011 at 6:27 PM, Mitch Garnaat via RT <\n\n> [bugs@support.eucalyptus.com](mailto:bugs@support.eucalyptus.com)> wrote:\n\n>\n\n> > On Mon Jun 06 18:08:47 2011, [wen.ye](http://wen.ye) wrote:\n\n> > > Mitch:\n\n> > >\n\n> > > What is the first backoff time? It seems that it is not long enough to\n\n> > > prevent the replay attack prevention mechanism. The real problem here\n\n> > > is\n\n> > > that the first error is obscured by the replay attack error, which is\n\n> > > very\n\n> > > inconvenient for users.\n\n> > >\n\n> > > Ye\n\n> > >\n\n> > > On Mon, Jun 6, 2011 at 3:23 PM, Ye Wen\n<[wenye@eucalyptus.com](mailto:wenye@eucalyptus.com)> wrote:\n\n> > >\n\n> > > > Mitch:\n\n> > > >\n\n> > > > Let's talk about it first before making any changes. I'm still\n\n> > > > investigating the problem I just saw. It might be the case that your\n\n> > > backoff\n\n> > > > algorithm works, but something else is wrong. I will let you know.\n\n> > > >\n\n> > > > Thanks!\n\n> > > > Ye\n\n> > > >\n\n> > > >\n\n> > > > On Mon, Jun 6, 2011 at 3:20 PM, Mitch Garnaat via RT <\n\n> > > > [bugs@support.eucalyptus.com](mailto:bugs@support.eucalyptus.com)>\nwrote:\n\n> > > >\n\n> > > >>\n\n> > > >> [http://support.eucalyptus.com/Ticket/Display.html?id=2458](http://su\npport.eucalyptus.com/Ticket/Display.html?id=2458)\n\n> > > >> This is a comment. It is not sent to the Requestor(s):\n\n> > > >>\n\n> > > >> I will investigate making the change in boto. However, this\n\n> > > behavior is\n\n> > > >> significantly different than AWS and will probably cause problems\n\n> > > for\n\n> > > >> other\n\n> > > >> clients and libraries.\n\n> > > >>\n\n> > > >>\n\n> > > >\n\n> >\n\n> > If boto receives a 500 error, it will attempt a retry. There is a loop\n\n> > controlling the number of retries (this is settable via the boto config\n\n> > file)\n\n> > but each time through the loop, this line is executed:\n\n> >\n\n> > time.sleep(2 ** i)\n\n> > initially, I has a value of 0 so the delay would be 1 second. The second\n\n> > time\n\n> > through, it would be 2, then 4, 8 16, etc. So, I don't see how it could be\n\n> > retrying the request in less than a second\n\n> >\n\n> >\n\n  \n\n>\n\n> The exact line I quoted above can be found at line 556 of\n\nboto/boto/connection.py. You could just change that to a hard-coded value of 5\n\nor something and see what happens. I'd definitely like to find out what's\n\nhappening so let me know if I can help at all.\n\n  \n\n  \n\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"created":"2012-04-23T16:09:08.607-0500","updated":"2012-04-23T16:09:08.607-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/10830/comment/14055","id":"14055","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=rusvika","name":"rusvika","key":"rusvika","accountId":"557058:0f138bdf-f1d0-4468-9edd-e45575af47da","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/c975ce5391bf03e1a9aa2a957435569b?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Drusvika%26avatarId%3D10701%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/c975ce5391bf03e1a9aa2a957435569b?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Drusvika%26avatarId%3D10701%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/c975ce5391bf03e1a9aa2a957435569b?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Drusvika%26avatarId%3D10701%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/c975ce5391bf03e1a9aa2a957435569b?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Drusvika%26avatarId%3D10701%26noRedirect%3Dtrue"},"displayName":"Vika Felmetsger","active":true,"timeZone":"America/Los_Angeles"},"body":"Originally posted on 2011-06-07 03:32:15\nYe,\n\n  \nAs I understand from Mitch's previous responses, the problem here is not the\ntime between the retries but the fact that the messages are not re-signed (and\ncontain the same timestamp). CLC is going to keep the first message's\nsignature cached for 5 mins (until the timestamp on it actually expires and\nmakes it invalid) and will complain about replays if a message with the same\nsignature is received. So, unless euca2ools retry the message with a new\ntimestamp(resulting in a different signature), a replay attack will be\ndetected.\n\n  \nOn Mon Jun 06 18:50:22 2011, wen.ye wrote:\n\n> Thanks Mitch. I'll keep you posted.\n\n>\n\n> On Mon, Jun 6, 2011 at 6:37 PM, Mitch Garnaat via RT <\n\n> bugs@support.eucalyptus.com> wrote:\n\n>\n\n> > On Mon Jun 06 18:32:55 2011, wen.ye wrote:\n\n> > > The exact problem here is somewhere in my code throwing an NPE and\n\n> > causing a\n\n> > > 500 error, which was then overridden by the replay attack error.\n\n> So I\n\n> > guess\n\n> > > we could do better in the backend, but it is useful to have tools\n\n> showing\n\n> > > the real error. Anyway, could you point me to the code, maybe I\n\n> can try\n\n> > > playing with the backoff time a little?\n\n> > >\n\n> > > Thanks!\n\n> > >\n\n> > > On Mon, Jun 6, 2011 at 6:27 PM, Mitch Garnaat via RT <\n\n> > > bugs@support.eucalyptus.com> wrote:\n\n> > >\n\n> > > > On Mon Jun 06 18:08:47 2011, wen.ye wrote:\n\n> > > > > Mitch:\n\n> > > > >\n\n> > > > > What is the first backoff time? It seems that it is not long\n\n> enough\n\n> > to\n\n> > > > > prevent the replay attack prevention mechanism. The real\n\n> problem here\n\n> > > > > is\n\n> > > > > that the first error is obscured by the replay attack error,\n\n> which is\n\n> > > > > very\n\n> > > > > inconvenient for users.\n\n> > > > >\n\n> > > > > Ye\n\n> > > > >\n\n> > > > > On Mon, Jun 6, 2011 at 3:23 PM, Ye Wen <wenye@eucalyptus.com>\n\n> wrote:\n\n> > > > >\n\n> > > > > > Mitch:\n\n> > > > > >\n\n> > > > > > Let's talk about it first before making any changes. I'm\n\n> still\n\n> > > > > > investigating the problem I just saw. It might be the case\n\n> that\n\n> > your\n\n> > > > > backoff\n\n> > > > > > algorithm works, but something else is wrong. I will let you\n\n> know.\n\n> > > > > >\n\n> > > > > > Thanks!\n\n> > > > > > Ye\n\n> > > > > >\n\n> > > > > >\n\n> > > > > > On Mon, Jun 6, 2011 at 3:20 PM, Mitch Garnaat via RT <\n\n> > > > > > bugs@support.eucalyptus.com> wrote:\n\n> > > > > >\n\n> > > > > >>\n\n> > > > > >> http://support.eucalyptus.com/Ticket/Display.html?id=2458\n\n> > > > > >> This is a comment. It is not sent to the Requestor(s):\n\n> > > > > >>\n\n> > > > > >> I will investigate making the change in boto. However, this\n\n> > > > > behavior is\n\n> > > > > >> significantly different than AWS and will probably cause\n\n> problems\n\n> > > > > for\n\n> > > > > >> other\n\n> > > > > >> clients and libraries.\n\n> > > > > >>\n\n> > > > > >>\n\n> > > > > >\n\n> > > >\n\n> > > > If boto receives a 500 error, it will attempt a retry. There is\n\n> a loop\n\n> > > > controlling the number of retries (this is settable via the boto\n\n> config\n\n> > > > file)\n\n> > > > but each time through the loop, this line is executed:\n\n> > > >\n\n> > > > time.sleep(2 ** i)\n\n> > > > initially, I has a value of 0 so the delay would be 1 second.\n\n> The\n\n> > second\n\n> > > > time\n\n> > > > through, it would be 2, then 4, 8 16, etc. So, I don't see how\n\n> it could\n\n> > be\n\n> > > > retrying the request in less than a second\n\n> > > >\n\n> > > >\n\n> >\n\n> > The exact line I quoted above can be found at line 556 of\n\n> > boto/boto/connection.py. You could just change that to a hard-coded\n\n> value\n\n> > of 5\n\n> > or something and see what happens. I'd definitely like to find out\n\n> what's\n\n> > happening so let me know if I can help at all.\n\n> >\n\n> >\n\n  \n  \n\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=rusvika","name":"rusvika","key":"rusvika","accountId":"557058:0f138bdf-f1d0-4468-9edd-e45575af47da","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/c975ce5391bf03e1a9aa2a957435569b?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Drusvika%26avatarId%3D10701%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/c975ce5391bf03e1a9aa2a957435569b?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Drusvika%26avatarId%3D10701%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/c975ce5391bf03e1a9aa2a957435569b?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Drusvika%26avatarId%3D10701%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/c975ce5391bf03e1a9aa2a957435569b?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Drusvika%26avatarId%3D10701%26noRedirect%3Dtrue"},"displayName":"Vika Felmetsger","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-04-23T16:09:09.150-0500","updated":"2012-04-23T16:09:09.150-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/10830/comment/14056","id":"14056","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"body":"Originally posted on 2011-06-07 03:32:15 by admin\n\nhttp://support.eucalyptus.com/Ticket/Display.html?id=2458\nThis is a comment.  It is not sent to the Requestor(s):\n\nYe,\n\nAs I understand from Mitch's previous responses, the problem here is not the\ntime between the retries but the fact that the messages are not re-signed (and\ncontain the same timestamp). CLC is going to keep the first message's signature\ncached for 5 mins (until the timestamp on it actually expires and makes it\ninvalid) and will complain about replays if a message with the same signature\nis received. So, unless euca2ools retry the message with a new\ntimestamp(resulting in a different signature), a replay attack will be\ndetected.\n\nOn Mon Jun 06 18:50:22 2011, wen.ye wrote:\n> Thanks Mitch. I'll keep you posted.\n>\n> On Mon, Jun 6, 2011 at 6:37 PM, Mitch Garnaat via RT <\n> bugs@support.eucalyptus.com> wrote:\n>\n> > On Mon Jun 06 18:32:55 2011, wen.ye wrote:\n> > > The exact problem here is somewhere in my code throwing an NPE and\n> > causing a\n> > > 500 error, which was then overridden by the replay attack error.\n> So I\n> > guess\n> > > we could do better in the backend, but it is useful to have tools\n> showing\n> > > the real error. Anyway, could you point me to the code, maybe I\n> can try\n> > > playing with the backoff time a little?\n> > >\n> > > Thanks!\n> > >\n> > > On Mon, Jun 6, 2011 at 6:27 PM, Mitch Garnaat via RT <\n> > > bugs@support.eucalyptus.com> wrote:\n> > >\n> > > > On Mon Jun 06 18:08:47 2011, wen.ye wrote:\n> > > > > Mitch:\n> > > > >\n> > > > > What is the first backoff time? It seems that it is not long\n> enough\n> > to\n> > > > > prevent the replay attack prevention mechanism. The real\n> problem here\n> > > > > is\n> > > > > that the first error is obscured by the replay attack error,\n> which is\n> > > > > very\n> > > > > inconvenient for users.\n> > > > >\n> > > > > Ye\n> > > > >\n> > > > > On Mon, Jun 6, 2011 at 3:23 PM, Ye Wen <wenye@eucalyptus.com>\n> wrote:\n> > > > >\n> > > > > > Mitch:\n> > > > > >\n> > > > > > Let's talk about it first before making any changes. I'm\n> still\n> > > > > > investigating the problem I just saw. It might be the case\n> that\n> > your\n> > > > > backoff\n> > > > > > algorithm works, but something else is wrong. I will let you\n> know.\n> > > > > >\n> > > > > > Thanks!\n> > > > > > Ye\n> > > > > >\n> > > > > >\n> > > > > > On Mon, Jun 6, 2011 at 3:20 PM, Mitch Garnaat via RT <\n> > > > > > bugs@support.eucalyptus.com> wrote:\n> > > > > >\n> > > > > >>\n> > > > > >> http://support.eucalyptus.com/Ticket/Display.html?id=2458\n> > > > > >> This is a comment. It is not sent to the Requestor(s):\n> > > > > >>\n> > > > > >> I will investigate making the change in boto. However, this\n> > > > > behavior is\n> > > > > >> significantly different than AWS and will probably cause\n> problems\n> > > > > for\n> > > > > >> other\n> > > > > >> clients and libraries.\n> > > > > >>\n> > > > > >>\n> > > > > >\n> > > >\n> > > > If boto receives a 500 error, it will attempt a retry. There is\n> a loop\n> > > > controlling the number of retries (this is settable via the boto\n> config\n> > > > file)\n> > > > but each time through the loop, this line is executed:\n> > > >\n> > > > time.sleep(2 ** i)\n> > > > initially, I has a value of 0 so the delay would be 1 second.\n> The\n> > second\n> > > > time\n> > > > through, it would be 2, then 4, 8 16, etc. So, I don't see how\n> it could\n> > be\n> > > > retrying the request in less than a second\n> > > >\n> > > >\n> >\n> > The exact line I quoted above can be found at line 556 of\n> > boto/boto/connection.py. You could just change that to a hard-coded\n> value\n> > of 5\n> > or something and see what happens. I'd definitely like to find out\n> what's\n> > happening so let me know if I can help at all.\n> >\n> >\n\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"created":"2012-04-23T16:09:09.780-0500","updated":"2012-04-23T16:09:09.780-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/10830/comment/14057","id":"14057","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"body":"Originally posted on 2011-06-07 04:25:22 by wenye\nHi, Vika:\n\nChris told me that an one second backoff should avoid the replay attack\ndetection. Maybe he's wrong?\n\nYe\n\nOn Mon, Jun 6, 2011 at 8:32 PM, Vika Felmetsger via RT <\nbugs@support.eucalyptus.com> wrote:\n\n>\n> http://support.eucalyptus.com/Ticket/Display.html?id=2458\n> This is a comment.  It is not sent to the Requestor(s):\n>\n> Ye,\n>\n> As I understand from Mitch's previous responses, the problem here is not\n> the\n> time between the retries but the fact that the messages are not re-signed\n> (and\n> contain the same timestamp). CLC is going to keep the first message's\n> signature\n> cached for 5 mins (until the timestamp on it actually expires and makes it\n> invalid) and will complain about replays if a message with the same\n> signature\n> is received. So, unless euca2ools retry the message with a new\n> timestamp(resulting in a different signature), a replay attack will be\n> detected.\n>\n> On Mon Jun 06 18:50:22 2011, wen.ye wrote:\n> > Thanks Mitch. I'll keep you posted.\n> >\n> > On Mon, Jun 6, 2011 at 6:37 PM, Mitch Garnaat via RT <\n> > bugs@support.eucalyptus.com> wrote:\n> >\n> > > On Mon Jun 06 18:32:55 2011, wen.ye wrote:\n> > > > The exact problem here is somewhere in my code throwing an NPE and\n> > > causing a\n> > > > 500 error, which was then overridden by the replay attack error.\n> > So I\n> > > guess\n> > > > we could do better in the backend, but it is useful to have tools\n> > showing\n> > > > the real error. Anyway, could you point me to the code, maybe I\n> > can try\n> > > > playing with the backoff time a little?\n> > > >\n> > > > Thanks!\n> > > >\n> > > > On Mon, Jun 6, 2011 at 6:27 PM, Mitch Garnaat via RT <\n> > > > bugs@support.eucalyptus.com> wrote:\n> > > >\n> > > > > On Mon Jun 06 18:08:47 2011, wen.ye wrote:\n> > > > > > Mitch:\n> > > > > >\n> > > > > > What is the first backoff time? It seems that it is not long\n> > enough\n> > > to\n> > > > > > prevent the replay attack prevention mechanism. The real\n> > problem here\n> > > > > > is\n> > > > > > that the first error is obscured by the replay attack error,\n> > which is\n> > > > > > very\n> > > > > > inconvenient for users.\n> > > > > >\n> > > > > > Ye\n> > > > > >\n> > > > > > On Mon, Jun 6, 2011 at 3:23 PM, Ye Wen <wenye@eucalyptus.com>\n> > wrote:\n> > > > > >\n> > > > > > > Mitch:\n> > > > > > >\n> > > > > > > Let's talk about it first before making any changes. I'm\n> > still\n> > > > > > > investigating the problem I just saw. It might be the case\n> > that\n> > > your\n> > > > > > backoff\n> > > > > > > algorithm works, but something else is wrong. I will let you\n> > know.\n> > > > > > >\n> > > > > > > Thanks!\n> > > > > > > Ye\n> > > > > > >\n> > > > > > >\n> > > > > > > On Mon, Jun 6, 2011 at 3:20 PM, Mitch Garnaat via RT <\n> > > > > > > bugs@support.eucalyptus.com> wrote:\n> > > > > > >\n> > > > > > >>\n> > > > > > >> http://support.eucalyptus.com/Ticket/Display.html?id=2458\n> > > > > > >> This is a comment. It is not sent to the Requestor(s):\n> > > > > > >>\n> > > > > > >> I will investigate making the change in boto. However, this\n> > > > > > behavior is\n> > > > > > >> significantly different than AWS and will probably cause\n> > problems\n> > > > > > for\n> > > > > > >> other\n> > > > > > >> clients and libraries.\n> > > > > > >>\n> > > > > > >>\n> > > > > > >\n> > > > >\n> > > > > If boto receives a 500 error, it will attempt a retry. There is\n> > a loop\n> > > > > controlling the number of retries (this is settable via the boto\n> > config\n> > > > > file)\n> > > > > but each time through the loop, this line is executed:\n> > > > >\n> > > > > time.sleep(2 ** i)\n> > > > > initially, I has a value of 0 so the delay would be 1 second.\n> > The\n> > > second\n> > > > > time\n> > > > > through, it would be 2, then 4, 8 16, etc. So, I don't see how\n> > it could\n> > > be\n> > > > > retrying the request in less than a second\n> > > > >\n> > > > >\n> > >\n> > > The exact line I quoted above can be found at line 556 of\n> > > boto/boto/connection.py. You could just change that to a hard-coded\n> > value\n> > > of 5\n> > > or something and see what happens. I'd definitely like to find out\n> > what's\n> > > happening so let me know if I can help at all.\n> > >\n> > >\n>\n>\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"created":"2012-04-23T16:09:10.325-0500","updated":"2012-04-23T16:09:10.325-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/10830/comment/14058","id":"14058","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"body":"Originally posted on 2011-06-07 04:25:22 by wenye\nHi, Vika:<div><br></div><div>Chris told me that an one second backoff should avoid the replay attack detection. Maybe he&#39;s wrong?</div><div><br></div><div>Ye</div><div><br><div class=\"gmail_quote\">On Mon, Jun 6, 2011 at 8:32 PM, Vika Felmetsger via RT <span dir=\"ltr\"><<a href=\"mailto:bugs@support.eucalyptus.com\">bugs@support.eucalyptus.com</a>></span> wrote:<br>\n\n<blockquote class=\"gmail_quote\" style=\"margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex;\"><div class=\"im\"><br>\n<a href=\"http://support.eucalyptus.com/Ticket/Display.html?id=2458\" target=\"_blank\">http://support.eucalyptus.com/Ticket/Display.html?id=2458</a><br>\nThis is a comment.   It is not sent to the Requestor(s):<br>\n<br>\n</div>Ye,<br>\n<br>\nAs I understand from Mitch&#39;s previous responses, the problem here is not the<br>\ntime between the retries but the fact that the messages are not re-signed (and<br>\ncontain the same timestamp). CLC is going to keep the first message&#39;s signature<br>\ncached for 5 mins (until the timestamp on it actually expires and makes it<br>\ninvalid) and will complain about replays if a message with the same signature<br>\nis received. So, unless euca2ools retry the message with a new<br>\ntimestamp(resulting in a different signature), a replay attack will be<br>\ndetected.<br>\n<div><div></div><div class=\"h5\"><br>\nOn Mon Jun 06 18:50:22 2011, <a href=\"http://wen.ye\" target=\"_blank\">wen.ye</a> wrote:<br>\n> Thanks Mitch. I&#39;ll keep you posted.<br>\n><br>\n> On Mon, Jun 6, 2011 at 6:37 PM, Mitch Garnaat via RT <<br>\n> <a href=\"mailto:bugs@support.eucalyptus.com\">bugs@support.eucalyptus.com</a>> wrote:<br>\n><br>\n> > On Mon Jun 06 18:32:55 2011, <a href=\"http://wen.ye\" target=\"_blank\">wen.ye</a> wrote:<br>\n> > > The exact problem here is somewhere in my code throwing an NPE and<br>\n> > causing a<br>\n> > > 500 error, which was then overridden by the replay attack error.<br>\n> So I<br>\n> > guess<br>\n> > > we could do better in the backend, but it is useful to have tools<br>\n> showing<br>\n> > > the real error. Anyway, could you point me to the code, maybe I<br>\n> can try<br>\n> > > playing with the backoff time a little?<br>\n> > ><br>\n> > > Thanks!<br>\n> > ><br>\n> > > On Mon, Jun 6, 2011 at 6:27 PM, Mitch Garnaat via RT <<br>\n> > > <a href=\"mailto:bugs@support.eucalyptus.com\">bugs@support.eucalyptus.com</a>> wrote:<br>\n> > ><br>\n> > > > On Mon Jun 06 18:08:47 2011, <a href=\"http://wen.ye\" target=\"_blank\">wen.ye</a> wrote:<br>\n> > > > > Mitch:<br>\n> > > > ><br>\n> > > > > What is the first backoff time? It seems that it is not long<br>\n> enough<br>\n> > to<br>\n> > > > > prevent the replay attack prevention mechanism. The real<br>\n> problem here<br>\n> > > > > is<br>\n> > > > > that the first error is obscured by the replay attack error,<br>\n> which is<br>\n> > > > > very<br>\n> > > > > inconvenient for users.<br>\n> > > > ><br>\n> > > > > Ye<br>\n> > > > ><br>\n> > > > > On Mon, Jun 6, 2011 at 3:23 PM, Ye Wen <<a href=\"mailto:wenye@eucalyptus.com\">wenye@eucalyptus.com</a>><br>\n> wrote:<br>\n> > > > ><br>\n> > > > > > Mitch:<br>\n> > > > > ><br>\n> > > > > > Let&#39;s talk about it first before making any changes. I&#39;m<br>\n> still<br>\n> > > > > > investigating the problem I just saw. It might be the case<br>\n> that<br>\n> > your<br>\n> > > > > backoff<br>\n> > > > > > algorithm works, but something else is wrong. I will let you<br>\n> know.<br>\n> > > > > ><br>\n> > > > > > Thanks!<br>\n> > > > > > Ye<br>\n> > > > > ><br>\n> > > > > ><br>\n> > > > > > On Mon, Jun 6, 2011 at 3:20 PM, Mitch Garnaat via RT <<br>\n> > > > > > <a href=\"mailto:bugs@support.eucalyptus.com\">bugs@support.eucalyptus.com</a>> wrote:<br>\n> > > > > ><br>\n> > > > > >><br>\n> > > > > >> <a href=\"http://support.eucalyptus.com/Ticket/Display.html?id=2458\" target=\"_blank\">http://support.eucalyptus.com/Ticket/Display.html?id=2458</a><br>\n> > > > > >> This is a comment. It is not sent to the Requestor(s):<br>\n> > > > > >><br>\n> > > > > >> I will investigate making the change in boto. However, this<br>\n> > > > > behavior is<br>\n> > > > > >> significantly different than AWS and will probably cause<br>\n> problems<br>\n> > > > > for<br>\n> > > > > >> other<br>\n> > > > > >> clients and libraries.<br>\n> > > > > >><br>\n> > > > > >><br>\n> > > > > ><br>\n> > > ><br>\n> > > > If boto receives a 500 error, it will attempt a retry. There is<br>\n> a loop<br>\n> > > > controlling the number of retries (this is settable via the boto<br>\n> config<br>\n> > > > file)<br>\n> > > > but each time through the loop, this line is executed:<br>\n> > > ><br>\n> > > > time.sleep(2 ** i)<br>\n> > > > initially, I has a value of 0 so the delay would be 1 second.<br>\n> The<br>\n> > second<br>\n> > > > time<br>\n> > > > through, it would be 2, then 4, 8 16, etc. So, I don&#39;t see how<br>\n> it could<br>\n> > be<br>\n> > > > retrying the request in less than a second<br>\n> > > ><br>\n> > > ><br>\n> ><br>\n> > The exact line I quoted above can be found at line 556 of<br>\n> > boto/boto/connection.py. You could just change that to a hard-coded<br>\n> value<br>\n> > of 5<br>\n> > or something and see what happens. I&#39;d definitely like to find out<br>\n> what&#39;s<br>\n> > happening so let me know if I can help at all.<br>\n> ><br>\n> ><br>\n<br>\n</div></div></blockquote></div><br></div>\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"created":"2012-04-23T16:09:10.891-0500","updated":"2012-04-23T16:09:10.891-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/10830/comment/14059","id":"14059","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"body":"Originally posted on 2011-06-07 04:25:22 by wenye\n\n<URL: http://support.eucalyptus.com/Ticket/Display.html?id=2458 >\n\nHi, Vika:\n\nChris told me that an one second backoff should avoid the replay attack\ndetection. Maybe he's wrong?\n\nYe\n\nOn Mon, Jun 6, 2011 at 8:32 PM, Vika Felmetsger via RT <\nbugs@support.eucalyptus.com> wrote:\n\n>\n> http://support.eucalyptus.com/Ticket/Display.html?id=2458\n> This is a comment.  It is not sent to the Requestor(s):\n>\n> Ye,\n>\n> As I understand from Mitch's previous responses, the problem here is not\n> the\n> time between the retries but the fact that the messages are not re-signed\n> (and\n> contain the same timestamp). CLC is going to keep the first message's\n> signature\n> cached for 5 mins (until the timestamp on it actually expires and makes it\n> invalid) and will complain about replays if a message with the same\n> signature\n> is received. So, unless euca2ools retry the message with a new\n> timestamp(resulting in a different signature), a replay attack will be\n> detected.\n>\n> On Mon Jun 06 18:50:22 2011, wen.ye wrote:\n> > Thanks Mitch. I'll keep you posted.\n> >\n> > On Mon, Jun 6, 2011 at 6:37 PM, Mitch Garnaat via RT <\n> > bugs@support.eucalyptus.com> wrote:\n> >\n> > > On Mon Jun 06 18:32:55 2011, wen.ye wrote:\n> > > > The exact problem here is somewhere in my code throwing an NPE and\n> > > causing a\n> > > > 500 error, which was then overridden by the replay attack error.\n> > So I\n> > > guess\n> > > > we could do better in the backend, but it is useful to have tools\n> > showing\n> > > > the real error. Anyway, could you point me to the code, maybe I\n> > can try\n> > > > playing with the backoff time a little?\n> > > >\n> > > > Thanks!\n> > > >\n> > > > On Mon, Jun 6, 2011 at 6:27 PM, Mitch Garnaat via RT <\n> > > > bugs@support.eucalyptus.com> wrote:\n> > > >\n> > > > > On Mon Jun 06 18:08:47 2011, wen.ye wrote:\n> > > > > > Mitch:\n> > > > > >\n> > > > > > What is the first backoff time? It seems that it is not long\n> > enough\n> > > to\n> > > > > > prevent the replay attack prevention mechanism. The real\n> > problem here\n> > > > > > is\n> > > > > > that the first error is obscured by the replay attack error,\n> > which is\n> > > > > > very\n> > > > > > inconvenient for users.\n> > > > > >\n> > > > > > Ye\n> > > > > >\n> > > > > > On Mon, Jun 6, 2011 at 3:23 PM, Ye Wen <wenye@eucalyptus.com>\n> > wrote:\n> > > > > >\n> > > > > > > Mitch:\n> > > > > > >\n> > > > > > > Let's talk about it first before making any changes. I'm\n> > still\n> > > > > > > investigating the problem I just saw. It might be the case\n> > that\n> > > your\n> > > > > > backoff\n> > > > > > > algorithm works, but something else is wrong. I will let you\n> > know.\n> > > > > > >\n> > > > > > > Thanks!\n> > > > > > > Ye\n> > > > > > >\n> > > > > > >\n> > > > > > > On Mon, Jun 6, 2011 at 3:20 PM, Mitch Garnaat via RT <\n> > > > > > > bugs@support.eucalyptus.com> wrote:\n> > > > > > >\n> > > > > > >>\n> > > > > > >> http://support.eucalyptus.com/Ticket/Display.html?id=2458\n> > > > > > >> This is a comment. It is not sent to the Requestor(s):\n> > > > > > >>\n> > > > > > >> I will investigate making the change in boto. However, this\n> > > > > > behavior is\n> > > > > > >> significantly different than AWS and will probably cause\n> > problems\n> > > > > > for\n> > > > > > >> other\n> > > > > > >> clients and libraries.\n> > > > > > >>\n> > > > > > >>\n> > > > > > >\n> > > > >\n> > > > > If boto receives a 500 error, it will attempt a retry. There is\n> > a loop\n> > > > > controlling the number of retries (this is settable via the boto\n> > config\n> > > > > file)\n> > > > > but each time through the loop, this line is executed:\n> > > > >\n> > > > > time.sleep(2 ** i)\n> > > > > initially, I has a value of 0 so the delay would be 1 second.\n> > The\n> > > second\n> > > > > time\n> > > > > through, it would be 2, then 4, 8 16, etc. So, I don't see how\n> > it could\n> > > be\n> > > > > retrying the request in less than a second\n> > > > >\n> > > > >\n> > >\n> > > The exact line I quoted above can be found at line 556 of\n> > > boto/boto/connection.py. You could just change that to a hard-coded\n> > value\n> > > of 5\n> > > or something and see what happens. I'd definitely like to find out\n> > what's\n> > > happening so let me know if I can help at all.\n> > >\n> > >\n>\n>\n\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"created":"2012-04-23T16:09:11.438-0500","updated":"2012-04-23T16:09:11.438-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/10830/comment/14060","id":"14060","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=rusvika","name":"rusvika","key":"rusvika","accountId":"557058:0f138bdf-f1d0-4468-9edd-e45575af47da","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/c975ce5391bf03e1a9aa2a957435569b?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Drusvika%26avatarId%3D10701%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/c975ce5391bf03e1a9aa2a957435569b?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Drusvika%26avatarId%3D10701%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/c975ce5391bf03e1a9aa2a957435569b?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Drusvika%26avatarId%3D10701%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/c975ce5391bf03e1a9aa2a957435569b?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Drusvika%26avatarId%3D10701%26noRedirect%3Dtrue"},"displayName":"Vika Felmetsger","active":true,"timeZone":"America/Los_Angeles"},"body":"Originally posted on 2011-06-07 04:46:00\nYe, Chris is right, but only if the message being resent has a different\nsignature (this can happen for the same message only if the timestamps that\nare included in the signature calculation are different). It all depends on\nwhether euca2ools/boto generate a new timestamp and re-sign the message on\neach new resend attempt.\n\nFrom your original trace, it looks like euca2ools do not generate a new\ntimestamp on the retry:\n\n...\n\n01%22%2C%0A%20%20%22Statement%22%3A%5B%7B%0A%20%20%20%20%22Sid%22%3A%221%22%2C\n%0A%20%20%20%20%22Effect%22%3A%22Allow%22%2C%0A%20%20%20%20%22Action%22%3A%22e\nc2%3Aassociateaddress%22%2C%0A%20%20%20%20%22Resource%22%3A%22arn%3Aaws%3Aec2%\n3A%3A%3Aaddress%2F192.168.1.1%22%0A%20%20%7D%5D%0A%7D%0A&PolicyName=testpolicy\n&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2011-\n\n> 06-06T21%3A14%3A25Z&UserName=testuser&Version=2010-05-\n\n> 08&Signature=22tvnExeafRejR770cADvNcV3HymLY7StXPuEUEWDgk%3D\n\n...\n\n> retrying in 1 seconds\n\n...\n\n01%22%2C%0A%20%20%22Statement%22%3A%5B%7B%0A%20%20%20%20%22Sid%22%3A%221%22%2C\n%0A%20%20%20%20%22Effect%22%3A%22Allow%22%2C%0A%20%20%20%20%22Action%22%3A%22e\nc2%3Aassociateaddress%22%2C%0A%20%20%20%20%22Resource%22%3A%22arn%3Aaws%3Aec2%\n3A%3A%3Aaddress%2F192.168.1.1%22%0A%20%20%7D%5D%0A%7D%0A&PolicyName=testpolicy\n&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2011-\n\n> 06-06T21%3A14%3A25Z&UserName=testuser&Version=2010-05-\n\n> 08&Signature=22tvnExeafRejR770cADvNcV3HymLY7StXPuEUEWDgk%3D\n\n  \n\nAs you see, the timestamp is the same in the second message sent 1 sec later\nand, therefore, the signature is the same, so a replay is detected. If the\ntimestamp in the second message differed by at least 1 second, the signature\nwould be different and there would be no problem on CLC side.\n\n  \n\nOn Mon Jun 06 21:25:22 2011, wen.ye wrote:\n\n> Hi, Vika:\n\n>\n\n> Chris told me that an one second backoff should avoid the replay attack\n\n> detection. Maybe he's wrong?\n\n>\n\n> Ye\n\n>\n\n> On Mon, Jun 6, 2011 at 8:32 PM, Vika Felmetsger via RT <\n\n> bugs@support.eucalyptus.com> wrote:\n\n>\n\n> >\n\n> > http://support.eucalyptus.com/Ticket/Display.html?id=2458\n\n> > This is a comment. It is not sent to the Requestor(s):\n\n> >\n\n> > Ye,\n\n> >\n\n> > As I understand from Mitch's previous responses, the problem here is not\n\n> > the\n\n> > time between the retries but the fact that the messages are not re-signed\n\n> > (and\n\n> > contain the same timestamp). CLC is going to keep the first message's\n\n> > signature\n\n> > cached for 5 mins (until the timestamp on it actually expires and makes it\n\n> > invalid) and will complain about replays if a message with the same\n\n> > signature\n\n> > is received. So, unless euca2ools retry the message with a new\n\n> > timestamp(resulting in a different signature), a replay attack will be\n\n> > detected.\n\n> >\n\n> > On Mon Jun 06 18:50:22 2011, wen.ye wrote:\n\n> > > Thanks Mitch. I'll keep you posted.\n\n> > >\n\n> > > On Mon, Jun 6, 2011 at 6:37 PM, Mitch Garnaat via RT <\n\n> > > bugs@support.eucalyptus.com> wrote:\n\n> > >\n\n> > > > On Mon Jun 06 18:32:55 2011, wen.ye wrote:\n\n> > > > > The exact problem here is somewhere in my code throwing an NPE and\n\n> > > > causing a\n\n> > > > > 500 error, which was then overridden by the replay attack error.\n\n> > > So I\n\n> > > > guess\n\n> > > > > we could do better in the backend, but it is useful to have tools\n\n> > > showing\n\n> > > > > the real error. Anyway, could you point me to the code, maybe I\n\n> > > can try\n\n> > > > > playing with the backoff time a little?\n\n> > > > >\n\n> > > > > Thanks!\n\n> > > > >\n\n> > > > > On Mon, Jun 6, 2011 at 6:27 PM, Mitch Garnaat via RT <\n\n> > > > > bugs@support.eucalyptus.com> wrote:\n\n> > > > >\n\n> > > > > > On Mon Jun 06 18:08:47 2011, wen.ye wrote:\n\n> > > > > > > Mitch:\n\n> > > > > > >\n\n> > > > > > > What is the first backoff time? It seems that it is not long\n\n> > > enough\n\n> > > > to\n\n> > > > > > > prevent the replay attack prevention mechanism. The real\n\n> > > problem here\n\n> > > > > > > is\n\n> > > > > > > that the first error is obscured by the replay attack error,\n\n> > > which is\n\n> > > > > > > very\n\n> > > > > > > inconvenient for users.\n\n> > > > > > >\n\n> > > > > > > Ye\n\n> > > > > > >\n\n> > > > > > > On Mon, Jun 6, 2011 at 3:23 PM, Ye Wen <wenye@eucalyptus.com>\n\n> > > wrote:\n\n> > > > > > >\n\n> > > > > > > > Mitch:\n\n> > > > > > > >\n\n> > > > > > > > Let's talk about it first before making any changes. I'm\n\n> > > still\n\n> > > > > > > > investigating the problem I just saw. It might be the case\n\n> > > that\n\n> > > > your\n\n> > > > > > > backoff\n\n> > > > > > > > algorithm works, but something else is wrong. I will let you\n\n> > > know.\n\n> > > > > > > >\n\n> > > > > > > > Thanks!\n\n> > > > > > > > Ye\n\n> > > > > > > >\n\n> > > > > > > >\n\n> > > > > > > > On Mon, Jun 6, 2011 at 3:20 PM, Mitch Garnaat via RT <\n\n> > > > > > > > bugs@support.eucalyptus.com> wrote:\n\n> > > > > > > >\n\n> > > > > > > >>\n\n> > > > > > > >> http://support.eucalyptus.com/Ticket/Display.html?id=2458\n\n> > > > > > > >> This is a comment. It is not sent to the Requestor(s):\n\n> > > > > > > >>\n\n> > > > > > > >> I will investigate making the change in boto. However, this\n\n> > > > > > > behavior is\n\n> > > > > > > >> significantly different than AWS and will probably cause\n\n> > > problems\n\n> > > > > > > for\n\n> > > > > > > >> other\n\n> > > > > > > >> clients and libraries.\n\n> > > > > > > >>\n\n> > > > > > > >>\n\n> > > > > > > >\n\n> > > > > >\n\n> > > > > > If boto receives a 500 error, it will attempt a retry. There is\n\n> > > a loop\n\n> > > > > > controlling the number of retries (this is settable via the boto\n\n> > > config\n\n> > > > > > file)\n\n> > > > > > but each time through the loop, this line is executed:\n\n> > > > > >\n\n> > > > > > time.sleep(2 ** i)\n\n> > > > > > initially, I has a value of 0 so the delay would be 1 second.\n\n> > > The\n\n> > > > second\n\n> > > > > > time\n\n> > > > > > through, it would be 2, then 4, 8 16, etc. So, I don't see how\n\n> > > it could\n\n> > > > be\n\n> > > > > > retrying the request in less than a second\n\n> > > > > >\n\n> > > > > >\n\n> > > >\n\n> > > > The exact line I quoted above can be found at line 556 of\n\n> > > > boto/boto/connection.py. You could just change that to a hard-coded\n\n> > > value\n\n> > > > of 5\n\n> > > > or something and see what happens. I'd definitely like to find out\n\n> > > what's\n\n> > > > happening so let me know if I can help at all.\n\n> > > >\n\n> > > >\n\n> >\n\n> >\n\n  \n  \n\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=rusvika","name":"rusvika","key":"rusvika","accountId":"557058:0f138bdf-f1d0-4468-9edd-e45575af47da","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/c975ce5391bf03e1a9aa2a957435569b?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Drusvika%26avatarId%3D10701%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/c975ce5391bf03e1a9aa2a957435569b?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Drusvika%26avatarId%3D10701%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/c975ce5391bf03e1a9aa2a957435569b?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Drusvika%26avatarId%3D10701%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/c975ce5391bf03e1a9aa2a957435569b?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Drusvika%26avatarId%3D10701%26noRedirect%3Dtrue"},"displayName":"Vika Felmetsger","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-04-23T16:09:11.998-0500","updated":"2012-04-23T16:09:11.998-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/10830/comment/14061","id":"14061","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"body":"Originally posted on 2011-06-07 04:46:00 by admin\n\nhttp://support.eucalyptus.com/Ticket/Display.html?id=2458\nThis is a comment.  It is not sent to the Requestor(s):\n\nYe, Chris is right, but only if the message being resent has a different\nsignature (this can happen for the same message only if the timestamps that are\nincluded in the signature calculation are different). It all depends on whether\neuca2ools/boto generate a new timestamp and re-sign the message on each new\nresend attempt. From your original trace, it looks like euca2ools do not\ngenerate a new timestamp on the retry: ...01%22%2C%0A%20%20%22Statement%22%3A%5B%7B%0A%20%20%20%20%22Sid%22%3A%221%22%2C%0A%20%20%20%20%22Effect%22%3A%22Allow%22%2C%0A%20%20%20%20%22Action%22%3A%22ec2%3Aassociateaddress%22%2C%0A%20%20%20%20%22Resource%22%3A%22arn%3Aaws%3Aec2%3A%3A%3Aaddress%2F192.168.1.1%22%0A%20%20%7D%5D%0A%7D%0A&PolicyName=testpolicy&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2011->\n06-06T21%3A14%3A25Z&UserName=testuser&Version=2010-05-\n> 08&Signature=22tvnExeafRejR770cADvNcV3HymLY7StXPuEUEWDgk%3D\n...\n> retrying in 1 seconds\n...\n01%22%2C%0A%20%20%22Statement%22%3A%5B%7B%0A%20%20%20%20%22Sid%22%3A%221%22%2C%0A%20%20%20%20%22Effect%22%3A%22Allow%22%2C%0A%20%20%20%20%22Action%22%3A%22ec2%3Aassociateaddress%22%2C%0A%20%20%20%20%22Resource%22%3A%22arn%3Aaws%3Aec2%3A%3A%3Aaddress%2F192.168.1.1%22%0A%20%20%7D%5D%0A%7D%0A&PolicyName=testpolicy&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2011-\n> 06-06T21%3A14%3A25Z&UserName=testuser&Version=2010-05-\n> 08&Signature=22tvnExeafRejR770cADvNcV3HymLY7StXPuEUEWDgk%3D\nAs you see, the timestamp is the same in the second message sent 1 sec later\nand, therefore, the signature is the same, so a replay is detected. If the\ntimestamp in the second message differed by at least 1 second, the signature\nwould be different and there would be no problem on CLC side.\n\nOn Mon Jun 06 21:25:22 2011, wen.ye wrote:\n> Hi, Vika:\n>\n> Chris told me that an one second backoff should avoid the replay attack\n> detection. Maybe he's wrong?\n>\n> Ye\n>\n> On Mon, Jun 6, 2011 at 8:32 PM, Vika Felmetsger via RT <\n> bugs@support.eucalyptus.com> wrote:\n>\n> >\n> > http://support.eucalyptus.com/Ticket/Display.html?id=2458\n> > This is a comment. It is not sent to the Requestor(s):\n> >\n> > Ye,\n> >\n> > As I understand from Mitch's previous responses, the problem here is not\n> > the\n> > time between the retries but the fact that the messages are not re-signed\n> > (and\n> > contain the same timestamp). CLC is going to keep the first message's\n> > signature\n> > cached for 5 mins (until the timestamp on it actually expires and makes it\n> > invalid) and will complain about replays if a message with the same\n> > signature\n> > is received. So, unless euca2ools retry the message with a new\n> > timestamp(resulting in a different signature), a replay attack will be\n> > detected.\n> >\n> > On Mon Jun 06 18:50:22 2011, wen.ye wrote:\n> > > Thanks Mitch. I'll keep you posted.\n> > >\n> > > On Mon, Jun 6, 2011 at 6:37 PM, Mitch Garnaat via RT <\n> > > bugs@support.eucalyptus.com> wrote:\n> > >\n> > > > On Mon Jun 06 18:32:55 2011, wen.ye wrote:\n> > > > > The exact problem here is somewhere in my code throwing an NPE and\n> > > > causing a\n> > > > > 500 error, which was then overridden by the replay attack error.\n> > > So I\n> > > > guess\n> > > > > we could do better in the backend, but it is useful to have tools\n> > > showing\n> > > > > the real error. Anyway, could you point me to the code, maybe I\n> > > can try\n> > > > > playing with the backoff time a little?\n> > > > >\n> > > > > Thanks!\n> > > > >\n> > > > > On Mon, Jun 6, 2011 at 6:27 PM, Mitch Garnaat via RT <\n> > > > > bugs@support.eucalyptus.com> wrote:\n> > > > >\n> > > > > > On Mon Jun 06 18:08:47 2011, wen.ye wrote:\n> > > > > > > Mitch:\n> > > > > > >\n> > > > > > > What is the first backoff time? It seems that it is not long\n> > > enough\n> > > > to\n> > > > > > > prevent the replay attack prevention mechanism. The real\n> > > problem here\n> > > > > > > is\n> > > > > > > that the first error is obscured by the replay attack error,\n> > > which is\n> > > > > > > very\n> > > > > > > inconvenient for users.\n> > > > > > >\n> > > > > > > Ye\n> > > > > > >\n> > > > > > > On Mon, Jun 6, 2011 at 3:23 PM, Ye Wen <wenye@eucalyptus.com>\n> > > wrote:\n> > > > > > >\n> > > > > > > > Mitch:\n> > > > > > > >\n> > > > > > > > Let's talk about it first before making any changes. I'm\n> > > still\n> > > > > > > > investigating the problem I just saw. It might be the case\n> > > that\n> > > > your\n> > > > > > > backoff\n> > > > > > > > algorithm works, but something else is wrong. I will let you\n> > > know.\n> > > > > > > >\n> > > > > > > > Thanks!\n> > > > > > > > Ye\n> > > > > > > >\n> > > > > > > >\n> > > > > > > > On Mon, Jun 6, 2011 at 3:20 PM, Mitch Garnaat via RT <\n> > > > > > > > bugs@support.eucalyptus.com> wrote:\n> > > > > > > >\n> > > > > > > >>\n> > > > > > > >> http://support.eucalyptus.com/Ticket/Display.html?id=2458\n> > > > > > > >> This is a comment. It is not sent to the Requestor(s):\n> > > > > > > >>\n> > > > > > > >> I will investigate making the change in boto. However, this\n> > > > > > > behavior is\n> > > > > > > >> significantly different than AWS and will probably cause\n> > > problems\n> > > > > > > for\n> > > > > > > >> other\n> > > > > > > >> clients and libraries.\n> > > > > > > >>\n> > > > > > > >>\n> > > > > > > >\n> > > > > >\n> > > > > > If boto receives a 500 error, it will attempt a retry. There is\n> > > a loop\n> > > > > > controlling the number of retries (this is settable via the boto\n> > > config\n> > > > > > file)\n> > > > > > but each time through the loop, this line is executed:\n> > > > > >\n> > > > > > time.sleep(2 ** i)\n> > > > > > initially, I has a value of 0 so the delay would be 1 second.\n> > > The\n> > > > second\n> > > > > > time\n> > > > > > through, it would be 2, then 4, 8 16, etc. So, I don't see how\n> > > it could\n> > > > be\n> > > > > > retrying the request in less than a second\n> > > > > >\n> > > > > >\n> > > >\n> > > > The exact line I quoted above can be found at line 556 of\n> > > > boto/boto/connection.py. You could just change that to a hard-coded\n> > > value\n> > > > of 5\n> > > > or something and see what happens. I'd definitely like to find out\n> > > what's\n> > > > happening so let me know if I can help at all.\n> > > >\n> > > >\n> >\n> >\n\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"created":"2012-04-23T16:09:12.589-0500","updated":"2012-04-23T16:09:12.589-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/10830/comment/14062","id":"14062","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"body":"Originally posted on 2011-06-07 04:48:52 by wenye\n\n<URL: http://support.eucalyptus.com/Ticket/Display.html?id=2458 >\n\nGood point. I think that's the problem. Thanks Vika.\n\nMitch, could you verify that? Is it easy to fix?\n\nOn Mon, Jun 6, 2011 at 9:46 PM, Vika Felmetsger via RT <\nbugs@support.eucalyptus.com> wrote:\n\n>\n> http://support.eucalyptus.com/Ticket/Display.html?id=2458\n> This is a comment.  It is not sent to the Requestor(s):\n>\n> Ye, Chris is right, but only if the message being resent has a different\n> signature (this can happen for the same message only if the timestamps that\n> are\n> included in the signature calculation are different). It all depends on\n> whether\n> euca2ools/boto generate a new timestamp and re-sign the message on each new\n> resend attempt. From your original trace, it looks like euca2ools do not\n> generate a new timestamp on the retry:\n> ...01%22%2C%0A%20%20%22Statement%22%3A%5B%7B%0A%20%20%20%20%22Sid%22%3A%221%22%2C%0A%20%20%20%20%22Effect%22%3A%22Allow%22%2C%0A%20%20%20%20%22Action%22%3A%22ec2%3Aassociateaddress%22%2C%0A%20%20%20%20%22Resource%22%3A%22arn%3Aaws%3Aec2%3A%3A%3Aaddress%2F192.168.1.1%22%0A%20%20%7D%5D%0A%7D%0A&PolicyName=testpolicy&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2011->\n> 06-06T21%3A14%3A25Z&UserName=testuser&Version=2010-05-\n> > 08&Signature=22tvnExeafRejR770cADvNcV3HymLY7StXPuEUEWDgk%3D\n> ...\n> > retrying in 1 seconds\n> ...\n>\n> 01%22%2C%0A%20%20%22Statement%22%3A%5B%7B%0A%20%20%20%20%22Sid%22%3A%221%22%2C%0A%20%20%20%20%22Effect%22%3A%22Allow%22%2C%0A%20%20%20%20%22Action%22%3A%22ec2%3Aassociateaddress%22%2C%0A%20%20%20%20%22Resource%22%3A%22arn%3Aaws%3Aec2%3A%3A%3Aaddress%2F192.168.1.1%22%0A%20%20%7D%5D%0A%7D%0A&PolicyName=testpolicy&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2011-\n> > 06-06T21%3A14%3A25Z&UserName=testuser&Version=2010-05-\n> > 08&Signature=22tvnExeafRejR770cADvNcV3HymLY7StXPuEUEWDgk%3D\n> As you see, the timestamp is the same in the second message sent 1 sec\n> later\n> and, therefore, the signature is the same, so a replay is detected. If the\n> timestamp in the second message differed by at least 1 second, the\n> signature\n> would be different and there would be no problem on CLC side.\n>\n> On Mon Jun 06 21:25:22 2011, wen.ye wrote:\n> > Hi, Vika:\n> >\n> > Chris told me that an one second backoff should avoid the replay attack\n> > detection. Maybe he's wrong?\n> >\n> > Ye\n> >\n> > On Mon, Jun 6, 2011 at 8:32 PM, Vika Felmetsger via RT <\n> > bugs@support.eucalyptus.com> wrote:\n> >\n> > >\n> > > http://support.eucalyptus.com/Ticket/Display.html?id=2458\n> > > This is a comment. It is not sent to the Requestor(s):\n> > >\n> > > Ye,\n> > >\n> > > As I understand from Mitch's previous responses, the problem here is\n> not\n> > > the\n> > > time between the retries but the fact that the messages are not\n> re-signed\n> > > (and\n> > > contain the same timestamp). CLC is going to keep the first message's\n> > > signature\n> > > cached for 5 mins (until the timestamp on it actually expires and makes\n> it\n> > > invalid) and will complain about replays if a message with the same\n> > > signature\n> > > is received. So, unless euca2ools retry the message with a new\n> > > timestamp(resulting in a different signature), a replay attack will be\n> > > detected.\n> > >\n> > > On Mon Jun 06 18:50:22 2011, wen.ye wrote:\n> > > > Thanks Mitch. I'll keep you posted.\n> > > >\n> > > > On Mon, Jun 6, 2011 at 6:37 PM, Mitch Garnaat via RT <\n> > > > bugs@support.eucalyptus.com> wrote:\n> > > >\n> > > > > On Mon Jun 06 18:32:55 2011, wen.ye wrote:\n> > > > > > The exact problem here is somewhere in my code throwing an NPE\n> and\n> > > > > causing a\n> > > > > > 500 error, which was then overridden by the replay attack error.\n> > > > So I\n> > > > > guess\n> > > > > > we could do better in the backend, but it is useful to have tools\n> > > > showing\n> > > > > > the real error. Anyway, could you point me to the code, maybe I\n> > > > can try\n> > > > > > playing with the backoff time a little?\n> > > > > >\n> > > > > > Thanks!\n> > > > > >\n> > > > > > On Mon, Jun 6, 2011 at 6:27 PM, Mitch Garnaat via RT <\n> > > > > > bugs@support.eucalyptus.com> wrote:\n> > > > > >\n> > > > > > > On Mon Jun 06 18:08:47 2011, wen.ye wrote:\n> > > > > > > > Mitch:\n> > > > > > > >\n> > > > > > > > What is the first backoff time? It seems that it is not long\n> > > > enough\n> > > > > to\n> > > > > > > > prevent the replay attack prevention mechanism. The real\n> > > > problem here\n> > > > > > > > is\n> > > > > > > > that the first error is obscured by the replay attack error,\n> > > > which is\n> > > > > > > > very\n> > > > > > > > inconvenient for users.\n> > > > > > > >\n> > > > > > > > Ye\n> > > > > > > >\n> > > > > > > > On Mon, Jun 6, 2011 at 3:23 PM, Ye Wen <wenye@eucalyptus.com\n> >\n> > > > wrote:\n> > > > > > > >\n> > > > > > > > > Mitch:\n> > > > > > > > >\n> > > > > > > > > Let's talk about it first before making any changes. I'm\n> > > > still\n> > > > > > > > > investigating the problem I just saw. It might be the case\n> > > > that\n> > > > > your\n> > > > > > > > backoff\n> > > > > > > > > algorithm works, but something else is wrong. I will let\n> you\n> > > > know.\n> > > > > > > > >\n> > > > > > > > > Thanks!\n> > > > > > > > > Ye\n> > > > > > > > >\n> > > > > > > > >\n> > > > > > > > > On Mon, Jun 6, 2011 at 3:20 PM, Mitch Garnaat via RT <\n> > > > > > > > > bugs@support.eucalyptus.com> wrote:\n> > > > > > > > >\n> > > > > > > > >>\n> > > > > > > > >> http://support.eucalyptus.com/Ticket/Display.html?id=2458\n> > > > > > > > >> This is a comment. It is not sent to the Requestor(s):\n> > > > > > > > >>\n> > > > > > > > >> I will investigate making the change in boto. However,\n> this\n> > > > > > > > behavior is\n> > > > > > > > >> significantly different than AWS and will probably cause\n> > > > problems\n> > > > > > > > for\n> > > > > > > > >> other\n> > > > > > > > >> clients and libraries.\n> > > > > > > > >>\n> > > > > > > > >>\n> > > > > > > > >\n> > > > > > >\n> > > > > > > If boto receives a 500 error, it will attempt a retry. There is\n> > > > a loop\n> > > > > > > controlling the number of retries (this is settable via the\n> boto\n> > > > config\n> > > > > > > file)\n> > > > > > > but each time through the loop, this line is executed:\n> > > > > > >\n> > > > > > > time.sleep(2 ** i)\n> > > > > > > initially, I has a value of 0 so the delay would be 1 second.\n> > > > The\n> > > > > second\n> > > > > > > time\n> > > > > > > through, it would be 2, then 4, 8 16, etc. So, I don't see how\n> > > > it could\n> > > > > be\n> > > > > > > retrying the request in less than a second\n> > > > > > >\n> > > > > > >\n> > > > >\n> > > > > The exact line I quoted above can be found at line 556 of\n> > > > > boto/boto/connection.py. You could just change that to a hard-coded\n> > > > value\n> > > > > of 5\n> > > > > or something and see what happens. I'd definitely like to find out\n> > > > what's\n> > > > > happening so let me know if I can help at all.\n> > > > >\n> > > > >\n> > >\n> > >\n>\n>\n\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"created":"2012-04-23T16:09:13.134-0500","updated":"2012-04-23T16:09:13.134-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/10830/comment/14063","id":"14063","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"body":"Originally posted on 2011-06-07 04:48:52 by wenye\nGood point. I think that's the problem. Thanks Vika.\n\nMitch, could you verify that? Is it easy to fix?\n\nOn Mon, Jun 6, 2011 at 9:46 PM, Vika Felmetsger via RT <\nbugs@support.eucalyptus.com> wrote:\n\n>\n> http://support.eucalyptus.com/Ticket/Display.html?id=2458\n> This is a comment.  It is not sent to the Requestor(s):\n>\n> Ye, Chris is right, but only if the message being resent has a different\n> signature (this can happen for the same message only if the timestamps that\n> are\n> included in the signature calculation are different). It all depends on\n> whether\n> euca2ools/boto generate a new timestamp and re-sign the message on each new\n> resend attempt. From your original trace, it looks like euca2ools do not\n> generate a new timestamp on the retry:\n> ...01%22%2C%0A%20%20%22Statement%22%3A%5B%7B%0A%20%20%20%20%22Sid%22%3A%221%22%2C%0A%20%20%20%20%22Effect%22%3A%22Allow%22%2C%0A%20%20%20%20%22Action%22%3A%22ec2%3Aassociateaddress%22%2C%0A%20%20%20%20%22Resource%22%3A%22arn%3Aaws%3Aec2%3A%3A%3Aaddress%2F192.168.1.1%22%0A%20%20%7D%5D%0A%7D%0A&PolicyName=testpolicy&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2011->\n> 06-06T21%3A14%3A25Z&UserName=testuser&Version=2010-05-\n> > 08&Signature=22tvnExeafRejR770cADvNcV3HymLY7StXPuEUEWDgk%3D\n> ...\n> > retrying in 1 seconds\n> ...\n>\n> 01%22%2C%0A%20%20%22Statement%22%3A%5B%7B%0A%20%20%20%20%22Sid%22%3A%221%22%2C%0A%20%20%20%20%22Effect%22%3A%22Allow%22%2C%0A%20%20%20%20%22Action%22%3A%22ec2%3Aassociateaddress%22%2C%0A%20%20%20%20%22Resource%22%3A%22arn%3Aaws%3Aec2%3A%3A%3Aaddress%2F192.168.1.1%22%0A%20%20%7D%5D%0A%7D%0A&PolicyName=testpolicy&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2011-\n> > 06-06T21%3A14%3A25Z&UserName=testuser&Version=2010-05-\n> > 08&Signature=22tvnExeafRejR770cADvNcV3HymLY7StXPuEUEWDgk%3D\n> As you see, the timestamp is the same in the second message sent 1 sec\n> later\n> and, therefore, the signature is the same, so a replay is detected. If the\n> timestamp in the second message differed by at least 1 second, the\n> signature\n> would be different and there would be no problem on CLC side.\n>\n> On Mon Jun 06 21:25:22 2011, wen.ye wrote:\n> > Hi, Vika:\n> >\n> > Chris told me that an one second backoff should avoid the replay attack\n> > detection. Maybe he's wrong?\n> >\n> > Ye\n> >\n> > On Mon, Jun 6, 2011 at 8:32 PM, Vika Felmetsger via RT <\n> > bugs@support.eucalyptus.com> wrote:\n> >\n> > >\n> > > http://support.eucalyptus.com/Ticket/Display.html?id=2458\n> > > This is a comment. It is not sent to the Requestor(s):\n> > >\n> > > Ye,\n> > >\n> > > As I understand from Mitch's previous responses, the problem here is\n> not\n> > > the\n> > > time between the retries but the fact that the messages are not\n> re-signed\n> > > (and\n> > > contain the same timestamp). CLC is going to keep the first message's\n> > > signature\n> > > cached for 5 mins (until the timestamp on it actually expires and makes\n> it\n> > > invalid) and will complain about replays if a message with the same\n> > > signature\n> > > is received. So, unless euca2ools retry the message with a new\n> > > timestamp(resulting in a different signature), a replay attack will be\n> > > detected.\n> > >\n> > > On Mon Jun 06 18:50:22 2011, wen.ye wrote:\n> > > > Thanks Mitch. I'll keep you posted.\n> > > >\n> > > > On Mon, Jun 6, 2011 at 6:37 PM, Mitch Garnaat via RT <\n> > > > bugs@support.eucalyptus.com> wrote:\n> > > >\n> > > > > On Mon Jun 06 18:32:55 2011, wen.ye wrote:\n> > > > > > The exact problem here is somewhere in my code throwing an NPE\n> and\n> > > > > causing a\n> > > > > > 500 error, which was then overridden by the replay attack error.\n> > > > So I\n> > > > > guess\n> > > > > > we could do better in the backend, but it is useful to have tools\n> > > > showing\n> > > > > > the real error. Anyway, could you point me to the code, maybe I\n> > > > can try\n> > > > > > playing with the backoff time a little?\n> > > > > >\n> > > > > > Thanks!\n> > > > > >\n> > > > > > On Mon, Jun 6, 2011 at 6:27 PM, Mitch Garnaat via RT <\n> > > > > > bugs@support.eucalyptus.com> wrote:\n> > > > > >\n> > > > > > > On Mon Jun 06 18:08:47 2011, wen.ye wrote:\n> > > > > > > > Mitch:\n> > > > > > > >\n> > > > > > > > What is the first backoff time? It seems that it is not long\n> > > > enough\n> > > > > to\n> > > > > > > > prevent the replay attack prevention mechanism. The real\n> > > > problem here\n> > > > > > > > is\n> > > > > > > > that the first error is obscured by the replay attack error,\n> > > > which is\n> > > > > > > > very\n> > > > > > > > inconvenient for users.\n> > > > > > > >\n> > > > > > > > Ye\n> > > > > > > >\n> > > > > > > > On Mon, Jun 6, 2011 at 3:23 PM, Ye Wen <wenye@eucalyptus.com\n> >\n> > > > wrote:\n> > > > > > > >\n> > > > > > > > > Mitch:\n> > > > > > > > >\n> > > > > > > > > Let's talk about it first before making any changes. I'm\n> > > > still\n> > > > > > > > > investigating the problem I just saw. It might be the case\n> > > > that\n> > > > > your\n> > > > > > > > backoff\n> > > > > > > > > algorithm works, but something else is wrong. I will let\n> you\n> > > > know.\n> > > > > > > > >\n> > > > > > > > > Thanks!\n> > > > > > > > > Ye\n> > > > > > > > >\n> > > > > > > > >\n> > > > > > > > > On Mon, Jun 6, 2011 at 3:20 PM, Mitch Garnaat via RT <\n> > > > > > > > > bugs@support.eucalyptus.com> wrote:\n> > > > > > > > >\n> > > > > > > > >>\n> > > > > > > > >> http://support.eucalyptus.com/Ticket/Display.html?id=2458\n> > > > > > > > >> This is a comment. It is not sent to the Requestor(s):\n> > > > > > > > >>\n> > > > > > > > >> I will investigate making the change in boto. However,\n> this\n> > > > > > > > behavior is\n> > > > > > > > >> significantly different than AWS and will probably cause\n> > > > problems\n> > > > > > > > for\n> > > > > > > > >> other\n> > > > > > > > >> clients and libraries.\n> > > > > > > > >>\n> > > > > > > > >>\n> > > > > > > > >\n> > > > > > >\n> > > > > > > If boto receives a 500 error, it will attempt a retry. There is\n> > > > a loop\n> > > > > > > controlling the number of retries (this is settable via the\n> boto\n> > > > config\n> > > > > > > file)\n> > > > > > > but each time through the loop, this line is executed:\n> > > > > > >\n> > > > > > > time.sleep(2 ** i)\n> > > > > > > initially, I has a value of 0 so the delay would be 1 second.\n> > > > The\n> > > > > second\n> > > > > > > time\n> > > > > > > through, it would be 2, then 4, 8 16, etc. So, I don't see how\n> > > > it could\n> > > > > be\n> > > > > > > retrying the request in less than a second\n> > > > > > >\n> > > > > > >\n> > > > >\n> > > > > The exact line I quoted above can be found at line 556 of\n> > > > > boto/boto/connection.py. You could just change that to a hard-coded\n> > > > value\n> > > > > of 5\n> > > > > or something and see what happens. I'd definitely like to find out\n> > > > what's\n> > > > > happening so let me know if I can help at all.\n> > > > >\n> > > > >\n> > >\n> > >\n>\n>\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"created":"2012-04-23T16:09:13.702-0500","updated":"2012-04-23T16:09:13.702-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/10830/comment/14064","id":"14064","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"body":"Originally posted on 2011-06-07 04:48:52 by wenye\nGood point. I think that&#39;s the problem. Thanks Vika.<div><br></div><div>Mitch, could you verify that? Is it easy to fix?<br><div><br><div class=\"gmail_quote\">On Mon, Jun 6, 2011 at 9:46 PM, Vika Felmetsger via RT <span dir=\"ltr\"><<a href=\"mailto:bugs@support.eucalyptus.com\">bugs@support.eucalyptus.com</a>></span> wrote:<br>\n\n<blockquote class=\"gmail_quote\" style=\"margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex;\"><div class=\"im\"><br>\n<a href=\"http://support.eucalyptus.com/Ticket/Display.html?id=2458\" target=\"_blank\">http://support.eucalyptus.com/Ticket/Display.html?id=2458</a><br>\nThis is a comment.   It is not sent to the Requestor(s):<br>\n<br>\n</div>Ye, Chris is right, but only if the message being resent has a different<br>\nsignature (this can happen for the same message only if the timestamps that are<br>\nincluded in the signature calculation are different). It all depends on whether<br>\neuca2ools/boto generate a new timestamp and re-sign the message on each new<br>\nresend attempt. From your original trace, it looks like euca2ools do not<br>\ngenerate a new timestamp on the retry: ...01%22%2C%0A%20%20%22Statement%22%3A%5B%7B%0A%20%20%20%20%22Sid%22%3A%221%22%2C%0A%20%20%20%20%22Effect%22%3A%22Allow%22%2C%0A%20%20%20%20%22Action%22%3A%22ec2%3Aassociateaddress%22%2C%0A%20%20%20%20%22Resource%22%3A%22arn%3Aaws%3Aec2%3A%3A%3Aaddress%2F192.168.1.1%22%0A%20%20%7D%5D%0A%7D%0A&PolicyName=testpolicy&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2011-><br>\n\n\n06-06T21%3A14%3A25Z&UserName=testuser&Version=2010-05-<br>\n> 08&Signature=22tvnExeafRejR770cADvNcV3HymLY7StXPuEUEWDgk%3D<br>\n...<br>\n> retrying in 1 seconds<br>\n...<br>\n01%22%2C%0A%20%20%22Statement%22%3A%5B%7B%0A%20%20%20%20%22Sid%22%3A%221%22%2C%0A%20%20%20%20%22Effect%22%3A%22Allow%22%2C%0A%20%20%20%20%22Action%22%3A%22ec2%3Aassociateaddress%22%2C%0A%20%20%20%20%22Resource%22%3A%22arn%3Aaws%3Aec2%3A%3A%3Aaddress%2F192.168.1.1%22%0A%20%20%7D%5D%0A%7D%0A&PolicyName=testpolicy&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2011-<br>\n\n\n> 06-06T21%3A14%3A25Z&UserName=testuser&Version=2010-05-<br>\n> 08&Signature=22tvnExeafRejR770cADvNcV3HymLY7StXPuEUEWDgk%3D<br>\nAs you see, the timestamp is the same in the second message sent 1 sec later<br>\nand, therefore, the signature is the same, so a replay is detected. If the<br>\ntimestamp in the second message differed by at least 1 second, the signature<br>\nwould be different and there would be no problem on CLC side.<br>\n<div><div></div><div class=\"h5\"><br>\nOn Mon Jun 06 21:25:22 2011, <a href=\"http://wen.ye\" target=\"_blank\">wen.ye</a> wrote:<br>\n> Hi, Vika:<br>\n><br>\n> Chris told me that an one second backoff should avoid the replay attack<br>\n> detection. Maybe he&#39;s wrong?<br>\n><br>\n> Ye<br>\n><br>\n> On Mon, Jun 6, 2011 at 8:32 PM, Vika Felmetsger via RT <<br>\n> <a href=\"mailto:bugs@support.eucalyptus.com\">bugs@support.eucalyptus.com</a>> wrote:<br>\n><br>\n> ><br>\n> > <a href=\"http://support.eucalyptus.com/Ticket/Display.html?id=2458\" target=\"_blank\">http://support.eucalyptus.com/Ticket/Display.html?id=2458</a><br>\n> > This is a comment. It is not sent to the Requestor(s):<br>\n> ><br>\n> > Ye,<br>\n> ><br>\n> > As I understand from Mitch&#39;s previous responses, the problem here is not<br>\n> > the<br>\n> > time between the retries but the fact that the messages are not re-signed<br>\n> > (and<br>\n> > contain the same timestamp). CLC is going to keep the first message&#39;s<br>\n> > signature<br>\n> > cached for 5 mins (until the timestamp on it actually expires and makes it<br>\n> > invalid) and will complain about replays if a message with the same<br>\n> > signature<br>\n> > is received. So, unless euca2ools retry the message with a new<br>\n> > timestamp(resulting in a different signature), a replay attack will be<br>\n> > detected.<br>\n> ><br>\n> > On Mon Jun 06 18:50:22 2011, <a href=\"http://wen.ye\" target=\"_blank\">wen.ye</a> wrote:<br>\n> > > Thanks Mitch. I&#39;ll keep you posted.<br>\n> > ><br>\n> > > On Mon, Jun 6, 2011 at 6:37 PM, Mitch Garnaat via RT <<br>\n> > > <a href=\"mailto:bugs@support.eucalyptus.com\">bugs@support.eucalyptus.com</a>> wrote:<br>\n> > ><br>\n> > > > On Mon Jun 06 18:32:55 2011, <a href=\"http://wen.ye\" target=\"_blank\">wen.ye</a> wrote:<br>\n> > > > > The exact problem here is somewhere in my code throwing an NPE and<br>\n> > > > causing a<br>\n> > > > > 500 error, which was then overridden by the replay attack error.<br>\n> > > So I<br>\n> > > > guess<br>\n> > > > > we could do better in the backend, but it is useful to have tools<br>\n> > > showing<br>\n> > > > > the real error. Anyway, could you point me to the code, maybe I<br>\n> > > can try<br>\n> > > > > playing with the backoff time a little?<br>\n> > > > ><br>\n> > > > > Thanks!<br>\n> > > > ><br>\n> > > > > On Mon, Jun 6, 2011 at 6:27 PM, Mitch Garnaat via RT <<br>\n> > > > > <a href=\"mailto:bugs@support.eucalyptus.com\">bugs@support.eucalyptus.com</a>> wrote:<br>\n> > > > ><br>\n> > > > > > On Mon Jun 06 18:08:47 2011, <a href=\"http://wen.ye\" target=\"_blank\">wen.ye</a> wrote:<br>\n> > > > > > > Mitch:<br>\n> > > > > > ><br>\n> > > > > > > What is the first backoff time? It seems that it is not long<br>\n> > > enough<br>\n> > > > to<br>\n> > > > > > > prevent the replay attack prevention mechanism. The real<br>\n> > > problem here<br>\n> > > > > > > is<br>\n> > > > > > > that the first error is obscured by the replay attack error,<br>\n> > > which is<br>\n> > > > > > > very<br>\n> > > > > > > inconvenient for users.<br>\n> > > > > > ><br>\n> > > > > > > Ye<br>\n> > > > > > ><br>\n> > > > > > > On Mon, Jun 6, 2011 at 3:23 PM, Ye Wen <<a href=\"mailto:wenye@eucalyptus.com\">wenye@eucalyptus.com</a>><br>\n> > > wrote:<br>\n> > > > > > ><br>\n> > > > > > > > Mitch:<br>\n> > > > > > > ><br>\n> > > > > > > > Let&#39;s talk about it first before making any changes. I&#39;m<br>\n> > > still<br>\n> > > > > > > > investigating the problem I just saw. It might be the case<br>\n> > > that<br>\n> > > > your<br>\n> > > > > > > backoff<br>\n> > > > > > > > algorithm works, but something else is wrong. I will let you<br>\n> > > know.<br>\n> > > > > > > ><br>\n> > > > > > > > Thanks!<br>\n> > > > > > > > Ye<br>\n> > > > > > > ><br>\n> > > > > > > ><br>\n> > > > > > > > On Mon, Jun 6, 2011 at 3:20 PM, Mitch Garnaat via RT <<br>\n> > > > > > > > <a href=\"mailto:bugs@support.eucalyptus.com\">bugs@support.eucalyptus.com</a>> wrote:<br>\n> > > > > > > ><br>\n> > > > > > > >><br>\n> > > > > > > >> <a href=\"http://support.eucalyptus.com/Ticket/Display.html?id=2458\" target=\"_blank\">http://support.eucalyptus.com/Ticket/Display.html?id=2458</a><br>\n> > > > > > > >> This is a comment. It is not sent to the Requestor(s):<br>\n> > > > > > > >><br>\n> > > > > > > >> I will investigate making the change in boto. However, this<br>\n> > > > > > > behavior is<br>\n> > > > > > > >> significantly different than AWS and will probably cause<br>\n> > > problems<br>\n> > > > > > > for<br>\n> > > > > > > >> other<br>\n> > > > > > > >> clients and libraries.<br>\n> > > > > > > >><br>\n> > > > > > > >><br>\n> > > > > > > ><br>\n> > > > > ><br>\n> > > > > > If boto receives a 500 error, it will attempt a retry. There is<br>\n> > > a loop<br>\n> > > > > > controlling the number of retries (this is settable via the boto<br>\n> > > config<br>\n> > > > > > file)<br>\n> > > > > > but each time through the loop, this line is executed:<br>\n> > > > > ><br>\n> > > > > > time.sleep(2 ** i)<br>\n> > > > > > initially, I has a value of 0 so the delay would be 1 second.<br>\n> > > The<br>\n> > > > second<br>\n> > > > > > time<br>\n> > > > > > through, it would be 2, then 4, 8 16, etc. So, I don&#39;t see how<br>\n> > > it could<br>\n> > > > be<br>\n> > > > > > retrying the request in less than a second<br>\n> > > > > ><br>\n> > > > > ><br>\n> > > ><br>\n> > > > The exact line I quoted above can be found at line 556 of<br>\n> > > > boto/boto/connection.py. You could just change that to a hard-coded<br>\n> > > value<br>\n> > > > of 5<br>\n> > > > or something and see what happens. I&#39;d definitely like to find out<br>\n> > > what&#39;s<br>\n> > > > happening so let me know if I can help at all.<br>\n> > > ><br>\n> > > ><br>\n> ><br>\n> ><br>\n<br>\n</div></div></blockquote></div><br></div></div>\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"created":"2012-04-23T16:09:14.299-0500","updated":"2012-04-23T16:09:14.299-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/10830/comment/14065","id":"14065","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"body":"Originally posted on 2011-06-07 11:37:14 by admin\nOn Mon Jun 06 21:48:52 2011, wen.ye wrote:\n\n> Good point. I think that's the problem. Thanks Vika.\n\n>\n\n> Mitch, could you verify that? Is it easy to fix?\n\n>\n\n> On Mon, Jun 6, 2011 at 9:46 PM, Vika Felmetsger via RT <\n\n> bugs@support.eucalyptus.com> wrote:\n\n>\n\n> >\n\n> > http://support.eucalyptus.com/Ticket/Display.html?id=2458\n\n> > This is a comment. It is not sent to the Requestor(s):\n\n> >\n\n> > Ye, Chris is right, but only if the message being resent has a\n\n> different\n\n> > signature (this can happen for the same message only if the\n\n> timestamps that\n\n> > are\n\n> > included in the signature calculation are different). It all depends\n\n> on\n\n> > whether\n\n> > euca2ools/boto generate a new timestamp and re-sign the message on\n\n> each new\n\n> > resend attempt. From your original trace, it looks like euca2ools do\n\n> not\n\n> > generate a new timestamp on the retry:\n\n> >\n\n> ...01%22%2C%0A%20%20%22Statement%22%3A%5B%7B%0A%20%20%20%20%22Sid%22%3A%221%\n22%2C%0A%20%20%20%20%22Effect%22%3A%22Allow%22%2C%0A%20%20%20%20%22Action%22%3\nA%22ec2%3Aassociateaddress%22%2C%0A%20%20%20%20%22Resource%22%3A%22arn%3Aaws%3\nAec2%3A%3A%3Aaddress%2F192.168.1.1%22%0A%20%20%7D%5D%0A%7D%0A&PolicyName=testp\nolicy&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2011-\n\n> >\n\n> > 06-06T21%3A14%3A25Z&UserName=testuser&Version=2010-05-\n\n> > > 08&Signature=22tvnExeafRejR770cADvNcV3HymLY7StXPuEUEWDgk%3D\n\n> > ...\n\n> > > retrying in 1 seconds\n\n> > ...\n\n> >\n\n> >\n\n> 01%22%2C%0A%20%20%22Statement%22%3A%5B%7B%0A%20%20%20%20%22Sid%22%3A%221%22%\n2C%0A%20%20%20%20%22Effect%22%3A%22Allow%22%2C%0A%20%20%20%20%22Action%22%3A%2\n2ec2%3Aassociateaddress%22%2C%0A%20%20%20%20%22Resource%22%3A%22arn%3Aaws%3Aec\n2%3A%3A%3Aaddress%2F192.168.1.1%22%0A%20%20%7D%5D%0A%7D%0A&PolicyName=testpoli\ncy&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2011-\n\n> > > 06-06T21%3A14%3A25Z&UserName=testuser&Version=2010-05-\n\n> > > 08&Signature=22tvnExeafRejR770cADvNcV3HymLY7StXPuEUEWDgk%3D\n\n> > As you see, the timestamp is the same in the second message sent 1\n\n> sec\n\n> > later\n\n> > and, therefore, the signature is the same, so a replay is detected.\n\n> If the\n\n> > timestamp in the second message differed by at least 1 second, the\n\n> > signature\n\n> > would be different and there would be no problem on CLC side.\n\n> >\n\n> > On Mon Jun 06 21:25:22 2011, wen.ye wrote:\n\n> > > Hi, Vika:\n\n> > >\n\n> > > Chris told me that an one second backoff should avoid the replay\n\n> attack\n\n> > > detection. Maybe he's wrong?\n\n> > >\n\n> > > Ye\n\n> > >\n\n> > > On Mon, Jun 6, 2011 at 8:32 PM, Vika Felmetsger via RT <\n\n> > > bugs@support.eucalyptus.com> wrote:\n\n> > >\n\n> > > >\n\n> > > > http://support.eucalyptus.com/Ticket/Display.html?id=2458\n\n> > > > This is a comment. It is not sent to the Requestor(s):\n\n> > > >\n\n> > > > Ye,\n\n> > > >\n\n> > > > As I understand from Mitch's previous responses, the problem\n\n> here is\n\n> > not\n\n> > > > the\n\n> > > > time between the retries but the fact that the messages are not\n\n> > re-signed\n\n> > > > (and\n\n> > > > contain the same timestamp). CLC is going to keep the first\n\n> message's\n\n> > > > signature\n\n> > > > cached for 5 mins (until the timestamp on it actually expires\n\n> and makes\n\n> > it\n\n> > > > invalid) and will complain about replays if a message with the\n\n> same\n\n> > > > signature\n\n> > > > is received. So, unless euca2ools retry the message with a new\n\n> > > > timestamp(resulting in a different signature), a replay attack\n\n> will be\n\n> > > > detected.\n\n> > > >\n\n> > > > On Mon Jun 06 18:50:22 2011, wen.ye wrote:\n\n> > > > > Thanks Mitch. I'll keep you posted.\n\n> > > > >\n\n> > > > > On Mon, Jun 6, 2011 at 6:37 PM, Mitch Garnaat via RT <\n\n> > > > > bugs@support.eucalyptus.com> wrote:\n\n> > > > >\n\n> > > > > > On Mon Jun 06 18:32:55 2011, wen.ye wrote:\n\n> > > > > > > The exact problem here is somewhere in my code throwing an\n\n> NPE\n\n> > and\n\n> > > > > > causing a\n\n> > > > > > > 500 error, which was then overridden by the replay attack\n\n> error.\n\n> > > > > So I\n\n> > > > > > guess\n\n> > > > > > > we could do better in the backend, but it is useful to\n\n> have tools\n\n> > > > > showing\n\n> > > > > > > the real error. Anyway, could you point me to the code,\n\n> maybe I\n\n> > > > > can try\n\n> > > > > > > playing with the backoff time a little?\n\n> > > > > > >\n\n> > > > > > > Thanks!\n\n> > > > > > >\n\n> > > > > > > On Mon, Jun 6, 2011 at 6:27 PM, Mitch Garnaat via RT <\n\n> > > > > > > bugs@support.eucalyptus.com> wrote:\n\n> > > > > > >\n\n> > > > > > > > On Mon Jun 06 18:08:47 2011, wen.ye wrote:\n\n> > > > > > > > > Mitch:\n\n> > > > > > > > >\n\n> > > > > > > > > What is the first backoff time? It seems that it is\n\n> not long\n\n> > > > > enough\n\n> > > > > > to\n\n> > > > > > > > > prevent the replay attack prevention mechanism. The\n\n> real\n\n> > > > > problem here\n\n> > > > > > > > > is\n\n> > > > > > > > > that the first error is obscured by the replay attack\n\n> error,\n\n> > > > > which is\n\n> > > > > > > > > very\n\n> > > > > > > > > inconvenient for users.\n\n> > > > > > > > >\n\n> > > > > > > > > Ye\n\n> > > > > > > > >\n\n> > > > > > > > > On Mon, Jun 6, 2011 at 3:23 PM, Ye Wen\n\n> <wenye@eucalyptus.com\n\n> > >\n\n> > > > > wrote:\n\n> > > > > > > > >\n\n> > > > > > > > > > Mitch:\n\n> > > > > > > > > >\n\n> > > > > > > > > > Let's talk about it first before making any changes.\n\n> I'm\n\n> > > > > still\n\n> > > > > > > > > > investigating the problem I just saw. It might be\n\n> the case\n\n> > > > > that\n\n> > > > > > your\n\n> > > > > > > > > backoff\n\n> > > > > > > > > > algorithm works, but something else is wrong. I will\n\n> let\n\n> > you\n\n> > > > > know.\n\n> > > > > > > > > >\n\n> > > > > > > > > > Thanks!\n\n> > > > > > > > > > Ye\n\n> > > > > > > > > >\n\n> > > > > > > > > >\n\n> > > > > > > > > > On Mon, Jun 6, 2011 at 3:20 PM, Mitch Garnaat via RT\n\n> <\n\n> > > > > > > > > > bugs@support.eucalyptus.com> wrote:\n\n> > > > > > > > > >\n\n> > > > > > > > > >>\n\n> > > > > > > > > >>\n\n> http://support.eucalyptus.com/Ticket/Display.html?id=2458\n\n> > > > > > > > > >> This is a comment. It is not sent to the\n\n> Requestor(s):\n\n> > > > > > > > > >>\n\n> > > > > > > > > >> I will investigate making the change in boto.\n\n> However,\n\n> > this\n\n> > > > > > > > > behavior is\n\n> > > > > > > > > >> significantly different than AWS and will probably\n\n> cause\n\n> > > > > problems\n\n> > > > > > > > > for\n\n> > > > > > > > > >> other\n\n> > > > > > > > > >> clients and libraries.\n\n> > > > > > > > > >>\n\n> > > > > > > > > >>\n\n> > > > > > > > > >\n\n> > > > > > > >\n\n> > > > > > > > If boto receives a 500 error, it will attempt a retry.\n\n> There is\n\n> > > > > a loop\n\n> > > > > > > > controlling the number of retries (this is settable via\n\n> the\n\n> > boto\n\n> > > > > config\n\n> > > > > > > > file)\n\n> > > > > > > > but each time through the loop, this line is executed:\n\n> > > > > > > >\n\n> > > > > > > > time.sleep(2 ** i)\n\n> > > > > > > > initially, I has a value of 0 so the delay would be 1\n\n> second.\n\n> > > > > The\n\n> > > > > > second\n\n> > > > > > > > time\n\n> > > > > > > > through, it would be 2, then 4, 8 16, etc. So, I don't\n\n> see how\n\n> > > > > it could\n\n> > > > > > be\n\n> > > > > > > > retrying the request in less than a second\n\n> > > > > > > >\n\n> > > > > > > >\n\n> > > > > >\n\n> > > > > > The exact line I quoted above can be found at line 556 of\n\n> > > > > > boto/boto/connection.py. You could just change that to a\n\n> hard-coded\n\n> > > > > value\n\n> > > > > > of 5\n\n> > > > > > or something and see what happens. I'd definitely like to\n\n> find out\n\n> > > > > what's\n\n> > > > > > happening so let me know if I can help at all.\n\n> > > > > >\n\n> > > > > >\n\n> > > >\n\n> > > >\n\n> >\n\n> >\n\n  \nBoto does not currently resign retries.  That's what I was explaining earlier\nin the thread.  I will go change this in boto, I don't think it will be\ndifficult.  But we need to be aware that boto is only one of many, many\nclients and libraries out there.  I don't know if all of them retry requests\nw/o re-signing but since that is a perfectly acceptable thing to do when\ntalking to AWS (or Euca before this change) I expect at least some do and\nthose will be broken in the same way that boto is now.\n\n  \nI'm concerned that we advertise as being AWS-compatible but then introduce a\nnon-compatible replay detection mechanism that might break clients and\nlibraries.  We should probably try some of the other major tools like the AWS\nCLI tools, jclouds, etc. to see how they behave with this although the problem\nwill only arise when a retry-able (500) error occurs server side.\n\n  \n\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"created":"2012-04-23T16:09:14.902-0500","updated":"2012-04-23T16:09:14.902-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/10830/comment/14066","id":"14066","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"body":"Originally posted on 2011-06-07 11:37:15 by mitch.garnaat@eucalyptus.com\n\n<URL: http://support.eucalyptus.com/Ticket/Display.html?id=2458 >\n\nOn Mon Jun 06 21:48:52 2011, wen.ye wrote:\n> Good point. I think that's the problem. Thanks Vika.\n>\n> Mitch, could you verify that? Is it easy to fix?\n>\n> On Mon, Jun 6, 2011 at 9:46 PM, Vika Felmetsger via RT <\n> bugs@support.eucalyptus.com> wrote:\n>\n> >\n> > http://support.eucalyptus.com/Ticket/Display.html?id=2458\n> > This is a comment. It is not sent to the Requestor(s):\n> >\n> > Ye, Chris is right, but only if the message being resent has a\n> different\n> > signature (this can happen for the same message only if the\n> timestamps that\n> > are\n> > included in the signature calculation are different). It all depends\n> on\n> > whether\n> > euca2ools/boto generate a new timestamp and re-sign the message on\n> each new\n> > resend attempt. From your original trace, it looks like euca2ools do\n> not\n> > generate a new timestamp on the retry:\n> >\n>\n...01%22%2C%0A%20%20%22Statement%22%3A%5B%7B%0A%20%20%20%20%22Sid%22%3A%221%22%2C%0A%20%20%20%20%22Effect%22%3A%22Allow%22%2C%0A%20%20%20%20%22Action%22%3A%22ec2%3Aassociateaddress%22%2C%0A%20%20%20%20%22Resource%22%3A%22arn%3Aaws%3Aec2%3A%3A%3Aaddress%2F192.168.1.1%22%0A%20%20%7D%5D%0A%7D%0A&PolicyName=testpolicy&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2011-\n> >\n> > 06-06T21%3A14%3A25Z&UserName=testuser&Version=2010-05-\n> > > 08&Signature=22tvnExeafRejR770cADvNcV3HymLY7StXPuEUEWDgk%3D\n> > ...\n> > > retrying in 1 seconds\n> > ...\n> >\n> >\n>\n01%22%2C%0A%20%20%22Statement%22%3A%5B%7B%0A%20%20%20%20%22Sid%22%3A%221%22%2C%0A%20%20%20%20%22Effect%22%3A%22Allow%22%2C%0A%20%20%20%20%22Action%22%3A%22ec2%3Aassociateaddress%22%2C%0A%20%20%20%20%22Resource%22%3A%22arn%3Aaws%3Aec2%3A%3A%3Aaddress%2F192.168.1.1%22%0A%20%20%7D%5D%0A%7D%0A&PolicyName=testpolicy&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2011-\n> > > 06-06T21%3A14%3A25Z&UserName=testuser&Version=2010-05-\n> > > 08&Signature=22tvnExeafRejR770cADvNcV3HymLY7StXPuEUEWDgk%3D\n> > As you see, the timestamp is the same in the second message sent 1\n> sec\n> > later\n> > and, therefore, the signature is the same, so a replay is detected.\n> If the\n> > timestamp in the second message differed by at least 1 second, the\n> > signature\n> > would be different and there would be no problem on CLC side.\n> >\n> > On Mon Jun 06 21:25:22 2011, wen.ye wrote:\n> > > Hi, Vika:\n> > >\n> > > Chris told me that an one second backoff should avoid the replay\n> attack\n> > > detection. Maybe he's wrong?\n> > >\n> > > Ye\n> > >\n> > > On Mon, Jun 6, 2011 at 8:32 PM, Vika Felmetsger via RT <\n> > > bugs@support.eucalyptus.com> wrote:\n> > >\n> > > >\n> > > > http://support.eucalyptus.com/Ticket/Display.html?id=2458\n> > > > This is a comment. It is not sent to the Requestor(s):\n> > > >\n> > > > Ye,\n> > > >\n> > > > As I understand from Mitch's previous responses, the problem\n> here is\n> > not\n> > > > the\n> > > > time between the retries but the fact that the messages are not\n> > re-signed\n> > > > (and\n> > > > contain the same timestamp). CLC is going to keep the first\n> message's\n> > > > signature\n> > > > cached for 5 mins (until the timestamp on it actually expires\n> and makes\n> > it\n> > > > invalid) and will complain about replays if a message with the\n> same\n> > > > signature\n> > > > is received. So, unless euca2ools retry the message with a new\n> > > > timestamp(resulting in a different signature), a replay attack\n> will be\n> > > > detected.\n> > > >\n> > > > On Mon Jun 06 18:50:22 2011, wen.ye wrote:\n> > > > > Thanks Mitch. I'll keep you posted.\n> > > > >\n> > > > > On Mon, Jun 6, 2011 at 6:37 PM, Mitch Garnaat via RT <\n> > > > > bugs@support.eucalyptus.com> wrote:\n> > > > >\n> > > > > > On Mon Jun 06 18:32:55 2011, wen.ye wrote:\n> > > > > > > The exact problem here is somewhere in my code throwing an\n> NPE\n> > and\n> > > > > > causing a\n> > > > > > > 500 error, which was then overridden by the replay attack\n> error.\n> > > > > So I\n> > > > > > guess\n> > > > > > > we could do better in the backend, but it is useful to\n> have tools\n> > > > > showing\n> > > > > > > the real error. Anyway, could you point me to the code,\n> maybe I\n> > > > > can try\n> > > > > > > playing with the backoff time a little?\n> > > > > > >\n> > > > > > > Thanks!\n> > > > > > >\n> > > > > > > On Mon, Jun 6, 2011 at 6:27 PM, Mitch Garnaat via RT <\n> > > > > > > bugs@support.eucalyptus.com> wrote:\n> > > > > > >\n> > > > > > > > On Mon Jun 06 18:08:47 2011, wen.ye wrote:\n> > > > > > > > > Mitch:\n> > > > > > > > >\n> > > > > > > > > What is the first backoff time? It seems that it is\n> not long\n> > > > > enough\n> > > > > > to\n> > > > > > > > > prevent the replay attack prevention mechanism. The\n> real\n> > > > > problem here\n> > > > > > > > > is\n> > > > > > > > > that the first error is obscured by the replay attack\n> error,\n> > > > > which is\n> > > > > > > > > very\n> > > > > > > > > inconvenient for users.\n> > > > > > > > >\n> > > > > > > > > Ye\n> > > > > > > > >\n> > > > > > > > > On Mon, Jun 6, 2011 at 3:23 PM, Ye Wen\n> <wenye@eucalyptus.com\n> > >\n> > > > > wrote:\n> > > > > > > > >\n> > > > > > > > > > Mitch:\n> > > > > > > > > >\n> > > > > > > > > > Let's talk about it first before making any changes.\n> I'm\n> > > > > still\n> > > > > > > > > > investigating the problem I just saw. It might be\n> the case\n> > > > > that\n> > > > > > your\n> > > > > > > > > backoff\n> > > > > > > > > > algorithm works, but something else is wrong. I will\n> let\n> > you\n> > > > > know.\n> > > > > > > > > >\n> > > > > > > > > > Thanks!\n> > > > > > > > > > Ye\n> > > > > > > > > >\n> > > > > > > > > >\n> > > > > > > > > > On Mon, Jun 6, 2011 at 3:20 PM, Mitch Garnaat via RT\n> <\n> > > > > > > > > > bugs@support.eucalyptus.com> wrote:\n> > > > > > > > > >\n> > > > > > > > > >>\n> > > > > > > > > >>\n> http://support.eucalyptus.com/Ticket/Display.html?id=2458\n> > > > > > > > > >> This is a comment. It is not sent to the\n> Requestor(s):\n> > > > > > > > > >>\n> > > > > > > > > >> I will investigate making the change in boto.\n> However,\n> > this\n> > > > > > > > > behavior is\n> > > > > > > > > >> significantly different than AWS and will probably\n> cause\n> > > > > problems\n> > > > > > > > > for\n> > > > > > > > > >> other\n> > > > > > > > > >> clients and libraries.\n> > > > > > > > > >>\n> > > > > > > > > >>\n> > > > > > > > > >\n> > > > > > > >\n> > > > > > > > If boto receives a 500 error, it will attempt a retry.\n> There is\n> > > > > a loop\n> > > > > > > > controlling the number of retries (this is settable via\n> the\n> > boto\n> > > > > config\n> > > > > > > > file)\n> > > > > > > > but each time through the loop, this line is executed:\n> > > > > > > >\n> > > > > > > > time.sleep(2 ** i)\n> > > > > > > > initially, I has a value of 0 so the delay would be 1\n> second.\n> > > > > The\n> > > > > > second\n> > > > > > > > time\n> > > > > > > > through, it would be 2, then 4, 8 16, etc. So, I don't\n> see how\n> > > > > it could\n> > > > > > be\n> > > > > > > > retrying the request in less than a second\n> > > > > > > >\n> > > > > > > >\n> > > > > >\n> > > > > > The exact line I quoted above can be found at line 556 of\n> > > > > > boto/boto/connection.py. You could just change that to a\n> hard-coded\n> > > > > value\n> > > > > > of 5\n> > > > > > or something and see what happens. I'd definitely like to\n> find out\n> > > > > what's\n> > > > > > happening so let me know if I can help at all.\n> > > > > >\n> > > > > >\n> > > >\n> > > >\n> >\n> >\n\nBoto does not currently resign retries. That's what I was explaining earlier in\nthe thread. I will go change this in boto, I don't think it will be difficult.\nBut we need to be aware that boto is only one of many, many clients and\nlibraries out there. I don't know if all of them retry requests w/o re-signing\nbut since that is a perfectly acceptable thing to do when talking to AWS (or\nEuca before this change) I expect at least some do and those will be broken in\nthe same way that boto is now.\n\nI'm concerned that we advertise as being AWS-compatible but then introduce a\nnon-compatible replay detection mechanism that might break clients and\nlibraries. We should probably try some of the other major tools like the AWS\nCLI tools, jclouds, etc. to see how they behave with this although the problem\nwill only arise when a retry-able (500) error occurs server side.\n\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"created":"2012-04-23T16:09:15.503-0500","updated":"2012-04-23T16:09:15.503-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/10830/comment/14067","id":"14067","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"body":"Originally posted on 2011-06-07 11:37:15 by mitch.garnaat@eucalyptus.com\nOn Mon Jun 06 21:48:52 2011, wen.ye wrote:\n> Good point. I think that's the problem. Thanks Vika.\n>\n> Mitch, could you verify that? Is it easy to fix?\n>\n> On Mon, Jun 6, 2011 at 9:46 PM, Vika Felmetsger via RT <\n> bugs@support.eucalyptus.com> wrote:\n>\n> >\n> > http://support.eucalyptus.com/Ticket/Display.html?id=2458\n> > This is a comment. It is not sent to the Requestor(s):\n> >\n> > Ye, Chris is right, but only if the message being resent has a\n> different\n> > signature (this can happen for the same message only if the\n> timestamps that\n> > are\n> > included in the signature calculation are different). It all depends\n> on\n> > whether\n> > euca2ools/boto generate a new timestamp and re-sign the message on\n> each new\n> > resend attempt. From your original trace, it looks like euca2ools do\n> not\n> > generate a new timestamp on the retry:\n> >\n>\n...01%22%2C%0A%20%20%22Statement%22%3A%5B%7B%0A%20%20%20%20%22Sid%22%3A%221%22%2C%0A%20%20%20%20%22Effect%22%3A%22Allow%22%2C%0A%20%20%20%20%22Action%22%3A%22ec2%3Aassociateaddress%22%2C%0A%20%20%20%20%22Resource%22%3A%22arn%3Aaws%3Aec2%3A%3A%3Aaddress%2F192.168.1.1%22%0A%20%20%7D%5D%0A%7D%0A&PolicyName=testpolicy&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2011-\n> >\n> > 06-06T21%3A14%3A25Z&UserName=testuser&Version=2010-05-\n> > > 08&Signature=22tvnExeafRejR770cADvNcV3HymLY7StXPuEUEWDgk%3D\n> > ...\n> > > retrying in 1 seconds\n> > ...\n> >\n> >\n>\n01%22%2C%0A%20%20%22Statement%22%3A%5B%7B%0A%20%20%20%20%22Sid%22%3A%221%22%2C%0A%20%20%20%20%22Effect%22%3A%22Allow%22%2C%0A%20%20%20%20%22Action%22%3A%22ec2%3Aassociateaddress%22%2C%0A%20%20%20%20%22Resource%22%3A%22arn%3Aaws%3Aec2%3A%3A%3Aaddress%2F192.168.1.1%22%0A%20%20%7D%5D%0A%7D%0A&PolicyName=testpolicy&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2011-\n> > > 06-06T21%3A14%3A25Z&UserName=testuser&Version=2010-05-\n> > > 08&Signature=22tvnExeafRejR770cADvNcV3HymLY7StXPuEUEWDgk%3D\n> > As you see, the timestamp is the same in the second message sent 1\n> sec\n> > later\n> > and, therefore, the signature is the same, so a replay is detected.\n> If the\n> > timestamp in the second message differed by at least 1 second, the\n> > signature\n> > would be different and there would be no problem on CLC side.\n> >\n> > On Mon Jun 06 21:25:22 2011, wen.ye wrote:\n> > > Hi, Vika:\n> > >\n> > > Chris told me that an one second backoff should avoid the replay\n> attack\n> > > detection. Maybe he's wrong?\n> > >\n> > > Ye\n> > >\n> > > On Mon, Jun 6, 2011 at 8:32 PM, Vika Felmetsger via RT <\n> > > bugs@support.eucalyptus.com> wrote:\n> > >\n> > > >\n> > > > http://support.eucalyptus.com/Ticket/Display.html?id=2458\n> > > > This is a comment. It is not sent to the Requestor(s):\n> > > >\n> > > > Ye,\n> > > >\n> > > > As I understand from Mitch's previous responses, the problem\n> here is\n> > not\n> > > > the\n> > > > time between the retries but the fact that the messages are not\n> > re-signed\n> > > > (and\n> > > > contain the same timestamp). CLC is going to keep the first\n> message's\n> > > > signature\n> > > > cached for 5 mins (until the timestamp on it actually expires\n> and makes\n> > it\n> > > > invalid) and will complain about replays if a message with the\n> same\n> > > > signature\n> > > > is received. So, unless euca2ools retry the message with a new\n> > > > timestamp(resulting in a different signature), a replay attack\n> will be\n> > > > detected.\n> > > >\n> > > > On Mon Jun 06 18:50:22 2011, wen.ye wrote:\n> > > > > Thanks Mitch. I'll keep you posted.\n> > > > >\n> > > > > On Mon, Jun 6, 2011 at 6:37 PM, Mitch Garnaat via RT <\n> > > > > bugs@support.eucalyptus.com> wrote:\n> > > > >\n> > > > > > On Mon Jun 06 18:32:55 2011, wen.ye wrote:\n> > > > > > > The exact problem here is somewhere in my code throwing an\n> NPE\n> > and\n> > > > > > causing a\n> > > > > > > 500 error, which was then overridden by the replay attack\n> error.\n> > > > > So I\n> > > > > > guess\n> > > > > > > we could do better in the backend, but it is useful to\n> have tools\n> > > > > showing\n> > > > > > > the real error. Anyway, could you point me to the code,\n> maybe I\n> > > > > can try\n> > > > > > > playing with the backoff time a little?\n> > > > > > >\n> > > > > > > Thanks!\n> > > > > > >\n> > > > > > > On Mon, Jun 6, 2011 at 6:27 PM, Mitch Garnaat via RT <\n> > > > > > > bugs@support.eucalyptus.com> wrote:\n> > > > > > >\n> > > > > > > > On Mon Jun 06 18:08:47 2011, wen.ye wrote:\n> > > > > > > > > Mitch:\n> > > > > > > > >\n> > > > > > > > > What is the first backoff time? It seems that it is\n> not long\n> > > > > enough\n> > > > > > to\n> > > > > > > > > prevent the replay attack prevention mechanism. The\n> real\n> > > > > problem here\n> > > > > > > > > is\n> > > > > > > > > that the first error is obscured by the replay attack\n> error,\n> > > > > which is\n> > > > > > > > > very\n> > > > > > > > > inconvenient for users.\n> > > > > > > > >\n> > > > > > > > > Ye\n> > > > > > > > >\n> > > > > > > > > On Mon, Jun 6, 2011 at 3:23 PM, Ye Wen\n> <wenye@eucalyptus.com\n> > >\n> > > > > wrote:\n> > > > > > > > >\n> > > > > > > > > > Mitch:\n> > > > > > > > > >\n> > > > > > > > > > Let's talk about it first before making any changes.\n> I'm\n> > > > > still\n> > > > > > > > > > investigating the problem I just saw. It might be\n> the case\n> > > > > that\n> > > > > > your\n> > > > > > > > > backoff\n> > > > > > > > > > algorithm works, but something else is wrong. I will\n> let\n> > you\n> > > > > know.\n> > > > > > > > > >\n> > > > > > > > > > Thanks!\n> > > > > > > > > > Ye\n> > > > > > > > > >\n> > > > > > > > > >\n> > > > > > > > > > On Mon, Jun 6, 2011 at 3:20 PM, Mitch Garnaat via RT\n> <\n> > > > > > > > > > bugs@support.eucalyptus.com> wrote:\n> > > > > > > > > >\n> > > > > > > > > >>\n> > > > > > > > > >>\n> http://support.eucalyptus.com/Ticket/Display.html?id=2458\n> > > > > > > > > >> This is a comment. It is not sent to the\n> Requestor(s):\n> > > > > > > > > >>\n> > > > > > > > > >> I will investigate making the change in boto.\n> However,\n> > this\n> > > > > > > > > behavior is\n> > > > > > > > > >> significantly different than AWS and will probably\n> cause\n> > > > > problems\n> > > > > > > > > for\n> > > > > > > > > >> other\n> > > > > > > > > >> clients and libraries.\n> > > > > > > > > >>\n> > > > > > > > > >>\n> > > > > > > > > >\n> > > > > > > >\n> > > > > > > > If boto receives a 500 error, it will attempt a retry.\n> There is\n> > > > > a loop\n> > > > > > > > controlling the number of retries (this is settable via\n> the\n> > boto\n> > > > > config\n> > > > > > > > file)\n> > > > > > > > but each time through the loop, this line is executed:\n> > > > > > > >\n> > > > > > > > time.sleep(2 ** i)\n> > > > > > > > initially, I has a value of 0 so the delay would be 1\n> second.\n> > > > > The\n> > > > > > second\n> > > > > > > > time\n> > > > > > > > through, it would be 2, then 4, 8 16, etc. So, I don't\n> see how\n> > > > > it could\n> > > > > > be\n> > > > > > > > retrying the request in less than a second\n> > > > > > > >\n> > > > > > > >\n> > > > > >\n> > > > > > The exact line I quoted above can be found at line 556 of\n> > > > > > boto/boto/connection.py. You could just change that to a\n> hard-coded\n> > > > > value\n> > > > > > of 5\n> > > > > > or something and see what happens. I'd definitely like to\n> find out\n> > > > > what's\n> > > > > > happening so let me know if I can help at all.\n> > > > > >\n> > > > > >\n> > > >\n> > > >\n> >\n> >\n\nBoto does not currently resign retries. That's what I was explaining earlier in\nthe thread. I will go change this in boto, I don't think it will be difficult.\nBut we need to be aware that boto is only one of many, many clients and\nlibraries out there. I don't know if all of them retry requests w/o re-signing\nbut since that is a perfectly acceptable thing to do when talking to AWS (or\nEuca before this change) I expect at least some do and those will be broken in\nthe same way that boto is now.\n\nI'm concerned that we advertise as being AWS-compatible but then introduce a\nnon-compatible replay detection mechanism that might break clients and\nlibraries. We should probably try some of the other major tools like the AWS\nCLI tools, jclouds, etc. to see how they behave with this although the problem\nwill only arise when a retry-able (500) error occurs server side.\n\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"created":"2012-04-23T16:09:16.079-0500","updated":"2012-04-23T16:09:16.079-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/10830/comment/14068","id":"14068","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"body":"Originally posted on 2011-06-07 13:27:31 by admin\nI've checked in a new version of boto/boto/connection.py that will re-sign\neach request prior to retrying.  It is checked into our boto bzr repo (revno\n8) and should get picked up by your tests automatically.  If not, check with\nKyo on the values in your MEMO field.\n\n  \nLet me know if this fixes the issue.\n\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"created":"2012-04-23T16:09:16.641-0500","updated":"2012-04-23T16:09:16.641-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/10830/comment/14069","id":"14069","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"body":"Originally posted on 2011-06-07 13:27:31 by admin\nhttp://support.eucalyptus.com/Ticket/Display.html?id=2458 This is a comment.\nIt is not sent to the Requestor(s): I've checked in a new version of\nboto/boto/connection.py that will re-sign each request prior to retrying. It\nis checked into our boto bzr repo (revno 8) and should get picked up by your\ntests automatically. If not, check with Kyo on the values in your MEMO field.\nLet me know if this fixes the issue.\n\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"created":"2012-04-23T16:09:17.269-0500","updated":"2012-04-23T16:09:17.269-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/10830/comment/14070","id":"14070","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=dkavanagh","name":"dkavanagh","key":"dkavanagh","accountId":"557058:03be2b52-89f7-4c8f-8e00-e2a60a3e7a5e","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/e04f1add3c50bf8a7d1676b60b8ba337?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Ddkavanagh%26avatarId%3D10202%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/e04f1add3c50bf8a7d1676b60b8ba337?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Ddkavanagh%26avatarId%3D10202%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/e04f1add3c50bf8a7d1676b60b8ba337?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Ddkavanagh%26avatarId%3D10202%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/e04f1add3c50bf8a7d1676b60b8ba337?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Ddkavanagh%26avatarId%3D10202%26noRedirect%3Dtrue"},"displayName":"David Kavanagh","active":false,"timeZone":"America/New_York"},"body":"Originally posted on 2011-06-07 14:30:07\nI'm going to back up what Mitch says here. When implementing retry\nlogic in typica, the algorithm comes from here;\nhttp://aws.amazon.com/articles/1394?_encoding=UTF8&jiveRedirect=1\n\nThis became somewhat the gold standard for implementing retries for\nAWS when Alesky published it. Lots of people referred to it. Now, it\nsays \"Submit request\", and it isn't specific about re-signing, but\nI've never see resigning occur, though I've only looked at a few\nlibraries. I do recommend being tolerant of this on the server side.\nIf you cache a request that a 5xx error was returned for, mark it\nspecially, so that if that requests comes again (in a retry, for some\nnumber of minutes), it is accepted if the server doesn't have a 5xx\nerror this time, and the time shift of the request is ignored. Again,\nthere needs to be a time limit (3-5 minutes should be sufficient, but\nI'm not sure even Amazon has that limit, not that I've hit anyway).\n\nDavid\n\nPS. compatibility at the API level is huge. Look at our partner and\ntool ecosystem. we must be very careful not to break that.\n\nOn Tue, Jun 7, 2011 at 9:27 AM, Mitch Garnaat via RT\n<bugs@support.eucalyptus.com> wrote:\n>\n> http://support.eucalyptus.com/Ticket/Display.html?id=2458\n> This is a comment.   It is not sent to the Requestor(s):\n>\n>   I've checked in a new version of boto/boto/connection.py that will re-sign\n> each request prior to retrying. It is checked into our boto bzr repo (revno 8)\n> and should get picked up by your tests automatically. If not, check with Kyo on\n> the values in your MEMO field.\n>\n> Let me know if this fixes the issue.\n>\n>\n\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=dkavanagh","name":"dkavanagh","key":"dkavanagh","accountId":"557058:03be2b52-89f7-4c8f-8e00-e2a60a3e7a5e","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/e04f1add3c50bf8a7d1676b60b8ba337?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Ddkavanagh%26avatarId%3D10202%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/e04f1add3c50bf8a7d1676b60b8ba337?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Ddkavanagh%26avatarId%3D10202%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/e04f1add3c50bf8a7d1676b60b8ba337?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Ddkavanagh%26avatarId%3D10202%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/e04f1add3c50bf8a7d1676b60b8ba337?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Ddkavanagh%26avatarId%3D10202%26noRedirect%3Dtrue"},"displayName":"David Kavanagh","active":false,"timeZone":"America/New_York"},"created":"2012-04-23T16:09:17.908-0500","updated":"2012-04-23T16:09:17.908-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/10830/comment/14071","id":"14071","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=dkavanagh","name":"dkavanagh","key":"dkavanagh","accountId":"557058:03be2b52-89f7-4c8f-8e00-e2a60a3e7a5e","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/e04f1add3c50bf8a7d1676b60b8ba337?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Ddkavanagh%26avatarId%3D10202%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/e04f1add3c50bf8a7d1676b60b8ba337?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Ddkavanagh%26avatarId%3D10202%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/e04f1add3c50bf8a7d1676b60b8ba337?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Ddkavanagh%26avatarId%3D10202%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/e04f1add3c50bf8a7d1676b60b8ba337?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Ddkavanagh%26avatarId%3D10202%26noRedirect%3Dtrue"},"displayName":"David Kavanagh","active":false,"timeZone":"America/New_York"},"body":"Originally posted on 2011-06-07 14:30:08\nI'm going to back up what Mitch says here. When implementing retry\nlogic in typica, the algorithm comes from here;\nhttp://aws.amazon.com/articles/1394?_encoding=UTF8&jiveRedirect=1\n\nThis became somewhat the gold standard for implementing retries for\nAWS when Alesky published it. Lots of people referred to it. Now, it\nsays \"Submit request\", and it isn't specific about re-signing, but\nI've never see resigning occur, though I've only looked at a few\nlibraries. I do recommend being tolerant of this on the server side.\nIf you cache a request that a 5xx error was returned for, mark it\nspecially, so that if that requests comes again (in a retry, for some\nnumber of minutes), it is accepted if the server doesn't have a 5xx\nerror this time, and the time shift of the request is ignored. Again,\nthere needs to be a time limit (3-5 minutes should be sufficient, but\nI'm not sure even Amazon has that limit, not that I've hit anyway).\n\nDavid\n\nPS. compatibility at the API level is huge. Look at our partner and\ntool ecosystem. we must be very careful not to break that.\n\nOn Tue, Jun 7, 2011 at 9:27 AM, Mitch Garnaat via RT\n<bugs@support.eucalyptus.com> wrote:\n>\n> http://support.eucalyptus.com/Ticket/Display.html?id=2458\n> This is a comment.   It is not sent to the Requestor(s):\n>\n>   I've checked in a new version of boto/boto/connection.py that will re-sign\n> each request prior to retrying. It is checked into our boto bzr repo (revno 8)\n> and should get picked up by your tests automatically. If not, check with Kyo on\n> the values in your MEMO field.\n>\n> Let me know if this fixes the issue.\n>\n>\n\n\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=dkavanagh","name":"dkavanagh","key":"dkavanagh","accountId":"557058:03be2b52-89f7-4c8f-8e00-e2a60a3e7a5e","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/e04f1add3c50bf8a7d1676b60b8ba337?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Ddkavanagh%26avatarId%3D10202%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/e04f1add3c50bf8a7d1676b60b8ba337?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Ddkavanagh%26avatarId%3D10202%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/e04f1add3c50bf8a7d1676b60b8ba337?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Ddkavanagh%26avatarId%3D10202%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/e04f1add3c50bf8a7d1676b60b8ba337?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Ddkavanagh%26avatarId%3D10202%26noRedirect%3Dtrue"},"displayName":"David Kavanagh","active":false,"timeZone":"America/New_York"},"created":"2012-04-23T16:09:18.877-0500","updated":"2012-04-23T16:09:18.877-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/10830/comment/14072","id":"14072","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=dkavanagh","name":"dkavanagh","key":"dkavanagh","accountId":"557058:03be2b52-89f7-4c8f-8e00-e2a60a3e7a5e","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/e04f1add3c50bf8a7d1676b60b8ba337?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Ddkavanagh%26avatarId%3D10202%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/e04f1add3c50bf8a7d1676b60b8ba337?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Ddkavanagh%26avatarId%3D10202%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/e04f1add3c50bf8a7d1676b60b8ba337?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Ddkavanagh%26avatarId%3D10202%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/e04f1add3c50bf8a7d1676b60b8ba337?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Ddkavanagh%26avatarId%3D10202%26noRedirect%3Dtrue"},"displayName":"David Kavanagh","active":false,"timeZone":"America/New_York"},"body":"Originally posted on 2011-06-07 14:30:08\n\n<URL: http://support.eucalyptus.com/Ticket/Display.html?id=2458 >\n\nI'm going to back up what Mitch says here. When implementing retry\nlogic in typica, the algorithm comes from here;\nhttp://aws.amazon.com/articles/1394?_encoding=UTF8&jiveRedirect=1\n\nThis became somewhat the gold standard for implementing retries for\nAWS when Alesky published it. Lots of people referred to it. Now, it\nsays \"Submit request\", and it isn't specific about re-signing, but\nI've never see resigning occur, though I've only looked at a few\nlibraries. I do recommend being tolerant of this on the server side.\nIf you cache a request that a 5xx error was returned for, mark it\nspecially, so that if that requests comes again (in a retry, for some\nnumber of minutes), it is accepted if the server doesn't have a 5xx\nerror this time, and the time shift of the request is ignored. Again,\nthere needs to be a time limit (3-5 minutes should be sufficient, but\nI'm not sure even Amazon has that limit, not that I've hit anyway).\n\nDavid\n\nPS. compatibility at the API level is huge. Look at our partner and\ntool ecosystem. we must be very careful not to break that.\n\nOn Tue, Jun 7, 2011 at 9:27 AM, Mitch Garnaat via RT\n<bugs@support.eucalyptus.com> wrote:\n>\n> http://support.eucalyptus.com/Ticket/Display.html?id=2458\n> This is a comment.   It is not sent to the Requestor(s):\n>\n>   I've checked in a new version of boto/boto/connection.py that will re-sign\n> each request prior to retrying. It is checked into our boto bzr repo (revno 8)\n> and should get picked up by your tests automatically. If not, check with Kyo on\n> the values in your MEMO field.\n>\n> Let me know if this fixes the issue.\n>\n>\n\n\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=dkavanagh","name":"dkavanagh","key":"dkavanagh","accountId":"557058:03be2b52-89f7-4c8f-8e00-e2a60a3e7a5e","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/e04f1add3c50bf8a7d1676b60b8ba337?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Ddkavanagh%26avatarId%3D10202%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/e04f1add3c50bf8a7d1676b60b8ba337?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Ddkavanagh%26avatarId%3D10202%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/e04f1add3c50bf8a7d1676b60b8ba337?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Ddkavanagh%26avatarId%3D10202%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/e04f1add3c50bf8a7d1676b60b8ba337?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Ddkavanagh%26avatarId%3D10202%26noRedirect%3Dtrue"},"displayName":"David Kavanagh","active":false,"timeZone":"America/New_York"},"created":"2012-04-23T16:09:19.443-0500","updated":"2012-04-23T16:09:19.443-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/10830/comment/14073","id":"14073","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=rusvika","name":"rusvika","key":"rusvika","accountId":"557058:0f138bdf-f1d0-4468-9edd-e45575af47da","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/c975ce5391bf03e1a9aa2a957435569b?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Drusvika%26avatarId%3D10701%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/c975ce5391bf03e1a9aa2a957435569b?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Drusvika%26avatarId%3D10701%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/c975ce5391bf03e1a9aa2a957435569b?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Drusvika%26avatarId%3D10701%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/c975ce5391bf03e1a9aa2a957435569b?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Drusvika%26avatarId%3D10701%26noRedirect%3Dtrue"},"displayName":"Vika Felmetsger","active":true,"timeZone":"America/Los_Angeles"},"body":"Originally posted on 2011-06-07 16:27:42\nMitch and David have a good point and fixing retry in euca2ools does not mean\nthat we will not have this problem with other tools. While the retry algorithm\ncited by David does not seem to state anything about whether exactly the same\nmessage should be retried, client tools might be retrying the exactly the same\nmessage simply because it works with AWS. And the reason it works with AWS, as\nfar as I understand from my previous discussions with Mitch, is that they do\nallow to replay messages until the timestamp expires, which might work for\ntheir deployment model but not for ours.\n\n  \nI don't know how easy it is to fix it in CLC code to handle replays\ndifferently in case of 500 errors differently  --- it's something that Chris\nwould have a better idea on. One suggestion I have at this point is to try to\nrun the IAM command corresponding to the problematic euare command while we\nstill have this bug in eucalyptus that triggers 500 response and see if IAM\ntools also choke. This way we will have one extra example of a user tool\nbehavior.\n\n  \nOn Tue Jun 07 07:30:07 2011, david.kavanagh wrote:\n\n> I'm going to back up what Mitch says here. When implementing retry\n\n> logic in typica, the algorithm comes from here;\n\n> http://aws.amazon.com/articles/1394?_encoding=UTF8&jiveRedirect=1\n\n>\n\n> This became somewhat the gold standard for implementing retries for\n\n> AWS when Alesky published it. Lots of people referred to it. Now, it\n\n> says \"Submit request\", and it isn't specific about re-signing, but\n\n> I've never see resigning occur, though I've only looked at a few\n\n> libraries. I do recommend being tolerant of this on the server side.\n\n> If you cache a request that a 5xx error was returned for, mark it\n\n> specially, so that if that requests comes again (in a retry, for some\n\n> number of minutes), it is accepted if the server doesn't have a 5xx\n\n> error this time, and the time shift of the request is ignored. Again,\n\n> there needs to be a time limit (3-5 minutes should be sufficient, but\n\n> I'm not sure even Amazon has that limit, not that I've hit anyway).\n\n>\n\n> David\n\n>\n\n> PS. compatibility at the API level is huge. Look at our partner and\n\n> tool ecosystem. we must be very careful not to break that.\n\n>\n\n> On Tue, Jun 7, 2011 at 9:27 AM, Mitch Garnaat via RT\n\n> <bugs@support.eucalyptus.com> wrote:\n\n> >\n\n> > http://support.eucalyptus.com/Ticket/Display.html?id=2458\n\n> > This is a comment.  It is not sent to the Requestor(s):\n\n> >\n\n> > I've checked in a new version of boto/boto/connection.py that will\n\n> re-sign\n\n> > each request prior to retrying. It is checked into our boto bzr repo\n\n> (revno 8)\n\n> > and should get picked up by your tests automatically. If not, check\n\n> with Kyo on\n\n> > the values in your MEMO field.\n\n> >\n\n> > Let me know if this fixes the issue.\n\n> >\n\n> >\n\n>\n\n  \n  \n\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=rusvika","name":"rusvika","key":"rusvika","accountId":"557058:0f138bdf-f1d0-4468-9edd-e45575af47da","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/c975ce5391bf03e1a9aa2a957435569b?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Drusvika%26avatarId%3D10701%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/c975ce5391bf03e1a9aa2a957435569b?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Drusvika%26avatarId%3D10701%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/c975ce5391bf03e1a9aa2a957435569b?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Drusvika%26avatarId%3D10701%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/c975ce5391bf03e1a9aa2a957435569b?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Drusvika%26avatarId%3D10701%26noRedirect%3Dtrue"},"displayName":"Vika Felmetsger","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-04-23T16:09:20.013-0500","updated":"2012-04-23T16:09:20.013-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/10830/comment/14074","id":"14074","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"body":"Originally posted on 2011-06-07 16:27:43 by admin\n\nhttp://support.eucalyptus.com/Ticket/Display.html?id=2458\nThis is a comment.  It is not sent to the Requestor(s):\n\nMitch and David have a good point and fixing retry in euca2ools does not mean\nthat we will not have this problem with other tools. While the retry algorithm\ncited by David does not seem to state anything about whether exactly the same\nmessage should be retried, client tools might be retrying the exactly the same\nmessage simply because it works with AWS. And the reason it works with AWS, as\nfar as I understand from my previous discussions with Mitch, is that they do\nallow to replay messages until the timestamp expires, which might work for\ntheir deployment model but not for ours.\n\nI don't know how easy it is to fix it in CLC code to handle replays differently\nin case of 500 errors differently --- it's something that Chris would have a\nbetter idea on. One suggestion I have at this point is to try to run the IAM\ncommand corresponding to the problematic euare command while we still have this\nbug in eucalyptus that triggers 500 response and see if IAM tools also choke.\nThis way we will have one extra example of a user tool behavior.\n\nOn Tue Jun 07 07:30:07 2011, david.kavanagh wrote:\n> I'm going to back up what Mitch says here. When implementing retry\n> logic in typica, the algorithm comes from here;\n> http://aws.amazon.com/articles/1394?_encoding=UTF8&jiveRedirect=1\n>\n> This became somewhat the gold standard for implementing retries for\n> AWS when Alesky published it. Lots of people referred to it. Now, it\n> says \"Submit request\", and it isn't specific about re-signing, but\n> I've never see resigning occur, though I've only looked at a few\n> libraries. I do recommend being tolerant of this on the server side.\n> If you cache a request that a 5xx error was returned for, mark it\n> specially, so that if that requests comes again (in a retry, for some\n> number of minutes), it is accepted if the server doesn't have a 5xx\n> error this time, and the time shift of the request is ignored. Again,\n> there needs to be a time limit (3-5 minutes should be sufficient, but\n> I'm not sure even Amazon has that limit, not that I've hit anyway).\n>\n> David\n>\n> PS. compatibility at the API level is huge. Look at our partner and\n> tool ecosystem. we must be very careful not to break that.\n>\n> On Tue, Jun 7, 2011 at 9:27 AM, Mitch Garnaat via RT\n> <bugs@support.eucalyptus.com> wrote:\n> >\n> > http://support.eucalyptus.com/Ticket/Display.html?id=2458\n> > This is a comment. It is not sent to the Requestor(s):\n> >\n> > I've checked in a new version of boto/boto/connection.py that will\n> re-sign\n> > each request prior to retrying. It is checked into our boto bzr repo\n> (revno 8)\n> > and should get picked up by your tests automatically. If not, check\n> with Kyo on\n> > the values in your MEMO field.\n> >\n> > Let me know if this fixes the issue.\n> >\n> >\n>\n\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"created":"2012-04-23T16:09:20.593-0500","updated":"2012-04-23T16:09:20.593-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/10830/comment/14075","id":"14075","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"body":"Originally posted on 2011-06-07 17:16:40 by admin\nOn Tue Jun 07 09:27:42 2011, vika.felmetsger wrote:\n\n> Mitch and David have a good point and fixing retry in euca2ools does\n\n> not mean\n\n> that we will not have this problem with other tools. While the retry\n\n> algorithm\n\n> cited by David does not seem to state anything about whether exactly\n\n> the same\n\n> message should be retried, client tools might be retrying the exactly\n\n> the same\n\n> message simply because it works with AWS. And the reason it works with\n\n> AWS, as\n\n> far as I understand from my previous discussions with Mitch, is that\n\n> they do\n\n> allow to replay messages until the timestamp expires, which might work\n\n> for\n\n> their deployment model but not for ours.\n\n>\n\n> I don't know how easy it is to fix it in CLC code to handle replays\n\n> differently\n\n> in case of 500 errors differently --- it's something that Chris would\n\n> have a\n\n> better idea on. One suggestion I have at this point is to try to run\n\n> the IAM\n\n> command corresponding to the problematic euare command while we still\n\n> have this\n\n> bug in eucalyptus that triggers 500 response and see if IAM tools also\n\n> choke.\n\n> This way we will have one extra example of a user tool behavior.\n\n>\n\n> On Tue Jun 07 07:30:07 2011, david.kavanagh wrote:\n\n> > I'm going to back up what Mitch says here. When implementing retry\n\n> > logic in typica, the algorithm comes from here;\n\n> > http://aws.amazon.com/articles/1394?_encoding=UTF8&jiveRedirect=1\n\n> >\n\n> > This became somewhat the gold standard for implementing retries for\n\n> > AWS when Alesky published it. Lots of people referred to it. Now, it\n\n> > says \"Submit request\", and it isn't specific about re-signing, but\n\n> > I've never see resigning occur, though I've only looked at a few\n\n> > libraries. I do recommend being tolerant of this on the server side.\n\n> > If you cache a request that a 5xx error was returned for, mark it\n\n> > specially, so that if that requests comes again (in a retry, for\n\n> some\n\n> > number of minutes), it is accepted if the server doesn't have a 5xx\n\n> > error this time, and the time shift of the request is ignored.\n\n> Again,\n\n> > there needs to be a time limit (3-5 minutes should be sufficient,\n\n> but\n\n> > I'm not sure even Amazon has that limit, not that I've hit anyway).\n\n> >\n\n> > David\n\n> >\n\n> > PS. compatibility at the API level is huge. Look at our partner and\n\n> > tool ecosystem. we must be very careful not to break that.\n\n> >\n\n> > On Tue, Jun 7, 2011 at 9:27 AM, Mitch Garnaat via RT\n\n> > <bugs@support.eucalyptus.com> wrote:\n\n> > >\n\n> > > http://support.eucalyptus.com/Ticket/Display.html?id=2458\n\n> > > This is a comment. It is not sent to the Requestor(s):\n\n> > >\n\n> > > I've checked in a new version of boto/boto/connection.py that will\n\n> > re-sign\n\n> > > each request prior to retrying. It is checked into our boto bzr\n\n> repo\n\n> > (revno 8)\n\n> > > and should get picked up by your tests automatically. If not,\n\n> check\n\n> > with Kyo on\n\n> > > the values in your MEMO field.\n\n> > >\n\n> > > Let me know if this fixes the issue.\n\n> > >\n\n> > >\n\n> >\n\n  \nI'm trying to recreate Ye's original test case on a QA machine and see if I\ncan determine if the changes I made in boto will take care of the issue or\nnot.\n\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"created":"2012-04-23T16:09:21.152-0500","updated":"2012-04-23T16:09:21.152-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/10830/comment/14076","id":"14076","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"body":"Originally posted on 2011-06-07 17:16:41 by mitch.garnaat@eucalyptus.com\n\n<URL: http://support.eucalyptus.com/Ticket/Display.html?id=2458 >\n\nOn Tue Jun 07 09:27:42 2011, vika.felmetsger wrote:\n> Mitch and David have a good point and fixing retry in euca2ools does\n> not mean\n> that we will not have this problem with other tools. While the retry\n> algorithm\n> cited by David does not seem to state anything about whether exactly\n> the same\n> message should be retried, client tools might be retrying the exactly\n> the same\n> message simply because it works with AWS. And the reason it works with\n> AWS, as\n> far as I understand from my previous discussions with Mitch, is that\n> they do\n> allow to replay messages until the timestamp expires, which might work\n> for\n> their deployment model but not for ours.\n>\n> I don't know how easy it is to fix it in CLC code to handle replays\n> differently\n> in case of 500 errors differently --- it's something that Chris would\n> have a\n> better idea on. One suggestion I have at this point is to try to run\n> the IAM\n> command corresponding to the problematic euare command while we still\n> have this\n> bug in eucalyptus that triggers 500 response and see if IAM tools also\n> choke.\n> This way we will have one extra example of a user tool behavior.\n>\n> On Tue Jun 07 07:30:07 2011, david.kavanagh wrote:\n> > I'm going to back up what Mitch says here. When implementing retry\n> > logic in typica, the algorithm comes from here;\n> > http://aws.amazon.com/articles/1394?_encoding=UTF8&jiveRedirect=1\n> >\n> > This became somewhat the gold standard for implementing retries for\n> > AWS when Alesky published it. Lots of people referred to it. Now, it\n> > says \"Submit request\", and it isn't specific about re-signing, but\n> > I've never see resigning occur, though I've only looked at a few\n> > libraries. I do recommend being tolerant of this on the server side.\n> > If you cache a request that a 5xx error was returned for, mark it\n> > specially, so that if that requests comes again (in a retry, for\n> some\n> > number of minutes), it is accepted if the server doesn't have a 5xx\n> > error this time, and the time shift of the request is ignored.\n> Again,\n> > there needs to be a time limit (3-5 minutes should be sufficient,\n> but\n> > I'm not sure even Amazon has that limit, not that I've hit anyway).\n> >\n> > David\n> >\n> > PS. compatibility at the API level is huge. Look at our partner and\n> > tool ecosystem. we must be very careful not to break that.\n> >\n> > On Tue, Jun 7, 2011 at 9:27 AM, Mitch Garnaat via RT\n> > <bugs@support.eucalyptus.com> wrote:\n> > >\n> > > http://support.eucalyptus.com/Ticket/Display.html?id=2458\n> > > This is a comment. It is not sent to the Requestor(s):\n> > >\n> > > I've checked in a new version of boto/boto/connection.py that will\n> > re-sign\n> > > each request prior to retrying. It is checked into our boto bzr\n> repo\n> > (revno 8)\n> > > and should get picked up by your tests automatically. If not,\n> check\n> > with Kyo on\n> > > the values in your MEMO field.\n> > >\n> > > Let me know if this fixes the issue.\n> > >\n> > >\n> >\n\nI'm trying to recreate Ye's original test case on a QA machine and see if I can\ndetermine if the changes I made in boto will take care of the issue or not.\n\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"created":"2012-04-23T16:09:21.709-0500","updated":"2012-04-23T16:09:21.709-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/10830/comment/14077","id":"14077","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"body":"Originally posted on 2011-06-07 17:16:41 by mitch.garnaat@eucalyptus.com\nOn Tue Jun 07 09:27:42 2011, vika.felmetsger wrote:\n> Mitch and David have a good point and fixing retry in euca2ools does\n> not mean\n> that we will not have this problem with other tools. While the retry\n> algorithm\n> cited by David does not seem to state anything about whether exactly\n> the same\n> message should be retried, client tools might be retrying the exactly\n> the same\n> message simply because it works with AWS. And the reason it works with\n> AWS, as\n> far as I understand from my previous discussions with Mitch, is that\n> they do\n> allow to replay messages until the timestamp expires, which might work\n> for\n> their deployment model but not for ours.\n>\n> I don't know how easy it is to fix it in CLC code to handle replays\n> differently\n> in case of 500 errors differently --- it's something that Chris would\n> have a\n> better idea on. One suggestion I have at this point is to try to run\n> the IAM\n> command corresponding to the problematic euare command while we still\n> have this\n> bug in eucalyptus that triggers 500 response and see if IAM tools also\n> choke.\n> This way we will have one extra example of a user tool behavior.\n>\n> On Tue Jun 07 07:30:07 2011, david.kavanagh wrote:\n> > I'm going to back up what Mitch says here. When implementing retry\n> > logic in typica, the algorithm comes from here;\n> > http://aws.amazon.com/articles/1394?_encoding=UTF8&jiveRedirect=1\n> >\n> > This became somewhat the gold standard for implementing retries for\n> > AWS when Alesky published it. Lots of people referred to it. Now, it\n> > says \"Submit request\", and it isn't specific about re-signing, but\n> > I've never see resigning occur, though I've only looked at a few\n> > libraries. I do recommend being tolerant of this on the server side.\n> > If you cache a request that a 5xx error was returned for, mark it\n> > specially, so that if that requests comes again (in a retry, for\n> some\n> > number of minutes), it is accepted if the server doesn't have a 5xx\n> > error this time, and the time shift of the request is ignored.\n> Again,\n> > there needs to be a time limit (3-5 minutes should be sufficient,\n> but\n> > I'm not sure even Amazon has that limit, not that I've hit anyway).\n> >\n> > David\n> >\n> > PS. compatibility at the API level is huge. Look at our partner and\n> > tool ecosystem. we must be very careful not to break that.\n> >\n> > On Tue, Jun 7, 2011 at 9:27 AM, Mitch Garnaat via RT\n> > <bugs@support.eucalyptus.com> wrote:\n> > >\n> > > http://support.eucalyptus.com/Ticket/Display.html?id=2458\n> > > This is a comment. It is not sent to the Requestor(s):\n> > >\n> > > I've checked in a new version of boto/boto/connection.py that will\n> > re-sign\n> > > each request prior to retrying. It is checked into our boto bzr\n> repo\n> > (revno 8)\n> > > and should get picked up by your tests automatically. If not,\n> check\n> > with Kyo on\n> > > the values in your MEMO field.\n> > >\n> > > Let me know if this fixes the issue.\n> > >\n> > >\n> >\n\nI'm trying to recreate Ye's original test case on a QA machine and see if I can\ndetermine if the changes I made in boto will take care of the issue or not.\n\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"created":"2012-04-23T16:09:22.289-0500","updated":"2012-04-23T16:09:22.289-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/10830/comment/14078","id":"14078","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"body":"Originally posted on 2011-06-07 17:26:25 by admin\nRe-signing each retried request in boto seems to work as expected (see log\nbelow).  I just need to do more testing to make sure I haven't broken anything\nelse:\n\n  \n\n[root@eucahost-51-126 ~]# euare-useruploadpolicy -u testuser -p testpolicy -f\ntest2.policy --debug\n\n2011-06-07 10:24:30,756 PutUserPolicy [DEBUG]:request_params: {'UserName':\n'testuser', 'PolicyName': 'testpolicy', 'PolicyDocument': '{\n\"Version\":\"2011-04-01\", \"Statement\":[{ \"Sid\":\"1\", \"Effect\":\"Allow\",\n\"Action\":\"ec2:associateaddress\",\n\"Resource\":\"arn:aws:ec2:::address/192.168.1.1\" }]}\\n'}\n\n2011-06-07 10:24:30,757 PutUserPolicy [DEBUG]:Method: GET\n\n2011-06-07 10:24:30,757 PutUserPolicy [DEBUG]:Path: /services/Euare/\n\n2011-06-07 10:24:30,757 PutUserPolicy [DEBUG]:Data:\n\n2011-06-07 10:24:30,757 PutUserPolicy [DEBUG]:Headers: {}\n\n2011-06-07 10:24:30,757 PutUserPolicy [DEBUG]:Host: 192.168.51.126:8773\n\n2011-06-07 10:24:30,757 PutUserPolicy [DEBUG]:establishing HTTP connection:\nkwargs={}\n\n2011-06-07 10:24:30,757 PutUserPolicy [DEBUG]:Params before auth: {'UserName':\n'testuser', 'PolicyName': 'testpolicy', 'PolicyDocument': '{\n\"Version\":\"2011-04-01\", \"Statement\":[{ \"Sid\":\"1\", \"Effect\":\"Allow\",\n\"Action\":\"ec2:associateaddress\",\n\"Resource\":\"arn:aws:ec2:::address/192.168.1.1\" }]}\\n', 'Action':\n'PutUserPolicy', 'Version': '2010-05-08'}\n\n2011-06-07 10:24:30,758 PutUserPolicy [DEBUG]:using _calc_signature_2\n\n2011-06-07 10:24:30,758 PutUserPolicy [DEBUG]:query string: AWSAccessKeyId=MXQ\nQXAGFYAI7P5J6R4PB0&Action=PutUserPolicy&PolicyDocument=%7B%20%22Version%22%3A%\n222011-04-01%22%2C%20%22Statement%22%3A%5B%7B%20%22Sid%22%3A%221%22%2C%20%22Ef\nfect%22%3A%22Allow%22%2C%20%22Action%22%3A%22ec2%3Aassociateaddress%22%2C%20%2\n2Resource%22%3A%22arn%3Aaws%3Aec2%3A%3A%3Aaddress%2F192.168.1.1%22%20%7D%5D%7D\n%0A&PolicyName=testpolicy&SignatureMethod=HmacSHA256&SignatureVersion=2&Timest\namp=2011-06-07T17%3A24%3A30Z&UserName=testuser&Version=2010-05-08\n\n2011-06-07 10:24:30,759 PutUserPolicy [DEBUG]:string_to_sign: GET\n\n192.168.51.126:8773\n\n/services/Euare/\n\nAWSAccessKeyId=MXQQXAGFYAI7P5J6R4PB0&Action=PutUserPolicy&PolicyDocument=%7B%2\n0%22Version%22%3A%222011-04-01%22%2C%20%22Statement%22%3A%5B%7B%20%22Sid%22%3A\n%221%22%2C%20%22Effect%22%3A%22Allow%22%2C%20%22Action%22%3A%22ec2%3Aassociate\naddress%22%2C%20%22Resource%22%3A%22arn%3Aaws%3Aec2%3A%3A%3Aaddress%2F192.168.\n1.1%22%20%7D%5D%7D%0A&PolicyName=testpolicy&SignatureMethod=HmacSHA256&Signatu\nreVersion=2&Timestamp=2011-06-07T17%3A24%3A30Z&UserName=testuser&Version=2010-\n05-08\n\n2011-06-07 10:24:30,759 PutUserPolicy [DEBUG]:len(b64)=44\n\n2011-06-07 10:24:30,759 PutUserPolicy [DEBUG]:base64 encoded digest:\nHmvd2m3nJGMDOhEwF+/lcsASLKAUzu6k9hBkTIQzIas=\n\n2011-06-07 10:24:30,759 PutUserPolicy [DEBUG]:query_string: AWSAccessKeyId=MXQ\nQXAGFYAI7P5J6R4PB0&Action=PutUserPolicy&PolicyDocument=%7B%20%22Version%22%3A%\n222011-04-01%22%2C%20%22Statement%22%3A%5B%7B%20%22Sid%22%3A%221%22%2C%20%22Ef\nfect%22%3A%22Allow%22%2C%20%22Action%22%3A%22ec2%3Aassociateaddress%22%2C%20%2\n2Resource%22%3A%22arn%3Aaws%3Aec2%3A%3A%3Aaddress%2F192.168.1.1%22%20%7D%5D%7D\n%0A&PolicyName=testpolicy&SignatureMethod=HmacSHA256&SignatureVersion=2&Timest\namp=2011-06-07T17%3A24%3A30Z&UserName=testuser&Version=2010-05-08 Signature:\nHmvd2m3nJGMDOhEwF+/lcsASLKAUzu6k9hBkTIQzIas=\n\n2011-06-07 10:24:30,759 PutUserPolicy [DEBUG]:Params after auth: {'UserName':\n'testuser', 'PolicyName': 'testpolicy', 'SignatureVersion': 2,\n'AWSAccessKeyId': 'MXQQXAGFYAI7P5J6R4PB0', 'Version': '2010-05-08',\n'Timestamp': '2011-06-07T17:24:30Z', 'SignatureMethod': 'HmacSHA256',\n'PolicyDocument': '{ \"Version\":\"2011-04-01\", \"Statement\":[{ \"Sid\":\"1\",\n\"Effect\":\"Allow\", \"Action\":\"ec2:associateaddress\",\n\"Resource\":\"arn:aws:ec2:::address/192.168.1.1\" }]}\\n', 'Action':\n'PutUserPolicy'}\n\nconnect: (192.168.51.126, 8773)\n\nsend: 'GET /services/Euare/?AWSAccessKeyId=MXQQXAGFYAI7P5J6R4PB0&Action=PutUse\nrPolicy&PolicyDocument=%7B%20%22Version%22%3A%222011-04-01%22%2C%20%22Statemen\nt%22%3A%5B%7B%20%22Sid%22%3A%221%22%2C%20%22Effect%22%3A%22Allow%22%2C%20%22Ac\ntion%22%3A%22ec2%3Aassociateaddress%22%2C%20%22Resource%22%3A%22arn%3Aaws%3Aec\n2%3A%3A%3Aaddress%2F192.168.1.1%22%20%7D%5D%7D%0A&PolicyName=testpolicy&Signat\nureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2011-06-07T17%3A24%3A30Z&Use\nrName=testuser&Version=2010-05-08&Signature=Hmvd2m3nJGMDOhEwF%2B/lcsASLKAUzu6k\n9hBkTIQzIas%3D HTTP/1.1\\r\\nHost: 192.168.51.126:8773\\r\\nAccept-Encoding:\nidentity\\r\\nContent-Length: 0\\r\\nUser-Agent: Boto/2.0rc1 (linux2)\\r\\n\\r\\n'\n\nreply: 'HTTP/1.1 500 Internal Server Error\\r\\n'\n\nheader: Content-Length: 244\n\nheader: Content-Type: application/xml; charset=UTF-8\n\n2011-06-07 10:24:30,819 PutUserPolicy [DEBUG]:received 500 response, retrying\nin 1 seconds\n\n2011-06-07 10:24:31,814 PutUserPolicy [DEBUG]:Params before auth: {'UserName':\n'testuser', 'PolicyName': 'testpolicy', 'SignatureVersion': 2,\n'AWSAccessKeyId': 'MXQQXAGFYAI7P5J6R4PB0', 'Version': '2010-05-08',\n'Timestamp': '2011-06-07T17:24:30Z', 'SignatureMethod': 'HmacSHA256',\n'PolicyDocument': '{ \"Version\":\"2011-04-01\", \"Statement\":[{ \"Sid\":\"1\",\n\"Effect\":\"Allow\", \"Action\":\"ec2:associateaddress\",\n\"Resource\":\"arn:aws:ec2:::address/192.168.1.1\" }]}\\n', 'Action':\n'PutUserPolicy'}\n\n2011-06-07 10:24:31,815 PutUserPolicy [DEBUG]:using _calc_signature_2\n\n2011-06-07 10:24:31,815 PutUserPolicy [DEBUG]:query string: AWSAccessKeyId=MXQ\nQXAGFYAI7P5J6R4PB0&Action=PutUserPolicy&PolicyDocument=%7B%20%22Version%22%3A%\n222011-04-01%22%2C%20%22Statement%22%3A%5B%7B%20%22Sid%22%3A%221%22%2C%20%22Ef\nfect%22%3A%22Allow%22%2C%20%22Action%22%3A%22ec2%3Aassociateaddress%22%2C%20%2\n2Resource%22%3A%22arn%3Aaws%3Aec2%3A%3A%3Aaddress%2F192.168.1.1%22%20%7D%5D%7D\n%0A&PolicyName=testpolicy&SignatureMethod=HmacSHA256&SignatureVersion=2&Timest\namp=2011-06-07T17%3A24%3A31Z&UserName=testuser&Version=2010-05-08\n\n2011-06-07 10:24:31,815 PutUserPolicy [DEBUG]:string_to_sign: GET\n\n192.168.51.126:8773\n\n/services/Euare/\n\nAWSAccessKeyId=MXQQXAGFYAI7P5J6R4PB0&Action=PutUserPolicy&PolicyDocument=%7B%2\n0%22Version%22%3A%222011-04-01%22%2C%20%22Statement%22%3A%5B%7B%20%22Sid%22%3A\n%221%22%2C%20%22Effect%22%3A%22Allow%22%2C%20%22Action%22%3A%22ec2%3Aassociate\naddress%22%2C%20%22Resource%22%3A%22arn%3Aaws%3Aec2%3A%3A%3Aaddress%2F192.168.\n1.1%22%20%7D%5D%7D%0A&PolicyName=testpolicy&SignatureMethod=HmacSHA256&Signatu\nreVersion=2&Timestamp=2011-06-07T17%3A24%3A31Z&UserName=testuser&Version=2010-\n05-08\n\n2011-06-07 10:24:31,815 PutUserPolicy [DEBUG]:len(b64)=44\n\n2011-06-07 10:24:31,815 PutUserPolicy [DEBUG]:base64 encoded digest:\ng/j3I9RMHaUoSliX6CaErJLug7RPcXXp7LVPKxxrNZU=\n\n2011-06-07 10:24:31,815 PutUserPolicy [DEBUG]:query_string: AWSAccessKeyId=MXQ\nQXAGFYAI7P5J6R4PB0&Action=PutUserPolicy&PolicyDocument=%7B%20%22Version%22%3A%\n222011-04-01%22%2C%20%22Statement%22%3A%5B%7B%20%22Sid%22%3A%221%22%2C%20%22Ef\nfect%22%3A%22Allow%22%2C%20%22Action%22%3A%22ec2%3Aassociateaddress%22%2C%20%2\n2Resource%22%3A%22arn%3Aaws%3Aec2%3A%3A%3Aaddress%2F192.168.1.1%22%20%7D%5D%7D\n%0A&PolicyName=testpolicy&SignatureMethod=HmacSHA256&SignatureVersion=2&Timest\namp=2011-06-07T17%3A24%3A31Z&UserName=testuser&Version=2010-05-08 Signature:\ng/j3I9RMHaUoSliX6CaErJLug7RPcXXp7LVPKxxrNZU=\n\n2011-06-07 10:24:31,816 PutUserPolicy [DEBUG]:Params after auth: {'UserName':\n'testuser', 'PolicyName': 'testpolicy', 'SignatureVersion': 2,\n'AWSAccessKeyId': 'MXQQXAGFYAI7P5J6R4PB0', 'Version': '2010-05-08',\n'Timestamp': '2011-06-07T17:24:31Z', 'SignatureMethod': 'HmacSHA256',\n'PolicyDocument': '{ \"Version\":\"2011-04-01\", \"Statement\":[{ \"Sid\":\"1\",\n\"Effect\":\"Allow\", \"Action\":\"ec2:associateaddress\",\n\"Resource\":\"arn:aws:ec2:::address/192.168.1.1\" }]}\\n', 'Action':\n'PutUserPolicy'}\n\nsend: 'GET /services/Euare/?AWSAccessKeyId=MXQQXAGFYAI7P5J6R4PB0&Action=PutUse\nrPolicy&PolicyDocument=%7B%20%22Version%22%3A%222011-04-01%22%2C%20%22Statemen\nt%22%3A%5B%7B%20%22Sid%22%3A%221%22%2C%20%22Effect%22%3A%22Allow%22%2C%20%22Ac\ntion%22%3A%22ec2%3Aassociateaddress%22%2C%20%22Resource%22%3A%22arn%3Aaws%3Aec\n2%3A%3A%3Aaddress%2F192.168.1.1%22%20%7D%5D%7D%0A&PolicyName=testpolicy&Signat\nureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2011-06-07T17%3A24%3A30Z&Use\nrName=testuser&Version=2010-05-08&Signature=Hmvd2m3nJGMDOhEwF%2B/lcsASLKAUzu6k\n9hBkTIQzIas%3D?AWSAccessKeyId=MXQQXAGFYAI7P5J6R4PB0&Action=PutUserPolicy&Polic\nyDocument=%7B%20%22Version%22%3A%222011-04-01%22%2C%20%22Statement%22%3A%5B%7B\n%20%22Sid%22%3A%221%22%2C%20%22Effect%22%3A%22Allow%22%2C%20%22Action%22%3A%22\nec2%3Aassociateaddress%22%2C%20%22Resource%22%3A%22arn%3Aaws%3Aec2%3A%3A%3Aadd\nress%2F192.168.1.1%22%20%7D%5D%7D%0A&PolicyName=testpolicy&SignatureMethod=Hma\ncSHA256&SignatureVersion=2&Timestamp=2011-06-07T17%3A24%3A31Z&UserName=testuse\nr&Version=2010-05-08&Signature=g/j3I9RMHaUoSliX6CaErJLug7RPcXXp7LVPKxxrNZU%3D\nHTTP/1.1\\r\\nHost: 192.168.51.126:8773\\r\\nAccept-Encoding: identity\\r\\nContent-\nLength: 0\\r\\nUser-Agent: Boto/2.0rc1 (linux2)\\r\\n\\r\\n'\n\nreply: 'HTTP/1.1 500 Internal Server Error\\r\\n'\n\nheader: Content-Length: 244\n\nheader: Content-Type: application/xml; charset=UTF-8\n\n2011-06-07 10:24:31,887 PutUserPolicy [DEBUG]:received 500 response, retrying\nin 2 seconds\n\n2011-06-07 10:24:33,887 PutUserPolicy [DEBUG]:Params before auth: {'UserName':\n'testuser', 'PolicyName': 'testpolicy', 'SignatureVersion': 2,\n'AWSAccessKeyId': 'MXQQXAGFYAI7P5J6R4PB0', 'Version': '2010-05-08',\n'Timestamp': '2011-06-07T17:24:31Z', 'SignatureMethod': 'HmacSHA256',\n'PolicyDocument': '{ \"Version\":\"2011-04-01\", \"Statement\":[{ \"Sid\":\"1\",\n\"Effect\":\"Allow\", \"Action\":\"ec2:associateaddress\",\n\"Resource\":\"arn:aws:ec2:::address/192.168.1.1\" }]}\\n', 'Action':\n'PutUserPolicy'}\n\n2011-06-07 10:24:33,887 PutUserPolicy [DEBUG]:using _calc_signature_2\n\n2011-06-07 10:24:33,887 PutUserPolicy [DEBUG]:query string: AWSAccessKeyId=MXQ\nQXAGFYAI7P5J6R4PB0&Action=PutUserPolicy&PolicyDocument=%7B%20%22Version%22%3A%\n222011-04-01%22%2C%20%22Statement%22%3A%5B%7B%20%22Sid%22%3A%221%22%2C%20%22Ef\nfect%22%3A%22Allow%22%2C%20%22Action%22%3A%22ec2%3Aassociateaddress%22%2C%20%2\n2Resource%22%3A%22arn%3Aaws%3Aec2%3A%3A%3Aaddress%2F192.168.1.1%22%20%7D%5D%7D\n%0A&PolicyName=testpolicy&SignatureMethod=HmacSHA256&SignatureVersion=2&Timest\namp=2011-06-07T17%3A24%3A33Z&UserName=testuser&Version=2010-05-08\n\n2011-06-07 10:24:33,887 PutUserPolicy [DEBUG]:string_to_sign: GET\n\n192.168.51.126:8773\n\n/services/Euare/\n\nAWSAccessKeyId=MXQQXAGFYAI7P5J6R4PB0&Action=PutUserPolicy&PolicyDocument=%7B%2\n0%22Version%22%3A%222011-04-01%22%2C%20%22Statement%22%3A%5B%7B%20%22Sid%22%3A\n%221%22%2C%20%22Effect%22%3A%22Allow%22%2C%20%22Action%22%3A%22ec2%3Aassociate\naddress%22%2C%20%22Resource%22%3A%22arn%3Aaws%3Aec2%3A%3A%3Aaddress%2F192.168.\n1.1%22%20%7D%5D%7D%0A&PolicyName=testpolicy&SignatureMethod=HmacSHA256&Signatu\nreVersion=2&Timestamp=2011-06-07T17%3A24%3A33Z&UserName=testuser&Version=2010-\n05-08\n\n2011-06-07 10:24:33,887 PutUserPolicy [DEBUG]:len(b64)=44\n\n2011-06-07 10:24:33,887 PutUserPolicy [DEBUG]:base64 encoded digest:\nKeUzEQ+9Pke69WrMI3UoBODNHK18ergon1X9Iy5yyG4=\n\n2011-06-07 10:24:33,887 PutUserPolicy [DEBUG]:query_string: AWSAccessKeyId=MXQ\nQXAGFYAI7P5J6R4PB0&Action=PutUserPolicy&PolicyDocument=%7B%20%22Version%22%3A%\n222011-04-01%22%2C%20%22Statement%22%3A%5B%7B%20%22Sid%22%3A%221%22%2C%20%22Ef\nfect%22%3A%22Allow%22%2C%20%22Action%22%3A%22ec2%3Aassociateaddress%22%2C%20%2\n2Resource%22%3A%22arn%3Aaws%3Aec2%3A%3A%3Aaddress%2F192.168.1.1%22%20%7D%5D%7D\n%0A&PolicyName=testpolicy&SignatureMethod=HmacSHA256&SignatureVersion=2&Timest\namp=2011-06-07T17%3A24%3A33Z&UserName=testuser&Version=2010-05-08 Signature:\nKeUzEQ+9Pke69WrMI3UoBODNHK18ergon1X9Iy5yyG4=\n\n2011-06-07 10:24:33,888 PutUserPolicy [DEBUG]:Params after auth: {'UserName':\n'testuser', 'PolicyName': 'testpolicy', 'SignatureVersion': 2,\n'AWSAccessKeyId': 'MXQQXAGFYAI7P5J6R4PB0', 'Version': '2010-05-08',\n'Timestamp': '2011-06-07T17:24:33Z', 'SignatureMethod': 'HmacSHA256',\n'PolicyDocument': '{ \"Version\":\"2011-04-01\", \"Statement\":[{ \"Sid\":\"1\",\n\"Effect\":\"Allow\", \"Action\":\"ec2:associateaddress\",\n\"Resource\":\"arn:aws:ec2:::address/192.168.1.1\" }]}\\n', 'Action':\n'PutUserPolicy'}\n\nsend: 'GET /services/Euare/?AWSAccessKeyId=MXQQXAGFYAI7P5J6R4PB0&Action=PutUse\nrPolicy&PolicyDocument=%7B%20%22Version%22%3A%222011-04-01%22%2C%20%22Statemen\nt%22%3A%5B%7B%20%22Sid%22%3A%221%22%2C%20%22Effect%22%3A%22Allow%22%2C%20%22Ac\ntion%22%3A%22ec2%3Aassociateaddress%22%2C%20%22Resource%22%3A%22arn%3Aaws%3Aec\n2%3A%3A%3Aaddress%2F192.168.1.1%22%20%7D%5D%7D%0A&PolicyName=testpolicy&Signat\nureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2011-06-07T17%3A24%3A30Z&Use\nrName=testuser&Version=2010-05-08&Signature=Hmvd2m3nJGMDOhEwF%2B/lcsASLKAUzu6k\n9hBkTIQzIas%3D?AWSAccessKeyId=MXQQXAGFYAI7P5J6R4PB0&Action=PutUserPolicy&Polic\nyDocument=%7B%20%22Version%22%3A%222011-04-01%22%2C%20%22Statement%22%3A%5B%7B\n%20%22Sid%22%3A%221%22%2C%20%22Effect%22%3A%22Allow%22%2C%20%22Action%22%3A%22\nec2%3Aassociateaddress%22%2C%20%22Resource%22%3A%22arn%3Aaws%3Aec2%3A%3A%3Aadd\nress%2F192.168.1.1%22%20%7D%5D%7D%0A&PolicyName=testpolicy&SignatureMethod=Hma\ncSHA256&SignatureVersion=2&Timestamp=2011-06-07T17%3A24%3A31Z&UserName=testuse\nr&Version=2010-05-08&Signature=g/j3I9RMHaUoSliX6CaErJLug7RPcXXp7LVPKxxrNZU%3D?\nAWSAccessKeyId=MXQQXAGFYAI7P5J6R4PB0&Action=PutUserPolicy&PolicyDocument=%7B%2\n0%22Version%22%3A%222011-04-01%22%2C%20%22Statement%22%3A%5B%7B%20%22Sid%22%3A\n%221%22%2C%20%22Effect%22%3A%22Allow%22%2C%20%22Action%22%3A%22ec2%3Aassociate\naddress%22%2C%20%22Resource%22%3A%22arn%3Aaws%3Aec2%3A%3A%3Aaddress%2F192.168.\n1.1%22%20%7D%5D%7D%0A&PolicyName=testpolicy&SignatureMethod=HmacSHA256&Signatu\nreVersion=2&Timestamp=2011-06-07T17%3A24%3A33Z&UserName=testuser&Version=2010-\n05-08&Signature=KeUzEQ%2B9Pke69WrMI3UoBODNHK18ergon1X9Iy5yyG4%3D\nHTTP/1.1\\r\\nHost: 192.168.51.126:8773\\r\\nAccept-Encoding: identity\\r\\nContent-\nLength: 0\\r\\nUser-Agent: Boto/2.0rc1 (linux2)\\r\\n\\r\\n'\n\nreply: 'HTTP/1.1 500 Internal Server Error\\r\\n'\n\nheader: Content-Length: 244\n\nheader: Content-Type: application/xml; charset=UTF-8\n\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"created":"2012-04-23T16:09:22.841-0500","updated":"2012-04-23T16:09:22.841-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/10830/comment/14079","id":"14079","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"body":"Originally posted on 2011-06-07 17:26:25 by admin\nhttp://support.eucalyptus.com/Ticket/Display.html?id=2458 This is a comment.\nIt is not sent to the Requestor(s): Re-signing each retried request in boto\nseems to work as expected (see log below). I just need to do more testing to\nmake sure I haven't broken anything else: [root@eucahost-51-126 ~]# euare-\nuseruploadpolicy -u testuser -p testpolicy -f test2.policy --debug2011-06-07\n10:24:30,756 PutUserPolicy [DEBUG]:request_params: {'UserName': 'testuser',\n'PolicyName': 'testpolicy', 'PolicyDocument': '{ \"Version\":\"2011-04-01\",\n\"Statement\":[{ \"Sid\":\"1\", \"Effect\":\"Allow\", \"Action\":\"ec2:associateaddress\",\n\"Resource\":\"arn:aws:ec2:::address/192.168.1.1\" }]}\\n'}2011-06-07 10:24:30,757\nPutUserPolicy [DEBUG]:Method: GET2011-06-07 10:24:30,757 PutUserPolicy\n[DEBUG]:Path: /services/Euare/2011-06-07 10:24:30,757 PutUserPolicy\n[DEBUG]:Data: 2011-06-07 10:24:30,757 PutUserPolicy [DEBUG]:Headers:\n{}2011-06-07 10:24:30,757 PutUserPolicy [DEBUG]:Host:\n192.168.51.126:87732011-06-07 10:24:30,757 PutUserPolicy [DEBUG]:establishing\nHTTP connection: kwargs={}2011-06-07 10:24:30,757 PutUserPolicy [DEBUG]:Params\nbefore auth: {'UserName': 'testuser', 'PolicyName': 'testpolicy',\n'PolicyDocument': '{ \"Version\":\"2011-04-01\", \"Statement\":[{ \"Sid\":\"1\",\n\"Effect\":\"Allow\", \"Action\":\"ec2:associateaddress\",\n\"Resource\":\"arn:aws:ec2:::address/192.168.1.1\" }]}\\n', 'Action':\n'PutUserPolicy', 'Version': '2010-05-08'}2011-06-07 10:24:30,758 PutUserPolicy\n[DEBUG]:using _calc_signature_22011-06-07 10:24:30,758 PutUserPolicy\n[DEBUG]:query string: AWSAccessKeyId=MXQQXAGFYAI7P5J6R4PB0&Action;=PutUserPoli\ncy&PolicyDocument;=%7B%20%22Version%22%3A%222011-04-01%22%2C%20%22Statement%22\n%3A%5B%7B%20%22Sid%22%3A%221%22%2C%20%22Effect%22%3A%22Allow%22%2C%20%22Action\n%22%3A%22ec2%3Aassociateaddress%22%2C%20%22Resource%22%3A%22arn%3Aaws%3Aec2%3A\n%3A%3Aaddress%2F192.168.1.1%22%20%7D%5D%7D%0A&PolicyName;=testpolicy&Signature\nMethod;=HmacSHA256&SignatureVersion;=2&Timestamp;=2011-06-07T17%3A24%3A30Z&Use\nrName;=testuser&Version;=2010-05-082011-06-07 10:24:30,759 PutUserPolicy\n[DEBUG]:string_to_sign: GET192.168.51.126:8773/services/Euare/AWSAccessKeyId=M\nXQQXAGFYAI7P5J6R4PB0&Action;=PutUserPolicy&PolicyDocument;=%7B%20%22Version%22\n%3A%222011-04-01%22%2C%20%22Statement%22%3A%5B%7B%20%22Sid%22%3A%221%22%2C%20%\n22Effect%22%3A%22Allow%22%2C%20%22Action%22%3A%22ec2%3Aassociateaddress%22%2C%\n20%22Resource%22%3A%22arn%3Aaws%3Aec2%3A%3A%3Aaddress%2F192.168.1.1%22%20%7D%5\nD%7D%0A&PolicyName;=testpolicy&SignatureMethod;=HmacSHA256&SignatureVersion;=2\n&Timestamp;=2011-06-07T17%3A24%3A30Z&UserName;=testuser&Version;=2010-05-08201\n1-06-07 10:24:30,759 PutUserPolicy [DEBUG]:len(b64)=442011-06-07 10:24:30,759\nPutUserPolicy [DEBUG]:base64 encoded digest:\nHmvd2m3nJGMDOhEwF+/lcsASLKAUzu6k9hBkTIQzIas=2011-06-07 10:24:30,759\nPutUserPolicy [DEBUG]:query_string: AWSAccessKeyId=MXQQXAGFYAI7P5J6R4PB0&Actio\nn;=PutUserPolicy&PolicyDocument;=%7B%20%22Version%22%3A%222011-04-01%22%2C%20%\n22Statement%22%3A%5B%7B%20%22Sid%22%3A%221%22%2C%20%22Effect%22%3A%22Allow%22%\n2C%20%22Action%22%3A%22ec2%3Aassociateaddress%22%2C%20%22Resource%22%3A%22arn%\n3Aaws%3Aec2%3A%3A%3Aaddress%2F192.168.1.1%22%20%7D%5D%7D%0A&PolicyName;=testpo\nlicy&SignatureMethod;=HmacSHA256&SignatureVersion;=2&Timestamp;=2011-06-07T17%\n3A24%3A30Z&UserName;=testuser&Version;=2010-05-08 Signature:\nHmvd2m3nJGMDOhEwF+/lcsASLKAUzu6k9hBkTIQzIas=2011-06-07 10:24:30,759\nPutUserPolicy [DEBUG]:Params after auth: {'UserName': 'testuser',\n'PolicyName': 'testpolicy', 'SignatureVersion': 2, 'AWSAccessKeyId':\n'MXQQXAGFYAI7P5J6R4PB0', 'Version': '2010-05-08', 'Timestamp':\n'2011-06-07T17:24:30Z', 'SignatureMethod': 'HmacSHA256', 'PolicyDocument': '{\n\"Version\":\"2011-04-01\", \"Statement\":[{ \"Sid\":\"1\", \"Effect\":\"Allow\",\n\"Action\":\"ec2:associateaddress\",\n\"Resource\":\"arn:aws:ec2:::address/192.168.1.1\" }]}\\n', 'Action':\n'PutUserPolicy'}connect: (192.168.51.126, 8773)send: 'GET /services/Euare/?AWS\nAccessKeyId=MXQQXAGFYAI7P5J6R4PB0&Action;=PutUserPolicy&PolicyDocument;=%7B%20\n%22Version%22%3A%222011-04-01%22%2C%20%22Statement%22%3A%5B%7B%20%22Sid%22%3A%\n221%22%2C%20%22Effect%22%3A%22Allow%22%2C%20%22Action%22%3A%22ec2%3Aassociatea\nddress%22%2C%20%22Resource%22%3A%22arn%3Aaws%3Aec2%3A%3A%3Aaddress%2F192.168.1\n.1%22%20%7D%5D%7D%0A&PolicyName;=testpolicy&SignatureMethod;=HmacSHA256&Signat\nureVersion;=2&Timestamp;=2011-06-07T17%3A24%3A30Z&UserName;=testuser&Version;=\n2010-05-08&Signature;=Hmvd2m3nJGMDOhEwF%2B/lcsASLKAUzu6k9hBkTIQzIas%3D\nHTTP/1.1\\r\\nHost: 192.168.51.126:8773\\r\\nAccept-Encoding: identity\\r\\nContent-\nLength: 0\\r\\nUser-Agent: Boto/2.0rc1 (linux2)\\r\\n\\r\\n'reply: 'HTTP/1.1 500\nInternal Server Error\\r\\n'header: Content-Length: 244header: Content-Type:\napplication/xml; charset=UTF-82011-06-07 10:24:30,819 PutUserPolicy\n[DEBUG]:received 500 response, retrying in 1 seconds2011-06-07 10:24:31,814\nPutUserPolicy [DEBUG]:Params before auth: {'UserName': 'testuser',\n'PolicyName': 'testpolicy', 'SignatureVersion': 2, 'AWSAccessKeyId':\n'MXQQXAGFYAI7P5J6R4PB0', 'Version': '2010-05-08', 'Timestamp':\n'2011-06-07T17:24:30Z', 'SignatureMethod': 'HmacSHA256', 'PolicyDocument': '{\n\"Version\":\"2011-04-01\", \"Statement\":[{ \"Sid\":\"1\", \"Effect\":\"Allow\",\n\"Action\":\"ec2:associateaddress\",\n\"Resource\":\"arn:aws:ec2:::address/192.168.1.1\" }]}\\n', 'Action':\n'PutUserPolicy'}2011-06-07 10:24:31,815 PutUserPolicy [DEBUG]:using\n_calc_signature_22011-06-07 10:24:31,815 PutUserPolicy [DEBUG]:query string: A\nWSAccessKeyId=MXQQXAGFYAI7P5J6R4PB0&Action;=PutUserPolicy&PolicyDocument;=%7B%\n20%22Version%22%3A%222011-04-01%22%2C%20%22Statement%22%3A%5B%7B%20%22Sid%22%3\nA%221%22%2C%20%22Effect%22%3A%22Allow%22%2C%20%22Action%22%3A%22ec2%3Aassociat\neaddress%22%2C%20%22Resource%22%3A%22arn%3Aaws%3Aec2%3A%3A%3Aaddress%2F192.168\n.1.1%22%20%7D%5D%7D%0A&PolicyName;=testpolicy&SignatureMethod;=HmacSHA256&Sign\natureVersion;=2&Timestamp;=2011-06-07T17%3A24%3A31Z&UserName;=testuser&Version\n;=2010-05-082011-06-07 10:24:31,815 PutUserPolicy [DEBUG]:string_to_sign: GET1\n92.168.51.126:8773/services/Euare/AWSAccessKeyId=MXQQXAGFYAI7P5J6R4PB0&Action;\n=PutUserPolicy&PolicyDocument;=%7B%20%22Version%22%3A%222011-04-01%22%2C%20%22\nStatement%22%3A%5B%7B%20%22Sid%22%3A%221%22%2C%20%22Effect%22%3A%22Allow%22%2C\n%20%22Action%22%3A%22ec2%3Aassociateaddress%22%2C%20%22Resource%22%3A%22arn%3A\naws%3Aec2%3A%3A%3Aaddress%2F192.168.1.1%22%20%7D%5D%7D%0A&PolicyName;=testpoli\ncy&SignatureMethod;=HmacSHA256&SignatureVersion;=2&Timestamp;=2011-06-07T17%3A\n24%3A31Z&UserName;=testuser&Version;=2010-05-082011-06-07 10:24:31,815\nPutUserPolicy [DEBUG]:len(b64)=442011-06-07 10:24:31,815 PutUserPolicy\n[DEBUG]:base64 encoded digest:\ng/j3I9RMHaUoSliX6CaErJLug7RPcXXp7LVPKxxrNZU=2011-06-07 10:24:31,815\nPutUserPolicy [DEBUG]:query_string: AWSAccessKeyId=MXQQXAGFYAI7P5J6R4PB0&Actio\nn;=PutUserPolicy&PolicyDocument;=%7B%20%22Version%22%3A%222011-04-01%22%2C%20%\n22Statement%22%3A%5B%7B%20%22Sid%22%3A%221%22%2C%20%22Effect%22%3A%22Allow%22%\n2C%20%22Action%22%3A%22ec2%3Aassociateaddress%22%2C%20%22Resource%22%3A%22arn%\n3Aaws%3Aec2%3A%3A%3Aaddress%2F192.168.1.1%22%20%7D%5D%7D%0A&PolicyName;=testpo\nlicy&SignatureMethod;=HmacSHA256&SignatureVersion;=2&Timestamp;=2011-06-07T17%\n3A24%3A31Z&UserName;=testuser&Version;=2010-05-08 Signature:\ng/j3I9RMHaUoSliX6CaErJLug7RPcXXp7LVPKxxrNZU=2011-06-07 10:24:31,816\nPutUserPolicy [DEBUG]:Params after auth: {'UserName': 'testuser',\n'PolicyName': 'testpolicy', 'SignatureVersion': 2, 'AWSAccessKeyId':\n'MXQQXAGFYAI7P5J6R4PB0', 'Version': '2010-05-08', 'Timestamp':\n'2011-06-07T17:24:31Z', 'SignatureMethod': 'HmacSHA256', 'PolicyDocument': '{\n\"Version\":\"2011-04-01\", \"Statement\":[{ \"Sid\":\"1\", \"Effect\":\"Allow\",\n\"Action\":\"ec2:associateaddress\",\n\"Resource\":\"arn:aws:ec2:::address/192.168.1.1\" }]}\\n', 'Action':\n'PutUserPolicy'}send: 'GET /services/Euare/?AWSAccessKeyId=MXQQXAGFYAI7P5J6R4P\nB0&Action;=PutUserPolicy&PolicyDocument;=%7B%20%22Version%22%3A%222011-04-01%2\n2%2C%20%22Statement%22%3A%5B%7B%20%22Sid%22%3A%221%22%2C%20%22Effect%22%3A%22A\nllow%22%2C%20%22Action%22%3A%22ec2%3Aassociateaddress%22%2C%20%22Resource%22%3\nA%22arn%3Aaws%3Aec2%3A%3A%3Aaddress%2F192.168.1.1%22%20%7D%5D%7D%0A&PolicyName\n;=testpolicy&SignatureMethod;=HmacSHA256&SignatureVersion;=2&Timestamp;=2011-0\n6-07T17%3A24%3A30Z&UserName;=testuser&Version;=2010-05-08&Signature;=Hmvd2m3nJ\nGMDOhEwF%2B/lcsASLKAUzu6k9hBkTIQzIas%3D?AWSAccessKeyId=MXQQXAGFYAI7P5J6R4PB0&A\nction;=PutUserPolicy&PolicyDocument;=%7B%20%22Version%22%3A%222011-04-01%22%2C\n%20%22Statement%22%3A%5B%7B%20%22Sid%22%3A%221%22%2C%20%22Effect%22%3A%22Allow\n%22%2C%20%22Action%22%3A%22ec2%3Aassociateaddress%22%2C%20%22Resource%22%3A%22\narn%3Aaws%3Aec2%3A%3A%3Aaddress%2F192.168.1.1%22%20%7D%5D%7D%0A&PolicyName;=te\nstpolicy&SignatureMethod;=HmacSHA256&SignatureVersion;=2&Timestamp;=2011-06-07\nT17%3A24%3A31Z&UserName;=testuser&Version;=2010-05-08&Signature;=g/j3I9RMHaUoS\nliX6CaErJLug7RPcXXp7LVPKxxrNZU%3D HTTP/1.1\\r\\nHost: 192.168.51.126:8773\\r\n\\nAccept-Encoding: identity\\r\\nContent-Length: 0\\r\\nUser-Agent: Boto/2.0rc1\n(linux2)\\r\\n\\r\\n'reply: 'HTTP/1.1 500 Internal Server Error\\r\\n'header:\nContent-Length: 244header: Content-Type: application/xml;\ncharset=UTF-82011-06-07 10:24:31,887 PutUserPolicy [DEBUG]:received 500\nresponse, retrying in 2 seconds2011-06-07 10:24:33,887 PutUserPolicy\n[DEBUG]:Params before auth: {'UserName': 'testuser', 'PolicyName':\n'testpolicy', 'SignatureVersion': 2, 'AWSAccessKeyId':\n'MXQQXAGFYAI7P5J6R4PB0', 'Version': '2010-05-08', 'Timestamp':\n'2011-06-07T17:24:31Z', 'SignatureMethod': 'HmacSHA256', 'PolicyDocument': '{\n\"Version\":\"2011-04-01\", \"Statement\":[{ \"Sid\":\"1\", \"Effect\":\"Allow\",\n\"Action\":\"ec2:associateaddress\",\n\"Resource\":\"arn:aws:ec2:::address/192.168.1.1\" }]}\\n', 'Action':\n'PutUserPolicy'}2011-06-07 10:24:33,887 PutUserPolicy [DEBUG]:using\n_calc_signature_22011-06-07 10:24:33,887 PutUserPolicy [DEBUG]:query string: A\nWSAccessKeyId=MXQQXAGFYAI7P5J6R4PB0&Action;=PutUserPolicy&PolicyDocument;=%7B%\n20%22Version%22%3A%222011-04-01%22%2C%20%22Statement%22%3A%5B%7B%20%22Sid%22%3\nA%221%22%2C%20%22Effect%22%3A%22Allow%22%2C%20%22Action%22%3A%22ec2%3Aassociat\neaddress%22%2C%20%22Resource%22%3A%22arn%3Aaws%3Aec2%3A%3A%3Aaddress%2F192.168\n.1.1%22%20%7D%5D%7D%0A&PolicyName;=testpolicy&SignatureMethod;=HmacSHA256&Sign\natureVersion;=2&Timestamp;=2011-06-07T17%3A24%3A33Z&UserName;=testuser&Version\n;=2010-05-082011-06-07 10:24:33,887 PutUserPolicy [DEBUG]:string_to_sign: GET1\n92.168.51.126:8773/services/Euare/AWSAccessKeyId=MXQQXAGFYAI7P5J6R4PB0&Action;\n=PutUserPolicy&PolicyDocument;=%7B%20%22Version%22%3A%222011-04-01%22%2C%20%22\nStatement%22%3A%5B%7B%20%22Sid%22%3A%221%22%2C%20%22Effect%22%3A%22Allow%22%2C\n%20%22Action%22%3A%22ec2%3Aassociateaddress%22%2C%20%22Resource%22%3A%22arn%3A\naws%3Aec2%3A%3A%3Aaddress%2F192.168.1.1%22%20%7D%5D%7D%0A&PolicyName;=testpoli\ncy&SignatureMethod;=HmacSHA256&SignatureVersion;=2&Timestamp;=2011-06-07T17%3A\n24%3A33Z&UserName;=testuser&Version;=2010-05-082011-06-07 10:24:33,887\nPutUserPolicy [DEBUG]:len(b64)=442011-06-07 10:24:33,887 PutUserPolicy\n[DEBUG]:base64 encoded digest:\nKeUzEQ+9Pke69WrMI3UoBODNHK18ergon1X9Iy5yyG4=2011-06-07 10:24:33,887\nPutUserPolicy [DEBUG]:query_string: AWSAccessKeyId=MXQQXAGFYAI7P5J6R4PB0&Actio\nn;=PutUserPolicy&PolicyDocument;=%7B%20%22Version%22%3A%222011-04-01%22%2C%20%\n22Statement%22%3A%5B%7B%20%22Sid%22%3A%221%22%2C%20%22Effect%22%3A%22Allow%22%\n2C%20%22Action%22%3A%22ec2%3Aassociateaddress%22%2C%20%22Resource%22%3A%22arn%\n3Aaws%3Aec2%3A%3A%3Aaddress%2F192.168.1.1%22%20%7D%5D%7D%0A&PolicyName;=testpo\nlicy&SignatureMethod;=HmacSHA256&SignatureVersion;=2&Timestamp;=2011-06-07T17%\n3A24%3A33Z&UserName;=testuser&Version;=2010-05-08 Signature:\nKeUzEQ+9Pke69WrMI3UoBODNHK18ergon1X9Iy5yyG4=2011-06-07 10:24:33,888\nPutUserPolicy [DEBUG]:Params after auth: {'UserName': 'testuser',\n'PolicyName': 'testpolicy', 'SignatureVersion': 2, 'AWSAccessKeyId':\n'MXQQXAGFYAI7P5J6R4PB0', 'Version': '2010-05-08', 'Timestamp':\n'2011-06-07T17:24:33Z', 'SignatureMethod': 'HmacSHA256', 'PolicyDocument': '{\n\"Version\":\"2011-04-01\", \"Statement\":[{ \"Sid\":\"1\", \"Effect\":\"Allow\",\n\"Action\":\"ec2:associateaddress\",\n\"Resource\":\"arn:aws:ec2:::address/192.168.1.1\" }]}\\n', 'Action':\n'PutUserPolicy'}send: 'GET /services/Euare/?AWSAccessKeyId=MXQQXAGFYAI7P5J6R4P\nB0&Action;=PutUserPolicy&PolicyDocument;=%7B%20%22Version%22%3A%222011-04-01%2\n2%2C%20%22Statement%22%3A%5B%7B%20%22Sid%22%3A%221%22%2C%20%22Effect%22%3A%22A\nllow%22%2C%20%22Action%22%3A%22ec2%3Aassociateaddress%22%2C%20%22Resource%22%3\nA%22arn%3Aaws%3Aec2%3A%3A%3Aaddress%2F192.168.1.1%22%20%7D%5D%7D%0A&PolicyName\n;=testpolicy&SignatureMethod;=HmacSHA256&SignatureVersion;=2&Timestamp;=2011-0\n6-07T17%3A24%3A30Z&UserName;=testuser&Version;=2010-05-08&Signature;=Hmvd2m3nJ\nGMDOhEwF%2B/lcsASLKAUzu6k9hBkTIQzIas%3D?AWSAccessKeyId=MXQQXAGFYAI7P5J6R4PB0&A\nction;=PutUserPolicy&PolicyDocument;=%7B%20%22Version%22%3A%222011-04-01%22%2C\n%20%22Statement%22%3A%5B%7B%20%22Sid%22%3A%221%22%2C%20%22Effect%22%3A%22Allow\n%22%2C%20%22Action%22%3A%22ec2%3Aassociateaddress%22%2C%20%22Resource%22%3A%22\narn%3Aaws%3Aec2%3A%3A%3Aaddress%2F192.168.1.1%22%20%7D%5D%7D%0A&PolicyName;=te\nstpolicy&SignatureMethod;=HmacSHA256&SignatureVersion;=2&Timestamp;=2011-06-07\nT17%3A24%3A31Z&UserName;=testuser&Version;=2010-05-08&Signature;=g/j3I9RMHaUoS\nliX6CaErJLug7RPcXXp7LVPKxxrNZU%3D?AWSAccessKeyId=MXQQXAGFYAI7P5J6R4PB0&Action;\n=PutUserPolicy&PolicyDocument;=%7B%20%22Version%22%3A%222011-04-01%22%2C%20%22\nStatement%22%3A%5B%7B%20%22Sid%22%3A%221%22%2C%20%22Effect%22%3A%22Allow%22%2C\n%20%22Action%22%3A%22ec2%3Aassociateaddress%22%2C%20%22Resource%22%3A%22arn%3A\naws%3Aec2%3A%3A%3Aaddress%2F192.168.1.1%22%20%7D%5D%7D%0A&PolicyName;=testpoli\ncy&SignatureMethod;=HmacSHA256&SignatureVersion;=2&Timestamp;=2011-06-07T17%3A\n24%3A33Z&UserName;=testuser&Version;=2010-05-08&Signature;=KeUzEQ%2B9Pke69WrMI\n3UoBODNHK18ergon1X9Iy5yyG4%3D HTTP/1.1\\r\\nHost: 192.168.51.126:8773\\r\\nAccept-\nEncoding: identity\\r\\nContent-Length: 0\\r\\nUser-Agent: Boto/2.0rc1\n(linux2)\\r\\n\\r\\n'reply: 'HTTP/1.1 500 Internal Server Error\\r\\n'header:\nContent-Length: 244header: Content-Type: application/xml; charset=UTF-8\n\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"created":"2012-04-23T16:09:23.396-0500","updated":"2012-04-23T16:09:23.396-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/10830/comment/14080","id":"14080","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"body":"Originally posted on 2011-06-07 17:27:46 by wenye\nI agree we should be careful not to break anything that is dependent on\nboto.\n\nBut I don't quite get what we are talking here. In my understanding, every\nrequest should be correctly signed with the right timestamp. Whatever the\n\"retry\" scheme is, the request should have right timestamp and right\nsignature, right? Also, any AWS service implementation should be \"retry\"\nagnostic. As long as the request is correctly signed, it should authenticate\nthe request. So I don't see how resigning every request in boto will break\nanything.\n\nAs far as other tools, that's a different story. We are breaking them even\nnow with the current replay attack mechanism if they don't resign their\nmessage for each request.\n\nLet's talk it in the meeting.\n\nOn Tue, Jun 7, 2011 at 10:16 AM, Mitch Garnaat via RT <\nbugs@support.eucalyptus.com> wrote:\n\n>\n> <URL: http://support.eucalyptus.com/Ticket/Display.html?id=2458 >\n>\n> On Tue Jun 07 09:27:42 2011, vika.felmetsger wrote:\n> > Mitch and David have a good point and fixing retry in euca2ools does\n> > not mean\n> > that we will not have this problem with other tools. While the retry\n> > algorithm\n> > cited by David does not seem to state anything about whether exactly\n> > the same\n> > message should be retried, client tools might be retrying the exactly\n> > the same\n> > message simply because it works with AWS. And the reason it works with\n> > AWS, as\n> > far as I understand from my previous discussions with Mitch, is that\n> > they do\n> > allow to replay messages until the timestamp expires, which might work\n> > for\n> > their deployment model but not for ours.\n> >\n> > I don't know how easy it is to fix it in CLC code to handle replays\n> > differently\n> > in case of 500 errors differently --- it's something that Chris would\n> > have a\n> > better idea on. One suggestion I have at this point is to try to run\n> > the IAM\n> > command corresponding to the problematic euare command while we still\n> > have this\n> > bug in eucalyptus that triggers 500 response and see if IAM tools also\n> > choke.\n> > This way we will have one extra example of a user tool behavior.\n> >\n> > On Tue Jun 07 07:30:07 2011, david.kavanagh wrote:\n> > > I'm going to back up what Mitch says here. When implementing retry\n> > > logic in typica, the algorithm comes from here;\n> > > http://aws.amazon.com/articles/1394?_encoding=UTF8&jiveRedirect=1\n> > >\n> > > This became somewhat the gold standard for implementing retries for\n> > > AWS when Alesky published it. Lots of people referred to it. Now, it\n> > > says \"Submit request\", and it isn't specific about re-signing, but\n> > > I've never see resigning occur, though I've only looked at a few\n> > > libraries. I do recommend being tolerant of this on the server side.\n> > > If you cache a request that a 5xx error was returned for, mark it\n> > > specially, so that if that requests comes again (in a retry, for\n> > some\n> > > number of minutes), it is accepted if the server doesn't have a 5xx\n> > > error this time, and the time shift of the request is ignored.\n> > Again,\n> > > there needs to be a time limit (3-5 minutes should be sufficient,\n> > but\n> > > I'm not sure even Amazon has that limit, not that I've hit anyway).\n> > >\n> > > David\n> > >\n> > > PS. compatibility at the API level is huge. Look at our partner and\n> > > tool ecosystem. we must be very careful not to break that.\n> > >\n> > > On Tue, Jun 7, 2011 at 9:27 AM, Mitch Garnaat via RT\n> > > <bugs@support.eucalyptus.com> wrote:\n> > > >\n> > > > http://support.eucalyptus.com/Ticket/Display.html?id=2458\n> > > > This is a comment. It is not sent to the Requestor(s):\n> > > >\n> > > > I've checked in a new version of boto/boto/connection.py that will\n> > > re-sign\n> > > > each request prior to retrying. It is checked into our boto bzr\n> > repo\n> > > (revno 8)\n> > > > and should get picked up by your tests automatically. If not,\n> > check\n> > > with Kyo on\n> > > > the values in your MEMO field.\n> > > >\n> > > > Let me know if this fixes the issue.\n> > > >\n> > > >\n> > >\n>\n> I'm trying to recreate Ye's original test case on a QA machine and see if I\n> can\n> determine if the changes I made in boto will take care of the issue or not.\n>\n>\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"created":"2012-04-23T16:09:23.937-0500","updated":"2012-04-23T16:09:23.937-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/10830/comment/14081","id":"14081","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"body":"Originally posted on 2011-06-07 17:27:46 by wenye\nI agree we should be careful not to break anything that is dependent on boto.\n\n  \n\nBut I don't quite get what we are talking here. In my understanding, every\nrequest should be correctly signed with the right timestamp. Whatever the\n\"retry\" scheme is, the request should have right timestamp and right\nsignature, right? Also, any AWS service implementation should be \"retry\"\nagnostic. As long as the request is correctly signed, it should authenticate\nthe request. So I don't see how resigning every request in boto will break\nanything.\n\n  \n\nAs far as other tools, that's a different story. We are breaking them even now\nwith the current replay attack mechanism if they don't resign their message\nfor each request.\n\n  \n\nLet's talk it in the meeting.\n\n  \n\nOn Tue, Jun 7, 2011 at 10:16 AM, Mitch Garnaat via RT\n<[bugs@support.eucalyptus.com](mailto:bugs@support.eucalyptus.com)> wrote:\n\n>\n\n<URL: [http://support.eucalyptus.com/Ticket/Display.html?id=2458](http://suppo\nrt.eucalyptus.com/Ticket/Display.html?id=2458) >\n\n>\n\n>\n\nOn Tue Jun 07 09:27:42 2011, vika.felmetsger wrote:\n\n> Mitch and David have a good point and fixing retry in euca2ools does\n\n> not mean\n\n> that we will not have this problem with other tools. While the retry\n\n> algorithm\n\n> cited by David does not seem to state anything about whether exactly\n\n> the same\n\n> message should be retried, client tools might be retrying the exactly\n\n> the same\n\n> message simply because it works with AWS. And the reason it works with\n\n> AWS, as\n\n> far as I understand from my previous discussions with Mitch, is that\n\n> they do\n\n> allow to replay messages until the timestamp expires, which might work\n\n> for\n\n> their deployment model but not for ours.\n\n>\n\n> I don't know how easy it is to fix it in CLC code to handle replays\n\n> differently\n\n> in case of 500 errors differently --- it's something that Chris would\n\n> have a\n\n> better idea on. One suggestion I have at this point is to try to run\n\n> the IAM\n\n> command corresponding to the problematic euare command while we still\n\n> have this\n\n> bug in eucalyptus that triggers 500 response and see if IAM tools also\n\n> choke.\n\n> This way we will have one extra example of a user tool behavior.\n\n>\n\n> On Tue Jun 07 07:30:07 2011, david.kavanagh wrote:\n\n> > I'm going to back up what Mitch says here. When implementing retry\n\n> > logic in typica, the algorithm comes from here;\n\n> > [http://aws.amazon.com/articles/1394?_encoding=UTF8&jiveRedirect=1](http:/\n/aws.amazon.com/articles/1394?_encoding=UTF8&jiveRedirect=1)\n\n> >\n\n> > This became somewhat the gold standard for implementing retries for\n\n> > AWS when Alesky published it. Lots of people referred to it. Now, it\n\n> > says \"Submit request\", and it isn't specific about re-signing, but\n\n> > I've never see resigning occur, though I've only looked at a few\n\n> > libraries. I do recommend being tolerant of this on the server side.\n\n> > If you cache a request that a 5xx error was returned for, mark it\n\n> > specially, so that if that requests comes again (in a retry, for\n\n> some\n\n> > number of minutes), it is accepted if the server doesn't have a 5xx\n\n> > error this time, and the time shift of the request is ignored.\n\n> Again,\n\n> > there needs to be a time limit (3-5 minutes should be sufficient,\n\n> but\n\n> > I'm not sure even Amazon has that limit, not that I've hit anyway).\n\n> >\n\n> > David\n\n> >\n\n> > PS. compatibility at the API level is huge. Look at our partner and\n\n> > tool ecosystem. we must be very careful not to break that.\n\n> >\n\n> > On Tue, Jun 7, 2011 at 9:27 AM, Mitch Garnaat via RT\n\n> > <[bugs@support.eucalyptus.com](mailto:bugs@support.eucalyptus.com)> wrote:\n\n> > >\n\n>\n\n> > > > [http://support.eucalyptus.com/Ticket/Display.html?id=2458](http://sup\nport.eucalyptus.com/Ticket/Display.html?id=2458)\n\n> > > This is a comment. It is not sent to the Requestor(s):\n\n> > >\n\n> > > I've checked in a new version of boto/boto/connection.py that will\n\n> > re-sign\n\n> > > each request prior to retrying. It is checked into our boto bzr\n\n> repo\n\n> > (revno 8)\n\n> > > and should get picked up by your tests automatically. If not,\n\n> check\n\n> > with Kyo on\n\n> > > the values in your MEMO field.\n\n> > >\n\n> > > Let me know if this fixes the issue.\n\n> > >\n\n> > >\n\n> >\n\n  \n\n>\n\n> I'm trying to recreate Ye's original test case on a QA machine and see if I\ncan\n\ndetermine if the changes I made in boto will take care of the issue or not.\n\n  \n\n  \n\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"created":"2012-04-23T16:09:24.549-0500","updated":"2012-04-23T16:09:24.549-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/10830/comment/14082","id":"14082","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"body":"Originally posted on 2011-06-07 17:27:47 by wenye\n\n<URL: http://support.eucalyptus.com/Ticket/Display.html?id=2458 >\n\nI agree we should be careful not to break anything that is dependent on\nboto.\n\nBut I don't quite get what we are talking here. In my understanding, every\nrequest should be correctly signed with the right timestamp. Whatever the\n\"retry\" scheme is, the request should have right timestamp and right\nsignature, right? Also, any AWS service implementation should be \"retry\"\nagnostic. As long as the request is correctly signed, it should authenticate\nthe request. So I don't see how resigning every request in boto will break\nanything.\n\nAs far as other tools, that's a different story. We are breaking them even\nnow with the current replay attack mechanism if they don't resign their\nmessage for each request.\n\nLet's talk it in the meeting.\n\nOn Tue, Jun 7, 2011 at 10:16 AM, Mitch Garnaat via RT <\nbugs@support.eucalyptus.com> wrote:\n\n>\n> <URL: http://support.eucalyptus.com/Ticket/Display.html?id=2458 >\n>\n> On Tue Jun 07 09:27:42 2011, vika.felmetsger wrote:\n> > Mitch and David have a good point and fixing retry in euca2ools does\n> > not mean\n> > that we will not have this problem with other tools. While the retry\n> > algorithm\n> > cited by David does not seem to state anything about whether exactly\n> > the same\n> > message should be retried, client tools might be retrying the exactly\n> > the same\n> > message simply because it works with AWS. And the reason it works with\n> > AWS, as\n> > far as I understand from my previous discussions with Mitch, is that\n> > they do\n> > allow to replay messages until the timestamp expires, which might work\n> > for\n> > their deployment model but not for ours.\n> >\n> > I don't know how easy it is to fix it in CLC code to handle replays\n> > differently\n> > in case of 500 errors differently --- it's something that Chris would\n> > have a\n> > better idea on. One suggestion I have at this point is to try to run\n> > the IAM\n> > command corresponding to the problematic euare command while we still\n> > have this\n> > bug in eucalyptus that triggers 500 response and see if IAM tools also\n> > choke.\n> > This way we will have one extra example of a user tool behavior.\n> >\n> > On Tue Jun 07 07:30:07 2011, david.kavanagh wrote:\n> > > I'm going to back up what Mitch says here. When implementing retry\n> > > logic in typica, the algorithm comes from here;\n> > > http://aws.amazon.com/articles/1394?_encoding=UTF8&jiveRedirect=1\n> > >\n> > > This became somewhat the gold standard for implementing retries for\n> > > AWS when Alesky published it. Lots of people referred to it. Now, it\n> > > says \"Submit request\", and it isn't specific about re-signing, but\n> > > I've never see resigning occur, though I've only looked at a few\n> > > libraries. I do recommend being tolerant of this on the server side.\n> > > If you cache a request that a 5xx error was returned for, mark it\n> > > specially, so that if that requests comes again (in a retry, for\n> > some\n> > > number of minutes), it is accepted if the server doesn't have a 5xx\n> > > error this time, and the time shift of the request is ignored.\n> > Again,\n> > > there needs to be a time limit (3-5 minutes should be sufficient,\n> > but\n> > > I'm not sure even Amazon has that limit, not that I've hit anyway).\n> > >\n> > > David\n> > >\n> > > PS. compatibility at the API level is huge. Look at our partner and\n> > > tool ecosystem. we must be very careful not to break that.\n> > >\n> > > On Tue, Jun 7, 2011 at 9:27 AM, Mitch Garnaat via RT\n> > > <bugs@support.eucalyptus.com> wrote:\n> > > >\n> > > > http://support.eucalyptus.com/Ticket/Display.html?id=2458\n> > > > This is a comment. It is not sent to the Requestor(s):\n> > > >\n> > > > I've checked in a new version of boto/boto/connection.py that will\n> > > re-sign\n> > > > each request prior to retrying. It is checked into our boto bzr\n> > repo\n> > > (revno 8)\n> > > > and should get picked up by your tests automatically. If not,\n> > check\n> > > with Kyo on\n> > > > the values in your MEMO field.\n> > > >\n> > > > Let me know if this fixes the issue.\n> > > >\n> > > >\n> > >\n>\n> I'm trying to recreate Ye's original test case on a QA machine and see if I\n> can\n> determine if the changes I made in boto will take care of the issue or not.\n>\n>\n\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"created":"2012-04-23T16:09:25.062-0500","updated":"2012-04-23T16:09:25.062-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/10830/comment/14083","id":"14083","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"body":"Originally posted on 2011-06-07 17:28:48 by wenye\nThanks Mitch. I was about to do it. On Tue, Jun 7, 2011 at 10:26 AM, Mitch\nGarnaat via RT < bugs@support.eucalyptus.com> wrote: > >\nhttp://support.eucalyptus.com/Ticket/Display.html?id=2458 > This is a comment.\nIt is not sent to the Requestor(s): > > Re-signing each retried request in\nboto seems to work as expected (see log > below). I just need to do more\ntesting to make sure I haven't broken > anything > else: > >\n[root@eucahost-51-126 ~]# euare-useruploadpolicy -u testuser -p testpolicy >\n-f > test2.policy --debug2011-06-07 10:24:30,756 PutUserPolicy >\n[DEBUG]:request_params: {'UserName': 'testuser', 'PolicyName': > 'testpolicy',\n> 'PolicyDocument': '{ \"Version\":\"2011-04-01\", \"Statement\":[{ \"Sid\":\"1\", >\n\"Effect\":\"Allow\", \"Action\":\"ec2:associateaddress\", >\n\"Resource\":\"arn:aws:ec2:::address/192.168.1.1\" }]}\\n'}2011-06-07 >\n10:24:30,757 > PutUserPolicy [DEBUG]:Method: GET2011-06-07 10:24:30,757\nPutUserPolicy > [DEBUG]:Path: /services/Euare/2011-06-07 10:24:30,757\nPutUserPolicy > [DEBUG]:Data: 2011-06-07 10:24:30,757 PutUserPolicy\n[DEBUG]:Headers: > {}2011-06-07 > 10:24:30,757 PutUserPolicy [DEBUG]:Host:\n192.168.51.126:87732011-06-07 > 10:24:30,757 PutUserPolicy\n[DEBUG]:establishing HTTP connection: > kwargs={}2011-06-07 > 10:24:30,757\nPutUserPolicy [DEBUG]:Params before auth: {'UserName': > 'testuser', >\n'PolicyName': 'testpolicy', 'PolicyDocument': '{ \"Version\":\"2011-04-01\", >\n\"Statement\":[{ \"Sid\":\"1\", \"Effect\":\"Allow\", > \"Action\":\"ec2:associateaddress\",\n> \"Resource\":\"arn:aws:ec2:::address/192.168.1.1\" }]}\\n', 'Action': >\n'PutUserPolicy', 'Version': '2010-05-08'}2011-06-07 10:24:30,758 >\nPutUserPolicy > [DEBUG]:using _calc_signature_22011-06-07 10:24:30,758\nPutUserPolicy > [DEBUG]:query string: > > AWSAccessKeyId=MXQQXAGFYAI7P5J6R4PB0\n&Action;=PutUserPolicy&PolicyDocument;=%7B%20%22Version%22%3A%222011-04-01%22%\n2C%20%22Statement%22%3A%5B%7B%20%22Sid%22%3A%221%22%2C%20%22Effect%22%3A%22All\now%22%2C%20%22Action%22%3A%22ec2%3Aassociateaddress%22%2C%20%22Resource%22%3A%\n22arn%3Aaws%3Aec2%3A%3A%3Aaddress%2F192.168.1.1%22%20%7D%5D%7D%0A&PolicyName;=\ntestpolicy&SignatureMethod;=HmacSHA256&SignatureVersion;=2&Timestamp;=2011-06-\n07T17%3A24%3A30Z&UserName;=testuser&Version;=2010-05-082011-06-07 >\n10:24:30,759 PutUserPolicy [DEBUG]:string_to_sign: > GET192.168.51.126:8773/se\nrvices/Euare/AWSAccessKeyId=MXQQXAGFYAI7P5J6R4PB0&Action;=PutUserPolicy&Policy\nDocument;=%7B%20%22Version%22%3A%222011-04-01%22%2C%20%22Statement%22%3A%5B%7B\n%20%22Sid%22%3A%221%22%2C%20%22Effect%22%3A%22Allow%22%2C%20%22Action%22%3A%22\nec2%3Aassociateaddress%22%2C%20%22Resource%22%3A%22arn%3Aaws%3Aec2%3A%3A%3Aadd\nress%2F192.168.1.1%22%20%7D%5D%7D%0A&PolicyName;=testpolicy&SignatureMethod;=H\nmacSHA256&SignatureVersion;=2&Timestamp;=2011-06-07T17%3A24%3A30Z&UserName;=te\nstuser&Version;=2010-05-082011-06-07 > 10:24:30,759 PutUserPolicy\n[DEBUG]:len(b64)=442011-06-07 10:24:30,759 > PutUserPolicy [DEBUG]:base64\nencoded digest: > Hmvd2m3nJGMDOhEwF+/lcsASLKAUzu6k9hBkTIQzIas=2011-06-07\n10:24:30,759 > PutUserPolicy [DEBUG]:query_string: > > AWSAccessKeyId=MXQQXAGF\nYAI7P5J6R4PB0&Action;=PutUserPolicy&PolicyDocument;=%7B%20%22Version%22%3A%222\n011-04-01%22%2C%20%22Statement%22%3A%5B%7B%20%22Sid%22%3A%221%22%2C%20%22Effec\nt%22%3A%22Allow%22%2C%20%22Action%22%3A%22ec2%3Aassociateaddress%22%2C%20%22Re\nsource%22%3A%22arn%3Aaws%3Aec2%3A%3A%3Aaddress%2F192.168.1.1%22%20%7D%5D%7D%0A\n&PolicyName;=testpolicy&SignatureMethod;=HmacSHA256&SignatureVersion;=2&Timest\namp;=2011-06-07T17%3A24%3A30Z&UserName;=testuser&Version;=2010-05-08 >\nSignature: Hmvd2m3nJGMDOhEwF+/lcsASLKAUzu6k9hBkTIQzIas=2011-06-07 >\n10:24:30,759 > PutUserPolicy [DEBUG]:Params after auth: {'UserName':\n'testuser', > 'PolicyName': > 'testpolicy', 'SignatureVersion': 2,\n'AWSAccessKeyId': > 'MXQQXAGFYAI7P5J6R4PB0', > 'Version': '2010-05-08',\n'Timestamp': '2011-06-07T17:24:30Z', > 'SignatureMethod': 'HmacSHA256',\n'PolicyDocument': '{ > \"Version\":\"2011-04-01\", > \"Statement\":[{ \"Sid\":\"1\",\n\"Effect\":\"Allow\", > \"Action\":\"ec2:associateaddress\", >\n\"Resource\":\"arn:aws:ec2:::address/192.168.1.1\" }]}\\n', 'Action': >\n'PutUserPolicy'}connect: (192.168.51.126, 8773)send: 'GET > > /services/Euare/\n?AWSAccessKeyId=MXQQXAGFYAI7P5J6R4PB0&Action;=PutUserPolicy&PolicyDocument;=%7\nB%20%22Version%22%3A%222011-04-01%22%2C%20%22Statement%22%3A%5B%7B%20%22Sid%22\n%3A%221%22%2C%20%22Effect%22%3A%22Allow%22%2C%20%22Action%22%3A%22ec2%3Aassoci\nateaddress%22%2C%20%22Resource%22%3A%22arn%3Aaws%3Aec2%3A%3A%3Aaddress%2F192.1\n68.1.1%22%20%7D%5D%7D%0A&PolicyName;=testpolicy&SignatureMethod;=HmacSHA256&Si\ngnatureVersion;=2&Timestamp;=2011-06-07T17%3A24%3A30Z&UserName;=testuser&Versi\non;=2010-05-08&Signature;=Hmvd2m3nJGMDOhEwF%2B/lcsASLKAUzu6k9hBkTIQzIas%3D >\nHTTP/1.1\\r\\nHost: 192.168.51.126:8773\\r\\nAccept-Encoding: > identity\\r\n\\nContent-Length: 0\\r\\nUser-Agent: Boto/2.0rc1 > (linux2)\\r\\n\\r\\n'reply: >\n'HTTP/1.1 500 Internal Server Error\\r\\n'header: Content-Length: 244header: >\nContent-Type: application/xml; charset=UTF-82011-06-07 10:24:30,819 >\nPutUserPolicy [DEBUG]:received 500 response, retrying in 1 > seconds2011-06-07\n> 10:24:31,814 PutUserPolicy [DEBUG]:Params before auth: {'UserName': >\n'testuser', > 'PolicyName': 'testpolicy', 'SignatureVersion': 2,\n'AWSAccessKeyId': > 'MXQQXAGFYAI7P5J6R4PB0', 'Version': '2010-05-08',\n'Timestamp': > '2011-06-07T17:24:30Z', 'SignatureMethod': 'HmacSHA256',\n'PolicyDocument': > '{ > \"Version\":\"2011-04-01\", \"Statement\":[{ \"Sid\":\"1\",\n\"Effect\":\"Allow\", > \"Action\":\"ec2:associateaddress\",\n\"Resource\":\"arn:aws:ec2:::address/ > 192.168.1.1\" > }]}\\n', 'Action':\n'PutUserPolicy'}2011-06-07 10:24:31,815 PutUserPolicy > [DEBUG]:using\n_calc_signature_22011-06-07 10:24:31,815 PutUserPolicy > [DEBUG]:query string:\n> > AWSAccessKeyId=MXQQXAGFYAI7P5J6R4PB0&Action;=PutUserPolicy&PolicyDocument;\n=%7B%20%22Version%22%3A%222011-04-01%22%2C%20%22Statement%22%3A%5B%7B%20%22Sid\n%22%3A%221%22%2C%20%22Effect%22%3A%22Allow%22%2C%20%22Action%22%3A%22ec2%3Aass\nociateaddress%22%2C%20%22Resource%22%3A%22arn%3Aaws%3Aec2%3A%3A%3Aaddress%2F19\n2.168.1.1%22%20%7D%5D%7D%0A&PolicyName;=testpolicy&SignatureMethod;=HmacSHA256\n&SignatureVersion;=2&Timestamp;=2011-06-07T17%3A24%3A31Z&UserName;=testuser&Ve\nrsion;=2010-05-082011-06-07 > 10:24:31,815 PutUserPolicy\n[DEBUG]:string_to_sign: > GET192.168.51.126:8773/services/Euare/AWSAccessKeyId\n=MXQQXAGFYAI7P5J6R4PB0&Action;=PutUserPolicy&PolicyDocument;=%7B%20%22Version%\n22%3A%222011-04-01%22%2C%20%22Statement%22%3A%5B%7B%20%22Sid%22%3A%221%22%2C%2\n0%22Effect%22%3A%22Allow%22%2C%20%22Action%22%3A%22ec2%3Aassociateaddress%22%2\nC%20%22Resource%22%3A%22arn%3Aaws%3Aec2%3A%3A%3Aaddress%2F192.168.1.1%22%20%7D\n%5D%7D%0A&PolicyName;=testpolicy&SignatureMethod;=HmacSHA256&SignatureVersion;\n=2&Timestamp;=2011-06-07T17%3A24%3A31Z&UserName;=testuser&Version;=2010-05-082\n011-06-07 > 10:24:31,815 PutUserPolicy [DEBUG]:len(b64)=442011-06-07\n10:24:31,815 > PutUserPolicy [DEBUG]:base64 encoded digest: >\ng/j3I9RMHaUoSliX6CaErJLug7RPcXXp7LVPKxxrNZU=2011-06-07 10:24:31,815 >\nPutUserPolicy [DEBUG]:query_string: > > AWSAccessKeyId=MXQQXAGFYAI7P5J6R4PB0&A\nction;=PutUserPolicy&PolicyDocument;=%7B%20%22Version%22%3A%222011-04-01%22%2C\n%20%22Statement%22%3A%5B%7B%20%22Sid%22%3A%221%22%2C%20%22Effect%22%3A%22Allow\n%22%2C%20%22Action%22%3A%22ec2%3Aassociateaddress%22%2C%20%22Resource%22%3A%22\narn%3Aaws%3Aec2%3A%3A%3Aaddress%2F192.168.1.1%22%20%7D%5D%7D%0A&PolicyName;=te\nstpolicy&SignatureMethod;=HmacSHA256&SignatureVersion;=2&Timestamp;=2011-06-07\nT17%3A24%3A31Z&UserName;=testuser&Version;=2010-05-08 > Signature:\ng/j3I9RMHaUoSliX6CaErJLug7RPcXXp7LVPKxxrNZU=2011-06-07 > 10:24:31,816 >\nPutUserPolicy [DEBUG]:Params after auth: {'UserName': 'testuser', >\n'PolicyName': > 'testpolicy', 'SignatureVersion': 2, 'AWSAccessKeyId': >\n'MXQQXAGFYAI7P5J6R4PB0', > 'Version': '2010-05-08', 'Timestamp':\n'2011-06-07T17:24:31Z', > 'SignatureMethod': 'HmacSHA256', 'PolicyDocument':\n'{ > \"Version\":\"2011-04-01\", > \"Statement\":[{ \"Sid\":\"1\", \"Effect\":\"Allow\", >\n\"Action\":\"ec2:associateaddress\", >\n\"Resource\":\"arn:aws:ec2:::address/192.168.1.1\" }]}\\n', 'Action': >\n'PutUserPolicy'}send: 'GET > > /services/Euare/?AWSAccessKeyId=MXQQXAGFYAI7P5J\n6R4PB0&Action;=PutUserPolicy&PolicyDocument;=%7B%20%22Version%22%3A%222011-04-\n01%22%2C%20%22Statement%22%3A%5B%7B%20%22Sid%22%3A%221%22%2C%20%22Effect%22%3A\n%22Allow%22%2C%20%22Action%22%3A%22ec2%3Aassociateaddress%22%2C%20%22Resource%\n22%3A%22arn%3Aaws%3Aec2%3A%3A%3Aaddress%2F192.168.1.1%22%20%7D%5D%7D%0A&Policy\nName;=testpolicy&SignatureMethod;=HmacSHA256&SignatureVersion;=2&Timestamp;=20\n11-06-07T17%3A24%3A30Z&UserName;=testuser&Version;=2010-05-08&Signature;=Hmvd2\nm3nJGMDOhEwF%2B/lcsASLKAUzu6k9hBkTIQzIas%3D?AWSAccessKeyId=MXQQXAGFYAI7P5J6R4P\nB0&Action;=PutUserPolicy&PolicyDocument;=%7B%20%22Version%22%3A%222011-04-01%2\n2%2C%20%22Statement%22%3A%5B%7B%20%22Sid%22%3A%221%22%2C%20%22Effect%22%3A%22A\nllow%22%2C%20%22Action%22%3A%22ec2%3Aassociateaddress%22%2C%20%22Resource%22%3\nA%22arn%3Aaws%3Aec2%3A%3A%3Aaddress%2F192.168.1.1%22%20%7D%5D%7D%0A&PolicyName\n;=testpolicy&SignatureMethod;=HmacSHA256&SignatureVersion;=2&Timestamp;=2011-0\n6-07T17%3A24%3A31Z&UserName;=testuser&Version;=2010-05-08&Signature;=g/j3I9RMH\naUoSliX6CaErJLug7RPcXXp7LVPKxxrNZU%3D > HTTP/1.1\\r\\nHost:\n192.168.51.126:8773\\r\\nAccept-Encoding: > identity\\r\\nContent-Length: 0\\r\n\\nUser-Agent: Boto/2.0rc1 > (linux2)\\r\\n\\r\\n'reply: > 'HTTP/1.1 500 Internal\nServer Error\\r\\n'header: Content-Length: 244header: > Content-Type:\napplication/xml; charset=UTF-82011-06-07 10:24:31,887 > PutUserPolicy\n[DEBUG]:received 500 response, retrying in 2 > seconds2011-06-07 >\n10:24:33,887 PutUserPolicy [DEBUG]:Params before auth: {'UserName': >\n'testuser', > 'PolicyName': 'testpolicy', 'SignatureVersion': 2,\n'AWSAccessKeyId': > 'MXQQXAGFYAI7P5J6R4PB0', 'Version': '2010-05-08',\n'Timestamp': > '2011-06-07T17:24:31Z', 'SignatureMethod': 'HmacSHA256',\n'PolicyDocument': > '{ > \"Version\":\"2011-04-01\", \"Statement\":[{ \"Sid\":\"1\",\n\"Effect\":\"Allow\", > \"Action\":\"ec2:associateaddress\",\n\"Resource\":\"arn:aws:ec2:::address/ > 192.168.1.1\" > }]}\\n', 'Action':\n'PutUserPolicy'}2011-06-07 10:24:33,887 PutUserPolicy > [DEBUG]:using\n_calc_signature_22011-06-07 10:24:33,887 PutUserPolicy > [DEBUG]:query string:\n> > AWSAccessKeyId=MXQQXAGFYAI7P5J6R4PB0&Action;=PutUserPolicy&PolicyDocument;\n=%7B%20%22Version%22%3A%222011-04-01%22%2C%20%22Statement%22%3A%5B%7B%20%22Sid\n%22%3A%221%22%2C%20%22Effect%22%3A%22Allow%22%2C%20%22Action%22%3A%22ec2%3Aass\nociateaddress%22%2C%20%22Resource%22%3A%22arn%3Aaws%3Aec2%3A%3A%3Aaddress%2F19\n2.168.1.1%22%20%7D%5D%7D%0A&PolicyName;=testpolicy&SignatureMethod;=HmacSHA256\n&SignatureVersion;=2&Timestamp;=2011-06-07T17%3A24%3A33Z&UserName;=testuser&Ve\nrsion;=2010-05-082011-06-07 > 10:24:33,887 PutUserPolicy\n[DEBUG]:string_to_sign: > GET192.168.51.126:8773/services/Euare/AWSAccessKeyId\n=MXQQXAGFYAI7P5J6R4PB0&Action;=PutUserPolicy&PolicyDocument;=%7B%20%22Version%\n22%3A%222011-04-01%22%2C%20%22Statement%22%3A%5B%7B%20%22Sid%22%3A%221%22%2C%2\n0%22Effect%22%3A%22Allow%22%2C%20%22Action%22%3A%22ec2%3Aassociateaddress%22%2\nC%20%22Resource%22%3A%22arn%3Aaws%3Aec2%3A%3A%3Aaddress%2F192.168.1.1%22%20%7D\n%5D%7D%0A&PolicyName;=testpolicy&SignatureMethod;=HmacSHA256&SignatureVersion;\n=2&Timestamp;=2011-06-07T17%3A24%3A33Z&UserName;=testuser&Version;=2010-05-082\n011-06-07 > 10:24:33,887 PutUserPolicy [DEBUG]:len(b64)=442011-06-07\n10:24:33,887 > PutUserPolicy [DEBUG]:base64 encoded digest: >\nKeUzEQ+9Pke69WrMI3UoBODNHK18ergon1X9Iy5yyG4=2011-06-07 10:24:33,887 >\nPutUserPolicy [DEBUG]:query_string: > > AWSAccessKeyId=MXQQXAGFYAI7P5J6R4PB0&A\nction;=PutUserPolicy&PolicyDocument;=%7B%20%22Version%22%3A%222011-04-01%22%2C\n%20%22Statement%22%3A%5B%7B%20%22Sid%22%3A%221%22%2C%20%22Effect%22%3A%22Allow\n%22%2C%20%22Action%22%3A%22ec2%3Aassociateaddress%22%2C%20%22Resource%22%3A%22\narn%3Aaws%3Aec2%3A%3A%3Aaddress%2F192.168.1.1%22%20%7D%5D%7D%0A&PolicyName;=te\nstpolicy&SignatureMethod;=HmacSHA256&SignatureVersion;=2&Timestamp;=2011-06-07\nT17%3A24%3A33Z&UserName;=testuser&Version;=2010-05-08 > Signature:\nKeUzEQ+9Pke69WrMI3UoBODNHK18ergon1X9Iy5yyG4=2011-06-07 > 10:24:33,888 >\nPutUserPolicy [DEBUG]:Params after auth: {'UserName': 'testuser', >\n'PolicyName': > 'testpolicy', 'SignatureVersion': 2, 'AWSAccessKeyId': >\n'MXQQXAGFYAI7P5J6R4PB0', > 'Version': '2010-05-08', 'Timestamp':\n'2011-06-07T17:24:33Z', > 'SignatureMethod': 'HmacSHA256', 'PolicyDocument':\n'{ > \"Version\":\"2011-04-01\", > \"Statement\":[{ \"Sid\":\"1\", \"Effect\":\"Allow\", >\n\"Action\":\"ec2:associateaddress\", >\n\"Resource\":\"arn:aws:ec2:::address/192.168.1.1\" }]}\\n', 'Action': >\n'PutUserPolicy'}send: 'GET > > /services/Euare/?AWSAccessKeyId=MXQQXAGFYAI7P5J\n6R4PB0&Action;=PutUserPolicy&PolicyDocument;=%7B%20%22Version%22%3A%222011-04-\n01%22%2C%20%22Statement%22%3A%5B%7B%20%22Sid%22%3A%221%22%2C%20%22Effect%22%3A\n%22Allow%22%2C%20%22Action%22%3A%22ec2%3Aassociateaddress%22%2C%20%22Resource%\n22%3A%22arn%3Aaws%3Aec2%3A%3A%3Aaddress%2F192.168.1.1%22%20%7D%5D%7D%0A&Policy\nName;=testpolicy&SignatureMethod;=HmacSHA256&SignatureVersion;=2&Timestamp;=20\n11-06-07T17%3A24%3A30Z&UserName;=testuser&Version;=2010-05-08&Signature;=Hmvd2\nm3nJGMDOhEwF%2B/lcsASLKAUzu6k9hBkTIQzIas%3D?AWSAccessKeyId=MXQQXAGFYAI7P5J6R4P\nB0&Action;=PutUserPolicy&PolicyDocument;=%7B%20%22Version%22%3A%222011-04-01%2\n2%2C%20%22Statement%22%3A%5B%7B%20%22Sid%22%3A%221%22%2C%20%22Effect%22%3A%22A\nllow%22%2C%20%22Action%22%3A%22ec2%3Aassociateaddress%22%2C%20%22Resource%22%3\nA%22arn%3Aaws%3Aec2%3A%3A%3Aaddress%2F192.168.1.1%22%20%7D%5D%7D%0A&PolicyName\n;=testpolicy&SignatureMethod;=HmacSHA256&SignatureVersion;=2&Timestamp;=2011-0\n6-07T17%3A24%3A31Z&UserName;=testuser&Version;=2010-05-08&Signature;=g/j3I9RMH\naUoSliX6CaErJLug7RPcXXp7LVPKxxrNZU%3D?AWSAccessKeyId=MXQQXAGFYAI7P5J6R4PB0&Act\nion;=PutUserPolicy&PolicyDocument;=%7B%20%22Version%22%3A%222011-04-01%22%2C%2\n0%22Statement%22%3A%5B%7B%20%22Sid%22%3A%221%22%2C%20%22Effect%22%3A%22Allow%2\n2%2C%20%22Action%22%3A%22ec2%3Aassociateaddress%22%2C%20%22Resource%22%3A%22ar\nn%3Aaws%3Aec2%3A%3A%3Aaddress%2F192.168.1.1%22%20%7D%5D%7D%0A&PolicyName;=test\npolicy&SignatureMethod;=HmacSHA256&SignatureVersion;=2&Timestamp;=2011-06-07T1\n7%3A24%3A33Z&UserName;=testuser&Version;=2010-05-08&Signature;=KeUzEQ%2B9Pke69\nWrMI3UoBODNHK18ergon1X9Iy5yyG4%3D > HTTP/1.1\\r\\nHost: 192.168.51.126:8773\\r\n\\nAccept-Encoding: > identity\\r\\nContent-Length: 0\\r\\nUser-Agent: Boto/2.0rc1\n> (linux2)\\r\\n\\r\\n'reply: > 'HTTP/1.1 500 Internal Server Error\\r\\n'header:\nContent-Length: 244header: > Content-Type: application/xml; charset=UTF-8 > >\n\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"created":"2012-04-23T16:09:25.609-0500","updated":"2012-04-23T16:09:25.609-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/10830/comment/14084","id":"14084","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"body":"Originally posted on 2011-06-07 17:28:48 by wenye\nThanks Mitch. I was about to do it.  <br><br><div class=\"gmail_quote\">On Tue, Jun 7, 2011 at 10:26 AM, Mitch Garnaat via RT <span dir=\"ltr\"><<a href=\"mailto:bugs@support.eucalyptus.com\">bugs@support.eucalyptus.com</a>></span> wrote:<br>\n\n<blockquote class=\"gmail_quote\" style=\"margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex;\"><div class=\"im\"><br>\n<a href=\"http://support.eucalyptus.com/Ticket/Display.html?id=2458\" target=\"_blank\">http://support.eucalyptus.com/Ticket/Display.html?id=2458</a><br>\nThis is a comment.   It is not sent to the Requestor(s):<br>\n<br>\n</div>  Re-signing each retried request in boto seems to work as expected (see log<br>\nbelow). I just need to do more testing to make sure I haven&#39;t broken anything<br>\nelse:<br>\n<br>\n[root@eucahost-51-126 ~]# euare-useruploadpolicy -u testuser -p testpolicy -f<br>\ntest2.policy --debug2011-06-07 10:24:30,756 PutUserPolicy<br>\n[DEBUG]:request_params: {&#39;UserName&#39;: &#39;testuser&#39;, &#39;PolicyName&#39;: &#39;testpolicy&#39;,<br>\n&#39;PolicyDocument&#39;: &#39;{ \"Version\":\"2011-04-01\", \"Statement\":[{ \"Sid\":\"1\",<br>\n\"Effect\":\"Allow\", \"Action\":\"ec2:associateaddress\",<br>\n\"Resource\":\"arn:aws:ec2:::address/<a href=\"http://192.168.1.1\" target=\"_blank\">192.168.1.1</a>\" }]}\\n&#39;}2011-06-07 10:24:30,757<br>\nPutUserPolicy [DEBUG]:Method: GET2011-06-07 10:24:30,757 PutUserPolicy<br>\n[DEBUG]:Path: /services/Euare/2011-06-07 10:24:30,757 PutUserPolicy<br>\n[DEBUG]:Data: 2011-06-07 10:24:30,757 PutUserPolicy [DEBUG]:Headers: {}2011-06-07<br>\n10:24:30,757 PutUserPolicy [DEBUG]:Host: 192.168.51.126:87732011-06-07<br>\n10:24:30,757 PutUserPolicy [DEBUG]:establishing HTTP connection: kwargs={}2011-06-07<br>\n10:24:30,757 PutUserPolicy [DEBUG]:Params before auth: {&#39;UserName&#39;: &#39;testuser&#39;,<br>\n&#39;PolicyName&#39;: &#39;testpolicy&#39;, &#39;PolicyDocument&#39;: &#39;{ \"Version\":\"2011-04-01\",<br>\n\"Statement\":[{ \"Sid\":\"1\", \"Effect\":\"Allow\", \"Action\":\"ec2:associateaddress\",<br>\n\"Resource\":\"arn:aws:ec2:::address/<a href=\"http://192.168.1.1\" target=\"_blank\">192.168.1.1</a>\" }]}\\n&#39;, &#39;Action&#39;:<br>\n&#39;PutUserPolicy&#39;, &#39;Version&#39;: &#39;2010-05-08&#39;}2011-06-07 10:24:30,758 PutUserPolicy<br>\n[DEBUG]:using _calc_signature_22011-06-07 10:24:30,758 PutUserPolicy<br>\n[DEBUG]:query string:<br>\nAWSAccessKeyId=MXQQXAGFYAI7P5J6R4PB0&Action=PutUserPolicy&PolicyDocument=%7B%20%22Version%22%3A%222011-04-01%22%2C%20%22Statement%22%3A%5B%7B%20%22Sid%22%3A%221%22%2C%20%22Effect%22%3A%22Allow%22%2C%20%22Action%22%3A%22ec2%3Aassociateaddress%22%2C%20%22Resource%22%3A%22arn%3Aaws%3Aec2%3A%3A%3Aaddress%2F192.168.1.1%22%20%7D%5D%7D%0A&PolicyName=testpolicy&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2011-06-07T17%3A24%3A30Z&UserName=testuser&Version=2010-05-082011-06-07<br>\n\n\n10:24:30,759 PutUserPolicy [DEBUG]:string_to_sign: GET192.168.51.126:8773/services/Euare/AWSAccessKeyId=MXQQXAGFYAI7P5J6R4PB0&Action=PutUserPolicy&PolicyDocument=%7B%20%22Version%22%3A%222011-04-01%22%2C%20%22Statement%22%3A%5B%7B%20%22Sid%22%3A%221%22%2C%20%22Effect%22%3A%22Allow%22%2C%20%22Action%22%3A%22ec2%3Aassociateaddress%22%2C%20%22Resource%22%3A%22arn%3Aaws%3Aec2%3A%3A%3Aaddress%2F192.168.1.1%22%20%7D%5D%7D%0A&PolicyName=testpolicy&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2011-06-07T17%3A24%3A30Z&UserName=testuser&Version=2010-05-082011-06-07<br>\n\n\n10:24:30,759 PutUserPolicy [DEBUG]:len(b64)=442011-06-07 10:24:30,759<br>\nPutUserPolicy [DEBUG]:base64 encoded digest:<br>\nHmvd2m3nJGMDOhEwF+/lcsASLKAUzu6k9hBkTIQzIas=2011-06-07 10:24:30,759<br>\nPutUserPolicy [DEBUG]:query_string:<br>\nAWSAccessKeyId=MXQQXAGFYAI7P5J6R4PB0&Action=PutUserPolicy&PolicyDocument=%7B%20%22Version%22%3A%222011-04-01%22%2C%20%22Statement%22%3A%5B%7B%20%22Sid%22%3A%221%22%2C%20%22Effect%22%3A%22Allow%22%2C%20%22Action%22%3A%22ec2%3Aassociateaddress%22%2C%20%22Resource%22%3A%22arn%3Aaws%3Aec2%3A%3A%3Aaddress%2F192.168.1.1%22%20%7D%5D%7D%0A&PolicyName=testpolicy&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2011-06-07T17%3A24%3A30Z&UserName=testuser&Version=2010-05-08<br>\n\n\nSignature: Hmvd2m3nJGMDOhEwF+/lcsASLKAUzu6k9hBkTIQzIas=2011-06-07 10:24:30,759<br>\nPutUserPolicy [DEBUG]:Params after auth: {&#39;UserName&#39;: &#39;testuser&#39;, &#39;PolicyName&#39;:<br>\n&#39;testpolicy&#39;, &#39;SignatureVersion&#39;: 2, &#39;AWSAccessKeyId&#39;: &#39;MXQQXAGFYAI7P5J6R4PB0&#39;,<br>\n&#39;Version&#39;: &#39;2010-05-08&#39;, &#39;Timestamp&#39;: &#39;2011-06-07T17:24:30Z&#39;,<br>\n&#39;SignatureMethod&#39;: &#39;HmacSHA256&#39;, &#39;PolicyDocument&#39;: &#39;{ \"Version\":\"2011-04-01\",<br>\n\"Statement\":[{ \"Sid\":\"1\", \"Effect\":\"Allow\", \"Action\":\"ec2:associateaddress\",<br>\n\"Resource\":\"arn:aws:ec2:::address/<a href=\"http://192.168.1.1\" target=\"_blank\">192.168.1.1</a>\" }]}\\n&#39;, &#39;Action&#39;:<br>\n&#39;PutUserPolicy&#39;}connect: (192.168.51.126, 8773)send: &#39;GET<br>\n/services/Euare/?AWSAccessKeyId=MXQQXAGFYAI7P5J6R4PB0&Action=PutUserPolicy&PolicyDocument=%7B%20%22Version%22%3A%222011-04-01%22%2C%20%22Statement%22%3A%5B%7B%20%22Sid%22%3A%221%22%2C%20%22Effect%22%3A%22Allow%22%2C%20%22Action%22%3A%22ec2%3Aassociateaddress%22%2C%20%22Resource%22%3A%22arn%3Aaws%3Aec2%3A%3A%3Aaddress%2F192.168.1.1%22%20%7D%5D%7D%0A&PolicyName=testpolicy&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2011-06-07T17%3A24%3A30Z&UserName=testuser&Version=2010-05-08&Signature=Hmvd2m3nJGMDOhEwF%2B/lcsASLKAUzu6k9hBkTIQzIas%3D<br>\n\n\nHTTP/1.1\\r\\nHost: <a href=\"http://192.168.51.126:8773\" target=\"_blank\">192.168.51.126:8773</a>\\r\\nAccept-Encoding:<br>\nidentity\\r\\nContent-Length: 0\\r\\nUser-Agent: Boto/2.0rc1 (linux2)\\r\\n\\r\\n&#39;reply:<br>\n&#39;HTTP/1.1 500 Internal Server Error\\r\\n&#39;header: Content-Length: 244header:<br>\nContent-Type: application/xml; charset=UTF-82011-06-07 10:24:30,819<br>\nPutUserPolicy [DEBUG]:received 500 response, retrying in 1 seconds2011-06-07<br>\n10:24:31,814 PutUserPolicy [DEBUG]:Params before auth: {&#39;UserName&#39;: &#39;testuser&#39;,<br>\n&#39;PolicyName&#39;: &#39;testpolicy&#39;, &#39;SignatureVersion&#39;: 2, &#39;AWSAccessKeyId&#39;:<br>\n&#39;MXQQXAGFYAI7P5J6R4PB0&#39;, &#39;Version&#39;: &#39;2010-05-08&#39;, &#39;Timestamp&#39;:<br>\n&#39;2011-06-07T17:24:30Z&#39;, &#39;SignatureMethod&#39;: &#39;HmacSHA256&#39;, &#39;PolicyDocument&#39;: &#39;{<br>\n\"Version\":\"2011-04-01\", \"Statement\":[{ \"Sid\":\"1\", \"Effect\":\"Allow\",<br>\n\"Action\":\"ec2:associateaddress\", \"Resource\":\"arn:aws:ec2:::address/<a href=\"http://192.168.1.1\" target=\"_blank\">192.168.1.1</a>\"<br>\n}]}\\n&#39;, &#39;Action&#39;: &#39;PutUserPolicy&#39;}2011-06-07 10:24:31,815 PutUserPolicy<br>\n[DEBUG]:using _calc_signature_22011-06-07 10:24:31,815 PutUserPolicy<br>\n[DEBUG]:query string:<br>\nAWSAccessKeyId=MXQQXAGFYAI7P5J6R4PB0&Action=PutUserPolicy&PolicyDocument=%7B%20%22Version%22%3A%222011-04-01%22%2C%20%22Statement%22%3A%5B%7B%20%22Sid%22%3A%221%22%2C%20%22Effect%22%3A%22Allow%22%2C%20%22Action%22%3A%22ec2%3Aassociateaddress%22%2C%20%22Resource%22%3A%22arn%3Aaws%3Aec2%3A%3A%3Aaddress%2F192.168.1.1%22%20%7D%5D%7D%0A&PolicyName=testpolicy&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2011-06-07T17%3A24%3A31Z&UserName=testuser&Version=2010-05-082011-06-07<br>\n\n\n10:24:31,815 PutUserPolicy [DEBUG]:string_to_sign: GET192.168.51.126:8773/services/Euare/AWSAccessKeyId=MXQQXAGFYAI7P5J6R4PB0&Action=PutUserPolicy&PolicyDocument=%7B%20%22Version%22%3A%222011-04-01%22%2C%20%22Statement%22%3A%5B%7B%20%22Sid%22%3A%221%22%2C%20%22Effect%22%3A%22Allow%22%2C%20%22Action%22%3A%22ec2%3Aassociateaddress%22%2C%20%22Resource%22%3A%22arn%3Aaws%3Aec2%3A%3A%3Aaddress%2F192.168.1.1%22%20%7D%5D%7D%0A&PolicyName=testpolicy&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2011-06-07T17%3A24%3A31Z&UserName=testuser&Version=2010-05-082011-06-07<br>\n\n\n10:24:31,815 PutUserPolicy [DEBUG]:len(b64)=442011-06-07 10:24:31,815<br>\nPutUserPolicy [DEBUG]:base64 encoded digest:<br>\ng/j3I9RMHaUoSliX6CaErJLug7RPcXXp7LVPKxxrNZU=2011-06-07 10:24:31,815<br>\nPutUserPolicy [DEBUG]:query_string:<br>\nAWSAccessKeyId=MXQQXAGFYAI7P5J6R4PB0&Action=PutUserPolicy&PolicyDocument=%7B%20%22Version%22%3A%222011-04-01%22%2C%20%22Statement%22%3A%5B%7B%20%22Sid%22%3A%221%22%2C%20%22Effect%22%3A%22Allow%22%2C%20%22Action%22%3A%22ec2%3Aassociateaddress%22%2C%20%22Resource%22%3A%22arn%3Aaws%3Aec2%3A%3A%3Aaddress%2F192.168.1.1%22%20%7D%5D%7D%0A&PolicyName=testpolicy&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2011-06-07T17%3A24%3A31Z&UserName=testuser&Version=2010-05-08<br>\n\n\nSignature: g/j3I9RMHaUoSliX6CaErJLug7RPcXXp7LVPKxxrNZU=2011-06-07 10:24:31,816<br>\nPutUserPolicy [DEBUG]:Params after auth: {&#39;UserName&#39;: &#39;testuser&#39;, &#39;PolicyName&#39;:<br>\n&#39;testpolicy&#39;, &#39;SignatureVersion&#39;: 2, &#39;AWSAccessKeyId&#39;: &#39;MXQQXAGFYAI7P5J6R4PB0&#39;,<br>\n&#39;Version&#39;: &#39;2010-05-08&#39;, &#39;Timestamp&#39;: &#39;2011-06-07T17:24:31Z&#39;,<br>\n&#39;SignatureMethod&#39;: &#39;HmacSHA256&#39;, &#39;PolicyDocument&#39;: &#39;{ \"Version\":\"2011-04-01\",<br>\n\"Statement\":[{ \"Sid\":\"1\", \"Effect\":\"Allow\", \"Action\":\"ec2:associateaddress\",<br>\n\"Resource\":\"arn:aws:ec2:::address/<a href=\"http://192.168.1.1\" target=\"_blank\">192.168.1.1</a>\" }]}\\n&#39;, &#39;Action&#39;:<br>\n&#39;PutUserPolicy&#39;}send: &#39;GET<br>\n/services/Euare/?AWSAccessKeyId=MXQQXAGFYAI7P5J6R4PB0&Action=PutUserPolicy&PolicyDocument=%7B%20%22Version%22%3A%222011-04-01%22%2C%20%22Statement%22%3A%5B%7B%20%22Sid%22%3A%221%22%2C%20%22Effect%22%3A%22Allow%22%2C%20%22Action%22%3A%22ec2%3Aassociateaddress%22%2C%20%22Resource%22%3A%22arn%3Aaws%3Aec2%3A%3A%3Aaddress%2F192.168.1.1%22%20%7D%5D%7D%0A&PolicyName=testpolicy&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2011-06-07T17%3A24%3A30Z&UserName=testuser&Version=2010-05-08&Signature=Hmvd2m3nJGMDOhEwF%2B/lcsASLKAUzu6k9hBkTIQzIas%3D?AWSAccessKeyId=MXQQXAGFYAI7P5J6R4PB0&Action=PutUserPolicy&PolicyDocument=%7B%20%22Version%22%3A%222011-04-01%22%2C%20%22Statement%22%3A%5B%7B%20%22Sid%22%3A%221%22%2C%20%22Effect%22%3A%22Allow%22%2C%20%22Action%22%3A%22ec2%3Aassociateaddress%22%2C%20%22Resource%22%3A%22arn%3Aaws%3Aec2%3A%3A%3Aaddress%2F192.168.1.1%22%20%7D%5D%7D%0A&PolicyName=testpolicy&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2011-06-07T17%3A24%3A31Z&UserName=testuser&Version=2010-05-08&Signature=g/j3I9RMHaUoSliX6CaErJLug7RPcXXp7LVPKxxrNZU%3D<br>\n\n\nHTTP/1.1\\r\\nHost: <a href=\"http://192.168.51.126:8773\" target=\"_blank\">192.168.51.126:8773</a>\\r\\nAccept-Encoding:<br>\nidentity\\r\\nContent-Length: 0\\r\\nUser-Agent: Boto/2.0rc1 (linux2)\\r\\n\\r\\n&#39;reply:<br>\n&#39;HTTP/1.1 500 Internal Server Error\\r\\n&#39;header: Content-Length: 244header:<br>\nContent-Type: application/xml; charset=UTF-82011-06-07 10:24:31,887<br>\nPutUserPolicy [DEBUG]:received 500 response, retrying in 2 seconds2011-06-07<br>\n10:24:33,887 PutUserPolicy [DEBUG]:Params before auth: {&#39;UserName&#39;: &#39;testuser&#39;,<br>\n&#39;PolicyName&#39;: &#39;testpolicy&#39;, &#39;SignatureVersion&#39;: 2, &#39;AWSAccessKeyId&#39;:<br>\n&#39;MXQQXAGFYAI7P5J6R4PB0&#39;, &#39;Version&#39;: &#39;2010-05-08&#39;, &#39;Timestamp&#39;:<br>\n&#39;2011-06-07T17:24:31Z&#39;, &#39;SignatureMethod&#39;: &#39;HmacSHA256&#39;, &#39;PolicyDocument&#39;: &#39;{<br>\n\"Version\":\"2011-04-01\", \"Statement\":[{ \"Sid\":\"1\", \"Effect\":\"Allow\",<br>\n\"Action\":\"ec2:associateaddress\", \"Resource\":\"arn:aws:ec2:::address/<a href=\"http://192.168.1.1\" target=\"_blank\">192.168.1.1</a>\"<br>\n}]}\\n&#39;, &#39;Action&#39;: &#39;PutUserPolicy&#39;}2011-06-07 10:24:33,887 PutUserPolicy<br>\n[DEBUG]:using _calc_signature_22011-06-07 10:24:33,887 PutUserPolicy<br>\n[DEBUG]:query string:<br>\nAWSAccessKeyId=MXQQXAGFYAI7P5J6R4PB0&Action=PutUserPolicy&PolicyDocument=%7B%20%22Version%22%3A%222011-04-01%22%2C%20%22Statement%22%3A%5B%7B%20%22Sid%22%3A%221%22%2C%20%22Effect%22%3A%22Allow%22%2C%20%22Action%22%3A%22ec2%3Aassociateaddress%22%2C%20%22Resource%22%3A%22arn%3Aaws%3Aec2%3A%3A%3Aaddress%2F192.168.1.1%22%20%7D%5D%7D%0A&PolicyName=testpolicy&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2011-06-07T17%3A24%3A33Z&UserName=testuser&Version=2010-05-082011-06-07<br>\n\n\n10:24:33,887 PutUserPolicy [DEBUG]:string_to_sign: GET192.168.51.126:8773/services/Euare/AWSAccessKeyId=MXQQXAGFYAI7P5J6R4PB0&Action=PutUserPolicy&PolicyDocument=%7B%20%22Version%22%3A%222011-04-01%22%2C%20%22Statement%22%3A%5B%7B%20%22Sid%22%3A%221%22%2C%20%22Effect%22%3A%22Allow%22%2C%20%22Action%22%3A%22ec2%3Aassociateaddress%22%2C%20%22Resource%22%3A%22arn%3Aaws%3Aec2%3A%3A%3Aaddress%2F192.168.1.1%22%20%7D%5D%7D%0A&PolicyName=testpolicy&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2011-06-07T17%3A24%3A33Z&UserName=testuser&Version=2010-05-082011-06-07<br>\n\n\n10:24:33,887 PutUserPolicy [DEBUG]:len(b64)=442011-06-07 10:24:33,887<br>\nPutUserPolicy [DEBUG]:base64 encoded digest:<br>\nKeUzEQ+9Pke69WrMI3UoBODNHK18ergon1X9Iy5yyG4=2011-06-07 10:24:33,887<br>\nPutUserPolicy [DEBUG]:query_string:<br>\nAWSAccessKeyId=MXQQXAGFYAI7P5J6R4PB0&Action=PutUserPolicy&PolicyDocument=%7B%20%22Version%22%3A%222011-04-01%22%2C%20%22Statement%22%3A%5B%7B%20%22Sid%22%3A%221%22%2C%20%22Effect%22%3A%22Allow%22%2C%20%22Action%22%3A%22ec2%3Aassociateaddress%22%2C%20%22Resource%22%3A%22arn%3Aaws%3Aec2%3A%3A%3Aaddress%2F192.168.1.1%22%20%7D%5D%7D%0A&PolicyName=testpolicy&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2011-06-07T17%3A24%3A33Z&UserName=testuser&Version=2010-05-08<br>\n\n\nSignature: KeUzEQ+9Pke69WrMI3UoBODNHK18ergon1X9Iy5yyG4=2011-06-07 10:24:33,888<br>\nPutUserPolicy [DEBUG]:Params after auth: {&#39;UserName&#39;: &#39;testuser&#39;, &#39;PolicyName&#39;:<br>\n&#39;testpolicy&#39;, &#39;SignatureVersion&#39;: 2, &#39;AWSAccessKeyId&#39;: &#39;MXQQXAGFYAI7P5J6R4PB0&#39;,<br>\n&#39;Version&#39;: &#39;2010-05-08&#39;, &#39;Timestamp&#39;: &#39;2011-06-07T17:24:33Z&#39;,<br>\n&#39;SignatureMethod&#39;: &#39;HmacSHA256&#39;, &#39;PolicyDocument&#39;: &#39;{ \"Version\":\"2011-04-01\",<br>\n\"Statement\":[{ \"Sid\":\"1\", \"Effect\":\"Allow\", \"Action\":\"ec2:associateaddress\",<br>\n\"Resource\":\"arn:aws:ec2:::address/<a href=\"http://192.168.1.1\" target=\"_blank\">192.168.1.1</a>\" }]}\\n&#39;, &#39;Action&#39;:<br>\n&#39;PutUserPolicy&#39;}send: &#39;GET<br>\n/services/Euare/?AWSAccessKeyId=MXQQXAGFYAI7P5J6R4PB0&Action=PutUserPolicy&PolicyDocument=%7B%20%22Version%22%3A%222011-04-01%22%2C%20%22Statement%22%3A%5B%7B%20%22Sid%22%3A%221%22%2C%20%22Effect%22%3A%22Allow%22%2C%20%22Action%22%3A%22ec2%3Aassociateaddress%22%2C%20%22Resource%22%3A%22arn%3Aaws%3Aec2%3A%3A%3Aaddress%2F192.168.1.1%22%20%7D%5D%7D%0A&PolicyName=testpolicy&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2011-06-07T17%3A24%3A30Z&UserName=testuser&Version=2010-05-08&Signature=Hmvd2m3nJGMDOhEwF%2B/lcsASLKAUzu6k9hBkTIQzIas%3D?AWSAccessKeyId=MXQQXAGFYAI7P5J6R4PB0&Action=PutUserPolicy&PolicyDocument=%7B%20%22Version%22%3A%222011-04-01%22%2C%20%22Statement%22%3A%5B%7B%20%22Sid%22%3A%221%22%2C%20%22Effect%22%3A%22Allow%22%2C%20%22Action%22%3A%22ec2%3Aassociateaddress%22%2C%20%22Resource%22%3A%22arn%3Aaws%3Aec2%3A%3A%3Aaddress%2F192.168.1.1%22%20%7D%5D%7D%0A&PolicyName=testpolicy&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2011-06-07T17%3A24%3A31Z&UserName=testuser&Version=2010-05-08&Signature=g/j3I9RMHaUoSliX6CaErJLug7RPcXXp7LVPKxxrNZU%3D?AWSAccessKeyId=MXQQXAGFYAI7P5J6R4PB0&Action=PutUserPolicy&PolicyDocument=%7B%20%22Version%22%3A%222011-04-01%22%2C%20%22Statement%22%3A%5B%7B%20%22Sid%22%3A%221%22%2C%20%22Effect%22%3A%22Allow%22%2C%20%22Action%22%3A%22ec2%3Aassociateaddress%22%2C%20%22Resource%22%3A%22arn%3Aaws%3Aec2%3A%3A%3Aaddress%2F192.168.1.1%22%20%7D%5D%7D%0A&PolicyName=testpolicy&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2011-06-07T17%3A24%3A33Z&UserName=testuser&Version=2010-05-08&Signature=KeUzEQ%2B9Pke69WrMI3UoBODNHK18ergon1X9Iy5yyG4%3D<br>\n\n\nHTTP/1.1\\r\\nHost: <a href=\"http://192.168.51.126:8773\" target=\"_blank\">192.168.51.126:8773</a>\\r\\nAccept-Encoding:<br>\nidentity\\r\\nContent-Length: 0\\r\\nUser-Agent: Boto/2.0rc1 (linux2)\\r\\n\\r\\n&#39;reply:<br>\n&#39;HTTP/1.1 500 Internal Server Error\\r\\n&#39;header: Content-Length: 244header:<br>\nContent-Type: application/xml; charset=UTF-8<br>\n<br>\n</blockquote></div><br>\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"created":"2012-04-23T16:09:26.176-0500","updated":"2012-04-23T16:09:26.176-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/10830/comment/14085","id":"14085","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"body":"Originally posted on 2011-06-07 17:28:49 by wenye\n\n<URL: http://support.eucalyptus.com/Ticket/Display.html?id=2458 >\n\nThanks Mitch. I was about to do it.\n\nOn Tue, Jun 7, 2011 at 10:26 AM, Mitch Garnaat via RT <\nbugs@support.eucalyptus.com> wrote:\n\n>\n> http://support.eucalyptus.com/Ticket/Display.html?id=2458\n> This is a comment.  It is not sent to the Requestor(s):\n>\n>  Re-signing each retried request in boto seems to work as expected (see log\n> below). I just need to do more testing to make sure I haven't broken\n> anything\n> else:\n>\n> [root@eucahost-51-126 ~]# euare-useruploadpolicy -u testuser -p testpolicy\n> -f\n> test2.policy --debug2011-06-07 10:24:30,756 PutUserPolicy\n> [DEBUG]:request_params: {'UserName': 'testuser', 'PolicyName':\n> 'testpolicy',\n> 'PolicyDocument': '{ \"Version\":\"2011-04-01\", \"Statement\":[{ \"Sid\":\"1\",\n> \"Effect\":\"Allow\", \"Action\":\"ec2:associateaddress\",\n> \"Resource\":\"arn:aws:ec2:::address/192.168.1.1\" }]}\\n'}2011-06-07\n> 10:24:30,757\n> PutUserPolicy [DEBUG]:Method: GET2011-06-07 10:24:30,757 PutUserPolicy\n> [DEBUG]:Path: /services/Euare/2011-06-07 10:24:30,757 PutUserPolicy\n> [DEBUG]:Data: 2011-06-07 10:24:30,757 PutUserPolicy [DEBUG]:Headers:\n> {}2011-06-07\n> 10:24:30,757 PutUserPolicy [DEBUG]:Host: 192.168.51.126:87732011-06-07\n> 10:24:30,757 PutUserPolicy [DEBUG]:establishing HTTP connection:\n> kwargs={}2011-06-07\n> 10:24:30,757 PutUserPolicy [DEBUG]:Params before auth: {'UserName':\n> 'testuser',\n> 'PolicyName': 'testpolicy', 'PolicyDocument': '{ \"Version\":\"2011-04-01\",\n> \"Statement\":[{ \"Sid\":\"1\", \"Effect\":\"Allow\",\n> \"Action\":\"ec2:associateaddress\",\n> \"Resource\":\"arn:aws:ec2:::address/192.168.1.1\" }]}\\n', 'Action':\n> 'PutUserPolicy', 'Version': '2010-05-08'}2011-06-07 10:24:30,758\n> PutUserPolicy\n> [DEBUG]:using _calc_signature_22011-06-07 10:24:30,758 PutUserPolicy\n> [DEBUG]:query string:\n>\n> AWSAccessKeyId=MXQQXAGFYAI7P5J6R4PB0&Action=PutUserPolicy&PolicyDocument=%7B%20%22Version%22%3A%222011-04-01%22%2C%20%22Statement%22%3A%5B%7B%20%22Sid%22%3A%221%22%2C%20%22Effect%22%3A%22Allow%22%2C%20%22Action%22%3A%22ec2%3Aassociateaddress%22%2C%20%22Resource%22%3A%22arn%3Aaws%3Aec2%3A%3A%3Aaddress%2F192.168.1.1%22%20%7D%5D%7D%0A&PolicyName=testpolicy&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2011-06-07T17%3A24%3A30Z&UserName=testuser&Version=2010-05-082011-06-07\n> 10:24:30,759 PutUserPolicy [DEBUG]:string_to_sign:\n> GET192.168.51.126:8773/services/Euare/AWSAccessKeyId=MXQQXAGFYAI7P5J6R4PB0&Action=PutUserPolicy&PolicyDocument=%7B%20%22Version%22%3A%222011-04-01%22%2C%20%22Statement%22%3A%5B%7B%20%22Sid%22%3A%221%22%2C%20%22Effect%22%3A%22Allow%22%2C%20%22Action%22%3A%22ec2%3Aassociateaddress%22%2C%20%22Resource%22%3A%22arn%3Aaws%3Aec2%3A%3A%3Aaddress%2F192.168.1.1%22%20%7D%5D%7D%0A&PolicyName=testpolicy&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2011-06-07T17%3A24%3A30Z&UserName=testuser&Version=2010-05-082011-06-07\n> 10:24:30,759 PutUserPolicy [DEBUG]:len(b64)=442011-06-07 10:24:30,759\n> PutUserPolicy [DEBUG]:base64 encoded digest:\n> Hmvd2m3nJGMDOhEwF+/lcsASLKAUzu6k9hBkTIQzIas=2011-06-07 10:24:30,759\n> PutUserPolicy [DEBUG]:query_string:\n>\n> AWSAccessKeyId=MXQQXAGFYAI7P5J6R4PB0&Action=PutUserPolicy&PolicyDocument=%7B%20%22Version%22%3A%222011-04-01%22%2C%20%22Statement%22%3A%5B%7B%20%22Sid%22%3A%221%22%2C%20%22Effect%22%3A%22Allow%22%2C%20%22Action%22%3A%22ec2%3Aassociateaddress%22%2C%20%22Resource%22%3A%22arn%3Aaws%3Aec2%3A%3A%3Aaddress%2F192.168.1.1%22%20%7D%5D%7D%0A&PolicyName=testpolicy&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2011-06-07T17%3A24%3A30Z&UserName=testuser&Version=2010-05-08\n> Signature: Hmvd2m3nJGMDOhEwF+/lcsASLKAUzu6k9hBkTIQzIas=2011-06-07\n> 10:24:30,759\n> PutUserPolicy [DEBUG]:Params after auth: {'UserName': 'testuser',\n> 'PolicyName':\n> 'testpolicy', 'SignatureVersion': 2, 'AWSAccessKeyId':\n> 'MXQQXAGFYAI7P5J6R4PB0',\n> 'Version': '2010-05-08', 'Timestamp': '2011-06-07T17:24:30Z',\n> 'SignatureMethod': 'HmacSHA256', 'PolicyDocument': '{\n> \"Version\":\"2011-04-01\",\n> \"Statement\":[{ \"Sid\":\"1\", \"Effect\":\"Allow\",\n> \"Action\":\"ec2:associateaddress\",\n> \"Resource\":\"arn:aws:ec2:::address/192.168.1.1\" }]}\\n', 'Action':\n> 'PutUserPolicy'}connect: (192.168.51.126, 8773)send: 'GET\n>\n> /services/Euare/?AWSAccessKeyId=MXQQXAGFYAI7P5J6R4PB0&Action=PutUserPolicy&PolicyDocument=%7B%20%22Version%22%3A%222011-04-01%22%2C%20%22Statement%22%3A%5B%7B%20%22Sid%22%3A%221%22%2C%20%22Effect%22%3A%22Allow%22%2C%20%22Action%22%3A%22ec2%3Aassociateaddress%22%2C%20%22Resource%22%3A%22arn%3Aaws%3Aec2%3A%3A%3Aaddress%2F192.168.1.1%22%20%7D%5D%7D%0A&PolicyName=testpolicy&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2011-06-07T17%3A24%3A30Z&UserName=testuser&Version=2010-05-08&Signature=Hmvd2m3nJGMDOhEwF%2B/lcsASLKAUzu6k9hBkTIQzIas%3D\n> HTTP/1.1\\r\\nHost: 192.168.51.126:8773\\r\\nAccept-Encoding:\n> identity\\r\\nContent-Length: 0\\r\\nUser-Agent: Boto/2.0rc1\n> (linux2)\\r\\n\\r\\n'reply:\n> 'HTTP/1.1 500 Internal Server Error\\r\\n'header: Content-Length: 244header:\n> Content-Type: application/xml; charset=UTF-82011-06-07 10:24:30,819\n> PutUserPolicy [DEBUG]:received 500 response, retrying in 1\n> seconds2011-06-07\n> 10:24:31,814 PutUserPolicy [DEBUG]:Params before auth: {'UserName':\n> 'testuser',\n> 'PolicyName': 'testpolicy', 'SignatureVersion': 2, 'AWSAccessKeyId':\n> 'MXQQXAGFYAI7P5J6R4PB0', 'Version': '2010-05-08', 'Timestamp':\n> '2011-06-07T17:24:30Z', 'SignatureMethod': 'HmacSHA256', 'PolicyDocument':\n> '{\n> \"Version\":\"2011-04-01\", \"Statement\":[{ \"Sid\":\"1\", \"Effect\":\"Allow\",\n> \"Action\":\"ec2:associateaddress\", \"Resource\":\"arn:aws:ec2:::address/\n> 192.168.1.1\"\n> }]}\\n', 'Action': 'PutUserPolicy'}2011-06-07 10:24:31,815 PutUserPolicy\n> [DEBUG]:using _calc_signature_22011-06-07 10:24:31,815 PutUserPolicy\n> [DEBUG]:query string:\n>\n> AWSAccessKeyId=MXQQXAGFYAI7P5J6R4PB0&Action=PutUserPolicy&PolicyDocument=%7B%20%22Version%22%3A%222011-04-01%22%2C%20%22Statement%22%3A%5B%7B%20%22Sid%22%3A%221%22%2C%20%22Effect%22%3A%22Allow%22%2C%20%22Action%22%3A%22ec2%3Aassociateaddress%22%2C%20%22Resource%22%3A%22arn%3Aaws%3Aec2%3A%3A%3Aaddress%2F192.168.1.1%22%20%7D%5D%7D%0A&PolicyName=testpolicy&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2011-06-07T17%3A24%3A31Z&UserName=testuser&Version=2010-05-082011-06-07\n> 10:24:31,815 PutUserPolicy [DEBUG]:string_to_sign:\n> GET192.168.51.126:8773/services/Euare/AWSAccessKeyId=MXQQXAGFYAI7P5J6R4PB0&Action=PutUserPolicy&PolicyDocument=%7B%20%22Version%22%3A%222011-04-01%22%2C%20%22Statement%22%3A%5B%7B%20%22Sid%22%3A%221%22%2C%20%22Effect%22%3A%22Allow%22%2C%20%22Action%22%3A%22ec2%3Aassociateaddress%22%2C%20%22Resource%22%3A%22arn%3Aaws%3Aec2%3A%3A%3Aaddress%2F192.168.1.1%22%20%7D%5D%7D%0A&PolicyName=testpolicy&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2011-06-07T17%3A24%3A31Z&UserName=testuser&Version=2010-05-082011-06-07\n> 10:24:31,815 PutUserPolicy [DEBUG]:len(b64)=442011-06-07 10:24:31,815\n> PutUserPolicy [DEBUG]:base64 encoded digest:\n> g/j3I9RMHaUoSliX6CaErJLug7RPcXXp7LVPKxxrNZU=2011-06-07 10:24:31,815\n> PutUserPolicy [DEBUG]:query_string:\n>\n> AWSAccessKeyId=MXQQXAGFYAI7P5J6R4PB0&Action=PutUserPolicy&PolicyDocument=%7B%20%22Version%22%3A%222011-04-01%22%2C%20%22Statement%22%3A%5B%7B%20%22Sid%22%3A%221%22%2C%20%22Effect%22%3A%22Allow%22%2C%20%22Action%22%3A%22ec2%3Aassociateaddress%22%2C%20%22Resource%22%3A%22arn%3Aaws%3Aec2%3A%3A%3Aaddress%2F192.168.1.1%22%20%7D%5D%7D%0A&PolicyName=testpolicy&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2011-06-07T17%3A24%3A31Z&UserName=testuser&Version=2010-05-08\n> Signature: g/j3I9RMHaUoSliX6CaErJLug7RPcXXp7LVPKxxrNZU=2011-06-07\n> 10:24:31,816\n> PutUserPolicy [DEBUG]:Params after auth: {'UserName': 'testuser',\n> 'PolicyName':\n> 'testpolicy', 'SignatureVersion': 2, 'AWSAccessKeyId':\n> 'MXQQXAGFYAI7P5J6R4PB0',\n> 'Version': '2010-05-08', 'Timestamp': '2011-06-07T17:24:31Z',\n> 'SignatureMethod': 'HmacSHA256', 'PolicyDocument': '{\n> \"Version\":\"2011-04-01\",\n> \"Statement\":[{ \"Sid\":\"1\", \"Effect\":\"Allow\",\n> \"Action\":\"ec2:associateaddress\",\n> \"Resource\":\"arn:aws:ec2:::address/192.168.1.1\" }]}\\n', 'Action':\n> 'PutUserPolicy'}send: 'GET\n>\n> /services/Euare/?AWSAccessKeyId=MXQQXAGFYAI7P5J6R4PB0&Action=PutUserPolicy&PolicyDocument=%7B%20%22Version%22%3A%222011-04-01%22%2C%20%22Statement%22%3A%5B%7B%20%22Sid%22%3A%221%22%2C%20%22Effect%22%3A%22Allow%22%2C%20%22Action%22%3A%22ec2%3Aassociateaddress%22%2C%20%22Resource%22%3A%22arn%3Aaws%3Aec2%3A%3A%3Aaddress%2F192.168.1.1%22%20%7D%5D%7D%0A&PolicyName=testpolicy&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2011-06-07T17%3A24%3A30Z&UserName=testuser&Version=2010-05-08&Signature=Hmvd2m3nJGMDOhEwF%2B/lcsASLKAUzu6k9hBkTIQzIas%3D?AWSAccessKeyId=MXQQXAGFYAI7P5J6R4PB0&Action=PutUserPolicy&PolicyDocument=%7B%20%22Version%22%3A%222011-04-01%22%2C%20%22Statement%22%3A%5B%7B%20%22Sid%22%3A%221%22%2C%20%22Effect%22%3A%22Allow%22%2C%20%22Action%22%3A%22ec2%3Aassociateaddress%22%2C%20%22Resource%22%3A%22arn%3Aaws%3Aec2%3A%3A%3Aaddress%2F192.168.1.1%22%20%7D%5D%7D%0A&PolicyName=testpolicy&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2011-06-07T17%3A24%3A31Z&UserName=testuser&Version=2010-05-08&Signature=g/j3I9RMHaUoSliX6CaErJLug7RPcXXp7LVPKxxrNZU%3D\n> HTTP/1.1\\r\\nHost: 192.168.51.126:8773\\r\\nAccept-Encoding:\n> identity\\r\\nContent-Length: 0\\r\\nUser-Agent: Boto/2.0rc1\n> (linux2)\\r\\n\\r\\n'reply:\n> 'HTTP/1.1 500 Internal Server Error\\r\\n'header: Content-Length: 244header:\n> Content-Type: application/xml; charset=UTF-82011-06-07 10:24:31,887\n> PutUserPolicy [DEBUG]:received 500 response, retrying in 2\n> seconds2011-06-07\n> 10:24:33,887 PutUserPolicy [DEBUG]:Params before auth: {'UserName':\n> 'testuser',\n> 'PolicyName': 'testpolicy', 'SignatureVersion': 2, 'AWSAccessKeyId':\n> 'MXQQXAGFYAI7P5J6R4PB0', 'Version': '2010-05-08', 'Timestamp':\n> '2011-06-07T17:24:31Z', 'SignatureMethod': 'HmacSHA256', 'PolicyDocument':\n> '{\n> \"Version\":\"2011-04-01\", \"Statement\":[{ \"Sid\":\"1\", \"Effect\":\"Allow\",\n> \"Action\":\"ec2:associateaddress\", \"Resource\":\"arn:aws:ec2:::address/\n> 192.168.1.1\"\n> }]}\\n', 'Action': 'PutUserPolicy'}2011-06-07 10:24:33,887 PutUserPolicy\n> [DEBUG]:using _calc_signature_22011-06-07 10:24:33,887 PutUserPolicy\n> [DEBUG]:query string:\n>\n> AWSAccessKeyId=MXQQXAGFYAI7P5J6R4PB0&Action=PutUserPolicy&PolicyDocument=%7B%20%22Version%22%3A%222011-04-01%22%2C%20%22Statement%22%3A%5B%7B%20%22Sid%22%3A%221%22%2C%20%22Effect%22%3A%22Allow%22%2C%20%22Action%22%3A%22ec2%3Aassociateaddress%22%2C%20%22Resource%22%3A%22arn%3Aaws%3Aec2%3A%3A%3Aaddress%2F192.168.1.1%22%20%7D%5D%7D%0A&PolicyName=testpolicy&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2011-06-07T17%3A24%3A33Z&UserName=testuser&Version=2010-05-082011-06-07\n> 10:24:33,887 PutUserPolicy [DEBUG]:string_to_sign:\n> GET192.168.51.126:8773/services/Euare/AWSAccessKeyId=MXQQXAGFYAI7P5J6R4PB0&Action=PutUserPolicy&PolicyDocument=%7B%20%22Version%22%3A%222011-04-01%22%2C%20%22Statement%22%3A%5B%7B%20%22Sid%22%3A%221%22%2C%20%22Effect%22%3A%22Allow%22%2C%20%22Action%22%3A%22ec2%3Aassociateaddress%22%2C%20%22Resource%22%3A%22arn%3Aaws%3Aec2%3A%3A%3Aaddress%2F192.168.1.1%22%20%7D%5D%7D%0A&PolicyName=testpolicy&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2011-06-07T17%3A24%3A33Z&UserName=testuser&Version=2010-05-082011-06-07\n> 10:24:33,887 PutUserPolicy [DEBUG]:len(b64)=442011-06-07 10:24:33,887\n> PutUserPolicy [DEBUG]:base64 encoded digest:\n> KeUzEQ+9Pke69WrMI3UoBODNHK18ergon1X9Iy5yyG4=2011-06-07 10:24:33,887\n> PutUserPolicy [DEBUG]:query_string:\n>\n> AWSAccessKeyId=MXQQXAGFYAI7P5J6R4PB0&Action=PutUserPolicy&PolicyDocument=%7B%20%22Version%22%3A%222011-04-01%22%2C%20%22Statement%22%3A%5B%7B%20%22Sid%22%3A%221%22%2C%20%22Effect%22%3A%22Allow%22%2C%20%22Action%22%3A%22ec2%3Aassociateaddress%22%2C%20%22Resource%22%3A%22arn%3Aaws%3Aec2%3A%3A%3Aaddress%2F192.168.1.1%22%20%7D%5D%7D%0A&PolicyName=testpolicy&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2011-06-07T17%3A24%3A33Z&UserName=testuser&Version=2010-05-08\n> Signature: KeUzEQ+9Pke69WrMI3UoBODNHK18ergon1X9Iy5yyG4=2011-06-07\n> 10:24:33,888\n> PutUserPolicy [DEBUG]:Params after auth: {'UserName': 'testuser',\n> 'PolicyName':\n> 'testpolicy', 'SignatureVersion': 2, 'AWSAccessKeyId':\n> 'MXQQXAGFYAI7P5J6R4PB0',\n> 'Version': '2010-05-08', 'Timestamp': '2011-06-07T17:24:33Z',\n> 'SignatureMethod': 'HmacSHA256', 'PolicyDocument': '{\n> \"Version\":\"2011-04-01\",\n> \"Statement\":[{ \"Sid\":\"1\", \"Effect\":\"Allow\",\n> \"Action\":\"ec2:associateaddress\",\n> \"Resource\":\"arn:aws:ec2:::address/192.168.1.1\" }]}\\n', 'Action':\n> 'PutUserPolicy'}send: 'GET\n>\n> /services/Euare/?AWSAccessKeyId=MXQQXAGFYAI7P5J6R4PB0&Action=PutUserPolicy&PolicyDocument=%7B%20%22Version%22%3A%222011-04-01%22%2C%20%22Statement%22%3A%5B%7B%20%22Sid%22%3A%221%22%2C%20%22Effect%22%3A%22Allow%22%2C%20%22Action%22%3A%22ec2%3Aassociateaddress%22%2C%20%22Resource%22%3A%22arn%3Aaws%3Aec2%3A%3A%3Aaddress%2F192.168.1.1%22%20%7D%5D%7D%0A&PolicyName=testpolicy&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2011-06-07T17%3A24%3A30Z&UserName=testuser&Version=2010-05-08&Signature=Hmvd2m3nJGMDOhEwF%2B/lcsASLKAUzu6k9hBkTIQzIas%3D?AWSAccessKeyId=MXQQXAGFYAI7P5J6R4PB0&Action=PutUserPolicy&PolicyDocument=%7B%20%22Version%22%3A%222011-04-01%22%2C%20%22Statement%22%3A%5B%7B%20%22Sid%22%3A%221%22%2C%20%22Effect%22%3A%22Allow%22%2C%20%22Action%22%3A%22ec2%3Aassociateaddress%22%2C%20%22Resource%22%3A%22arn%3Aaws%3Aec2%3A%3A%3Aaddress%2F192.168.1.1%22%20%7D%5D%7D%0A&PolicyName=testpolicy&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2011-06-07T17%3A24%3A31Z&UserName=testuser&Version=2010-05-08&Signature=g/j3I9RMHaUoSliX6CaErJLug7RPcXXp7LVPKxxrNZU%3D?AWSAccessKeyId=MXQQXAGFYAI7P5J6R4PB0&Action=PutUserPolicy&PolicyDocument=%7B%20%22Version%22%3A%222011-04-01%22%2C%20%22Statement%22%3A%5B%7B%20%22Sid%22%3A%221%22%2C%20%22Effect%22%3A%22Allow%22%2C%20%22Action%22%3A%22ec2%3Aassociateaddress%22%2C%20%22Resource%22%3A%22arn%3Aaws%3Aec2%3A%3A%3Aaddress%2F192.168.1.1%22%20%7D%5D%7D%0A&PolicyName=testpolicy&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2011-06-07T17%3A24%3A33Z&UserName=testuser&Version=2010-05-08&Signature=KeUzEQ%2B9Pke69WrMI3UoBODNHK18ergon1X9Iy5yyG4%3D\n> HTTP/1.1\\r\\nHost: 192.168.51.126:8773\\r\\nAccept-Encoding:\n> identity\\r\\nContent-Length: 0\\r\\nUser-Agent: Boto/2.0rc1\n> (linux2)\\r\\n\\r\\n'reply:\n> 'HTTP/1.1 500 Internal Server Error\\r\\n'header: Content-Length: 244header:\n> Content-Type: application/xml; charset=UTF-8\n>\n>\n\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"created":"2012-04-23T16:09:26.744-0500","updated":"2012-04-23T16:09:26.744-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/10830/comment/14086","id":"14086","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"body":"Originally posted on 2011-06-07 17:32:41 by admin\nOn Tue Jun 07 10:27:46 2011, wen.ye wrote:\n\n> I agree we should be careful not to break anything that is dependent\n\n> on\n\n> boto.\n\n>\n\n> But I don't quite get what we are talking here. In my understanding,\n\n> every\n\n> request should be correctly signed with the right timestamp. Whatever\n\n> the\n\n> \"retry\" scheme is, the request should have right timestamp and right\n\n> signature, right? Also, any AWS service implementation should be\n\n> \"retry\"\n\n> agnostic. As long as the request is correctly signed, it should\n\n> authenticate\n\n> the request. So I don't see how resigning every request in boto will\n\n> break\n\n> anything.\n\n>\n\n> As far as other tools, that's a different story. We are breaking them\n\n> even\n\n> now with the current replay attack mechanism if they don't resign\n\n> their\n\n> message for each request.\n\n>\n\n> Let's talk it in the meeting.\n\n>\n\n> On Tue, Jun 7, 2011 at 10:16 AM, Mitch Garnaat via RT <\n\n> bugs@support.eucalyptus.com> wrote:\n\n>\n\n> >\n\n> > <URL: http://support.eucalyptus.com/Ticket/Display.html?id=2458 >\n\n> >\n\n> > On Tue Jun 07 09:27:42 2011, vika.felmetsger wrote:\n\n> > > Mitch and David have a good point and fixing retry in euca2ools\n\n> does\n\n> > > not mean\n\n> > > that we will not have this problem with other tools. While the\n\n> retry\n\n> > > algorithm\n\n> > > cited by David does not seem to state anything about whether\n\n> exactly\n\n> > > the same\n\n> > > message should be retried, client tools might be retrying the\n\n> exactly\n\n> > > the same\n\n> > > message simply because it works with AWS. And the reason it works\n\n> with\n\n> > > AWS, as\n\n> > > far as I understand from my previous discussions with Mitch, is\n\n> that\n\n> > > they do\n\n> > > allow to replay messages until the timestamp expires, which might\n\n> work\n\n> > > for\n\n> > > their deployment model but not for ours.\n\n> > >\n\n> > > I don't know how easy it is to fix it in CLC code to handle\n\n> replays\n\n> > > differently\n\n> > > in case of 500 errors differently --- it's something that Chris\n\n> would\n\n> > > have a\n\n> > > better idea on. One suggestion I have at this point is to try to\n\n> run\n\n> > > the IAM\n\n> > > command corresponding to the problematic euare command while we\n\n> still\n\n> > > have this\n\n> > > bug in eucalyptus that triggers 500 response and see if IAM tools\n\n> also\n\n> > > choke.\n\n> > > This way we will have one extra example of a user tool behavior.\n\n> > >\n\n> > > On Tue Jun 07 07:30:07 2011, david.kavanagh wrote:\n\n> > > > I'm going to back up what Mitch says here. When implementing\n\n> retry\n\n> > > > logic in typica, the algorithm comes from here;\n\n> > > >\n\n> http://aws.amazon.com/articles/1394?_encoding=UTF8&jiveRedirect=1\n\n> > > >\n\n> > > > This became somewhat the gold standard for implementing retries\n\n> for\n\n> > > > AWS when Alesky published it. Lots of people referred to it.\n\n> Now, it\n\n> > > > says \"Submit request\", and it isn't specific about re-signing,\n\n> but\n\n> > > > I've never see resigning occur, though I've only looked at a few\n\n> > > > libraries. I do recommend being tolerant of this on the server\n\n> side.\n\n> > > > If you cache a request that a 5xx error was returned for, mark\n\n> it\n\n> > > > specially, so that if that requests comes again (in a retry, for\n\n> > > some\n\n> > > > number of minutes), it is accepted if the server doesn't have a\n\n> 5xx\n\n> > > > error this time, and the time shift of the request is ignored.\n\n> > > Again,\n\n> > > > there needs to be a time limit (3-5 minutes should be\n\n> sufficient,\n\n> > > but\n\n> > > > I'm not sure even Amazon has that limit, not that I've hit\n\n> anyway).\n\n> > > >\n\n> > > > David\n\n> > > >\n\n> > > > PS. compatibility at the API level is huge. Look at our partner\n\n> and\n\n> > > > tool ecosystem. we must be very careful not to break that.\n\n> > > >\n\n> > > > On Tue, Jun 7, 2011 at 9:27 AM, Mitch Garnaat via RT\n\n> > > > <bugs@support.eucalyptus.com> wrote:\n\n> > > > >\n\n> > > > > http://support.eucalyptus.com/Ticket/Display.html?id=2458\n\n> > > > > This is a comment. It is not sent to the Requestor(s):\n\n> > > > >\n\n> > > > > I've checked in a new version of boto/boto/connection.py that\n\n> will\n\n> > > > re-sign\n\n> > > > > each request prior to retrying. It is checked into our boto\n\n> bzr\n\n> > > repo\n\n> > > > (revno 8)\n\n> > > > > and should get picked up by your tests automatically. If not,\n\n> > > check\n\n> > > > with Kyo on\n\n> > > > > the values in your MEMO field.\n\n> > > > >\n\n> > > > > Let me know if this fixes the issue.\n\n> > > > >\n\n> > > > >\n\n> > > >\n\n> >\n\n> > I'm trying to recreate Ye's original test case on a QA machine and\n\n> see if I\n\n> > can\n\n> > determine if the changes I made in boto will take care of the issue\n\n> or not.\n\n> >\n\n> >\n\n  \nChanging boto to re-sign each request in a retry situation should not break\nanything with AWS, unless of course, I just make a mistake in making the\nchange.  That code is right in the guts of the system and it's complicated.\nHowever, assuming that I do it correctly, boto should be fine with Euca and\nwith AWS.\n\n  \nMy main concern is whether other libraries and clients are using the same\nretry approach as boto and typica did (i.e. NOT re-signing the request on\nretry).  I don't know for sure but if they do, their code will work just fine\nwith AWS and will break against Euca which is not a great situation.\n\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"created":"2012-04-23T16:09:27.312-0500","updated":"2012-04-23T16:09:27.312-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/10830/comment/14087","id":"14087","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"body":"Originally posted on 2011-06-07 17:32:42 by mitch.garnaat@eucalyptus.com\n\n<URL: http://support.eucalyptus.com/Ticket/Display.html?id=2458 >\n\nOn Tue Jun 07 10:27:46 2011, wen.ye wrote:\n> I agree we should be careful not to break anything that is dependent\n> on\n> boto.\n>\n> But I don't quite get what we are talking here. In my understanding,\n> every\n> request should be correctly signed with the right timestamp. Whatever\n> the\n> \"retry\" scheme is, the request should have right timestamp and right\n> signature, right? Also, any AWS service implementation should be\n> \"retry\"\n> agnostic. As long as the request is correctly signed, it should\n> authenticate\n> the request. So I don't see how resigning every request in boto will\n> break\n> anything.\n>\n> As far as other tools, that's a different story. We are breaking them\n> even\n> now with the current replay attack mechanism if they don't resign\n> their\n> message for each request.\n>\n> Let's talk it in the meeting.\n>\n> On Tue, Jun 7, 2011 at 10:16 AM, Mitch Garnaat via RT <\n> bugs@support.eucalyptus.com> wrote:\n>\n> >\n> > <URL: http://support.eucalyptus.com/Ticket/Display.html?id=2458 >\n> >\n> > On Tue Jun 07 09:27:42 2011, vika.felmetsger wrote:\n> > > Mitch and David have a good point and fixing retry in euca2ools\n> does\n> > > not mean\n> > > that we will not have this problem with other tools. While the\n> retry\n> > > algorithm\n> > > cited by David does not seem to state anything about whether\n> exactly\n> > > the same\n> > > message should be retried, client tools might be retrying the\n> exactly\n> > > the same\n> > > message simply because it works with AWS. And the reason it works\n> with\n> > > AWS, as\n> > > far as I understand from my previous discussions with Mitch, is\n> that\n> > > they do\n> > > allow to replay messages until the timestamp expires, which might\n> work\n> > > for\n> > > their deployment model but not for ours.\n> > >\n> > > I don't know how easy it is to fix it in CLC code to handle\n> replays\n> > > differently\n> > > in case of 500 errors differently --- it's something that Chris\n> would\n> > > have a\n> > > better idea on. One suggestion I have at this point is to try to\n> run\n> > > the IAM\n> > > command corresponding to the problematic euare command while we\n> still\n> > > have this\n> > > bug in eucalyptus that triggers 500 response and see if IAM tools\n> also\n> > > choke.\n> > > This way we will have one extra example of a user tool behavior.\n> > >\n> > > On Tue Jun 07 07:30:07 2011, david.kavanagh wrote:\n> > > > I'm going to back up what Mitch says here. When implementing\n> retry\n> > > > logic in typica, the algorithm comes from here;\n> > > >\n> http://aws.amazon.com/articles/1394?_encoding=UTF8&jiveRedirect=1\n> > > >\n> > > > This became somewhat the gold standard for implementing retries\n> for\n> > > > AWS when Alesky published it. Lots of people referred to it.\n> Now, it\n> > > > says \"Submit request\", and it isn't specific about re-signing,\n> but\n> > > > I've never see resigning occur, though I've only looked at a few\n> > > > libraries. I do recommend being tolerant of this on the server\n> side.\n> > > > If you cache a request that a 5xx error was returned for, mark\n> it\n> > > > specially, so that if that requests comes again (in a retry, for\n> > > some\n> > > > number of minutes), it is accepted if the server doesn't have a\n> 5xx\n> > > > error this time, and the time shift of the request is ignored.\n> > > Again,\n> > > > there needs to be a time limit (3-5 minutes should be\n> sufficient,\n> > > but\n> > > > I'm not sure even Amazon has that limit, not that I've hit\n> anyway).\n> > > >\n> > > > David\n> > > >\n> > > > PS. compatibility at the API level is huge. Look at our partner\n> and\n> > > > tool ecosystem. we must be very careful not to break that.\n> > > >\n> > > > On Tue, Jun 7, 2011 at 9:27 AM, Mitch Garnaat via RT\n> > > > <bugs@support.eucalyptus.com> wrote:\n> > > > >\n> > > > > http://support.eucalyptus.com/Ticket/Display.html?id=2458\n> > > > > This is a comment. It is not sent to the Requestor(s):\n> > > > >\n> > > > > I've checked in a new version of boto/boto/connection.py that\n> will\n> > > > re-sign\n> > > > > each request prior to retrying. It is checked into our boto\n> bzr\n> > > repo\n> > > > (revno 8)\n> > > > > and should get picked up by your tests automatically. If not,\n> > > check\n> > > > with Kyo on\n> > > > > the values in your MEMO field.\n> > > > >\n> > > > > Let me know if this fixes the issue.\n> > > > >\n> > > > >\n> > > >\n> >\n> > I'm trying to recreate Ye's original test case on a QA machine and\n> see if I\n> > can\n> > determine if the changes I made in boto will take care of the issue\n> or not.\n> >\n> >\n\nChanging boto to re-sign each request in a retry situation should not break\nanything with AWS, unless of course, I just make a mistake in making the\nchange. That code is right in the guts of the system and it's complicated.\nHowever, assuming that I do it correctly, boto should be fine with Euca and\nwith AWS.\n\nMy main concern is whether other libraries and clients are using the same retry\napproach as boto and typica did (i.e. NOT re-signing the request on retry). I\ndon't know for sure but if they do, their code will work just fine with AWS and\nwill break against Euca which is not a great situation.\n\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"created":"2012-04-23T16:09:27.825-0500","updated":"2012-04-23T16:09:27.825-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/10830/comment/14088","id":"14088","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"body":"Originally posted on 2011-06-07 17:32:42 by mitch.garnaat@eucalyptus.com\nOn Tue Jun 07 10:27:46 2011, wen.ye wrote:\n> I agree we should be careful not to break anything that is dependent\n> on\n> boto.\n>\n> But I don't quite get what we are talking here. In my understanding,\n> every\n> request should be correctly signed with the right timestamp. Whatever\n> the\n> \"retry\" scheme is, the request should have right timestamp and right\n> signature, right? Also, any AWS service implementation should be\n> \"retry\"\n> agnostic. As long as the request is correctly signed, it should\n> authenticate\n> the request. So I don't see how resigning every request in boto will\n> break\n> anything.\n>\n> As far as other tools, that's a different story. We are breaking them\n> even\n> now with the current replay attack mechanism if they don't resign\n> their\n> message for each request.\n>\n> Let's talk it in the meeting.\n>\n> On Tue, Jun 7, 2011 at 10:16 AM, Mitch Garnaat via RT <\n> bugs@support.eucalyptus.com> wrote:\n>\n> >\n> > <URL: http://support.eucalyptus.com/Ticket/Display.html?id=2458 >\n> >\n> > On Tue Jun 07 09:27:42 2011, vika.felmetsger wrote:\n> > > Mitch and David have a good point and fixing retry in euca2ools\n> does\n> > > not mean\n> > > that we will not have this problem with other tools. While the\n> retry\n> > > algorithm\n> > > cited by David does not seem to state anything about whether\n> exactly\n> > > the same\n> > > message should be retried, client tools might be retrying the\n> exactly\n> > > the same\n> > > message simply because it works with AWS. And the reason it works\n> with\n> > > AWS, as\n> > > far as I understand from my previous discussions with Mitch, is\n> that\n> > > they do\n> > > allow to replay messages until the timestamp expires, which might\n> work\n> > > for\n> > > their deployment model but not for ours.\n> > >\n> > > I don't know how easy it is to fix it in CLC code to handle\n> replays\n> > > differently\n> > > in case of 500 errors differently --- it's something that Chris\n> would\n> > > have a\n> > > better idea on. One suggestion I have at this point is to try to\n> run\n> > > the IAM\n> > > command corresponding to the problematic euare command while we\n> still\n> > > have this\n> > > bug in eucalyptus that triggers 500 response and see if IAM tools\n> also\n> > > choke.\n> > > This way we will have one extra example of a user tool behavior.\n> > >\n> > > On Tue Jun 07 07:30:07 2011, david.kavanagh wrote:\n> > > > I'm going to back up what Mitch says here. When implementing\n> retry\n> > > > logic in typica, the algorithm comes from here;\n> > > >\n> http://aws.amazon.com/articles/1394?_encoding=UTF8&jiveRedirect=1\n> > > >\n> > > > This became somewhat the gold standard for implementing retries\n> for\n> > > > AWS when Alesky published it. Lots of people referred to it.\n> Now, it\n> > > > says \"Submit request\", and it isn't specific about re-signing,\n> but\n> > > > I've never see resigning occur, though I've only looked at a few\n> > > > libraries. I do recommend being tolerant of this on the server\n> side.\n> > > > If you cache a request that a 5xx error was returned for, mark\n> it\n> > > > specially, so that if that requests comes again (in a retry, for\n> > > some\n> > > > number of minutes), it is accepted if the server doesn't have a\n> 5xx\n> > > > error this time, and the time shift of the request is ignored.\n> > > Again,\n> > > > there needs to be a time limit (3-5 minutes should be\n> sufficient,\n> > > but\n> > > > I'm not sure even Amazon has that limit, not that I've hit\n> anyway).\n> > > >\n> > > > David\n> > > >\n> > > > PS. compatibility at the API level is huge. Look at our partner\n> and\n> > > > tool ecosystem. we must be very careful not to break that.\n> > > >\n> > > > On Tue, Jun 7, 2011 at 9:27 AM, Mitch Garnaat via RT\n> > > > <bugs@support.eucalyptus.com> wrote:\n> > > > >\n> > > > > http://support.eucalyptus.com/Ticket/Display.html?id=2458\n> > > > > This is a comment. It is not sent to the Requestor(s):\n> > > > >\n> > > > > I've checked in a new version of boto/boto/connection.py that\n> will\n> > > > re-sign\n> > > > > each request prior to retrying. It is checked into our boto\n> bzr\n> > > repo\n> > > > (revno 8)\n> > > > > and should get picked up by your tests automatically. If not,\n> > > check\n> > > > with Kyo on\n> > > > > the values in your MEMO field.\n> > > > >\n> > > > > Let me know if this fixes the issue.\n> > > > >\n> > > > >\n> > > >\n> >\n> > I'm trying to recreate Ye's original test case on a QA machine and\n> see if I\n> > can\n> > determine if the changes I made in boto will take care of the issue\n> or not.\n> >\n> >\n\nChanging boto to re-sign each request in a retry situation should not break\nanything with AWS, unless of course, I just make a mistake in making the\nchange. That code is right in the guts of the system and it's complicated.\nHowever, assuming that I do it correctly, boto should be fine with Euca and\nwith AWS.\n\nMy main concern is whether other libraries and clients are using the same retry\napproach as boto and typica did (i.e. NOT re-signing the request on retry). I\ndon't know for sure but if they do, their code will work just fine with AWS and\nwill break against Euca which is not a great situation.\n\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"created":"2012-04-23T16:09:28.438-0500","updated":"2012-04-23T16:09:28.438-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/10830/comment/14089","id":"14089","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=dkavanagh","name":"dkavanagh","key":"dkavanagh","accountId":"557058:03be2b52-89f7-4c8f-8e00-e2a60a3e7a5e","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/e04f1add3c50bf8a7d1676b60b8ba337?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Ddkavanagh%26avatarId%3D10202%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/e04f1add3c50bf8a7d1676b60b8ba337?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Ddkavanagh%26avatarId%3D10202%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/e04f1add3c50bf8a7d1676b60b8ba337?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Ddkavanagh%26avatarId%3D10202%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/e04f1add3c50bf8a7d1676b60b8ba337?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Ddkavanagh%26avatarId%3D10202%26noRedirect%3Dtrue"},"displayName":"David Kavanagh","active":false,"timeZone":"America/New_York"},"body":"Originally posted on 2011-06-07 17:35:39\nYes, we can always make a given client work for this new server\nchange, but we can't expect all of the clients to be changed.\n\nDavid\n\nOn Tue, Jun 7, 2011 at 1:32 PM, Mitch Garnaat via RT\n<bugs@support.eucalyptus.com> wrote:\n>\n> <URL: http://support.eucalyptus.com/Ticket/Display.html?id=2458 >\n>\n> On Tue Jun 07 10:27:46 2011, wen.ye wrote:\n>> I agree we should be careful not to break anything that is dependent\n>> on\n>> boto.\n>>\n>> But I don't quite get what we are talking here. In my understanding,\n>> every\n>> request should be correctly signed with the right timestamp. Whatever\n>> the\n>> \"retry\" scheme is, the request should have right timestamp and right\n>> signature, right? Also, any AWS service implementation should be\n>> \"retry\"\n>> agnostic. As long as the request is correctly signed, it should\n>> authenticate\n>> the request. So I don't see how resigning every request in boto will\n>> break\n>> anything.\n>>\n>> As far as other tools, that's a different story. We are breaking them\n>> even\n>> now with the current replay attack mechanism if they don't resign\n>> their\n>> message for each request.\n>>\n>> Let's talk it in the meeting.\n>>\n>> On Tue, Jun 7, 2011 at 10:16 AM, Mitch Garnaat via RT <\n>> bugs@support.eucalyptus.com> wrote:\n>>\n>> >\n>> > <URL: http://support.eucalyptus.com/Ticket/Display.html?id=2458 >\n>> >\n>> > On Tue Jun 07 09:27:42 2011, vika.felmetsger wrote:\n>> > > Mitch and David have a good point and fixing retry in euca2ools\n>> does\n>> > > not mean\n>> > > that we will not have this problem with other tools. While the\n>> retry\n>> > > algorithm\n>> > > cited by David does not seem to state anything about whether\n>> exactly\n>> > > the same\n>> > > message should be retried, client tools might be retrying the\n>> exactly\n>> > > the same\n>> > > message simply because it works with AWS. And the reason it works\n>> with\n>> > > AWS, as\n>> > > far as I understand from my previous discussions with Mitch, is\n>> that\n>> > > they do\n>> > > allow to replay messages until the timestamp expires, which might\n>> work\n>> > > for\n>> > > their deployment model but not for ours.\n>> > >\n>> > > I don't know how easy it is to fix it in CLC code to handle\n>> replays\n>> > > differently\n>> > > in case of 500 errors differently --- it's something that Chris\n>> would\n>> > > have a\n>> > > better idea on. One suggestion I have at this point is to try to\n>> run\n>> > > the IAM\n>> > > command corresponding to the problematic euare command while we\n>> still\n>> > > have this\n>> > > bug in eucalyptus that triggers 500 response and see if IAM tools\n>> also\n>> > > choke.\n>> > > This way we will have one extra example of a user tool behavior.\n>> > >\n>> > > On Tue Jun 07 07:30:07 2011, david.kavanagh wrote:\n>> > > > I'm going to back up what Mitch says here. When implementing\n>> retry\n>> > > > logic in typica, the algorithm comes from here;\n>> > > >\n>> http://aws.amazon.com/articles/1394?_encoding=UTF8&jiveRedirect=1\n>> > > >\n>> > > > This became somewhat the gold standard for implementing retries\n>> for\n>> > > > AWS when Alesky published it. Lots of people referred to it.\n>> Now, it\n>> > > > says \"Submit request\", and it isn't specific about re-signing,\n>> but\n>> > > > I've never see resigning occur, though I've only looked at a few\n>> > > > libraries. I do recommend being tolerant of this on the server\n>> side.\n>> > > > If you cache a request that a 5xx error was returned for, mark\n>> it\n>> > > > specially, so that if that requests comes again (in a retry, for\n>> > > some\n>> > > > number of minutes), it is accepted if the server doesn't have a\n>> 5xx\n>> > > > error this time, and the time shift of the request is ignored.\n>> > > Again,\n>> > > > there needs to be a time limit (3-5 minutes should be\n>> sufficient,\n>> > > but\n>> > > > I'm not sure even Amazon has that limit, not that I've hit\n>> anyway).\n>> > > >\n>> > > > David\n>> > > >\n>> > > > PS. compatibility at the API level is huge. Look at our partner\n>> and\n>> > > > tool ecosystem. we must be very careful not to break that.\n>> > > >\n>> > > > On Tue, Jun 7, 2011 at 9:27 AM, Mitch Garnaat via RT\n>> > > > <bugs@support.eucalyptus.com> wrote:\n>> > > > >\n>> > > > > http://support.eucalyptus.com/Ticket/Display.html?id=2458\n>> > > > > This is a comment. It is not sent to the Requestor(s):\n>> > > > >\n>> > > > > I've checked in a new version of boto/boto/connection.py that\n>> will\n>> > > > re-sign\n>> > > > > each request prior to retrying. It is checked into our boto\n>> bzr\n>> > > repo\n>> > > > (revno 8)\n>> > > > > and should get picked up by your tests automatically. If not,\n>> > > check\n>> > > > with Kyo on\n>> > > > > the values in your MEMO field.\n>> > > > >\n>> > > > > Let me know if this fixes the issue.\n>> > > > >\n>> > > > >\n>> > > >\n>> >\n>> > I'm trying to recreate Ye's original test case on a QA machine and\n>> see if I\n>> > can\n>> > determine if the changes I made in boto will take care of the issue\n>> or not.\n>> >\n>> >\n>\n> Changing boto to re-sign each request in a retry situation should not break\n> anything with AWS, unless of course, I just make a mistake in making the\n> change. That code is right in the guts of the system and it's complicated.\n> However, assuming that I do it correctly, boto should be fine with Euca and\n> with AWS.\n>\n> My main concern is whether other libraries and clients are using the same retry\n> approach as boto and typica did (i.e. NOT re-signing the request on retry). I\n> don't know for sure but if they do, their code will work just fine with AWS and\n> will break against Euca which is not a great situation.\n>\n>\n\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=dkavanagh","name":"dkavanagh","key":"dkavanagh","accountId":"557058:03be2b52-89f7-4c8f-8e00-e2a60a3e7a5e","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/e04f1add3c50bf8a7d1676b60b8ba337?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Ddkavanagh%26avatarId%3D10202%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/e04f1add3c50bf8a7d1676b60b8ba337?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Ddkavanagh%26avatarId%3D10202%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/e04f1add3c50bf8a7d1676b60b8ba337?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Ddkavanagh%26avatarId%3D10202%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/e04f1add3c50bf8a7d1676b60b8ba337?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Ddkavanagh%26avatarId%3D10202%26noRedirect%3Dtrue"},"displayName":"David Kavanagh","active":false,"timeZone":"America/New_York"},"created":"2012-04-23T16:09:28.980-0500","updated":"2012-04-23T16:09:28.980-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/10830/comment/14090","id":"14090","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=dkavanagh","name":"dkavanagh","key":"dkavanagh","accountId":"557058:03be2b52-89f7-4c8f-8e00-e2a60a3e7a5e","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/e04f1add3c50bf8a7d1676b60b8ba337?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Ddkavanagh%26avatarId%3D10202%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/e04f1add3c50bf8a7d1676b60b8ba337?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Ddkavanagh%26avatarId%3D10202%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/e04f1add3c50bf8a7d1676b60b8ba337?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Ddkavanagh%26avatarId%3D10202%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/e04f1add3c50bf8a7d1676b60b8ba337?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Ddkavanagh%26avatarId%3D10202%26noRedirect%3Dtrue"},"displayName":"David Kavanagh","active":false,"timeZone":"America/New_York"},"body":"Originally posted on 2011-06-07 17:35:39\n\n<URL: http://support.eucalyptus.com/Ticket/Display.html?id=2458 >\n\nYes, we can always make a given client work for this new server\nchange, but we can't expect all of the clients to be changed.\n\nDavid\n\nOn Tue, Jun 7, 2011 at 1:32 PM, Mitch Garnaat via RT\n<bugs@support.eucalyptus.com> wrote:\n>\n> <URL: http://support.eucalyptus.com/Ticket/Display.html?id=2458 >\n>\n> On Tue Jun 07 10:27:46 2011, wen.ye wrote:\n>> I agree we should be careful not to break anything that is dependent\n>> on\n>> boto.\n>>\n>> But I don't quite get what we are talking here. In my understanding,\n>> every\n>> request should be correctly signed with the right timestamp. Whatever\n>> the\n>> \"retry\" scheme is, the request should have right timestamp and right\n>> signature, right? Also, any AWS service implementation should be\n>> \"retry\"\n>> agnostic. As long as the request is correctly signed, it should\n>> authenticate\n>> the request. So I don't see how resigning every request in boto will\n>> break\n>> anything.\n>>\n>> As far as other tools, that's a different story. We are breaking them\n>> even\n>> now with the current replay attack mechanism if they don't resign\n>> their\n>> message for each request.\n>>\n>> Let's talk it in the meeting.\n>>\n>> On Tue, Jun 7, 2011 at 10:16 AM, Mitch Garnaat via RT <\n>> bugs@support.eucalyptus.com> wrote:\n>>\n>> >\n>> > <URL: http://support.eucalyptus.com/Ticket/Display.html?id=2458 >\n>> >\n>> > On Tue Jun 07 09:27:42 2011, vika.felmetsger wrote:\n>> > > Mitch and David have a good point and fixing retry in euca2ools\n>> does\n>> > > not mean\n>> > > that we will not have this problem with other tools. While the\n>> retry\n>> > > algorithm\n>> > > cited by David does not seem to state anything about whether\n>> exactly\n>> > > the same\n>> > > message should be retried, client tools might be retrying the\n>> exactly\n>> > > the same\n>> > > message simply because it works with AWS. And the reason it works\n>> with\n>> > > AWS, as\n>> > > far as I understand from my previous discussions with Mitch, is\n>> that\n>> > > they do\n>> > > allow to replay messages until the timestamp expires, which might\n>> work\n>> > > for\n>> > > their deployment model but not for ours.\n>> > >\n>> > > I don't know how easy it is to fix it in CLC code to handle\n>> replays\n>> > > differently\n>> > > in case of 500 errors differently --- it's something that Chris\n>> would\n>> > > have a\n>> > > better idea on. One suggestion I have at this point is to try to\n>> run\n>> > > the IAM\n>> > > command corresponding to the problematic euare command while we\n>> still\n>> > > have this\n>> > > bug in eucalyptus that triggers 500 response and see if IAM tools\n>> also\n>> > > choke.\n>> > > This way we will have one extra example of a user tool behavior.\n>> > >\n>> > > On Tue Jun 07 07:30:07 2011, david.kavanagh wrote:\n>> > > > I'm going to back up what Mitch says here. When implementing\n>> retry\n>> > > > logic in typica, the algorithm comes from here;\n>> > > >\n>> http://aws.amazon.com/articles/1394?_encoding=UTF8&jiveRedirect=1\n>> > > >\n>> > > > This became somewhat the gold standard for implementing retries\n>> for\n>> > > > AWS when Alesky published it. Lots of people referred to it.\n>> Now, it\n>> > > > says \"Submit request\", and it isn't specific about re-signing,\n>> but\n>> > > > I've never see resigning occur, though I've only looked at a few\n>> > > > libraries. I do recommend being tolerant of this on the server\n>> side.\n>> > > > If you cache a request that a 5xx error was returned for, mark\n>> it\n>> > > > specially, so that if that requests comes again (in a retry, for\n>> > > some\n>> > > > number of minutes), it is accepted if the server doesn't have a\n>> 5xx\n>> > > > error this time, and the time shift of the request is ignored.\n>> > > Again,\n>> > > > there needs to be a time limit (3-5 minutes should be\n>> sufficient,\n>> > > but\n>> > > > I'm not sure even Amazon has that limit, not that I've hit\n>> anyway).\n>> > > >\n>> > > > David\n>> > > >\n>> > > > PS. compatibility at the API level is huge. Look at our partner\n>> and\n>> > > > tool ecosystem. we must be very careful not to break that.\n>> > > >\n>> > > > On Tue, Jun 7, 2011 at 9:27 AM, Mitch Garnaat via RT\n>> > > > <bugs@support.eucalyptus.com> wrote:\n>> > > > >\n>> > > > > http://support.eucalyptus.com/Ticket/Display.html?id=2458\n>> > > > > This is a comment. It is not sent to the Requestor(s):\n>> > > > >\n>> > > > > I've checked in a new version of boto/boto/connection.py that\n>> will\n>> > > > re-sign\n>> > > > > each request prior to retrying. It is checked into our boto\n>> bzr\n>> > > repo\n>> > > > (revno 8)\n>> > > > > and should get picked up by your tests automatically. If not,\n>> > > check\n>> > > > with Kyo on\n>> > > > > the values in your MEMO field.\n>> > > > >\n>> > > > > Let me know if this fixes the issue.\n>> > > > >\n>> > > > >\n>> > > >\n>> >\n>> > I'm trying to recreate Ye's original test case on a QA machine and\n>> see if I\n>> > can\n>> > determine if the changes I made in boto will take care of the issue\n>> or not.\n>> >\n>> >\n>\n> Changing boto to re-sign each request in a retry situation should not break\n> anything with AWS, unless of course, I just make a mistake in making the\n> change. That code is right in the guts of the system and it's complicated.\n> However, assuming that I do it correctly, boto should be fine with Euca and\n> with AWS.\n>\n> My main concern is whether other libraries and clients are using the same retry\n> approach as boto and typica did (i.e. NOT re-signing the request on retry). I\n> don't know for sure but if they do, their code will work just fine with AWS and\n> will break against Euca which is not a great situation.\n>\n>\n\n\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=dkavanagh","name":"dkavanagh","key":"dkavanagh","accountId":"557058:03be2b52-89f7-4c8f-8e00-e2a60a3e7a5e","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/e04f1add3c50bf8a7d1676b60b8ba337?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Ddkavanagh%26avatarId%3D10202%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/e04f1add3c50bf8a7d1676b60b8ba337?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Ddkavanagh%26avatarId%3D10202%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/e04f1add3c50bf8a7d1676b60b8ba337?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Ddkavanagh%26avatarId%3D10202%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/e04f1add3c50bf8a7d1676b60b8ba337?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Ddkavanagh%26avatarId%3D10202%26noRedirect%3Dtrue"},"displayName":"David Kavanagh","active":false,"timeZone":"America/New_York"},"created":"2012-04-23T16:09:29.590-0500","updated":"2012-04-23T16:09:29.590-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/10830/comment/14091","id":"14091","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=dkavanagh","name":"dkavanagh","key":"dkavanagh","accountId":"557058:03be2b52-89f7-4c8f-8e00-e2a60a3e7a5e","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/e04f1add3c50bf8a7d1676b60b8ba337?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Ddkavanagh%26avatarId%3D10202%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/e04f1add3c50bf8a7d1676b60b8ba337?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Ddkavanagh%26avatarId%3D10202%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/e04f1add3c50bf8a7d1676b60b8ba337?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Ddkavanagh%26avatarId%3D10202%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/e04f1add3c50bf8a7d1676b60b8ba337?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Ddkavanagh%26avatarId%3D10202%26noRedirect%3Dtrue"},"displayName":"David Kavanagh","active":false,"timeZone":"America/New_York"},"body":"Originally posted on 2011-06-07 17:35:39\nYes, we can always make a given client work for this new server\nchange, but we can't expect all of the clients to be changed.\n\nDavid\n\nOn Tue, Jun 7, 2011 at 1:32 PM, Mitch Garnaat via RT\n<bugs@support.eucalyptus.com> wrote:\n>\n> <URL: http://support.eucalyptus.com/Ticket/Display.html?id=2458 >\n>\n> On Tue Jun 07 10:27:46 2011, wen.ye wrote:\n>> I agree we should be careful not to break anything that is dependent\n>> on\n>> boto.\n>>\n>> But I don't quite get what we are talking here. In my understanding,\n>> every\n>> request should be correctly signed with the right timestamp. Whatever\n>> the\n>> \"retry\" scheme is, the request should have right timestamp and right\n>> signature, right? Also, any AWS service implementation should be\n>> \"retry\"\n>> agnostic. As long as the request is correctly signed, it should\n>> authenticate\n>> the request. So I don't see how resigning every request in boto will\n>> break\n>> anything.\n>>\n>> As far as other tools, that's a different story. We are breaking them\n>> even\n>> now with the current replay attack mechanism if they don't resign\n>> their\n>> message for each request.\n>>\n>> Let's talk it in the meeting.\n>>\n>> On Tue, Jun 7, 2011 at 10:16 AM, Mitch Garnaat via RT <\n>> bugs@support.eucalyptus.com> wrote:\n>>\n>> >\n>> > <URL: http://support.eucalyptus.com/Ticket/Display.html?id=2458 >\n>> >\n>> > On Tue Jun 07 09:27:42 2011, vika.felmetsger wrote:\n>> > > Mitch and David have a good point and fixing retry in euca2ools\n>> does\n>> > > not mean\n>> > > that we will not have this problem with other tools. While the\n>> retry\n>> > > algorithm\n>> > > cited by David does not seem to state anything about whether\n>> exactly\n>> > > the same\n>> > > message should be retried, client tools might be retrying the\n>> exactly\n>> > > the same\n>> > > message simply because it works with AWS. And the reason it works\n>> with\n>> > > AWS, as\n>> > > far as I understand from my previous discussions with Mitch, is\n>> that\n>> > > they do\n>> > > allow to replay messages until the timestamp expires, which might\n>> work\n>> > > for\n>> > > their deployment model but not for ours.\n>> > >\n>> > > I don't know how easy it is to fix it in CLC code to handle\n>> replays\n>> > > differently\n>> > > in case of 500 errors differently --- it's something that Chris\n>> would\n>> > > have a\n>> > > better idea on. One suggestion I have at this point is to try to\n>> run\n>> > > the IAM\n>> > > command corresponding to the problematic euare command while we\n>> still\n>> > > have this\n>> > > bug in eucalyptus that triggers 500 response and see if IAM tools\n>> also\n>> > > choke.\n>> > > This way we will have one extra example of a user tool behavior.\n>> > >\n>> > > On Tue Jun 07 07:30:07 2011, david.kavanagh wrote:\n>> > > > I'm going to back up what Mitch says here. When implementing\n>> retry\n>> > > > logic in typica, the algorithm comes from here;\n>> > > >\n>> http://aws.amazon.com/articles/1394?_encoding=UTF8&jiveRedirect=1\n>> > > >\n>> > > > This became somewhat the gold standard for implementing retries\n>> for\n>> > > > AWS when Alesky published it. Lots of people referred to it.\n>> Now, it\n>> > > > says \"Submit request\", and it isn't specific about re-signing,\n>> but\n>> > > > I've never see resigning occur, though I've only looked at a few\n>> > > > libraries. I do recommend being tolerant of this on the server\n>> side.\n>> > > > If you cache a request that a 5xx error was returned for, mark\n>> it\n>> > > > specially, so that if that requests comes again (in a retry, for\n>> > > some\n>> > > > number of minutes), it is accepted if the server doesn't have a\n>> 5xx\n>> > > > error this time, and the time shift of the request is ignored.\n>> > > Again,\n>> > > > there needs to be a time limit (3-5 minutes should be\n>> sufficient,\n>> > > but\n>> > > > I'm not sure even Amazon has that limit, not that I've hit\n>> anyway).\n>> > > >\n>> > > > David\n>> > > >\n>> > > > PS. compatibility at the API level is huge. Look at our partner\n>> and\n>> > > > tool ecosystem. we must be very careful not to break that.\n>> > > >\n>> > > > On Tue, Jun 7, 2011 at 9:27 AM, Mitch Garnaat via RT\n>> > > > <bugs@support.eucalyptus.com> wrote:\n>> > > > >\n>> > > > > http://support.eucalyptus.com/Ticket/Display.html?id=2458\n>> > > > > This is a comment. It is not sent to the Requestor(s):\n>> > > > >\n>> > > > > I've checked in a new version of boto/boto/connection.py that\n>> will\n>> > > > re-sign\n>> > > > > each request prior to retrying. It is checked into our boto\n>> bzr\n>> > > repo\n>> > > > (revno 8)\n>> > > > > and should get picked up by your tests automatically. If not,\n>> > > check\n>> > > > with Kyo on\n>> > > > > the values in your MEMO field.\n>> > > > >\n>> > > > > Let me know if this fixes the issue.\n>> > > > >\n>> > > > >\n>> > > >\n>> >\n>> > I'm trying to recreate Ye's original test case on a QA machine and\n>> see if I\n>> > can\n>> > determine if the changes I made in boto will take care of the issue\n>> or not.\n>> >\n>> >\n>\n> Changing boto to re-sign each request in a retry situation should not break\n> anything with AWS, unless of course, I just make a mistake in making the\n> change. That code is right in the guts of the system and it's complicated.\n> However, assuming that I do it correctly, boto should be fine with Euca and\n> with AWS.\n>\n> My main concern is whether other libraries and clients are using the same retry\n> approach as boto and typica did (i.e. NOT re-signing the request on retry). I\n> don't know for sure but if they do, their code will work just fine with AWS and\n> will break against Euca which is not a great situation.\n>\n>\n\n\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=dkavanagh","name":"dkavanagh","key":"dkavanagh","accountId":"557058:03be2b52-89f7-4c8f-8e00-e2a60a3e7a5e","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/e04f1add3c50bf8a7d1676b60b8ba337?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Ddkavanagh%26avatarId%3D10202%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/e04f1add3c50bf8a7d1676b60b8ba337?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Ddkavanagh%26avatarId%3D10202%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/e04f1add3c50bf8a7d1676b60b8ba337?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Ddkavanagh%26avatarId%3D10202%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/e04f1add3c50bf8a7d1676b60b8ba337?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Ddkavanagh%26avatarId%3D10202%26noRedirect%3Dtrue"},"displayName":"David Kavanagh","active":false,"timeZone":"America/New_York"},"created":"2012-04-23T16:09:30.152-0500","updated":"2012-04-23T16:09:30.152-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/10830/comment/14092","id":"14092","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"body":"Originally posted on 2011-06-07 17:41:13 by wenye\nI understand. But that's a separate issue concerning the replay attack\ndetection itself. Anyway, we will discuss this in the meeting.\n\nOn Tue, Jun 7, 2011 at 10:35 AM, David Kavanagh via RT <\nbugs@support.eucalyptus.com> wrote:\n\n> Yes, we can always make a given client work for this new server\n> change, but we can't expect all of the clients to be changed.\n>\n> David\n>\n> On Tue, Jun 7, 2011 at 1:32 PM, Mitch Garnaat via RT\n> <bugs@support.eucalyptus.com> wrote:\n> >\n> > <URL: http://support.eucalyptus.com/Ticket/Display.html?id=2458 >\n> >\n> > On Tue Jun 07 10:27:46 2011, wen.ye wrote:\n> >> I agree we should be careful not to break anything that is dependent\n> >> on\n> >> boto.\n> >>\n> >> But I don't quite get what we are talking here. In my understanding,\n> >> every\n> >> request should be correctly signed with the right timestamp. Whatever\n> >> the\n> >> \"retry\" scheme is, the request should have right timestamp and right\n> >> signature, right? Also, any AWS service implementation should be\n> >> \"retry\"\n> >> agnostic. As long as the request is correctly signed, it should\n> >> authenticate\n> >> the request. So I don't see how resigning every request in boto will\n> >> break\n> >> anything.\n> >>\n> >> As far as other tools, that's a different story. We are breaking them\n> >> even\n> >> now with the current replay attack mechanism if they don't resign\n> >> their\n> >> message for each request.\n> >>\n> >> Let's talk it in the meeting.\n> >>\n> >> On Tue, Jun 7, 2011 at 10:16 AM, Mitch Garnaat via RT <\n> >> bugs@support.eucalyptus.com> wrote:\n> >>\n> >> >\n> >> > <URL: http://support.eucalyptus.com/Ticket/Display.html?id=2458 >\n> >> >\n> >> > On Tue Jun 07 09:27:42 2011, vika.felmetsger wrote:\n> >> > > Mitch and David have a good point and fixing retry in euca2ools\n> >> does\n> >> > > not mean\n> >> > > that we will not have this problem with other tools. While the\n> >> retry\n> >> > > algorithm\n> >> > > cited by David does not seem to state anything about whether\n> >> exactly\n> >> > > the same\n> >> > > message should be retried, client tools might be retrying the\n> >> exactly\n> >> > > the same\n> >> > > message simply because it works with AWS. And the reason it works\n> >> with\n> >> > > AWS, as\n> >> > > far as I understand from my previous discussions with Mitch, is\n> >> that\n> >> > > they do\n> >> > > allow to replay messages until the timestamp expires, which might\n> >> work\n> >> > > for\n> >> > > their deployment model but not for ours.\n> >> > >\n> >> > > I don't know how easy it is to fix it in CLC code to handle\n> >> replays\n> >> > > differently\n> >> > > in case of 500 errors differently --- it's something that Chris\n> >> would\n> >> > > have a\n> >> > > better idea on. One suggestion I have at this point is to try to\n> >> run\n> >> > > the IAM\n> >> > > command corresponding to the problematic euare command while we\n> >> still\n> >> > > have this\n> >> > > bug in eucalyptus that triggers 500 response and see if IAM tools\n> >> also\n> >> > > choke.\n> >> > > This way we will have one extra example of a user tool behavior.\n> >> > >\n> >> > > On Tue Jun 07 07:30:07 2011, david.kavanagh wrote:\n> >> > > > I'm going to back up what Mitch says here. When implementing\n> >> retry\n> >> > > > logic in typica, the algorithm comes from here;\n> >> > > >\n> >> http://aws.amazon.com/articles/1394?_encoding=UTF8&jiveRedirect=1\n> >> > > >\n> >> > > > This became somewhat the gold standard for implementing retries\n> >> for\n> >> > > > AWS when Alesky published it. Lots of people referred to it.\n> >> Now, it\n> >> > > > says \"Submit request\", and it isn't specific about re-signing,\n> >> but\n> >> > > > I've never see resigning occur, though I've only looked at a few\n> >> > > > libraries. I do recommend being tolerant of this on the server\n> >> side.\n> >> > > > If you cache a request that a 5xx error was returned for, mark\n> >> it\n> >> > > > specially, so that if that requests comes again (in a retry, for\n> >> > > some\n> >> > > > number of minutes), it is accepted if the server doesn't have a\n> >> 5xx\n> >> > > > error this time, and the time shift of the request is ignored.\n> >> > > Again,\n> >> > > > there needs to be a time limit (3-5 minutes should be\n> >> sufficient,\n> >> > > but\n> >> > > > I'm not sure even Amazon has that limit, not that I've hit\n> >> anyway).\n> >> > > >\n> >> > > > David\n> >> > > >\n> >> > > > PS. compatibility at the API level is huge. Look at our partner\n> >> and\n> >> > > > tool ecosystem. we must be very careful not to break that.\n> >> > > >\n> >> > > > On Tue, Jun 7, 2011 at 9:27 AM, Mitch Garnaat via RT\n> >> > > > <bugs@support.eucalyptus.com> wrote:\n> >> > > > >\n> >> > > > > http://support.eucalyptus.com/Ticket/Display.html?id=2458\n> >> > > > > This is a comment. It is not sent to the Requestor(s):\n> >> > > > >\n> >> > > > > I've checked in a new version of boto/boto/connection.py that\n> >> will\n> >> > > > re-sign\n> >> > > > > each request prior to retrying. It is checked into our boto\n> >> bzr\n> >> > > repo\n> >> > > > (revno 8)\n> >> > > > > and should get picked up by your tests automatically. If not,\n> >> > > check\n> >> > > > with Kyo on\n> >> > > > > the values in your MEMO field.\n> >> > > > >\n> >> > > > > Let me know if this fixes the issue.\n> >> > > > >\n> >> > > > >\n> >> > > >\n> >> >\n> >> > I'm trying to recreate Ye's original test case on a QA machine and\n> >> see if I\n> >> > can\n> >> > determine if the changes I made in boto will take care of the issue\n> >> or not.\n> >> >\n> >> >\n> >\n> > Changing boto to re-sign each request in a retry situation should not\n> break\n> > anything with AWS, unless of course, I just make a mistake in making the\n> > change. That code is right in the guts of the system and it's\n> complicated.\n> > However, assuming that I do it correctly, boto should be fine with Euca\n> and\n> > with AWS.\n> >\n> > My main concern is whether other libraries and clients are using the same\n> retry\n> > approach as boto and typica did (i.e. NOT re-signing the request on\n> retry). I\n> > don't know for sure but if they do, their code will work just fine with\n> AWS and\n> > will break against Euca which is not a great situation.\n> >\n> >\n>\n>\n>\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"created":"2012-04-23T16:09:30.725-0500","updated":"2012-04-23T16:09:30.725-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/10830/comment/14093","id":"14093","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"body":"Originally posted on 2011-06-07 17:41:13 by wenye\nI understand. But that's a separate issue concerning the replay attack\ndetection itself. Anyway, we will discuss this in the meeting.\n\n  \n\nOn Tue, Jun 7, 2011 at 10:35 AM, David Kavanagh via RT\n<[bugs@support.eucalyptus.com](mailto:bugs@support.eucalyptus.com)> wrote:\n\n> Yes, we can always make a given client work for this new server\n\nchange, but we can't expect all of the clients to be changed.\n\n  \nDavid\n\n  \nOn Tue, Jun 7, 2011 at 1:32 PM, Mitch Garnaat via RT\n\n>\n\n> <[bugs@support.eucalyptus.com](mailto:bugs@support.eucalyptus.com)> wrote:\n\n>\n\n> <URL: [http://support.eucalyptus.com/Ticket/Display.html?id=2458](http://sup\nport.eucalyptus.com/Ticket/Display.html?id=2458) >\n\n>\n\n> On Tue Jun 07 10:27:46 2011, [wen.ye](http://wen.ye) wrote:\n\n>> I agree we should be careful not to break anything that is dependent\n\n>> on\n\n>> boto.\n\n>>\n\n>> But I don't quite get what we are talking here. In my understanding,\n\n>> every\n\n>> request should be correctly signed with the right timestamp. Whatever\n\n>> the\n\n>> \"retry\" scheme is, the request should have right timestamp and right\n\n>> signature, right? Also, any AWS service implementation should be\n\n>> \"retry\"\n\n>> agnostic. As long as the request is correctly signed, it should\n\n>> authenticate\n\n>> the request. So I don't see how resigning every request in boto will\n\n>> break\n\n>> anything.\n\n>>\n\n>> As far as other tools, that's a different story. We are breaking them\n\n>> even\n\n>> now with the current replay attack mechanism if they don't resign\n\n>> their\n\n>> message for each request.\n\n>>\n\n>> Let's talk it in the meeting.\n\n>>\n\n>> On Tue, Jun 7, 2011 at 10:16 AM, Mitch Garnaat via RT <\n\n>> [bugs@support.eucalyptus.com](mailto:bugs@support.eucalyptus.com)> wrote:\n\n>>\n\n>> >\n\n>> > <URL: [http://support.eucalyptus.com/Ticket/Display.html?id=2458](http://\nsupport.eucalyptus.com/Ticket/Display.html?id=2458) >\n\n>> >\n\n>> > On Tue Jun 07 09:27:42 2011, vika.felmetsger wrote:\n\n>> > > Mitch and David have a good point and fixing retry in euca2ools\n\n>> does\n\n>> > > not mean\n\n>> > > that we will not have this problem with other tools. While the\n\n>> retry\n\n>> > > algorithm\n\n>> > > cited by David does not seem to state anything about whether\n\n>> exactly\n\n>> > > the same\n\n>> > > message should be retried, client tools might be retrying the\n\n>> exactly\n\n>> > > the same\n\n>> > > message simply because it works with AWS. And the reason it works\n\n>> with\n\n>> > > AWS, as\n\n>> > > far as I understand from my previous discussions with Mitch, is\n\n>> that\n\n>> > > they do\n\n>> > > allow to replay messages until the timestamp expires, which might\n\n>> work\n\n>> > > for\n\n>> > > their deployment model but not for ours.\n\n>> > >\n\n>> > > I don't know how easy it is to fix it in CLC code to handle\n\n>> replays\n\n>> > > differently\n\n>> > > in case of 500 errors differently --- it's something that Chris\n\n>> would\n\n>> > > have a\n\n>> > > better idea on. One suggestion I have at this point is to try to\n\n>> run\n\n>> > > the IAM\n\n>> > > command corresponding to the problematic euare command while we\n\n>> still\n\n>> > > have this\n\n>> > > bug in eucalyptus that triggers 500 response and see if IAM tools\n\n>> also\n\n>> > > choke.\n\n>> > > This way we will have one extra example of a user tool behavior.\n\n>> > >\n\n>> > > On Tue Jun 07 07:30:07 2011, david.kavanagh wrote:\n\n>> > > > I'm going to back up what Mitch says here. When implementing\n\n>> retry\n\n>> > > > logic in typica, the algorithm comes from here;\n\n>> > > >\n\n>> [http://aws.amazon.com/articles/1394?_encoding=UTF8&jiveRedirect=1](http://\naws.amazon.com/articles/1394?_encoding=UTF8&jiveRedirect=1)\n\n>> > > >\n\n>> > > > This became somewhat the gold standard for implementing retries\n\n>> for\n\n>> > > > AWS when Alesky published it. Lots of people referred to it.\n\n>> Now, it\n\n>> > > > says \"Submit request\", and it isn't specific about re-signing,\n\n>> but\n\n>> > > > I've never see resigning occur, though I've only looked at a few\n\n>> > > > libraries. I do recommend being tolerant of this on the server\n\n>> side.\n\n>> > > > If you cache a request that a 5xx error was returned for, mark\n\n>> it\n\n>> > > > specially, so that if that requests comes again (in a retry, for\n\n>> > > some\n\n>> > > > number of minutes), it is accepted if the server doesn't have a\n\n>> 5xx\n\n>> > > > error this time, and the time shift of the request is ignored.\n\n>> > > Again,\n\n>> > > > there needs to be a time limit (3-5 minutes should be\n\n>> sufficient,\n\n>> > > but\n\n>> > > > I'm not sure even Amazon has that limit, not that I've hit\n\n>> anyway).\n\n>> > > >\n\n>> > > > David\n\n>> > > >\n\n>> > > > PS. compatibility at the API level is huge. Look at our partner\n\n>> and\n\n>> > > > tool ecosystem. we must be very careful not to break that.\n\n>> > > >\n\n>> > > > On Tue, Jun 7, 2011 at 9:27 AM, Mitch Garnaat via RT\n\n>> > > > <[bugs@support.eucalyptus.com](mailto:bugs@support.eucalyptus.com)>\nwrote:\n\n>> > > > >\n\n>> > > > > [http://support.eucalyptus.com/Ticket/Display.html?id=2458](http://\nsupport.eucalyptus.com/Ticket/Display.html?id=2458)\n\n>> > > > > This is a comment. It is not sent to the Requestor(s):\n\n>> > > > >\n\n>> > > > > I've checked in a new version of boto/boto/connection.py that\n\n>> will\n\n>> > > > re-sign\n\n>> > > > > each request prior to retrying. It is checked into our boto\n\n>> bzr\n\n>> > > repo\n\n>> > > > (revno 8)\n\n>> > > > > and should get picked up by your tests automatically. If not,\n\n>> > > check\n\n>> > > > with Kyo on\n\n>> > > > > the values in your MEMO field.\n\n>> > > > >\n\n>> > > > > Let me know if this fixes the issue.\n\n>> > > > >\n\n>> > > > >\n\n>> > > >\n\n>> >\n\n>> > I'm trying to recreate Ye's original test case on a QA machine and\n\n>> see if I\n\n>> > can\n\n>> > determine if the changes I made in boto will take care of the issue\n\n>> or not.\n\n>> >\n\n>> >\n\n>\n\n> Changing boto to re-sign each request in a retry situation should not break\n\n> anything with AWS, unless of course, I just make a mistake in making the\n\n> change. That code is right in the guts of the system and it's complicated.\n\n> However, assuming that I do it correctly, boto should be fine with Euca and\n\n> with AWS.\n\n>\n\n> My main concern is whether other libraries and clients are using the same\nretry\n\n> approach as boto and typica did (i.e. NOT re-signing the request on retry).\nI\n\n> don't know for sure but if they do, their code will work just fine with AWS\nand\n\n> will break against Euca which is not a great situation.\n\n>\n\n>\n\n  \n  \n\n  \n\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"created":"2012-04-23T16:09:31.324-0500","updated":"2012-04-23T16:09:31.324-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/10830/comment/14094","id":"14094","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"body":"Originally posted on 2011-06-07 17:41:14 by wenye\n\n<URL: http://support.eucalyptus.com/Ticket/Display.html?id=2458 >\n\nI understand. But that's a separate issue concerning the replay attack\ndetection itself. Anyway, we will discuss this in the meeting.\n\nOn Tue, Jun 7, 2011 at 10:35 AM, David Kavanagh via RT <\nbugs@support.eucalyptus.com> wrote:\n\n> Yes, we can always make a given client work for this new server\n> change, but we can't expect all of the clients to be changed.\n>\n> David\n>\n> On Tue, Jun 7, 2011 at 1:32 PM, Mitch Garnaat via RT\n> <bugs@support.eucalyptus.com> wrote:\n> >\n> > <URL: http://support.eucalyptus.com/Ticket/Display.html?id=2458 >\n> >\n> > On Tue Jun 07 10:27:46 2011, wen.ye wrote:\n> >> I agree we should be careful not to break anything that is dependent\n> >> on\n> >> boto.\n> >>\n> >> But I don't quite get what we are talking here. In my understanding,\n> >> every\n> >> request should be correctly signed with the right timestamp. Whatever\n> >> the\n> >> \"retry\" scheme is, the request should have right timestamp and right\n> >> signature, right? Also, any AWS service implementation should be\n> >> \"retry\"\n> >> agnostic. As long as the request is correctly signed, it should\n> >> authenticate\n> >> the request. So I don't see how resigning every request in boto will\n> >> break\n> >> anything.\n> >>\n> >> As far as other tools, that's a different story. We are breaking them\n> >> even\n> >> now with the current replay attack mechanism if they don't resign\n> >> their\n> >> message for each request.\n> >>\n> >> Let's talk it in the meeting.\n> >>\n> >> On Tue, Jun 7, 2011 at 10:16 AM, Mitch Garnaat via RT <\n> >> bugs@support.eucalyptus.com> wrote:\n> >>\n> >> >\n> >> > <URL: http://support.eucalyptus.com/Ticket/Display.html?id=2458 >\n> >> >\n> >> > On Tue Jun 07 09:27:42 2011, vika.felmetsger wrote:\n> >> > > Mitch and David have a good point and fixing retry in euca2ools\n> >> does\n> >> > > not mean\n> >> > > that we will not have this problem with other tools. While the\n> >> retry\n> >> > > algorithm\n> >> > > cited by David does not seem to state anything about whether\n> >> exactly\n> >> > > the same\n> >> > > message should be retried, client tools might be retrying the\n> >> exactly\n> >> > > the same\n> >> > > message simply because it works with AWS. And the reason it works\n> >> with\n> >> > > AWS, as\n> >> > > far as I understand from my previous discussions with Mitch, is\n> >> that\n> >> > > they do\n> >> > > allow to replay messages until the timestamp expires, which might\n> >> work\n> >> > > for\n> >> > > their deployment model but not for ours.\n> >> > >\n> >> > > I don't know how easy it is to fix it in CLC code to handle\n> >> replays\n> >> > > differently\n> >> > > in case of 500 errors differently --- it's something that Chris\n> >> would\n> >> > > have a\n> >> > > better idea on. One suggestion I have at this point is to try to\n> >> run\n> >> > > the IAM\n> >> > > command corresponding to the problematic euare command while we\n> >> still\n> >> > > have this\n> >> > > bug in eucalyptus that triggers 500 response and see if IAM tools\n> >> also\n> >> > > choke.\n> >> > > This way we will have one extra example of a user tool behavior.\n> >> > >\n> >> > > On Tue Jun 07 07:30:07 2011, david.kavanagh wrote:\n> >> > > > I'm going to back up what Mitch says here. When implementing\n> >> retry\n> >> > > > logic in typica, the algorithm comes from here;\n> >> > > >\n> >> http://aws.amazon.com/articles/1394?_encoding=UTF8&jiveRedirect=1\n> >> > > >\n> >> > > > This became somewhat the gold standard for implementing retries\n> >> for\n> >> > > > AWS when Alesky published it. Lots of people referred to it.\n> >> Now, it\n> >> > > > says \"Submit request\", and it isn't specific about re-signing,\n> >> but\n> >> > > > I've never see resigning occur, though I've only looked at a few\n> >> > > > libraries. I do recommend being tolerant of this on the server\n> >> side.\n> >> > > > If you cache a request that a 5xx error was returned for, mark\n> >> it\n> >> > > > specially, so that if that requests comes again (in a retry, for\n> >> > > some\n> >> > > > number of minutes), it is accepted if the server doesn't have a\n> >> 5xx\n> >> > > > error this time, and the time shift of the request is ignored.\n> >> > > Again,\n> >> > > > there needs to be a time limit (3-5 minutes should be\n> >> sufficient,\n> >> > > but\n> >> > > > I'm not sure even Amazon has that limit, not that I've hit\n> >> anyway).\n> >> > > >\n> >> > > > David\n> >> > > >\n> >> > > > PS. compatibility at the API level is huge. Look at our partner\n> >> and\n> >> > > > tool ecosystem. we must be very careful not to break that.\n> >> > > >\n> >> > > > On Tue, Jun 7, 2011 at 9:27 AM, Mitch Garnaat via RT\n> >> > > > <bugs@support.eucalyptus.com> wrote:\n> >> > > > >\n> >> > > > > http://support.eucalyptus.com/Ticket/Display.html?id=2458\n> >> > > > > This is a comment. It is not sent to the Requestor(s):\n> >> > > > >\n> >> > > > > I've checked in a new version of boto/boto/connection.py that\n> >> will\n> >> > > > re-sign\n> >> > > > > each request prior to retrying. It is checked into our boto\n> >> bzr\n> >> > > repo\n> >> > > > (revno 8)\n> >> > > > > and should get picked up by your tests automatically. If not,\n> >> > > check\n> >> > > > with Kyo on\n> >> > > > > the values in your MEMO field.\n> >> > > > >\n> >> > > > > Let me know if this fixes the issue.\n> >> > > > >\n> >> > > > >\n> >> > > >\n> >> >\n> >> > I'm trying to recreate Ye's original test case on a QA machine and\n> >> see if I\n> >> > can\n> >> > determine if the changes I made in boto will take care of the issue\n> >> or not.\n> >> >\n> >> >\n> >\n> > Changing boto to re-sign each request in a retry situation should not\n> break\n> > anything with AWS, unless of course, I just make a mistake in making the\n> > change. That code is right in the guts of the system and it's\n> complicated.\n> > However, assuming that I do it correctly, boto should be fine with Euca\n> and\n> > with AWS.\n> >\n> > My main concern is whether other libraries and clients are using the same\n> retry\n> > approach as boto and typica did (i.e. NOT re-signing the request on\n> retry). I\n> > don't know for sure but if they do, their code will work just fine with\n> AWS and\n> > will break against Euca which is not a great situation.\n> >\n> >\n>\n>\n>\n\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"created":"2012-04-23T16:09:31.865-0500","updated":"2012-04-23T16:09:31.865-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/10830/comment/14095","id":"14095","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"body":"Originally posted on 2011-06-13 18:08:46 by tjcramer\n\nMon Jun 13 11:08:46 2011: Request 2458 was acted upon.\n Transaction: Given to mitch.garnaat by tim.cramer\n       Queue: Engineering Bugs\n     Subject: euca2ools retry in conflict with replay attack prevention\n       Owner: mitch.garnaat\n  Requestors: wenye@eucalyptus.com\n      Status: open\n Ticket <URL: http://support.eucalyptus.com/Ticket/Display.html?id=2458 >\n\n\nThis transaction appears to have no content\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"created":"2012-04-23T16:09:32.567-0500","updated":"2012-04-23T16:09:32.567-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/10830/comment/14096","id":"14096","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"body":"Originally posted on 2011-07-07 18:17:24 by admin\nboto now re-signs each re-tried request.\n\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"created":"2012-04-23T16:09:33.165-0500","updated":"2012-04-23T16:09:33.165-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/10830/comment/14097","id":"14097","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"body":"Originally posted on 2011-07-07 18:17:25 by admin\nhttp://support.eucalyptus.com/Ticket/Display.html?id=2458 This is a comment.\nIt is not sent to the Requestor(s): boto now re-signs each re-tried request.\n\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"created":"2012-04-23T16:09:33.783-0500","updated":"2012-04-23T16:09:33.783-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/10830/comment/14098","id":"14098","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"body":"Originally posted on 2011-07-07 18:17:25 by mitch.garnaat@eucalyptus.com\nAccording to our records, your request has been resolved. If you have any\nfurther questions or concerns, please respond to this message.\n\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=agrimm","name":"agrimm","key":"agrimm","accountId":"557058:9ebc3512-73d8-45c9-85de-4325aaa62488","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/0e947b5413f5d57fba29a8ea5412f773?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26ownerId%3Dagrimm%26avatarId%3D10500%26noRedirect%3Dtrue"},"displayName":"Andy Grimm","active":false,"timeZone":"America/New_York"},"created":"2012-04-23T16:09:34.492-0500","updated":"2012-04-23T16:09:34.492-0500"}],"maxResults":77,"total":77,"startAt":0},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_11808":null}}
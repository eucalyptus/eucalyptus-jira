{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"49211","self":"https://eucalyptus.atlassian.net/rest/api/2/issue/49211","key":"DOC-1984","fields":{"issuetype":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issuetype/4","id":"4","description":"An improvement or enhancement to an existing feature or task.","iconUrl":"https://eucalyptus.atlassian.net/secure/viewavatar?size=xsmall&avatarId=14810&avatarType=issuetype","name":"Improvement","subtask":false,"avatarId":14810},"timespent":null,"customfield_13100":null,"project":{"self":"https://eucalyptus.atlassian.net/rest/api/2/project/10006","id":"10006","key":"DOC","name":"Documentation","avatarUrls":{"48x48":"https://eucalyptus.atlassian.net/secure/projectavatar?pid=10006&avatarId=10011","24x24":"https://eucalyptus.atlassian.net/secure/projectavatar?size=small&pid=10006&avatarId=10011","16x16":"https://eucalyptus.atlassian.net/secure/projectavatar?size=xsmall&pid=10006&avatarId=10011","32x32":"https://eucalyptus.atlassian.net/secure/projectavatar?size=medium&pid=10006&avatarId=10011"}},"customfield_11000":null,"fixVersions":[],"customfield_11001":null,"aggregatetimespent":null,"customfield_10310":null,"resolution":null,"customfield_11401":null,"customfield_11400":null,"customfield_10104":[],"customfield_10303":null,"customfield_10105":null,"customfield_10700":null,"customfield_10304":null,"customfield_10701":null,"customfield_10306":null,"customfield_10702":null,"customfield_10703":null,"customfield_10704":null,"resolutiondate":null,"customfield_10308":null,"customfield_10705":null,"customfield_10309":null,"workratio":-1,"watches":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/DOC-1984/watchers","watchCount":4,"isWatching":false},"lastViewed":null,"created":"2016-10-04T19:09:44.368-0500","customfield_12000":null,"customfield_12400":null,"priority":{"self":"https://eucalyptus.atlassian.net/rest/api/2/priority/3","iconUrl":"https://eucalyptus.atlassian.net/images/icons/priorities/major.svg","name":"Major","id":"3"},"customfield_12201":null,"customfield_10102":null,"customfield_12600":"{}","labels":[],"customfield_11700":null,"customfield_11900":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"versions":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/version/17202","id":"17202","description":"Eucalyptus 4.3.0","name":"4.3.0","archived":false,"released":false}],"customfield_11901":null,"issuelinks":[],"assignee":null,"updated":"2017-03-15T19:29:15.860-0500","status":{"self":"https://eucalyptus.atlassian.net/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://eucalyptus.atlassian.net/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://eucalyptus.atlassian.net/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"components":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/component/10203","id":"10203","name":"Installation Guide"}],"timeoriginalestimate":null,"description":"Currently the [Understanding VPC and Midonet|https://docs.hpcloud.com/eucalyptus/4.3.0/#install-guide/preparing_vpc_midonet.html] documentation states\r\n{quote}The use of \"localhost\" network on the node running CLC/eucanetd is sufficient and recommended in Eucalyptus deployments{quote}\r\n\r\nHowever there are several benefits and use cases when you might want to separate them out:\r\n* Avoids complexity of running multiple web services which lead to port conflicts (example of nginx and tomcat mentioned in [DOC-1896])\r\n* Ability to update MidoNet components independent of Eucalyptus software upgrades, including the underlying OS, minimizing maintenance downtime\r\n* Allows for greater expansion by putting multiple API frontends behind a load balancer for scalability in large-scale enterprise deployments\r\n\r\nAccording to the MidoNet documentation, both the API and CLI can be installed on a separate host.\r\n\r\nCurrently the eucanetd process looks for the api uri base in {{/usr/share/midonet-api/WEB-INF/web.xml}} desribed in [EUCA-12805]. For now you can simply modify the {{rest_api-base_uri}} parameter and restart eucanetd until this is made into a variable.\r\n\r\nInitial testing has shown that running midonet-api on a separate host has no impact to performance and in some cases a slight performance improvement, most likely due to the fact that the CLC has many processes running on it and isolating it to a separate host only running tomcat makes it faster.","customfield_13000":null,"customfield_13200":null,"customfield_11300":"DOC-1854","customfield_11500":null,"timetracking":{},"customfield_10401":null,"customfield_10005":null,"customfield_10600":null,"customfield_12900":null,"aggregatetimeestimate":null,"attachment":[],"summary":"Ability to run midonet-api on separate server from CLC","creator":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=jgallucci32","name":"jgallucci32","key":"jgallucci32","accountId":"557058:1cd98ee4-b2ee-4683-a315-2a6abd75b048","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/31cfdf964a6ac26962c22f3279e2c85c?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FavatarId%3D10122%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/31cfdf964a6ac26962c22f3279e2c85c?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26avatarId%3D10122%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/31cfdf964a6ac26962c22f3279e2c85c?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26avatarId%3D10122%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/31cfdf964a6ac26962c22f3279e2c85c?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26avatarId%3D10122%26noRedirect%3Dtrue"},"displayName":"John Gallucci","active":true,"timeZone":"America/Los_Angeles"},"subtasks":[],"reporter":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=jgallucci32","name":"jgallucci32","key":"jgallucci32","accountId":"557058:1cd98ee4-b2ee-4683-a315-2a6abd75b048","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/31cfdf964a6ac26962c22f3279e2c85c?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FavatarId%3D10122%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/31cfdf964a6ac26962c22f3279e2c85c?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26avatarId%3D10122%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/31cfdf964a6ac26962c22f3279e2c85c?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26avatarId%3D10122%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/31cfdf964a6ac26962c22f3279e2c85c?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26avatarId%3D10122%26noRedirect%3Dtrue"},"displayName":"John Gallucci","active":true,"timeZone":"America/Los_Angeles"},"customfield_10000":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12100":"0|i03xxr:","customfield_10001":"2017-02-14T22:06:52.263-0600","customfield_10002":null,"customfield_10200":null,"customfield_10003":null,"customfield_10400":null,"customfield_12500":null,"customfield_11600":["jgallucci32(jgallucci32)","kmeredith(kmeredith)"],"customfield_10116":null,"customfield_10117":null,"environment":null,"customfield_11800":null,"customfield_11802":null,"duedate":null,"customfield_11805":null,"progress":{"progress":0,"total":0},"customfield_11806":null,"votes":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/DOC-1984/votes","votes":0,"hasVoted":false},"comment":{"comments":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/49211/comment/111190","id":"111190","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=jgallucci32","name":"jgallucci32","key":"jgallucci32","accountId":"557058:1cd98ee4-b2ee-4683-a315-2a6abd75b048","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/31cfdf964a6ac26962c22f3279e2c85c?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FavatarId%3D10122%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/31cfdf964a6ac26962c22f3279e2c85c?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26avatarId%3D10122%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/31cfdf964a6ac26962c22f3279e2c85c?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26avatarId%3D10122%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/31cfdf964a6ac26962c22f3279e2c85c?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26avatarId%3D10122%26noRedirect%3Dtrue"},"displayName":"John Gallucci","active":true,"timeZone":"America/Los_Angeles"},"body":"I need to add a correction to the description on how eucanetd gets the uri base. Currently it does *not* get the value directly from the web.xml file. Rather it is hard-coded to look for {{http://localhost:8080/midonet-api}}. When it contacts the URL, if the IP address is listed differently in the web.xml file, eucanetd uses the URI with the IP address listed, rather than localhost.\r\n\r\nAs a workaround, I had to configure HAProxy on the CLC with a frontend on {{localhost:8080}} and a backend of {{<midonet-api>:8080}}. I chose HAProxy as it is a required package for midolman which is installed on the CLC. This works as well as having the variable configured as a cloud property, but with a little more complexity.\r\n\r\nHere is my example {{haproxy.cfg}} configuration (MidoNet API is on 10.10.10.10:\r\n{code}\r\n#Configuration for MidoNet API\r\nfrontend localhost-8080\r\n    bind localhost:8080\r\n    default_backend midonet-api-8080\r\n\r\nbackend midonet-api-8080\r\n    server midonet-api-server 10.10.10.10:8080 check\r\n{code}\r\n\r\nHere is a sample output from {{eucanetd.log}}\r\n{noformat}\r\n2016-10-05 14:14:41  INFO | eucanetd started\r\n2016-10-05 14:14:41  INFO | eucanetd: starting pre-flight checks\r\n2016-10-05 14:14:41  INFO |     configuring eucanetd in VPCMIDO mode\r\n2016-10-05 14:14:41  INFO |     eucanetd valid service peer (CLC) detected\r\n2016-10-05 14:14:41  INFO | Loading 'VPCMIDO' mode driver.\r\n2016-10-05 14:14:41  INFO | Initializing 'VPCMIDO' network driver.\r\n2016-10-05 14:14:41  INFO |\r\nmido API v1.9 at http://10.10.10.10:8080/midonet-api\r\n{noformat}","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=jgallucci32","name":"jgallucci32","key":"jgallucci32","accountId":"557058:1cd98ee4-b2ee-4683-a315-2a6abd75b048","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/31cfdf964a6ac26962c22f3279e2c85c?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FavatarId%3D10122%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/31cfdf964a6ac26962c22f3279e2c85c?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26avatarId%3D10122%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/31cfdf964a6ac26962c22f3279e2c85c?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26avatarId%3D10122%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/31cfdf964a6ac26962c22f3279e2c85c?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26avatarId%3D10122%26noRedirect%3Dtrue"},"displayName":"John Gallucci","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-10-05T16:16:26.028-0500","updated":"2016-10-05T16:16:26.028-0500"},{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/49211/comment/119121","id":"119121","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=kmeredith","name":"kmeredith","key":"kmeredith","accountId":"557058:ad01e29f-e62e-4f95-b458-a96ea25c65e5","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/8962f6c2075b2cf80ed6daccff85c8a7?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FavatarId%3D10100%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/8962f6c2075b2cf80ed6daccff85c8a7?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26avatarId%3D10100%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/8962f6c2075b2cf80ed6daccff85c8a7?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26avatarId%3D10100%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/8962f6c2075b2cf80ed6daccff85c8a7?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26avatarId%3D10100%26noRedirect%3Dtrue"},"displayName":"Keri Meredith","active":true,"timeZone":"America/Los_Angeles"},"body":"The 4.4 docs now say:\r\n{quote}For security reasons, the MidoNet REST API is accessed only on the CLC (localhost interface).{quote}\r\nhttps://docs.eucalyptus.com/eucalyptus/latest/#install-guide/install_midokura_installation.html\r\n","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=kmeredith","name":"kmeredith","key":"kmeredith","accountId":"557058:ad01e29f-e62e-4f95-b458-a96ea25c65e5","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/8962f6c2075b2cf80ed6daccff85c8a7?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FavatarId%3D10100%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/8962f6c2075b2cf80ed6daccff85c8a7?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26avatarId%3D10100%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/8962f6c2075b2cf80ed6daccff85c8a7?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26avatarId%3D10100%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/8962f6c2075b2cf80ed6daccff85c8a7?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26avatarId%3D10100%26noRedirect%3Dtrue"},"displayName":"Keri Meredith","active":true,"timeZone":"America/Los_Angeles"},"created":"2017-03-15T19:29:15.860-0500","updated":"2017-03-15T19:29:15.860-0500"}],"maxResults":2,"total":2,"startAt":0},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_11808":null}}
{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"38042","self":"https://eucalyptus.atlassian.net/rest/api/2/issue/38042","key":"DOC-1663","fields":{"issuetype":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://eucalyptus.atlassian.net/secure/viewavatar?size=xsmall&avatarId=14803&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":14803},"timespent":null,"customfield_13100":null,"project":{"self":"https://eucalyptus.atlassian.net/rest/api/2/project/10006","id":"10006","key":"DOC","name":"Documentation","avatarUrls":{"48x48":"https://eucalyptus.atlassian.net/secure/projectavatar?pid=10006&avatarId=10011","24x24":"https://eucalyptus.atlassian.net/secure/projectavatar?size=small&pid=10006&avatarId=10011","16x16":"https://eucalyptus.atlassian.net/secure/projectavatar?size=xsmall&pid=10006&avatarId=10011","32x32":"https://eucalyptus.atlassian.net/secure/projectavatar?size=medium&pid=10006&avatarId=10011"}},"customfield_11000":null,"customfield_11001":null,"fixVersions":[],"aggregatetimespent":null,"resolution":null,"customfield_10310":null,"customfield_11401":null,"customfield_11400":null,"customfield_10302":null,"customfield_10104":[],"customfield_10500":{"self":"https://eucalyptus.atlassian.net/rest/api/2/customFieldOption/10403","value":"Not Applicable","id":"10403"},"customfield_10303":null,"customfield_10105":null,"customfield_10304":null,"customfield_10700":null,"customfield_10701":null,"customfield_10702":null,"customfield_10306":null,"customfield_10703":null,"customfield_10308":null,"customfield_10704":null,"resolutiondate":null,"customfield_10309":null,"customfield_10705":null,"workratio":-1,"watches":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/DOC-1663/watchers","watchCount":2,"isWatching":false},"lastViewed":null,"created":"2015-09-03T11:42:57.069-0500","customfield_12000":null,"customfield_12400":null,"priority":{"self":"https://eucalyptus.atlassian.net/rest/api/2/priority/4","iconUrl":"https://eucalyptus.atlassian.net/images/icons/priorities/minor.svg","name":"Minor","id":"4"},"customfield_12201":null,"customfield_12600":"{}","customfield_10102":null,"customfield_10300":null,"labels":[],"customfield_10301":null,"customfield_11700":null,"customfield_11900":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_11901":null,"versions":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/version/15700","id":"15700","description":"Eucalyptus 4.1.1","name":"4.1.1","archived":false,"released":true,"releaseDate":"2015-05-11"}],"issuelinks":[],"assignee":null,"updated":"2016-03-10T18:55:32.690-0600","status":{"self":"https://eucalyptus.atlassian.net/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://eucalyptus.atlassian.net/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://eucalyptus.atlassian.net/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"components":[],"timeoriginalestimate":null,"customfield_13000":null,"description":"The following documentation is out of date due to the changes in the underlying database.  Original instructions can be found here:\r\nhttps://github.com/eucalyptus/eucalyptus/wiki/CloudWatch-FAQ\r\n\r\nThe instructions should be updated as follows\r\n# Save the following sql statements as a file on your system (in this example empty.sql)\r\n{noformat}\r\ndelete from eucalyptus_cloudwatch.absolute_metric_history;\r\ndelete from eucalyptus_cloudwatch.alarms;\r\ndelete from eucalyptus_cloudwatch.list_metrics;\r\ndelete from eucalyptus_cloudwatch_backend.alarm_history;\r\ndelete from eucalyptus_cloudwatch_backend.custom_metric_data_0;\r\ndelete from eucalyptus_cloudwatch_backend.custom_metric_data_1;\r\ndelete from eucalyptus_cloudwatch_backend.custom_metric_data_2;\r\ndelete from eucalyptus_cloudwatch_backend.custom_metric_data_3;\r\ndelete from eucalyptus_cloudwatch_backend.custom_metric_data_4;\r\ndelete from eucalyptus_cloudwatch_backend.custom_metric_data_5;\r\ndelete from eucalyptus_cloudwatch_backend.custom_metric_data_6;\r\ndelete from eucalyptus_cloudwatch_backend.custom_metric_data_7;\r\ndelete from eucalyptus_cloudwatch_backend.custom_metric_data_8;\r\ndelete from eucalyptus_cloudwatch_backend.custom_metric_data_9;\r\ndelete from eucalyptus_cloudwatch_backend.custom_metric_data_a;\r\ndelete from eucalyptus_cloudwatch_backend.custom_metric_data_b;\r\ndelete from eucalyptus_cloudwatch_backend.custom_metric_data_c;\r\ndelete from eucalyptus_cloudwatch_backend.custom_metric_data_d;\r\ndelete from eucalyptus_cloudwatch_backend.custom_metric_data_e;\r\ndelete from eucalyptus_cloudwatch_backend.custom_metric_data_f;\r\ndelete from eucalyptus_cloudwatch_backend.metric_data;\r\ndelete from eucalyptus_cloudwatch_backend.system_metric_data_0;\r\ndelete from eucalyptus_cloudwatch_backend.system_metric_data_1;\r\ndelete from eucalyptus_cloudwatch_backend.system_metric_data_2;\r\ndelete from eucalyptus_cloudwatch_backend.system_metric_data_3;\r\ndelete from eucalyptus_cloudwatch_backend.system_metric_data_4;\r\ndelete from eucalyptus_cloudwatch_backend.system_metric_data_5;\r\ndelete from eucalyptus_cloudwatch_backend.system_metric_data_6;\r\ndelete from eucalyptus_cloudwatch_backend.system_metric_data_7;\r\ndelete from eucalyptus_cloudwatch_backend.system_metric_data_8;\r\ndelete from eucalyptus_cloudwatch_backend.system_metric_data_9;\r\ndelete from eucalyptus_cloudwatch_backend.system_metric_data_a;\r\ndelete from eucalyptus_cloudwatch_backend.system_metric_data_b;\r\ndelete from eucalyptus_cloudwatch_backend.system_metric_data_c;\r\ndelete from eucalyptus_cloudwatch_backend.system_metric_data_d;\r\ndelete from eucalyptus_cloudwatch_backend.system_metric_data_e;\r\ndelete from eucalyptus_cloudwatch_backend.system_metric_data_f;\r\n{noformat}\r\n# Run the following command on the CLC:\r\n{noformat}\r\npsql -h /var/lib/eucalyptus/db/data -p 8777 eucalyptus_shared < empty.sql\r\n{noformat}","customfield_13200":null,"customfield_11300":null,"customfield_11500":null,"timetracking":{},"customfield_10005":null,"customfield_10401":null,"customfield_10600":null,"customfield_12900":null,"aggregatetimeestimate":null,"attachment":[],"summary":"Update instructions for purging CloudWatch data from database manually","creator":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=jgallucci32","name":"jgallucci32","key":"jgallucci32","accountId":"557058:1cd98ee4-b2ee-4683-a315-2a6abd75b048","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/31cfdf964a6ac26962c22f3279e2c85c?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FavatarId%3D10122%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/31cfdf964a6ac26962c22f3279e2c85c?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26avatarId%3D10122%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/31cfdf964a6ac26962c22f3279e2c85c?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26avatarId%3D10122%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/31cfdf964a6ac26962c22f3279e2c85c?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26avatarId%3D10122%26noRedirect%3Dtrue"},"displayName":"John Gallucci","active":true,"timeZone":"America/Los_Angeles"},"subtasks":[],"reporter":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=jgallucci32","name":"jgallucci32","key":"jgallucci32","accountId":"557058:1cd98ee4-b2ee-4683-a315-2a6abd75b048","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/31cfdf964a6ac26962c22f3279e2c85c?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FavatarId%3D10122%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/31cfdf964a6ac26962c22f3279e2c85c?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26avatarId%3D10122%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/31cfdf964a6ac26962c22f3279e2c85c?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26avatarId%3D10122%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/31cfdf964a6ac26962c22f3279e2c85c?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26avatarId%3D10122%26noRedirect%3Dtrue"},"displayName":"John Gallucci","active":true,"timeZone":"America/Los_Angeles"},"aggregateprogress":{"progress":0,"total":0},"customfield_10000":null,"customfield_12100":"0|i03dcv:","customfield_10001":null,"customfield_10200":null,"customfield_10002":null,"customfield_10003":null,"customfield_12500":null,"customfield_10400":null,"customfield_10116":null,"customfield_11600":["jgallucci32(jgallucci32)"],"environment":"n/a","customfield_10117":null,"customfield_11800":null,"customfield_11802":null,"customfield_11805":null,"duedate":null,"progress":{"progress":0,"total":0},"customfield_11806":null,"votes":{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/DOC-1663/votes","votes":0,"hasVoted":false},"comment":{"comments":[{"self":"https://eucalyptus.atlassian.net/rest/api/2/issue/38042/comment/100236","id":"100236","author":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=jgallucci32","name":"jgallucci32","key":"jgallucci32","accountId":"557058:1cd98ee4-b2ee-4683-a315-2a6abd75b048","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/31cfdf964a6ac26962c22f3279e2c85c?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FavatarId%3D10122%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/31cfdf964a6ac26962c22f3279e2c85c?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26avatarId%3D10122%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/31cfdf964a6ac26962c22f3279e2c85c?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26avatarId%3D10122%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/31cfdf964a6ac26962c22f3279e2c85c?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26avatarId%3D10122%26noRedirect%3Dtrue"},"displayName":"John Gallucci","active":true,"timeZone":"America/Los_Angeles"},"body":"I have developed a better set of instructions.  Using DELETE does not free up the disk space on the system.  Using TRUNCATE does.  Also some of the tables, if deleted, cause CloudWatch to break for already running ELBs and they have to be restarted.\r\n\r\nThis script can be ran reliably to free up the disk space\r\n\r\n# Create SQL Script\r\n{noformat}\r\ncat << EOF > /tmp/remove-backend-metrics.sql\r\nTRUNCATE eucalyptus_reporting_backend.reporting_instance_usage_events;\r\nTRUNCATE eucalyptus_cloudwatch_backend.custom_metric_data_0;\r\nTRUNCATE eucalyptus_cloudwatch_backend.custom_metric_data_1;\r\nTRUNCATE eucalyptus_cloudwatch_backend.custom_metric_data_2;\r\nTRUNCATE eucalyptus_cloudwatch_backend.custom_metric_data_3;\r\nTRUNCATE eucalyptus_cloudwatch_backend.custom_metric_data_4;\r\nTRUNCATE eucalyptus_cloudwatch_backend.custom_metric_data_5;\r\nTRUNCATE eucalyptus_cloudwatch_backend.custom_metric_data_6;\r\nTRUNCATE eucalyptus_cloudwatch_backend.custom_metric_data_7;\r\nTRUNCATE eucalyptus_cloudwatch_backend.custom_metric_data_8;\r\nTRUNCATE eucalyptus_cloudwatch_backend.custom_metric_data_9;\r\nTRUNCATE eucalyptus_cloudwatch_backend.custom_metric_data_a;\r\nTRUNCATE eucalyptus_cloudwatch_backend.custom_metric_data_b;\r\nTRUNCATE eucalyptus_cloudwatch_backend.custom_metric_data_c;\r\nTRUNCATE eucalyptus_cloudwatch_backend.custom_metric_data_d;\r\nTRUNCATE eucalyptus_cloudwatch_backend.custom_metric_data_e;\r\nTRUNCATE eucalyptus_cloudwatch_backend.custom_metric_data_f;\r\nTRUNCATE eucalyptus_cloudwatch_backend.system_metric_data_0;\r\nTRUNCATE eucalyptus_cloudwatch_backend.system_metric_data_1;\r\nTRUNCATE eucalyptus_cloudwatch_backend.system_metric_data_2;\r\nTRUNCATE eucalyptus_cloudwatch_backend.system_metric_data_3;\r\nTRUNCATE eucalyptus_cloudwatch_backend.system_metric_data_4;\r\nTRUNCATE eucalyptus_cloudwatch_backend.system_metric_data_5;\r\nTRUNCATE eucalyptus_cloudwatch_backend.system_metric_data_6;\r\nTRUNCATE eucalyptus_cloudwatch_backend.system_metric_data_7;\r\nTRUNCATE eucalyptus_cloudwatch_backend.system_metric_data_8;\r\nTRUNCATE eucalyptus_cloudwatch_backend.system_metric_data_9;\r\nTRUNCATE eucalyptus_cloudwatch_backend.system_metric_data_a;\r\nTRUNCATE eucalyptus_cloudwatch_backend.system_metric_data_b;\r\nTRUNCATE eucalyptus_cloudwatch_backend.system_metric_data_c;\r\nTRUNCATE eucalyptus_cloudwatch_backend.system_metric_data_d;\r\nTRUNCATE eucalyptus_cloudwatch_backend.system_metric_data_e;\r\nTRUNCATE eucalyptus_cloudwatch_backend.system_metric_data_f;\r\nEOF\r\n{noformat}\r\n# Execute Script\r\n{noformat}\r\npsql -h /var/lib/eucalyptus/db/data -p 8777 eucalyptus_shared < /tmp/remove-backend-metrics.sql\r\n{noformat}","updateAuthor":{"self":"https://eucalyptus.atlassian.net/rest/api/2/user?username=jgallucci32","name":"jgallucci32","key":"jgallucci32","accountId":"557058:1cd98ee4-b2ee-4683-a315-2a6abd75b048","avatarUrls":{"48x48":"https://avatar-cdn.atlassian.com/31cfdf964a6ac26962c22f3279e2c85c?s=48&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3FavatarId%3D10122%26noRedirect%3Dtrue","24x24":"https://avatar-cdn.atlassian.com/31cfdf964a6ac26962c22f3279e2c85c?s=24&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dsmall%26avatarId%3D10122%26noRedirect%3Dtrue","16x16":"https://avatar-cdn.atlassian.com/31cfdf964a6ac26962c22f3279e2c85c?s=16&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dxsmall%26avatarId%3D10122%26noRedirect%3Dtrue","32x32":"https://avatar-cdn.atlassian.com/31cfdf964a6ac26962c22f3279e2c85c?s=32&d=https%3A%2F%2Feucalyptus.atlassian.net%2Fsecure%2Fuseravatar%3Fsize%3Dmedium%26avatarId%3D10122%26noRedirect%3Dtrue"},"displayName":"John Gallucci","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-03-10T18:55:32.690-0600","updated":"2016-03-10T18:55:32.690-0600"}],"maxResults":1,"total":1,"startAt":0},"customfield_11808":null,"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]}}}